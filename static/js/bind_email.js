"use strict";var domain="https://comments.saobby.com";function load_bound_email(){fetch_data(domain+"/api/get_bound_email","POST",headers,JSON.stringify({access_token:localStorage["access-token"]})).then((function(e){var n=JSON.parse(e.response_text);n.success?gebi("email-addr").innerHTML=n.data.address?rsc(n.data.address):"当前还未绑定邮箱":gebi("email-addr").innerHTML="无法加载已绑定邮箱:"+n.message}),(function(e){gebi("email-addr").innerHTML="无法加载已绑定邮箱:"+e.message}))}function send_email(){var e=gebi("email-addr-input").value;e?(set_btn_html(gebi("send-email-btn"),"..."),saobbyCaptchaV2.open_window_and_return_promise().then((function(n){set_btn_html(gebi("send-email-btn"),"请稍候");var i={access_token:localStorage["access-token"],captcha_token:n.captcha_token,address:e};fetch_data(domain+"/api/bind_email","POST",headers,JSON.stringify(i)).then((function(e){var n=JSON.parse(e.response_text);n.success?gebi("send-email-result").innerHTML="已发送验证邮件，请查收":gebi("send-email-result").innerHTML=n.message,set_btn_html(gebi("send-email-btn"))}),(function(e){gebi("send-email-result").innerHTML=e.message,set_btn_html(gebi("send-email-btn"))}))}),(function(e){gebi("send-email-result").innerHTML="请先完成人机验证:"+e.message,set_btn_html(gebi("send-email-btn"))}))):gebi("send-email-result").innerHTML="请输入邮箱地址"}function unbind_email(){set_btn_html(gebi("unbind-email-btn"),"请稍候"),fetch_data(domain+"/api/unbind_email","POST",headers,JSON.stringify({access_token:localStorage["access-token"]})).then((function(e){var n=JSON.parse(e.response_text);n.success?gebi("unbind-email-result").innerHTML="解绑成功!":gebi("unbind-email-result").innerHTML=n.message,set_btn_html(gebi("unbind-email-btn"))}),(function(e){gebi("unbind-email-result").innerHTML=e.message,set_btn_html(gebi("unbind-email-btn"))}))}null==localStorage.getItem("access-token")&&(localStorage.login_redirect=window.location.href,window.location="/login"),load_bound_email();