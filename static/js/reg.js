var domain="https://comment.saobby.cf";function reg(){var e=document.getElementById("username").value,t=document.getElementById("password").value,n=document.getElementById("password2").value;""==e|""==t|""==n?document.getElementById("result").innerHTML="用户名和密码均不能为空!":t==n?(get_captcha_img(),document.getElementById("captcha-window").hidden=!1):document.getElementById("result").innerHTML="两次密码输入不一致!"}function complete_captcha(){document.getElementById("reg-btn").disabled=!0,document.getElementById("reg-btn").innerHTML="请稍候";var e=document.getElementById("username").value,t=document.getElementById("password").value,n=document.getElementById("captcha-token").value,o=new XMLHttpRequest;o.open("POST",domain+"/api/register",!0),o.setRequestHeader("Content-Type","application/json");var a={username:e,password:t,captcha_token:n};o.send(JSON.stringify(a)),o.onreadystatechange=function(){4==o.readyState&&(ret_json=JSON.parse(o.responseText),ret_json.success?(localStorage.setItem("access-token",ret_json.data.access_token),void 0===localStorage.login_redirect?window.location="/":(window.location=localStorage.login_redirect,localStorage.login_redirect=void 0)):(document.getElementById("reg-btn").disabled=!1,document.getElementById("reg-btn").innerHTML="注册",document.getElementById("result").innerHTML=ret_json.message))}}