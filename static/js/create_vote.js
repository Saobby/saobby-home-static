"use strict";var options=["",""],domain="https://vote.saobby.com";function add_option(){options.push(""),render_options()}function remove_option(t){options.splice(t,1),render_options()}function render_options(){var t="";for(var n in options){var e=options[n];t+='<input type="text" class="wux-form-input wux-form-input-md" placeholder="选项'.concat(parseInt(n)+1,'" value="').concat(rsc(e),'" onchange="options[').concat(n,']=this.value;"><button class="wux-btn wux-btn-primary" type="button" onclick="remove_option(').concat(n,');">').concat(icon_with_text("trash-white","删除此项"),"</button><hr>")}gebi("options-div").innerHTML=t}function submit(){function t(t){!function n(e){for(var o=e.children,i=0;i<o.length;i++)o[i].disabled=t,n(o[i])}(gebi("config"))}var n=gebi("title").value,e=options.length,o=gebi("always-show-result"),i={true:!0,false:!1}[o.options[o.selectedIndex].value],s=gebi("font-size").value,r=gebi("font-color").value;""===n||""===s||""===r||include("",options)?gebi("result").innerHTML="所有字段均不能为空":e<2?gebi("result").innerHTML="请至少添加2个选项":(t(!0),set_btn_html(gebi("submit-btn"),"..."),saobbyCaptchaV2.open_window_and_return_promise().then((function(o){gebi("submit-btn").innerHTML="请稍候";var a={options_amount:e,always_show_result:i,show_number:gebi("show-number").checked,show_percent:gebi("show-percent").checked,font_size:s,font_color:r,captcha_token:gebi("scpc-token").value};fetch_data(domain+"/api/create_vote","POST",headers,JSON.stringify(a)).then((function(e){var o=JSON.parse(e.response_text);if(o.success){gebi("result").innerHTML="创建成功";var i="**投票:".concat(n,"**(点击选项进行投票):  \n");for(var s in options){var r=options[s];i+="[".concat(r,"](").concat(domain+"/v/"+o.data.vote_id+"/"+s.toString(),") ![](").concat(domain+"/i/"+o.data.vote_id+"/"+s.toString(),")  \n")}gebi("markdown").value=i}else gebi("result").innerHTML=o.message;t(!1),set_btn_html(gebi("submit-btn"))}),(function(n){gebi("result").innerHTML=n.message,t(!1),set_btn_html(gebi("submit-btn"))}))}),(function(n){gebi("result").innerHTML="请先完成人机验证:"+n.message,t(!1),set_btn_html(gebi("submit-btn"))})))}render_options();