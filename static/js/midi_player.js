"use strict";var _excluded=["offset"],_excluded2=["curve","oversample"],_excluded3=["coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","positionX","positionY","positionZ","refDistance","rolloffFactor"],_excluded4=["channelCount","channelCountMode","pan"];function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,e)},_wrapNativeSuper(e)}function _construct(e,t,n){if(_isNativeReflectConstruct())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&_setPrototypeOf(i,n.prototype),i}function _isNativeFunction(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}function _superPropGet(e,t,n,r){var i=_get(_getPrototypeOf(1&r?e.prototype:e),t,n);return 2&r&&"function"==typeof i?function(e){return i.apply(n,e)}:i}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=_superPropBase(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(arguments.length<3?e:n):i.value}},_get.apply(null,arguments)}function _superPropBase(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_getPrototypeOf(e)););return e}function _objectWithoutProperties(e,t){if(null==e)return{};var n,r,i=_objectWithoutPropertiesLoose(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function _objectWithoutPropertiesLoose(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}function _callSuper(e,t,n){return t=_getPrototypeOf(t),_possibleConstructorReturn(e,_isNativeReflectConstruct()?Reflect.construct(t,n||[],_getPrototypeOf(e).constructor):t.apply(e,n))}function _possibleConstructorReturn(e,t){if(t&&("object"==_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_isNativeReflectConstruct=function(){return!!e})()}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _regeneratorRuntime(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */_regeneratorRuntime=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function l(e,t,n,r){var o=t&&t.prototype instanceof g?t:g,a=Object.create(o.prototype),s=new M(r||[]);return i(a,"_invoke",{value:C(e,n,s)}),a}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=l;var f="suspendedStart",p="suspendedYield",d="executing",m="completed",v={};function g(){}function y(){}function _(){}var k={};c(k,a,(function(){return this}));var b=Object.getPrototypeOf,S=b&&b(b(N([])));S&&S!==n&&r.call(S,a)&&(k=S);var w=_.prototype=g.prototype=Object.create(k);function x(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(i,o,a,s){var u=h(e[i],e,o);if("throw"!==u.type){var c=u.arg,l=c.value;return l&&"object"==_typeof(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(l).then((function(e){c.value=e,a(c)}),(function(e){return n("throw",e,a,s)}))}s(u.arg)}var o;i(this,"_invoke",{value:function(e,r){function i(){return new t((function(t,i){n(e,r,t,i)}))}return o=o?o.then(i,i):i()}})}function C(t,n,r){var i=f;return function(o,a){if(i===d)throw Error("Generator is already running");if(i===m){if("throw"===o)throw a;return{value:e,done:!0}}for(r.method=o,r.arg=a;;){var s=r.delegate;if(s){var u=P(s,r);if(u){if(u===v)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=d;var c=h(t,n,r);if("normal"===c.type){if(i=r.done?m:p,c.arg===v)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(i=m,r.method="throw",r.arg=c.arg)}}}function P(t,n){var r=n.method,i=t.iterator[r];if(i===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,P(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var o=h(i,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,v;var a=o.arg;return a?a.done?(n[t.resultName]=a.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function O(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function N(t){if(t||""===t){var n=t[a];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function n(){for(;++i<t.length;)if(r.call(t,i))return n.value=t[i],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(_typeof(t)+" is not iterable")}return y.prototype=_,i(w,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:y,configurable:!0}),y.displayName=c(_,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,_):(e.__proto__=_,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},t.awrap=function(e){return{__await:e}},x(T.prototype),c(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,i,o){void 0===o&&(o=Promise);var a=new T(l(e,n,r,i),o);return t.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(w),c(w,u,"Generator"),c(w,a,(function(){return this})),c(w,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=N,M.prototype={constructor:M,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(O),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function i(r,i){return s.type="throw",s.arg=t,n.next=r,i&&(n.method="next",n.arg=e),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var u=r.call(a,"catchLoc"),c=r.call(a,"finallyLoc");if(u&&c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),O(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;O(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:N(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),v}},t}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return(t=_toPropertyKey(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function _asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){asyncGeneratorStep(o,r,i,a,s,"next",e)}function s(e){asyncGeneratorStep(o,r,i,a,s,"throw",e)}a(void 0)}))}}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,o,a,s=[],u=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);u=!0);}catch(e){c=!0,i=e}finally{try{if(!u&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}!function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.Tone=t():e.Tone=t()}("undefined"!=typeof self?self:void 0,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=9)}([function(e,t,n){!function(e,t,n,r){function i(e){return e&&"object"==_typeof(e)&&"default"in e?e:{default:e}}var o=i(t),a=i(n),s=i(r),u=function(e,t,n){return{endTime:t,insertTime:n,type:"exponentialRampToValue",value:e}},c=function(e,t,n){return{endTime:t,insertTime:n,type:"linearRampToValue",value:e}},l=function(e,t){return{startTime:t,type:"setValue",value:e}},h=function(e,t,n){return{duration:n,startTime:t,type:"setValueCurve",values:e}},f=function(e,t,n){var r=n.startTime,i=n.target,o=n.timeConstant;return i+(t-i)*Math.exp((r-e)/o)},p=function(e){return"exponentialRampToValue"===e.type},d=function(e){return"linearRampToValue"===e.type},m=function(e){return p(e)||d(e)},v=function(e){return"setValue"===e.type},g=function(e){return"setValueCurve"===e.type},y=function e(t,n,r,i){var o=t[n];return void 0===o?i:m(o)||v(o)?o.value:g(o)?o.values[o.values.length-1]:f(r,e(t,n-1,o.startTime,i),o)},_=function(e,t,n,r,i){return void 0===n?[r.insertTime,i]:m(n)?[n.endTime,n.value]:v(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(e,t-1,n.startTime,i)]},k=function(e){return"cancelAndHold"===e.type},b=function(e){return"cancelScheduledValues"===e.type},S=function(e){return k(e)||b(e)?e.cancelTime:p(e)||d(e)?e.endTime:e.startTime},w=function(e,t,n,r){var i=r.endTime,o=r.value;return n===o?o:0<n&&0<o||n<0&&o<0?n*Math.pow(o/n,(e-t)/(i-t)):0},x=function(e,t,n,r){return n+(e-t)/(r.endTime-t)*(r.value-n)},T=function(e){return"setTarget"===e.type},C=function(){function e(t){a.default(this,e),this._automationEvents=[],this._currenTime=0,this._defaultValue=t}return s.default(e,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(e){var t=S(e);if(k(e)||b(e)){var n=this._automationEvents.findIndex((function(n){return b(e)&&g(n)?n.startTime+n.duration>=t:S(n)>=t})),r=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),k(e)){var i=this._automationEvents[this._automationEvents.length-1];if(void 0!==r&&m(r)){if(T(i))throw new Error("The internal list is malformed.");var o=g(i)?i.startTime+i.duration:S(i),a=g(i)?i.values[i.values.length-1]:i.value,s=p(r)?w(t,o,a,r):x(t,o,a,r),f=p(r)?u(s,t,this._currenTime):c(s,t,this._currenTime);this._automationEvents.push(f)}void 0!==i&&T(i)&&this._automationEvents.push(l(this.getValue(t),t)),void 0!==i&&g(i)&&i.startTime+i.duration>t&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),i.startTime,t-i.startTime))}}else{var v=this._automationEvents.findIndex((function(e){return S(e)>t})),y=-1===v?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[v-1];if(void 0!==y&&g(y)&&S(y)+y.duration>t)return!1;var _=p(e)?u(e.value,e.endTime,this._currenTime):d(e)?c(e.value,t,this._currenTime):e;if(-1===v)this._automationEvents.push(_);else{if(g(e)&&t+e.duration>S(this._automationEvents[v]))return!1;this._automationEvents.splice(v,0,_)}}return!0}},{key:"flush",value:function(e){var t=this._automationEvents.findIndex((function(t){return S(t)>e}));if(t>1){var n=this._automationEvents.slice(t-1),r=n[0];T(r)&&n.unshift(l(y(this._automationEvents,t-2,r.startTime,this._defaultValue),r.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(e){if(0===this._automationEvents.length)return this._defaultValue;var t=this._automationEvents[this._automationEvents.length-1],n=this._automationEvents.findIndex((function(t){return S(t)>e})),r=this._automationEvents[n],i=S(t)<=e?t:this._automationEvents[n-1];if(void 0!==i&&T(i)&&(void 0===r||!m(r)||r.insertTime>e))return f(e,y(this._automationEvents,n-2,i.startTime,this._defaultValue),i);if(void 0!==i&&v(i)&&(void 0===r||!m(r)))return i.value;if(void 0!==i&&g(i)&&(void 0===r||!m(r)||i.startTime+i.duration>e))return e<i.startTime+i.duration?function(e,t){var n=t.duration,r=t.startTime,i=t.values;return function(e,t){var n=Math.floor(t),r=Math.ceil(t);return n===r?e[n]:(1-(t-n))*e[n]+(1-(r-t))*e[r]}(i,(e-r)/n*(i.length-1))}(e,i):i.values[i.values.length-1];if(void 0!==i&&m(i)&&(void 0===r||!m(r)))return i.value;if(void 0!==r&&p(r)){var a=_(this._automationEvents,n-1,i,r,this._defaultValue),s=o.default(a,2),u=s[0],c=s[1];return w(e,u,c,r)}if(void 0!==r&&d(r)){var l=_(this._automationEvents,n-1,i,r,this._defaultValue),h=o.default(l,2),k=h[0],b=h[1];return x(e,k,b,r)}return this._defaultValue}}]),e}();e.AutomationEventList=C,e.createCancelAndHoldAutomationEvent=function(e){return{cancelTime:e,type:"cancelAndHold"}},e.createCancelScheduledValuesAutomationEvent=function(e){return{cancelTime:e,type:"cancelScheduledValues"}},e.createExponentialRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"exponentialRampToValue",value:e}},e.createLinearRampToValueAutomationEvent=function(e,t){return{endTime:t,type:"linearRampToValue",value:e}},e.createSetTargetAutomationEvent=function(e,t,n){return{startTime:t,target:e,timeConstant:n,type:"setTarget"}},e.createSetValueAutomationEvent=l,e.createSetValueCurveAutomationEvent=h,Object.defineProperty(e,"__esModule",{value:!0})}(t,n(1),n(7),n(8))},function(e,t,n){var r=n(2),i=n(3),o=n(4),a=n(6);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t,n){var r=n(5);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=_regeneratorRuntime().mark(us),i=_regeneratorRuntime().mark(cs),o=_regeneratorRuntime().mark(ls),a=_regeneratorRuntime().mark(fs),s=_regeneratorRuntime().mark(ps),u=_regeneratorRuntime().mark(ds),c=_regeneratorRuntime().mark(ms);n.r(t),n.d(t,"getContext",(function(){return Yi})),n.d(t,"setContext",(function(){return Xi})),n.d(t,"Clock",(function(){return Mo})),n.d(t,"Context",(function(){return Li})),n.d(t,"BaseContext",(function(){return Fi})),n.d(t,"Delay",(function(){return No})),n.d(t,"Gain",(function(){return So})),n.d(t,"Offline",(function(){return Io})),n.d(t,"OfflineContext",(function(){return Hi})),n.d(t,"Param",(function(){return go})),n.d(t,"ToneAudioBuffer",(function(){return Ui})),n.d(t,"ToneAudioBuffers",(function(){return Eo})),n.d(t,"ToneAudioNode",(function(){return yo})),n.d(t,"connectSeries",(function(){return _o})),n.d(t,"connect",(function(){return ko})),n.d(t,"disconnect",(function(){return bo})),n.d(t,"FrequencyClass",(function(){return uo})),n.d(t,"Frequency",(function(){return ho})),n.d(t,"MidiClass",(function(){return qo})),n.d(t,"Midi",(function(){return Do})),n.d(t,"TimeClass",(function(){return ao})),n.d(t,"Time",(function(){return so})),n.d(t,"TicksClass",(function(){return Ro})),n.d(t,"Ticks",(function(){return jo})),n.d(t,"TransportTimeClass",(function(){return fo})),n.d(t,"TransportTime",(function(){return po})),n.d(t,"Emitter",(function(){return zi})),n.d(t,"IntervalTimeline",(function(){return Fo})),n.d(t,"StateTimeline",(function(){return vo})),n.d(t,"Timeline",(function(){return Ei})),n.d(t,"isUndef",(function(){return ri})),n.d(t,"isDefined",(function(){return ii})),n.d(t,"isFunction",(function(){return oi})),n.d(t,"isNumber",(function(){return ai})),n.d(t,"isObject",(function(){return si})),n.d(t,"isBoolean",(function(){return ui})),n.d(t,"isArray",(function(){return ci})),n.d(t,"isString",(function(){return li})),n.d(t,"isNote",(function(){return hi})),n.d(t,"dbToGain",(function(){return Ji})),n.d(t,"gainToDb",(function(){return $i})),n.d(t,"intervalToFrequencyRatio",(function(){return eo})),n.d(t,"ftom",(function(){return no})),n.d(t,"mtof",(function(){return io})),n.d(t,"optionsFromArguments",(function(){return xi})),n.d(t,"defaultArg",(function(){return Ti})),n.d(t,"Unit",(function(){return h})),n.d(t,"debug",(function(){return l})),n.d(t,"Noise",(function(){return Xo})),n.d(t,"UserMedia",(function(){return Jo})),n.d(t,"Oscillator",(function(){return ta})),n.d(t,"AMOscillator",(function(){return aa})),n.d(t,"FMOscillator",(function(){return sa})),n.d(t,"PulseOscillator",(function(){return ua})),n.d(t,"FatOscillator",(function(){return ca})),n.d(t,"PWMOscillator",(function(){return la})),n.d(t,"OmniOscillator",(function(){return fa})),n.d(t,"ToneOscillatorNode",(function(){return ea})),n.d(t,"LFO",(function(){return va})),n.d(t,"ToneBufferSource",(function(){return Yo})),n.d(t,"Player",(function(){return _a})),n.d(t,"Players",(function(){return ka})),n.d(t,"GrainPlayer",(function(){return ba})),n.d(t,"Add",(function(){return pa})),n.d(t,"Abs",(function(){return Sa})),n.d(t,"AudioToGain",(function(){return ia})),n.d(t,"GainToAudio",(function(){return wa})),n.d(t,"GreaterThan",(function(){return Pa})),n.d(t,"GreaterThanZero",(function(){return Ca})),n.d(t,"Multiply",(function(){return oa})),n.d(t,"Negate",(function(){return xa})),n.d(t,"Pow",(function(){return Aa})),n.d(t,"Signal",(function(){return To})),n.d(t,"connectSignal",(function(){return Co})),n.d(t,"Scale",(function(){return da})),n.d(t,"ScaleExp",(function(){return Oa})),n.d(t,"Subtract",(function(){return Ta})),n.d(t,"SyncedSignal",(function(){return Ma})),n.d(t,"WaveShaper",(function(){return ra})),n.d(t,"Zero",(function(){return ma})),n.d(t,"AMSynth",(function(){return za})),n.d(t,"DuoSynth",(function(){return Ba})),n.d(t,"FMSynth",(function(){return Ua})),n.d(t,"MetalSynth",(function(){return Qa})),n.d(t,"MembraneSynth",(function(){return Wa})),n.d(t,"MonoSynth",(function(){return Ga})),n.d(t,"NoiseSynth",(function(){return Ya})),n.d(t,"PluckSynth",(function(){return ns})),n.d(t,"PolySynth",(function(){return rs})),n.d(t,"Sampler",(function(){return is})),n.d(t,"Synth",(function(){return Ra})),n.d(t,"Loop",(function(){return as})),n.d(t,"Part",(function(){return ss})),n.d(t,"Pattern",(function(){return gs})),n.d(t,"Sequence",(function(){return ys})),n.d(t,"ToneEvent",(function(){return os})),n.d(t,"AutoFilter",(function(){return Ss})),n.d(t,"AutoPanner",(function(){return xs})),n.d(t,"AutoWah",(function(){return Cs})),n.d(t,"BitCrusher",(function(){return Ps})),n.d(t,"Chebyshev",(function(){return Os})),n.d(t,"Chorus",(function(){return qs})),n.d(t,"Distortion",(function(){return Ds})),n.d(t,"FeedbackDelay",(function(){return js})),n.d(t,"FrequencyShifter",(function(){return Fs})),n.d(t,"Freeverb",(function(){return Gs})),n.d(t,"JCReverb",(function(){return Qs})),n.d(t,"PingPongDelay",(function(){return Ys})),n.d(t,"PitchShift",(function(){return Xs})),n.d(t,"Phaser",(function(){return Zs})),n.d(t,"Reverb",(function(){return Ks})),n.d(t,"StereoWidener",(function(){return tu})),n.d(t,"Tremolo",(function(){return nu})),n.d(t,"Vibrato",(function(){return ru})),n.d(t,"Analyser",(function(){return iu})),n.d(t,"Meter",(function(){return au})),n.d(t,"FFT",(function(){return su})),n.d(t,"DCMeter",(function(){return uu})),n.d(t,"Waveform",(function(){return cu})),n.d(t,"Follower",(function(){return Ts})),n.d(t,"Channel",(function(){return fu})),n.d(t,"CrossFade",(function(){return _s})),n.d(t,"Merge",(function(){return Ns})),n.d(t,"MidSideMerge",(function(){return $s})),n.d(t,"MidSideSplit",(function(){return Js})),n.d(t,"MultibandSplit",(function(){return pu})),n.d(t,"Panner",(function(){return ws})),n.d(t,"Panner3D",(function(){return mu})),n.d(t,"PanVol",(function(){return hu})),n.d(t,"Recorder",(function(){return vu})),n.d(t,"Solo",(function(){return lu})),n.d(t,"Split",(function(){return Ms})),n.d(t,"Volume",(function(){return Vo})),n.d(t,"Compressor",(function(){return gu})),n.d(t,"Gate",(function(){return yu})),n.d(t,"Limiter",(function(){return _u})),n.d(t,"MidSideCompressor",(function(){return ku})),n.d(t,"MultibandCompressor",(function(){return bu})),n.d(t,"AmplitudeEnvelope",(function(){return Da})),n.d(t,"Envelope",(function(){return Na})),n.d(t,"FrequencyEnvelope",(function(){return Va})),n.d(t,"EQ3",(function(){return Su})),n.d(t,"Filter",(function(){return La})),n.d(t,"OnePoleFilter",(function(){return es})),n.d(t,"FeedbackCombFilter",(function(){return $a})),n.d(t,"LowpassCombFilter",(function(){return ts})),n.d(t,"Convolver",(function(){return wu})),n.d(t,"BiquadFilter",(function(){return Fa})),n.d(t,"version",(function(){return f})),n.d(t,"start",(function(){return Zi})),n.d(t,"supported",(function(){return Xr})),n.d(t,"now",(function(){return xu})),n.d(t,"immediate",(function(){return Tu})),n.d(t,"Transport",(function(){return Cu})),n.d(t,"getTransport",(function(){return Pu})),n.d(t,"Destination",(function(){return Au})),n.d(t,"Master",(function(){return Ou})),n.d(t,"getDestination",(function(){return Mu})),n.d(t,"Listener",(function(){return Nu})),n.d(t,"getListener",(function(){return Iu})),n.d(t,"Draw",(function(){return Eu})),n.d(t,"getDraw",(function(){return qu})),n.d(t,"context",(function(){return Du})),n.d(t,"loaded",(function(){return Ru})),n.d(t,"Buffer",(function(){return ju})),n.d(t,"Buffers",(function(){return zu})),n.d(t,"BufferSource",(function(){return Fu}));var l={};n.r(l),n.d(l,"assert",(function(){return Zr})),n.d(l,"assertRange",(function(){return Kr})),n.d(l,"assertContextRunning",(function(){return Jr})),n.d(l,"setLogger",(function(){return ei})),n.d(l,"log",(function(){return ti})),n.d(l,"warn",(function(){return ni}));var h={};n.r(h);var f="14.7.58",p=n(0),d=new WeakSet,m=new WeakMap,v=new WeakMap,g=new WeakMap,y=new WeakMap,_=new WeakMap,k=new WeakMap,b=new WeakMap,S=new WeakMap,w=new WeakMap,x={construct:function(){return x}},T=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,C=function(e,t){for(var n=[],r=e.replace(/^[\s]+/,""),i=r.match(T);null!==i;){var o=i[1].slice(1,-1),a=i[0].replace(/([\s]+)?;?$/,"").replace(o,new URL(o,t).toString());n.push(a),i=(r=r.slice(i[0].length).replace(/^[\s]+/,"")).match(T)}return[n.join(";"),r]},P=function(e){if(void 0!==e&&!Array.isArray(e))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},A=function(e){if(!function(e){try{new new Proxy(e,x)}catch(e){return!1}return!0}(e))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===e.prototype||"object"!=_typeof(e.prototype))throw new TypeError("The given value for processorCtor should have a prototype.")},O={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},M=function(e,t){return e.context===t},N=function(e){try{e.copyToChannel(new Float32Array(1),0,-1)}catch(e){return!1}return!0},I=function(){return new DOMException("","IndexSizeError")},E=function(e){var t;e.getChannelData=(t=e.getChannelData,function(n){try{return t.call(e,n)}catch(e){if(12===e.code)throw I();throw e}})},q={numberOfChannels:1},D=-34028234663852886e22,R=-D,j=function(e){return d.has(e)},z=function(e,t){var n=e.get(t);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},F=function(e){return z(k,e)},L=function(e){if(d.has(e))throw new Error("The AudioNode is already stored.");d.add(e),F(e).forEach((function(e){return e(!0)}))},V=function(e){if(!d.has(e))throw new Error("The AudioNode is not stored.");d.delete(e),F(e).forEach((function(e){return e(!1)}))},G={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},B=function(e){return"port"in e},U=function(e){return z(m,e)},H=function(e){return z(g,e)},Q=function(e,t){U(e).activeInputs.forEach((function(n){return n.forEach((function(n){var r=_slicedToArray(n,1)[0];t.includes(e)||Q(r,[].concat(_toConsumableArray(t),[e]))}))}));var n,r=_createForOfIteratorHelper(function(e){return"playbackRate"in e}(e)?[e.playbackRate]:B(e)?Array.from(e.parameters.values()):function(e){return"frequency"in e&&"gain"in e}(e)?[e.Q,e.detune,e.frequency,e.gain]:function(e){return"offset"in e}(e)?[e.offset]:function(e){return!("frequency"in e)&&"gain"in e}(e)?[e.gain]:function(e){return"detune"in e&&"frequency"in e}(e)?[e.detune,e.frequency]:function(e){return"pan"in e}(e)?[e.pan]:[]);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=H(i);void 0!==o&&o.activeInputs.forEach((function(e){var n=_slicedToArray(e,1)[0];return Q(n,t)}))}}catch(e){r.e(e)}finally{r.f()}j(e)&&V(e)},W=function(e){Q(e.destination,[])},Y=function(e){return"context"in e},X=function(e){return Y(e[0])},Z=function(e){return"inputs"in e},K=function(e,t,n,r){if(Z(t)){var i=t.inputs[r];return e.connect(i,n,0),[i,n,0]}return e.connect(t,n,r),[t,n,r]},J=function(e,t){if(!F(e).delete(t))throw new Error("Missing the expected event listener.")},$=function(e,t,n,r){Z(t)?e.disconnect(t.inputs[r],n,0):e.disconnect(t,n,r)},ee=function(e){return z(v,e)},te=function(e){return z(y,e)},ne=function(e,t,n,r){var i,o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){if(n(i.value)){if(r)return!1;throw Error("The set contains at least one similar element.")}}}catch(e){o.e(e)}finally{o.f()}return e.add(t),!0},re=function(e){return b.has(e)},ie=function(e){return!d.has(e)},oe=function(e,t){var n=Array.from(e).filter(t);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");var r=_slicedToArray(n,1)[0];return e.delete(r),r},ae=function(e,t){!B(e)&&t.every((function(e){return 0===e.size}))&&V(e)},se=function(e){return new Promise((function(t){var n=e.createScriptProcessor(256,1,1),r=e.createGain(),i=e.createBuffer(1,2,44100),o=i.getChannelData(0);o[0]=1,o[1]=1;var a=e.createBufferSource();a.buffer=i,a.loop=!0,a.connect(n).connect(e.destination),a.connect(r),a.disconnect(r),n.onaudioprocess=function(r){var i=r.inputBuffer.getChannelData(0);Array.prototype.some.call(i,(function(e){return 1===e}))?t(!0):t(!1),a.stop(),n.onaudioprocess=null,a.disconnect(n),n.disconnect(e.destination)},a.start()}))},ue=function(e,t){var n,r=new Map,i=_createForOfIteratorHelper(e);try{for(i.s();!(n=i.n()).done;){var o,a=_createForOfIteratorHelper(n.value);try{for(a.s();!(o=a.n()).done;){var s=o.value,u=r.get(s);r.set(s,void 0===u?1:u+1)}}catch(e){a.e(e)}finally{a.f()}}}catch(e){i.e(e)}finally{i.f()}r.forEach((function(e,n){return t(n,e)}))},ce=function(e){return"context"in e},le=function(e,t,n,r){var i=_slicedToArray(n,3),o=i[0],a=i[1],s=i[2];ne(e[a],[t,o,s],(function(e){return e[0]===t&&e[1]===o}),r)},he=function(e,t,n,r){var i=_slicedToArray(n,2),o=i[0],a=i[1];ne(e,[t,o,a],(function(e){return e[0]===t&&e[1]===o}),r)},fe=function(e,t,n,r){var i=_slicedToArray(n,3),o=i[0],a=i[1],s=i[2],u=e.get(o);void 0===u?e.set(o,new Set([[a,t,s]])):ne(u,[a,t,s],(function(e){return e[0]===a&&e[1]===t}),r)},pe=function(e,t,n){var r=_slicedToArray(t,3),i=r[0],o=r[1],a=r[2],s=e.get(i);void 0===s?e.set(i,new Set([[o,a]])):ne(s,[o,a],(function(e){return e[0]===o}),n)},de=function(e,t,n,r){var i=z(e,t),o=oe(i,(function(e){return e[0]===n&&e[1]===r}));return 0===i.size&&e.delete(t),o},me=function(e,t,n){var r=z(e,t),i=oe(r,(function(e){return e[0]===n}));return 0===r.size&&e.delete(t),i},ve=function(e,t,n){var r,i=_createForOfIteratorHelper(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o[0]===t&&o[1]===n)return e.delete(o),o}}catch(e){i.e(e)}finally{i.f()}return null},ge=function(e,t,n,r,i){var o=function(e,t,n,r){var i=U(t),o=i.activeInputs,a=i.passiveInputs,s=ve(o[r],e,n);return null===s?[de(a,e,n,r)[2],!1]:[s[2],!0]}(e,n,r,i),a=_slicedToArray(o,2),s=a[0],u=a[1];if(null!==s&&(J(e,s),!u||t||re(e)||$(ee(e),ee(n),r,i)),j(n)){var c=U(n).activeInputs;ae(n,c)}},ye=function(e,t,n,r){var i=function(e,t,n){var r=H(t),i=r.activeInputs,o=r.passiveInputs,a=ve(i,e,n);return null===a?[me(o,e,n)[1],!1]:[a[2],!0]}(e,n,r),o=_slicedToArray(i,2),a=o[0],s=o[1];null!==a&&(J(e,a),!s||t||re(e)||ee(e).disconnect(te(n),r))},_e=function(){return _createClass((function e(t){_classCallCheck(this,e),this._map=new Map(t)}),[{key:"size",get:function(){return this._map.size}},{key:"entries",value:function(){return this._map.entries()}},{key:"forEach",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._map.forEach((function(r,i){return e.call(n,r,i,t)}))}},{key:"get",value:function(e){return this._map.get(e)}},{key:"has",value:function(e){return this._map.has(e)}},{key:"keys",value:function(){return this._map.keys()}},{key:"values",value:function(){return this._map.values()}}])}(),ke={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function be(e,t,n,r,i){if("function"==typeof e.copyFromChannel)0===t[n].byteLength&&(t[n]=new Float32Array(128)),e.copyFromChannel(t[n],r,i);else{var o=e.getChannelData(r);if(0===t[n].byteLength)t[n]=o.slice(i,i+128);else{var a=new Float32Array(o.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);t[n].set(a)}}}var Se=function(e,t,n,r,i){"function"==typeof e.copyToChannel?0!==t[n].byteLength&&e.copyToChannel(t[n],r,i):0!==t[n].byteLength&&e.getChannelData(r).set(t[n],i)},we=function(e,t){for(var n=[],r=0;r<e;r+=1){for(var i=[],o="number"==typeof t?t:t[r],a=0;a<o;a+=1)i.push(new Float32Array(128));n.push(i)}return n},xe=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i,o,a,s){var u,c,l,h,f,p,d,m,v,g,y;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=null===n?128*Math.ceil(t.context.length/128):n.length,c=i.channelCount*i.numberOfInputs,l=o.reduce((function(e,t){return e+t}),0),h=0===l?null:r.createBuffer(l,u,r.sampleRate),void 0!==a){e.next=3;break}throw new Error("Missing the processor constructor.");case 3:return f=U(t),e.next=6,function(e,t){var n=z(w,e),r=ee(t);return z(n,r)}(r,t);case 6:p=e.sent,d=we(i.numberOfInputs,i.channelCount),m=we(i.numberOfOutputs,o),v=Array.from(t.parameters.keys()).reduce((function(e,t){return _objectSpread(_objectSpread({},e),{},_defineProperty({},t,new Float32Array(128)))}),{}),g=_regeneratorRuntime().mark((function e(u){var l,g,y,_,k,b,S,w,x;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.numberOfInputs>0&&null!==n)for(l=0;l<i.numberOfInputs;l+=1)for(g=0;g<i.channelCount;g+=1)be(n,d[l],g,g,u);for(void 0!==a.parameterDescriptors&&null!==n&&a.parameterDescriptors.forEach((function(e,t){var r=e.name;be(n,v,r,c+t,u)})),y=0;y<i.numberOfInputs;y+=1)for(_=0;_<o[y];_+=1)0===m[y][_].byteLength&&(m[y][_]=new Float32Array(128));if(e.prev=3,k=d.map((function(e,t){return 0===f.activeInputs[t].size?[]:e})),b=s(u/r.sampleRate,r.sampleRate,(function(){return p.process(k,m,v)})),null!==h)for(S=0,w=0;S<i.numberOfOutputs;S+=1){for(x=0;x<o[S];x+=1)Se(h,m[S],x,w+x,u);w+=o[S]}if(b){e.next=8;break}return e.abrupt("return",0);case 8:e.next=14;break;case 10:return e.prev=10,e.t0=e.catch(3),t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.t0.colno,filename:e.t0.filename,lineno:e.t0.lineno,message:e.t0.message})),e.abrupt("return",0);case 14:case"end":return e.stop()}}),e,null,[[3,10]])})),y=0;case 12:if(!(y<u)){e.next=20;break}return e.delegateYield(g(y),"t0",14);case 14:if(0!==e.t0){e.next=17;break}return e.abrupt("break",20);case 17:y+=128,e.next=12;break;case 20:return e.abrupt("return",h);case 21:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o,a,s){return e.apply(this,arguments)}}(),Te={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},Ce={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},Pe={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},Ae={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Oe={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Me={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Ne=function(e,t,n){var r=t[n];if(void 0===r)throw e();return r},Ie={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},Ee={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},qe=function(){return new DOMException("","InvalidStateError")},De=function(){return new DOMException("","InvalidAccessError")},Re={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},je=function(e,t,n,r,i,o,a,s,u,c,l){for(var h=c.length,f=s,p=0;p<h;p+=1){for(var d=n[0]*c[p],m=1;m<i;m+=1){var v=f-m&u-1;d+=n[m]*o[v],d-=e[m]*a[v]}for(var g=i;g<r;g+=1)d+=n[g]*o[f-g&u-1];for(var y=i;y<t;y+=1)d-=e[y]*a[f-y&u-1];o[f]=c[p],a[f]=d,f=f+1&u-1,l[p]=d}return f},ze={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Fe=function(e){var t=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{var n=e.decodeAudioData(t.buffer,(function(){}));return void 0!==n&&(n.catch((function(){})),!0)}catch(e){}return!1},Le=function(e,t,n){var r=t[n];void 0!==r&&r!==e[n]&&(e[n]=r)},Ve=function(e,t){Le(e,t,"channelCount"),Le(e,t,"channelCountMode"),Le(e,t,"channelInterpretation")},Ge=function(e){return"function"==typeof e.getFloatTimeDomainData},Be=function(e,t,n){var r=t[n];void 0!==r&&r!==e[n].value&&(e[n].value=r)},Ue=function(e){var t;e.start=(t=e.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;if("number"==typeof i&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");t.call(e,n,r,i)})},He=function(e){var t;e.stop=(t=e.stop,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(n<0)throw new RangeError("The parameter can't be negative.");t.call(e,n)})},Qe=function(e,t){return null===e?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(e*t)))))},We=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,function(e){return new Promise((function(t,n){var r=new MessageChannel,i=r.port1,o=r.port2;i.onmessage=function(e){var n=e.data;i.close(),o.close(),t(n)},i.onmessageerror=function(e){var t=e.data;i.close(),o.close(),n(t)},o.postMessage(e)}))}(n);case 3:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Ye=function(e,t){var n=e.createBiquadFilter();return Ve(n,t),Be(n,t,"Q"),Be(n,t,"detune"),Be(n,t,"frequency"),Be(n,t,"gain"),Le(n,t,"type"),n},Xe=function(e,t){var n=e.createChannelSplitter(t.numberOfOutputs);return Ve(n,t),function(e){var t=e.numberOfOutputs;Object.defineProperty(e,"channelCount",{get:function(){return t},set:function(e){if(e!==t)throw qe()}}),Object.defineProperty(e,"channelCountMode",{get:function(){return"explicit"},set:function(e){if("explicit"!==e)throw qe()}}),Object.defineProperty(e,"channelInterpretation",{get:function(){return"discrete"},set:function(e){if("discrete"!==e)throw qe()}})}(n),n},Ze=function(e,t){return e.connect=t.connect.bind(t),e.disconnect=t.disconnect.bind(t),e},Ke=function(e,t){var n=e.createDelay(t.maxDelayTime);return Ve(n,t),Be(n,t,"delayTime"),n},Je=function(e,t){var n=e.createGain();return Ve(n,t),Be(n,t,"gain"),n};function $e(e,t){var n=t[0]*t[0]+t[1]*t[1];return[(e[0]*t[0]+e[1]*t[1])/n,(e[1]*t[0]-e[0]*t[1])/n]}function et(e,t){for(var n,r,i=[0,0],o=e.length-1;o>=0;o-=1)r=t,(i=[(n=i)[0]*r[0]-n[1]*r[1],n[0]*r[1]+n[1]*r[0]])[0]+=e[o];return i}var tt,nt,rt,it,ot,at,st,ut,ct,lt,ht,ft,pt,dt,mt,vt,gt,yt,_t,kt,bt,St,wt,xt,Tt,Ct,Pt,At,Ot,Mt,Nt,It,Et,qt,Dt,Rt,jt=function(e,t,n,r){return e.createScriptProcessor(t,n,r)},zt=function(){return new DOMException("","NotSupportedError")},Ft={numberOfChannels:1},Lt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Vt={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},Gt={disableNormalization:!1},Bt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Ut=function(){return new DOMException("","UnknownError")},Ht={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},Qt=function(e){if(null===e)return!1;var t=e.length;return t%2!=0?0!==e[Math.floor(t/2)]:e[t/2-1]+e[t/2]!==0},Wt=function(e,t,n,r){for(var i=Object.getPrototypeOf(e);!i.hasOwnProperty(t);)i=Object.getPrototypeOf(i);var o=Object.getOwnPropertyDescriptor(i,t),a=o.get,s=o.set;Object.defineProperty(e,t,{get:n(a),set:r(s)})},Yt=function(e){var t=e.createOscillator();try{t.start(-1)}catch(e){return e instanceof RangeError}return!1},Xt=function(e){var t=e.createBuffer(1,1,44100),n=e.createBufferSource();n.buffer=t,n.start(),n.stop();try{return n.stop(),!0}catch(e){return!1}},Zt=function(e){var t=e.createOscillator();try{t.stop(-1)}catch(e){return e instanceof RangeError}return!1},Kt=function(){try{new DOMException}catch(e){return!1}return!0},Jt=function(){return new Promise((function(e){var t=new ArrayBuffer(0),n=new MessageChannel,r=n.port1,i=n.port2;r.onmessage=function(t){var n=t.data;return e(null!==n)},i.postMessage(t,[t])}))},$t=function(e,t){var n=t.createGain();e.connect(n);var r,i=(r=e.disconnect,function(){r.call(e,n),e.removeEventListener("ended",i)});e.addEventListener("ended",i),Ze(e,n),e.stop=function(t){var r=!1;return function(){var i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(r)try{t.call(e,i)}catch(e){n.gain.setValueAtTime(0,i)}else t.call(e,i),r=!0}}(e.stop)},en=function(e,t){return function(n){var r={value:e};return Object.defineProperties(n,{currentTarget:r,target:r}),"function"==typeof t?t.call(e,n):t.handleEvent.call(e,n)}},tn=(tt=new Map,nt=new WeakMap,function(e,t){var n=nt.get(e);if(void 0!==n)return n;var r=tt.get(e);if(void 0!==r)return r;try{var i=t();return i instanceof Promise?(tt.set(e,i),i.catch((function(){return!1})).then((function(t){return tt.delete(e),nt.set(e,t),t}))):(nt.set(e,i),i)}catch(t){return nt.set(e,!1),!1}}),nn="undefined"==typeof window?null:window,rn=(rt=tn,it=I,function(e,t){var n=e.createAnalyser();if(Ve(n,t),!(t.maxDecibels>t.minDecibels))throw it();return Le(n,t,"fftSize"),Le(n,t,"maxDecibels"),Le(n,t,"minDecibels"),Le(n,t,"smoothingTimeConstant"),rt(Ge,(function(){return Ge(n)}))||function(e){e.getFloatTimeDomainData=function(t){var n=new Uint8Array(t.length);e.getByteTimeDomainData(n);for(var r=Math.max(n.length,e.fftSize),i=0;i<r;i+=1)t[i]=.0078125*(n[i]-128);return t}}(n),n}),on=(ot=U,function(e){var t=ot(e);if(null===t.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return t.renderer}),an=function(e,t,n){return function(){var r=_asyncToGenerator(_regeneratorRuntime().mark((function r(i,o,a,s){var u,c;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=e(i),c=[].concat(_toConsumableArray(s),[i]),r.next=3,Promise.all(u.activeInputs.map((function(e,r){return Array.from(e).filter((function(e){var t=_slicedToArray(e,1)[0];return!c.includes(t)})).map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(s){var u,l,h,f,p,d;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=_slicedToArray(s,2),l=u[0],h=u[1],f=t(l),e.next=4,f.render(l,o,c);case 4:p=e.sent,d=i.context.destination,n(l)||i===d&&n(i)||p.connect(a,h,r);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())})).reduce((function(e,t){return[].concat(_toConsumableArray(e),_toConsumableArray(t))}),[]));case 3:case"end":return r.stop()}}),r)})));return function(e,t,n,i){return r.apply(this,arguments)}}()}(U,on,re),sn=(at=rn,st=ee,ut=an,function(){var e=new WeakMap;return{render:function(t,n,r){var i,o=e.get(n);return void 0!==o?Promise.resolve(o):(i=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r,i){var o,a;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=st(n),M(o,r)||(a={channelCount:o.channelCount,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,fftSize:o.fftSize,maxDecibels:o.maxDecibels,minDecibels:o.minDecibels,smoothingTimeConstant:o.smoothingTimeConstant},o=at(r,a)),e.set(r,o),t.next=5,ut(n,r,o,i);case 5:return t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)}))),function(e,t,n){return i.apply(this,arguments)})(t,n,r)}}}),un=(ct=_,function(e){var t=ct.get(e);if(void 0===t)throw qe();return t}),cn=function(e){return null===e?null:e.hasOwnProperty("OfflineAudioContext")?e.OfflineAudioContext:e.hasOwnProperty("webkitOfflineAudioContext")?e.webkitOfflineAudioContext:null}(nn),ln=(lt=cn,function(e){return null!==lt&&e instanceof lt}),hn=new WeakMap,fn=(ht=en,function(){return _createClass((function e(t){_classCallCheck(this,e),this._nativeEventTarget=t,this._listeners=new WeakMap}),[{key:"addEventListener",value:function(e,t,n){if(null!==t){var r=this._listeners.get(t);void 0===r&&(r=ht(this,t),"function"==typeof t&&this._listeners.set(t,r)),this._nativeEventTarget.addEventListener(e,r,n)}}},{key:"dispatchEvent",value:function(e){return this._nativeEventTarget.dispatchEvent(e)}},{key:"removeEventListener",value:function(e,t,n){var r=null===t?void 0:this._listeners.get(t);this._nativeEventTarget.removeEventListener(e,void 0===r?null:r,n)}}])}()),pn=function(e){return null===e?null:e.hasOwnProperty("AudioContext")?e.AudioContext:e.hasOwnProperty("webkitAudioContext")?e.webkitAudioContext:null}(nn),dn=(ft=pn,function(e){return null!==ft&&e instanceof ft}),mn=function(e){return function(t){return null!==e&&"function"==typeof e.AudioNode&&t instanceof e.AudioNode}}(nn),vn=function(e){return function(t){return null!==e&&"function"==typeof e.AudioParam&&t instanceof e.AudioParam}}(nn),gn=function(e,t,n,r,i,o,a,s,u,c,l,h,f,p){return function(u){function d(n,r,i,o){var a;_classCallCheck(this,d),(a=_callSuper(this,d,[i]))._context=n,a._nativeAudioNode=i;var s=c(n);return l(s)&&!0!==t(se,(function(){return se(s)}))&&function(e){var t,n,r=new Map;e.connect=(t=e.connect.bind(e),function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=ce(e)?t(e,n,i):t(e,n),a=r.get(e);return void 0===a?r.set(e,[{input:i,output:n}]):a.every((function(e){return e.input!==i||e.output!==n}))&&a.push({input:i,output:n}),o}),e.disconnect=(n=e.disconnect,function(t,i,o){if(n.apply(e),void 0===t)r.clear();else if("number"==typeof t){var a,s=_createForOfIteratorHelper(r);try{for(s.s();!(a=s.n()).done;){var u=_slicedToArray(a.value,2),c=u[0],l=u[1].filter((function(e){return e.output!==t}));0===l.length?r.delete(c):r.set(c,l)}}catch(e){s.e(e)}finally{s.f()}}else if(r.has(t))if(void 0===i)r.delete(t);else{var h=r.get(t);if(void 0!==h){var f=h.filter((function(e){return e.output!==i&&(e.input!==o||void 0===o)}));0===f.length?r.delete(t):r.set(t,f)}}var p,d=_createForOfIteratorHelper(r);try{var m=function(){var t=_slicedToArray(p.value,2),n=t[0];t[1].forEach((function(t){ce(n)?e.connect(n,t.output,t.input):e.connect(n,t.output)}))};for(d.s();!(p=d.n()).done;)m()}catch(e){d.e(e)}finally{d.f()}})}(i),v.set(a,i),k.set(a,new Set),"closed"!==n.state&&r&&L(a),e(a,o,i),a}return _inherits(d,u),_createClass(d,[{key:"channelCount",get:function(){return this._nativeAudioNode.channelCount},set:function(e){this._nativeAudioNode.channelCount=e}},{key:"channelCountMode",get:function(){return this._nativeAudioNode.channelCountMode},set:function(e){this._nativeAudioNode.channelCountMode=e}},{key:"channelInterpretation",get:function(){return this._nativeAudioNode.channelInterpretation},set:function(e){this._nativeAudioNode.channelInterpretation=e}},{key:"context",get:function(){return this._context}},{key:"numberOfInputs",get:function(){return this._nativeAudioNode.numberOfInputs}},{key:"numberOfOutputs",get:function(){return this._nativeAudioNode.numberOfOutputs}},{key:"connect",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(t<0||t>=this._nativeAudioNode.numberOfOutputs)throw r();var u=c(this._context),l=p(u);if(h(e)||f(e))throw i();if(Y(e)){var d=ee(e);try{var m,v=K(this._nativeAudioNode,d,t,a),g=ie(this);(l||g)&&(m=this._nativeAudioNode).disconnect.apply(m,_toConsumableArray(v)),"closed"!==this.context.state&&!g&&ie(e)&&L(e)}catch(e){if(12===e.code)throw i();throw e}if(function(e,t,n,r,i){var o=U(t),a=o.activeInputs,s=o.passiveInputs,u=U(e).outputs,c=F(e),l=function(o){var u=ee(t),c=ee(e);if(o){var l=de(s,e,n,r);le(a,e,l,!1),i||re(e)||K(c,u,n,r),ie(t)&&L(t)}else{var h=function(e,t,n,r){return oe(e[r],(function(e){return e[0]===t&&e[1]===n}))}(a,e,n,r);fe(s,r,h,!1),i||re(e)||$(c,u,n,r),j(t)&&ae(t,a)}};return!!ne(u,[t,n,r],(function(e){return e[0]===t&&e[1]===n&&e[2]===r}),!0)&&(c.add(l),j(e)?le(a,e,[n,r,l],!0):fe(s,r,[e,n,l],!0),!0)}(this,e,t,a,l)){var y=s([this],e);ue(y,n(l))}return e}var _=te(e);if("playbackRate"===_.name)throw o();try{this._nativeAudioNode.connect(_,t),(l||ie(this))&&this._nativeAudioNode.disconnect(_,t)}catch(e){if(12===e.code)throw i();throw e}if(function(e,t,n,r){var i=H(t),o=i.activeInputs,a=i.passiveInputs,s=U(e).outputs,u=F(e),c=function(i){var s=ee(e),u=te(t);if(i){var c=me(a,e,n);he(o,e,c,!1),r||re(e)||s.connect(u,n)}else{var l=function(e,t,n){return oe(e,(function(e){return e[0]===t&&e[1]===n}))}(o,e,n);pe(a,l,!1),r||re(e)||s.disconnect(u,n)}};return!!ne(s,[t,n],(function(e){return e[0]===t&&e[1]===n}),!0)&&(u.add(c),j(e)?he(o,e,[n,c],!0):pe(a,[e,n,c],!0),!0)}(this,e,t,l)){var k=s([this],e);ue(k,n(l))}}},{key:"disconnect",value:function(e,t,n){var o,u=c(this._context),l=p(u);if(void 0===e)o=function(e,t){var n,r=U(e),i=[],o=_createForOfIteratorHelper(r.outputs);try{for(o.s();!(n=o.n()).done;){var a=n.value;X(a)?ge.apply(void 0,[e,t].concat(_toConsumableArray(a))):ye.apply(void 0,[e,t].concat(_toConsumableArray(a))),i.push(a[0])}}catch(e){o.e(e)}finally{o.f()}return r.outputs.clear(),i}(this,l);else if("number"==typeof e){if(e<0||e>=this.numberOfOutputs)throw r();o=function(e,t,n){var r,i=U(e),o=[],a=_createForOfIteratorHelper(i.outputs);try{for(a.s();!(r=a.n()).done;){var s=r.value;s[1]===n&&(X(s)?ge.apply(void 0,[e,t].concat(_toConsumableArray(s))):ye.apply(void 0,[e,t].concat(_toConsumableArray(s))),o.push(s[0]),i.outputs.delete(s))}}catch(e){a.e(e)}finally{a.f()}return o}(this,l,e)}else{if(void 0!==t&&(t<0||t>=this.numberOfOutputs))throw r();if(Y(e)&&void 0!==n&&(n<0||n>=e.numberOfInputs))throw r();if(o=function(e,t,n,r,i){var o=U(e);return Array.from(o.outputs).filter((function(e){return!(e[0]!==n||void 0!==r&&e[1]!==r||void 0!==i&&e[2]!==i)})).map((function(n){return X(n)?ge.apply(void 0,[e,t].concat(_toConsumableArray(n))):ye.apply(void 0,[e,t].concat(_toConsumableArray(n))),o.outputs.delete(n),n[0]}))}(this,l,e,t,n),0===o.length)throw i()}var h,f=_createForOfIteratorHelper(o);try{for(f.s();!(h=f.n()).done;){var d=h.value,m=s([this],d);ue(m,a)}}catch(e){f.e(e)}finally{f.f()}}}])}(u)}((pt=m,function(e,t,n){for(var r=[],i=0;i<n.numberOfInputs;i+=1)r.push(new Set);pt.set(e,{activeInputs:r,outputs:new Set,passiveInputs:new WeakMap,renderer:t})}),tn,function(e,t,n,r,i,o){return function(a){return function(s,u){var c=e.get(s);if(void 0===c){if(!a&&o(s)){var l,h=r(s),f=_createForOfIteratorHelper(n(s).outputs);try{for(f.s();!(l=f.n()).done;){var p=l.value;if(X(p)){var d=r(p[0]);t(h,d,p[1],p[2])}else{var m=i(p[0]);h.disconnect(m,p[1])}}}catch(e){f.e(e)}finally{f.f()}}e.set(s,u)}else e.set(s,c+u)}}}(b,$,U,ee,te,j),I,De,zt,function(e,t,n,r,i,o,a,s){return function(u,c){var l=t.get(u);if(void 0===l)throw new Error("Missing the expected cycle count.");var h=o(u.context),f=s(h);if(l===c){if(t.delete(u),!f&&a(u)){var p,d=r(u),m=_createForOfIteratorHelper(n(u).outputs);try{for(m.s();!(p=m.n()).done;){var v=p.value;if(X(v)){var g=r(v[0]);e(d,g,v[1],v[2])}else{var y=i(v[0]);d.connect(y,v[1])}}}catch(e){m.e(e)}finally{m.f()}}}else t.set(u,l-c)}}(K,b,U,ee,te,un,j,ln),function(e,t,n){return function r(i,o){var a=Y(o)?o:n(e,o);if(function(e){return"delayTime"in e}(a))return[];if(i[0]===a)return[i];if(i.includes(a))return[];var s=t(a).outputs;return Array.from(s).map((function(e){return r([].concat(_toConsumableArray(i),[a]),e[0])})).reduce((function(e,t){return e.concat(t)}),[])}}(hn,U,z),fn,un,dn,mn,vn,ln),yn=function(e,t,n,r,i,o){return function(e){function a(e,n){var s;_classCallCheck(this,a);var u=i(e),c=_objectSpread(_objectSpread({},O),n),l=r(u,c);return(s=_callSuper(this,a,[e,!1,l,o(u)?t():null]))._nativeAnalyserNode=l,s}return _inherits(a,e),_createClass(a,[{key:"fftSize",get:function(){return this._nativeAnalyserNode.fftSize},set:function(e){this._nativeAnalyserNode.fftSize=e}},{key:"frequencyBinCount",get:function(){return this._nativeAnalyserNode.frequencyBinCount}},{key:"maxDecibels",get:function(){return this._nativeAnalyserNode.maxDecibels},set:function(e){var t=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=e,!(e>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=t,n()}},{key:"minDecibels",get:function(){return this._nativeAnalyserNode.minDecibels},set:function(e){var t=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=e,!(this._nativeAnalyserNode.maxDecibels>e))throw this._nativeAnalyserNode.minDecibels=t,n()}},{key:"smoothingTimeConstant",get:function(){return this._nativeAnalyserNode.smoothingTimeConstant},set:function(e){this._nativeAnalyserNode.smoothingTimeConstant=e}},{key:"getByteFrequencyData",value:function(e){this._nativeAnalyserNode.getByteFrequencyData(e)}},{key:"getByteTimeDomainData",value:function(e){this._nativeAnalyserNode.getByteTimeDomainData(e)}},{key:"getFloatFrequencyData",value:function(e){this._nativeAnalyserNode.getFloatFrequencyData(e)}},{key:"getFloatTimeDomainData",value:function(e){this._nativeAnalyserNode.getFloatTimeDomainData(e)}}])}(e)}(gn,sn,I,rn,un,ln),_n=new WeakSet,kn=function(e){return null===e?null:e.hasOwnProperty("AudioBuffer")?e.AudioBuffer:null}(nn),bn=(dt=new Uint32Array(1),function(e){return dt[0]=e,dt[0]}),Sn=function(e,t){return function(n){n.copyFromChannel=function(r,i){var o=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),a=e(i);if(a>=n.numberOfChannels)throw t();for(var s=n.length,u=n.getChannelData(a),c=r.length,l=o<0?-o:0;l+o<s&&l<c;l+=1)r[l]=u[l+o]},n.copyToChannel=function(r,i){var o=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),a=e(i);if(a>=n.numberOfChannels)throw t();for(var s=n.length,u=n.getChannelData(a),c=r.length,l=o<0?-o:0;l+o<s&&l<c;l+=1)u[l+o]=r[l]}}}(bn,I),wn=function(e){return function(t){t.copyFromChannel=function(n){return function(r,i){var o=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),a=e(i);if(o<t.length)return n.call(t,r,a,o)}}(t.copyFromChannel),t.copyToChannel=function(n){return function(r,i){var o=e(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),a=e(i);if(o<t.length)return n.call(t,r,a,o)}}(t.copyToChannel)}}(bn),xn=function(e,t,n,r,i,o,a,s){var u=null;return function(){function c(l){if(_classCallCheck(this,c),null===i)throw new Error("Missing the native OfflineAudioContext constructor.");var h=_objectSpread(_objectSpread({},q),l),f=h.length,p=h.numberOfChannels,d=h.sampleRate;null===u&&(u=new i(1,1,44100));var m=null!==r&&t(o,o)?new r({length:f,numberOfChannels:p,sampleRate:d}):u.createBuffer(p,f,d);if(0===m.numberOfChannels)throw n();return"function"!=typeof m.copyFromChannel?(a(m),E(m)):t(N,(function(){return N(m)}))||s(m),e.add(m),m}return _createClass(c,null,[{key:Symbol.hasInstance,value:function(t){return null!==t&&"object"==_typeof(t)&&Object.getPrototypeOf(t)===c.prototype||e.has(t)}}])}()}(_n,tn,zt,kn,cn,(mt=kn,function(){if(null===mt)return!1;try{new mt({length:1,sampleRate:44100})}catch(e){return!1}return!0}),Sn,wn),Tn=(vt=Je,function(e,t){var n=vt(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});t.connect(n).connect(e.destination);var r=function(){t.removeEventListener("ended",r),t.disconnect(n),n.disconnect()};t.addEventListener("ended",r)}),Cn=function(e,t,n){return function(){var r=_asyncToGenerator(_regeneratorRuntime().mark((function r(i,o,a,s){var u;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return u=t(i),r.next=3,Promise.all(Array.from(u.activeInputs).map(function(){var t=_asyncToGenerator(_regeneratorRuntime().mark((function t(r){var i,u,c,l,h;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=_slicedToArray(r,2),u=i[0],c=i[1],l=e(u),t.next=4,l.render(u,o,s);case 4:h=t.sent,n(u)||h.connect(a,c);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()));case 3:case"end":return r.stop()}}),r)})));return function(e,t,n,i){return r.apply(this,arguments)}}()}(on,H,re),Pn=function(e){return function(t,n,r,i){return e(n,t,r,i)}}(Cn),An=function(e,t,n,r,i,o,a,s,u,c,l){return function(u,h){var f=u.createBufferSource();return Ve(f,h),Be(f,h,"playbackRate"),Le(f,h,"buffer"),Le(f,h,"loop"),Le(f,h,"loopEnd"),Le(f,h,"loopStart"),t(n,(function(){return n(u)}))||function(e){e.start=function(t){var n=!1;return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0;if(n)throw qe();t.call(e,r,i,o),n=!0}}(e.start)}(f),t(r,(function(){return r(u)}))||function(e){var t;e.start=(t=e.start,function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,o=e.buffer,a=null===o?r:Math.min(o.duration,r);null!==o&&a>o.duration-.5/e.context.sampleRate?t.call(e,n,0,0):t.call(e,n,a,i)})}(f),t(i,(function(){return i(u)}))||c(f,u),t(o,(function(){return o(u)}))||Ue(f),t(a,(function(){return a(u)}))||l(f,u),t(s,(function(){return s(u)}))||He(f),e(u,f),f}}(Tn,tn,(function(e){var t=e.createBufferSource();t.start();try{t.start()}catch(e){return!0}return!1}),(function(e){var t=e.createBufferSource(),n=e.createBuffer(1,1,44100);t.buffer=n;try{t.start(0,1)}catch(e){return!1}return!0}),(function(e){var t=e.createBufferSource();t.start();try{t.stop()}catch(e){return!1}return!0}),Yt,Xt,Zt,0,(gt=Wt,function(e,t){var n=t.createBuffer(1,1,t.sampleRate);null===e.buffer&&(e.buffer=n),gt(e,"buffer",(function(t){return function(){var r=t.call(e);return r===n?null:r}}),(function(t){return function(r){return t.call(e,null===r?n:r)}}))}),$t),On=function(e,t){return function(n,r,i,o){return e(r).replay(i),t(r,n,i,o)}}(function(e){return function(t){var n=e(t);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer}}(H),Cn),Mn=function(e,t,n,r,i){return function(){var o=new WeakMap,a=null,s=null;return{set start(e){a=e},set stop(e){s=e},render:function(u,c,l){var h,f=o.get(c);return void 0!==f?Promise.resolve(f):(h=_asyncToGenerator(_regeneratorRuntime().mark((function u(c,l,h){var f,p,d,m;return _regeneratorRuntime().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(f=n(c),(p=M(f,l))||(m={buffer:f.buffer,channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,loop:f.loop,loopEnd:f.loopEnd,loopStart:f.loopStart,playbackRate:f.playbackRate.value},f=t(l,m),null!==a&&(d=f).start.apply(d,_toConsumableArray(a)),null!==s&&f.stop(s)),o.set(l,f),!p){u.next=9;break}return u.next=7,e(l,c.playbackRate,f.playbackRate,h);case 7:u.next=11;break;case 9:return u.next=11,r(l,c.playbackRate,f.playbackRate,h);case 11:return u.next=13,i(c,l,f,h);case 13:return u.abrupt("return",f);case 14:case"end":return u.stop()}}),u)}))),function(e,t,n){return h.apply(this,arguments)})(u,c,l)}}}}(Pn,An,ee,On,an),Nn=function(e,t,n,r,i,o,a,s,u,c,l,h){return function(r,f,d){var m=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,v=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,g=new p.AutomationEventList(d.defaultValue),y=f?function(e){return{replay:function(t){var n,r=_createForOfIteratorHelper(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("exponentialRampToValue"===i.type){var o=i.endTime,a=i.value;t.exponentialRampToValueAtTime(a,o)}else if("linearRampToValue"===i.type){var s=i.endTime,u=i.value;t.linearRampToValueAtTime(u,s)}else if("setTarget"===i.type){var c=i.startTime,l=i.target,h=i.timeConstant;t.setTargetAtTime(l,c,h)}else if("setValue"===i.type){var f=i.startTime,p=i.value;t.setValueAtTime(p,f)}else{if("setValueCurve"!==i.type)throw new Error("Can't apply an unknown automation.");var d=i.duration,m=i.startTime,v=i.values;t.setValueCurveAtTime(v,m,d)}}}catch(e){r.e(e)}finally{r.f()}}}}(g):null,_={get defaultValue(){return d.defaultValue},get maxValue(){return null===m?d.maxValue:m},get minValue(){return null===v?d.minValue:v},get value(){return d.value},set value(e){d.value=e,_.setValueAtTime(e,r.context.currentTime)},cancelAndHoldAtTime:function(e){if("function"==typeof d.cancelAndHoldAtTime)null===y&&g.flush(r.context.currentTime),g.add(i(e)),d.cancelAndHoldAtTime(e);else{var t=Array.from(g).pop();null===y&&g.flush(r.context.currentTime),g.add(i(e));var n=Array.from(g).pop();d.cancelScheduledValues(e),t!==n&&void 0!==n&&("exponentialRampToValue"===n.type?d.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?d.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?d.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&d.setValueCurveAtTime(n.values,n.startTime,n.duration))}return _},cancelScheduledValues:function(e){return null===y&&g.flush(r.context.currentTime),g.add(o(e)),d.cancelScheduledValues(e),_},exponentialRampToValueAtTime:function(e,t){if(0===e)throw new RangeError;if(!Number.isFinite(t)||t<0)throw new RangeError;return null===y&&g.flush(r.context.currentTime),g.add(a(e,t)),d.exponentialRampToValueAtTime(e,t),_},linearRampToValueAtTime:function(e,t){return null===y&&g.flush(r.context.currentTime),g.add(s(e,t)),d.linearRampToValueAtTime(e,t),_},setTargetAtTime:function(e,t,n){return null===y&&g.flush(r.context.currentTime),g.add(u(e,t,n)),d.setTargetAtTime(e,t,n),_},setValueAtTime:function(e,t){return null===y&&g.flush(r.context.currentTime),g.add(c(e,t)),d.setValueAtTime(e,t),_},setValueCurveAtTime:function(e,t,n){var i=e instanceof Float32Array?e:new Float32Array(e);if(null!==h&&"webkitAudioContext"===h.name){for(var o=t+n,a=r.context.sampleRate,s=Math.ceil(t*a),u=Math.floor(o*a),c=u-s,f=new Float32Array(c),p=0;p<c;p+=1){var m=(i.length-1)/n*((s+p)/a-t),v=Math.floor(m),k=Math.ceil(m);f[p]=v===k?i[v]:(1-(m-v))*i[v]+(1-(k-m))*i[k]}null===y&&g.flush(r.context.currentTime),g.add(l(f,t,n)),d.setValueCurveAtTime(f,t,n);var b=u/a;b<o&&_.setValueAtTime(f[f.length-1],b),_.setValueAtTime(i[i.length-1],o)}else null===y&&g.flush(r.context.currentTime),g.add(l(i,t,n)),d.setValueCurveAtTime(i,t,n);return _}};return n.set(_,d),t.set(_,r),e(_,y),_}}((yt=g,function(e,t){yt.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:t})}),hn,y,0,p.createCancelAndHoldAutomationEvent,p.createCancelScheduledValuesAutomationEvent,p.createExponentialRampToValueAutomationEvent,p.createLinearRampToValueAutomationEvent,p.createSetTargetAutomationEvent,p.createSetValueAutomationEvent,p.createSetValueCurveAutomationEvent,pn),In=function(e,t,n,r,i,o,a,s){return function(e){function u(e,r){var s;_classCallCheck(this,u);var c=o(e),l=_objectSpread(_objectSpread({},G),r),h=i(c,l),f=a(c),p=f?t():null;return(s=_callSuper(this,u,[e,!1,h,p]))._audioBufferSourceNodeRenderer=p,s._isBufferNullified=!1,s._isBufferSet=null!==l.buffer,s._nativeAudioBufferSourceNode=h,s._onended=null,s._playbackRate=n(_assertThisInitialized(s),f,h.playbackRate,R,D),s}return _inherits(u,e),_createClass(u,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer},set:function(e){if(this._nativeAudioBufferSourceNode.buffer=e,null!==e){if(this._isBufferSet)throw r();this._isBufferSet=!0}}},{key:"loop",get:function(){return this._nativeAudioBufferSourceNode.loop},set:function(e){this._nativeAudioBufferSourceNode.loop=e}},{key:"loopEnd",get:function(){return this._nativeAudioBufferSourceNode.loopEnd},set:function(e){this._nativeAudioBufferSourceNode.loopEnd=e}},{key:"loopStart",get:function(){return this._nativeAudioBufferSourceNode.loopStart},set:function(e){this._nativeAudioBufferSourceNode.loopStart=e}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"==typeof e?s(this,e):null;this._nativeAudioBufferSourceNode.onended=t;var n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"playbackRate",get:function(){return this._playbackRate}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;if(this._nativeAudioBufferSourceNode.start(t,n,r),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===r?[t,n]:[t,n,r]),"closed"!==this.context.state){L(this);var i=function(){e._nativeAudioBufferSourceNode.removeEventListener("ended",i),setTimeout((function(){j(e)&&V(e)}),1e3)};this._nativeAudioBufferSourceNode.addEventListener("ended",i)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeAudioBufferSourceNode.stop(e),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=e)}}])}(e)}(gn,Mn,Nn,qe,An,un,ln,en),En=function(e,t,n,r,i,o,a,s){return function(e){function u(e,n){var r;_classCallCheck(this,u);var c=o(e),l=a(c),h=i(c,n,l);return(r=_callSuper(this,u,[e,!1,h,l?t(s):null]))._isNodeOfNativeOfflineAudioContext=l,r._nativeAudioDestinationNode=h,r}return _inherits(u,e),_createClass(u,[{key:"channelCount",get:function(){return this._nativeAudioDestinationNode.channelCount},set:function(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(e>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=e}},{key:"channelCountMode",get:function(){return this._nativeAudioDestinationNode.channelCountMode},set:function(e){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=e}},{key:"maxChannelCount",get:function(){return this._nativeAudioDestinationNode.maxChannelCount}}])}(e)}(gn,(function(e){var t=null;return{render:function(n,r,i){return null===t&&(t=(o=_asyncToGenerator(_regeneratorRuntime().mark((function t(n,r,i){var o;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=r.destination,t.next=3,e(n,r,o,i);case 3:return t.abrupt("return",o);case 4:case"end":return t.stop()}}),t)}))),function(e,t,n){return o.apply(this,arguments)})(n,r,i)),t;var o}}}),I,qe,function(e,t){return function(n,r,i){var o=n.destination;if(o.channelCount!==r)try{o.channelCount=r}catch(e){}i&&"explicit"!==o.channelCountMode&&(o.channelCountMode="explicit"),0===o.maxChannelCount&&Object.defineProperty(o,"maxChannelCount",{value:r});var a=e(n,{channelCount:r,channelCountMode:o.channelCountMode,channelInterpretation:o.channelInterpretation,gain:1});return t(a,"channelCount",(function(e){return function(){return e.call(a)}}),(function(e){return function(t){e.call(a,t);try{o.channelCount=t}catch(e){if(t>o.maxChannelCount)throw e}}})),t(a,"channelCountMode",(function(e){return function(){return e.call(a)}}),(function(e){return function(t){e.call(a,t),o.channelCountMode=t}})),t(a,"channelInterpretation",(function(e){return function(){return e.call(a)}}),(function(e){return function(t){e.call(a,t),o.channelInterpretation=t}})),Object.defineProperty(a,"maxChannelCount",{get:function(){return o.maxChannelCount}}),a.connect(o),a}}(Je,Wt),un,ln,an),qn=function(e,t,n,r,i){return function(){var o=new WeakMap;return{render:function(a,s,u){var c,l=o.get(s);return void 0!==l?Promise.resolve(l):(c=_asyncToGenerator(_regeneratorRuntime().mark((function a(s,u,c){var l,h,f;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(l=n(s),(h=M(l,u))||(f={Q:l.Q.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,detune:l.detune.value,frequency:l.frequency.value,gain:l.gain.value,type:l.type},l=t(u,f)),o.set(u,l),!h){a.next=15;break}return a.next=7,e(u,s.Q,l.Q,c);case 7:return a.next=9,e(u,s.detune,l.detune,c);case 9:return a.next=11,e(u,s.frequency,l.frequency,c);case 11:return a.next=13,e(u,s.gain,l.gain,c);case 13:a.next=23;break;case 15:return a.next=17,r(u,s.Q,l.Q,c);case 17:return a.next=19,r(u,s.detune,l.detune,c);case 19:return a.next=21,r(u,s.frequency,l.frequency,c);case 21:return a.next=23,r(u,s.gain,l.gain,c);case 23:return a.next=25,i(s,u,l,c);case 25:return a.abrupt("return",l);case 26:case"end":return a.stop()}}),a)}))),function(e,t,n){return c.apply(this,arguments)})(a,s,u)}}}}(Pn,Ye,ee,On,an),Dn=(_t=Nn,kt=qn,bt=De,St=Ye,wt=un,xt=ln,function(e){function t(e,n){var r;_classCallCheck(this,t);var i=wt(e),o=_objectSpread(_objectSpread({},Te),n),a=St(i,o),s=xt(i);return(r=_callSuper(this,t,[e,!1,a,s?kt():null]))._Q=_t(_assertThisInitialized(r),s,a.Q,R,D),r._detune=_t(_assertThisInitialized(r),s,a.detune,1200*Math.log2(R),-1200*Math.log2(R)),r._frequency=_t(_assertThisInitialized(r),s,a.frequency,e.sampleRate/2,0),r._gain=_t(_assertThisInitialized(r),s,a.gain,40*Math.log10(R),D),r._nativeBiquadFilterNode=a,r}return _inherits(t,e),_createClass(t,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"gain",get:function(){return this._gain}},{key:"Q",get:function(){return this._Q}},{key:"type",get:function(){return this._nativeBiquadFilterNode.type},set:function(e){this._nativeBiquadFilterNode.type=e}},{key:"getFrequencyResponse",value:function(e,t,n){if(this._nativeBiquadFilterNode.getFrequencyResponse(e,t,n),e.length!==t.length||t.length!==n.length)throw bt()}}])}(gn)),Rn=function(e,t){return function(n,r,i){var o,a,s=new Set;return n.connect=(o=n.connect,function(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=0===s.size;if(t(i))return o.call(n,i,a,u),e(s,[i,a,u],(function(e){return e[0]===i&&e[1]===a&&e[2]===u}),!0),c&&r(),i;o.call(n,i,a),e(s,[i,a],(function(e){return e[0]===i&&e[1]===a}),!0),c&&r()}),n.disconnect=(a=n.disconnect,function(e,r,o){var u=s.size>0;if(void 0===e)a.apply(n),s.clear();else if("number"==typeof e){a.call(n,e);var c,l=_createForOfIteratorHelper(s);try{for(l.s();!(c=l.n()).done;){var h=c.value;h[1]===e&&s.delete(h)}}catch(e){l.e(e)}finally{l.f()}}else{t(e)?a.call(n,e,r,o):a.call(n,e,r);var f,p=_createForOfIteratorHelper(s);try{for(p.s();!(f=p.n()).done;){var d=f.value;d[0]!==e||void 0!==r&&d[1]!==r||void 0!==o&&d[2]!==o||s.delete(d)}}catch(e){p.e(e)}finally{p.f()}}var m=0===s.size;u&&m&&i()}),n}}(ne,mn),jn=(Tt=qe,Ct=Rn,function(e,t){t.channelCount=1,t.channelCountMode="explicit",Object.defineProperty(t,"channelCount",{get:function(){return 1},set:function(){throw Tt()}}),Object.defineProperty(t,"channelCountMode",{get:function(){return"explicit"},set:function(){throw Tt()}});var n=e.createBufferSource();Ct(t,(function(){for(var e=t.numberOfInputs,r=0;r<e;r+=1)n.connect(t,0,r)}),(function(){return n.disconnect(t)}))}),zn=function(e,t){return function(n,r){var i=n.createChannelMerger(r.numberOfInputs);return null!==e&&"webkitAudioContext"===e.name&&t(n,i),Ve(i,r),i}}(pn,jn),Fn=function(e,t,n,r,i){return function(e){function o(e,a){_classCallCheck(this,o);var s=r(e),u=_objectSpread(_objectSpread({},Ce),a);return _callSuper(this,o,[e,!1,n(s,u),i(s)?t():null])}return _inherits(o,e),_createClass(o)}(e)}(gn,function(e,t,n){return function(){var r=new WeakMap;return{render:function(i,o,a){var s,u=r.get(o);return void 0!==u?Promise.resolve(u):(s=_asyncToGenerator(_regeneratorRuntime().mark((function i(o,a,s){var u,c;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=t(o),M(u,a)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfInputs:u.numberOfInputs},u=e(a,c)),r.set(a,u),i.next=5,n(o,a,u,s);case 5:return i.abrupt("return",u);case 6:case"end":return i.stop()}}),i)}))),function(e,t,n){return s.apply(this,arguments)})(i,o,a)}}}}(zn,ee,an),zn,un,ln),Ln=function(e,t,n,r,i){return function(e){function o(e,a){_classCallCheck(this,o);var s=r(e),u=function(e){return _objectSpread(_objectSpread({},e),{},{channelCount:e.numberOfOutputs})}(_objectSpread(_objectSpread({},Pe),a));return _callSuper(this,o,[e,!1,n(s,u),i(s)?t():null])}return _inherits(o,e),_createClass(o)}(e)}(gn,function(e,t,n){return function(){var r=new WeakMap;return{render:function(i,o,a){var s,u=r.get(o);return void 0!==u?Promise.resolve(u):(s=_asyncToGenerator(_regeneratorRuntime().mark((function i(o,a,s){var u,c;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return u=t(o),M(u,a)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,numberOfOutputs:u.numberOfOutputs},u=e(a,c)),r.set(a,u),i.next=5,n(o,a,u,s);case 5:return i.abrupt("return",u);case 6:case"end":return i.stop()}}),i)}))),function(e,t,n){return s.apply(this,arguments)})(i,o,a)}}}}(Xe,ee,an),Xe,un,ln),Vn=function(e,t,n,r){return function(i,o){var a=o.offset,s=_objectWithoutProperties(o,_excluded),u=i.createBuffer(1,2,i.sampleRate),c=t(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),l=n(i,_objectSpread(_objectSpread({},s),{},{gain:a})),h=u.getChannelData(0);h[0]=1,h[1]=1,c.buffer=u,c.loop=!0;var f={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){l.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){l.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){l.channelInterpretation=e},get context(){return l.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get offset(){return l.gain},get onended(){return c.onended},set onended(e){c.onended=e},addEventListener:function(){return c.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return c.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return c.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},start:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.start.call(c,e)},stop:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;c.stop.call(c,e)}};return e(i,c),r(Ze(f,l),(function(){return c.connect(l)}),(function(){return c.disconnect(l)}))}}(Tn,An,Je,Rn),Gn=function(e,t,n,r,i){return function(o,a){if(void 0===o.createConstantSource)return n(o,a);var s=o.createConstantSource();return Ve(s,a),Be(s,a,"offset"),t(r,(function(){return r(o)}))||Ue(s),t(i,(function(){return i(o)}))||He(s),e(o,s),s}}(Tn,tn,Vn,Yt,Zt),Bn=function(e,t,n,r,i,o,a){return function(e){function s(e,a){var u;_classCallCheck(this,s);var c=i(e),l=_objectSpread(_objectSpread({},Ae),a),h=r(c,l),f=o(c),p=f?n():null;return(u=_callSuper(this,s,[e,!1,h,p]))._constantSourceNodeRenderer=p,u._nativeConstantSourceNode=h,u._offset=t(_assertThisInitialized(u),f,h.offset,R,D),u._onended=null,u}return _inherits(s,e),_createClass(s,[{key:"offset",get:function(){return this._offset}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"==typeof e?a(this,e):null;this._nativeConstantSourceNode.onended=t;var n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){L(this);var n=function(){e._nativeConstantSourceNode.removeEventListener("ended",n),setTimeout((function(){j(e)&&V(e)}),1e3)};this._nativeConstantSourceNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeConstantSourceNode.stop(e),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=e)}}])}(e)}(gn,Nn,function(e,t,n,r,i){return function(){var o=new WeakMap,a=null,s=null;return{set start(e){a=e},set stop(e){s=e},render:function(u,c,l){var h,f=o.get(c);return void 0!==f?Promise.resolve(f):(h=_asyncToGenerator(_regeneratorRuntime().mark((function u(c,l,h){var f,p,d;return _regeneratorRuntime().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:if(f=n(c),(p=M(f,l))||(d={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,offset:f.offset.value},f=t(l,d),null!==a&&f.start(a),null!==s&&f.stop(s)),o.set(l,f),!p){u.next=9;break}return u.next=7,e(l,c.offset,f.offset,h);case 7:u.next=11;break;case 9:return u.next=11,r(l,c.offset,f.offset,h);case 11:return u.next=13,i(c,l,f,h);case 13:return u.abrupt("return",f);case 14:case"end":return u.stop()}}),u)}))),function(e,t,n){return h.apply(this,arguments)})(u,c,l)}}}}(Pn,Gn,ee,On,an),Gn,un,ln,en),Un=function(e,t){return function(n,r){var i=n.createConvolver();if(Ve(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),Le(i,r,"buffer"),r.channelCount>2)throw e();if(t(i,"channelCount",(function(e){return function(){return e.call(i)}}),(function(t){return function(n){if(n>2)throw e();return t.call(i,n)}})),"max"===r.channelCountMode)throw e();return t(i,"channelCountMode",(function(e){return function(){return e.call(i)}}),(function(t){return function(n){if("max"===n)throw e();return t.call(i,n)}})),i}}(zt,Wt),Hn=function(e,t,n,r,i){return function(e){function o(e,a){var s;_classCallCheck(this,o);var u=r(e),c=_objectSpread(_objectSpread({},Oe),a),l=n(u,c);return(s=_callSuper(this,o,[e,!1,l,i(u)?t():null]))._isBufferNullified=!1,s._nativeConvolverNode=l,s}return _inherits(o,e),_createClass(o,[{key:"buffer",get:function(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer},set:function(e){if(this._nativeConvolverNode.buffer=e,null===e&&null!==this._nativeConvolverNode.buffer){var t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,t.sampleRate),this._isBufferNullified=!0}else this._isBufferNullified=!1}},{key:"normalize",get:function(){return this._nativeConvolverNode.normalize},set:function(e){this._nativeConvolverNode.normalize=e}}])}(e)}(gn,function(e,t,n){return function(){var r=new WeakMap;return{render:function(i,o,a){var s,u=r.get(o);return void 0!==u?Promise.resolve(u):(s=_asyncToGenerator(_regeneratorRuntime().mark((function i(o,a,s){var u,c;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(u=t(o),M(u,a)||(c={buffer:u.buffer,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,disableNormalization:!u.normalize},u=e(a,c)),r.set(a,u),!Z(u)){i.next=8;break}return i.next=6,n(o,a,u.inputs[0],s);case 6:i.next=10;break;case 8:return i.next=10,n(o,a,u,s);case 10:return i.abrupt("return",u);case 11:case"end":return i.stop()}}),i)}))),function(e,t,n){return s.apply(this,arguments)})(i,o,a)}}}}(Un,ee,an),Un,un,ln),Qn=function(e,t,n,r,i,o){return function(e){function a(e,s){var u;_classCallCheck(this,a);var c=i(e),l=_objectSpread(_objectSpread({},Me),s),h=r(c,l),f=o(c);return(u=_callSuper(this,a,[e,!1,h,f?n(l.maxDelayTime):null]))._delayTime=t(_assertThisInitialized(u),f,h.delayTime),u}return _inherits(a,e),_createClass(a,[{key:"delayTime",get:function(){return this._delayTime}}])}(e)}(gn,Nn,function(e,t,n,r,i){return function(o){var a=new WeakMap;return{render:function(s,u,c){var l,h=a.get(u);return void 0!==h?Promise.resolve(h):(l=_asyncToGenerator(_regeneratorRuntime().mark((function s(u,c,l){var h,f,p;return _regeneratorRuntime().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(h=n(u),(f=M(h,c))||(p={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,delayTime:h.delayTime.value,maxDelayTime:o},h=t(c,p)),a.set(c,h),!f){s.next=9;break}return s.next=7,e(c,u.delayTime,h.delayTime,l);case 7:s.next=11;break;case 9:return s.next=11,r(c,u.delayTime,h.delayTime,l);case 11:return s.next=13,i(u,c,h,l);case 13:return s.abrupt("return",h);case 14:case"end":return s.stop()}}),s)}))),function(e,t,n){return l.apply(this,arguments)})(s,u,c)}}}}(Pn,Ke,ee,On,an),Ke,un,ln),Wn=(Pt=zt,function(e,t){var n=e.createDynamicsCompressor();if(Ve(n,t),t.channelCount>2)throw Pt();if("max"===t.channelCountMode)throw Pt();return Be(n,t,"attack"),Be(n,t,"knee"),Be(n,t,"ratio"),Be(n,t,"release"),Be(n,t,"threshold"),n}),Yn=function(e,t,n,r,i,o,a){return function(e){function s(e,i){var u;_classCallCheck(this,s);var c=o(e),l=_objectSpread(_objectSpread({},Ie),i),h=r(c,l),f=a(c);return(u=_callSuper(this,s,[e,!1,h,f?n():null]))._attack=t(_assertThisInitialized(u),f,h.attack),u._knee=t(_assertThisInitialized(u),f,h.knee),u._nativeDynamicsCompressorNode=h,u._ratio=t(_assertThisInitialized(u),f,h.ratio),u._release=t(_assertThisInitialized(u),f,h.release),u._threshold=t(_assertThisInitialized(u),f,h.threshold),u}return _inherits(s,e),_createClass(s,[{key:"attack",get:function(){return this._attack}},{key:"channelCount",get:function(){return this._nativeDynamicsCompressorNode.channelCount},set:function(e){var t=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=e,e>2)throw this._nativeDynamicsCompressorNode.channelCount=t,i()}},{key:"channelCountMode",get:function(){return this._nativeDynamicsCompressorNode.channelCountMode},set:function(e){var t=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=e,"max"===e)throw this._nativeDynamicsCompressorNode.channelCountMode=t,i()}},{key:"knee",get:function(){return this._knee}},{key:"ratio",get:function(){return this._ratio}},{key:"reduction",get:function(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}},{key:"release",get:function(){return this._release}},{key:"threshold",get:function(){return this._threshold}}])}(e)}(gn,Nn,function(e,t,n,r,i){return function(){var o=new WeakMap;return{render:function(a,s,u){var c,l=o.get(s);return void 0!==l?Promise.resolve(l):(c=_asyncToGenerator(_regeneratorRuntime().mark((function a(s,u,c){var l,h,f;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(l=n(s),(h=M(l,u))||(f={attack:l.attack.value,channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,knee:l.knee.value,ratio:l.ratio.value,release:l.release.value,threshold:l.threshold.value},l=t(u,f)),o.set(u,l),!h){a.next=17;break}return a.next=7,e(u,s.attack,l.attack,c);case 7:return a.next=9,e(u,s.knee,l.knee,c);case 9:return a.next=11,e(u,s.ratio,l.ratio,c);case 11:return a.next=13,e(u,s.release,l.release,c);case 13:return a.next=15,e(u,s.threshold,l.threshold,c);case 15:a.next=27;break;case 17:return a.next=19,r(u,s.attack,l.attack,c);case 19:return a.next=21,r(u,s.knee,l.knee,c);case 21:return a.next=23,r(u,s.ratio,l.ratio,c);case 23:return a.next=25,r(u,s.release,l.release,c);case 25:return a.next=27,r(u,s.threshold,l.threshold,c);case 27:return a.next=29,i(s,u,l,c);case 29:return a.abrupt("return",l);case 30:case"end":return a.stop()}}),a)}))),function(e,t,n){return c.apply(this,arguments)})(a,s,u)}}}}(Pn,Wn,ee,On,an),Wn,zt,un,ln),Xn=function(e,t,n,r,i,o){return function(e){function a(e,s){var u;_classCallCheck(this,a);var c=i(e),l=_objectSpread(_objectSpread({},Ee),s),h=r(c,l),f=o(c);return(u=_callSuper(this,a,[e,!1,h,f?n():null]))._gain=t(_assertThisInitialized(u),f,h.gain,R,D),u}return _inherits(a,e),_createClass(a,[{key:"gain",get:function(){return this._gain}}])}(e)}(gn,Nn,function(e,t,n,r,i){return function(){var o=new WeakMap;return{render:function(a,s,u){var c,l=o.get(s);return void 0!==l?Promise.resolve(l):(c=_asyncToGenerator(_regeneratorRuntime().mark((function a(s,u,c){var l,h,f;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(l=n(s),(h=M(l,u))||(f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,gain:l.gain.value},l=t(u,f)),o.set(u,l),!h){a.next=9;break}return a.next=7,e(u,s.gain,l.gain,c);case 7:a.next=11;break;case 9:return a.next=11,r(u,s.gain,l.gain,c);case 11:return a.next=13,i(s,u,l,c);case 13:return a.abrupt("return",l);case 14:case"end":return a.stop()}}),a)}))),function(e,t,n){return c.apply(this,arguments)})(a,s,u)}}}}(Pn,Je,ee,On,an),Je,un,ln),Zn=function(e,t,n,r){return function(i,o,a){var s=a.channelCount,u=a.channelCountMode,c=a.channelInterpretation,l=a.feedback,h=a.feedforward,f=Qe(o,i.sampleRate),p=l instanceof Float64Array?l:new Float64Array(l),d=h instanceof Float64Array?h:new Float64Array(h),m=p.length,v=d.length,g=Math.min(m,v);if(0===m||m>20)throw r();if(0===p[0])throw t();if(0===v||v>20)throw r();if(0===d[0])throw t();if(1!==p[0]){for(var y=0;y<v;y+=1)d[y]/=p[0];for(var _=1;_<m;_+=1)p[_]/=p[0]}var k=n(i,f,s,s);k.channelCount=s,k.channelCountMode=u,k.channelInterpretation=c;for(var b=[],S=[],w=[],x=0;x<s;x+=1){b.push(0);var T=new Float32Array(32),C=new Float32Array(32);T.fill(0),C.fill(0),S.push(T),w.push(C)}k.onaudioprocess=function(e){for(var t=e.inputBuffer,n=e.outputBuffer,r=t.numberOfChannels,i=0;i<r;i+=1){var o=t.getChannelData(i),a=n.getChannelData(i);b[i]=je(p,m,d,v,g,S[i],w[i],b[i],32,o,a)}};var P=i.sampleRate/2;return Ze({get bufferSize(){return f},get channelCount(){return k.channelCount},set channelCount(e){k.channelCount=e},get channelCountMode(){return k.channelCountMode},set channelCountMode(e){k.channelCountMode=e},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(e){k.channelInterpretation=e},get context(){return k.context},get inputs(){return[k]},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},addEventListener:function(){return k.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return k.dispatchEvent(arguments.length<=0?void 0:arguments[0])},getFrequencyResponse:function(t,n,r){if(t.length!==n.length||n.length!==r.length)throw e();for(var i=t.length,o=0;o<i;o+=1){var a=-Math.PI*(t[o]/P),s=[Math.cos(a),Math.sin(a)],u=$e(et(d,s),et(p,s));n[o]=Math.sqrt(u[0]*u[0]+u[1]*u[1]),r[o]=Math.atan2(u[1],u[0])}},removeEventListener:function(){return k.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},k)}}(De,qe,jt,zt),Kn=function(e,t,n,r){return function(i){return e(Fe,(function(){return Fe(i)}))?Promise.resolve(e(r,r)).then((function(e){if(!e){var t=n(i,512,0,1);i.oncomplete=function(){t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=function(){return i.currentTime},t.connect(i.destination)}return i.startRendering()})):new Promise((function(e){var n=t(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=function(t){n.disconnect(),e(t.renderedBuffer)},n.connect(i.destination),i.startRendering()}))}}(tn,Je,jt,function(e,t){return function(){if(null===t)return Promise.resolve(!1);var n=new t(1,1,44100),r=e(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((function(e){n.oncomplete=function(){r.disconnect(),e(0!==n.currentTime)},n.startRendering()}))}}(Je,cn)),Jn=function(e,t,n,r,i){return function(o,a){var s=new WeakMap,u=null,c=function(){var c=_asyncToGenerator(_regeneratorRuntime().mark((function c(l,h,f){var p,d,m,v,g;return _regeneratorRuntime().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(p=null,d=t(l),m=M(d,h),void 0===h.createIIRFilter?p=e(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):m||(d=h.createIIRFilter(a,o)),s.set(h,null===p?d:p),null===p){c.next=12;break}if(null!==u){c.next=8;break}if(null!==n){c.next=6;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 6:v=new n(l.context.destination.channelCount,l.context.length,h.sampleRate),u=_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(l,v,v.destination,f);case 2:return e.t0=function(e,t,n,r){var i=n instanceof Float64Array?n:new Float64Array(n),o=r instanceof Float64Array?r:new Float64Array(r),a=i.length,s=o.length,u=Math.min(a,s);if(1!==i[0]){for(var c=0;c<a;c+=1)o[c]/=i[0];for(var l=1;l<s;l+=1)i[l]/=i[0]}for(var h=new Float32Array(32),f=new Float32Array(32),p=t.createBuffer(e.numberOfChannels,e.length,e.sampleRate),d=e.numberOfChannels,m=0;m<d;m+=1){var v=e.getChannelData(m),g=p.getChannelData(m);h.fill(0),f.fill(0),je(i,a,o,s,u,h,f,0,32,v,g)}return p},e.next=5,i(v);case 5:return e.t1=e.sent,e.t2=h,e.t3=o,e.t4=a,e.abrupt("return",(0,e.t0)(e.t1,e.t2,e.t3,e.t4));case 10:case"end":return e.stop()}}),e)})))();case 8:return c.next=10,u;case 10:return g=c.sent,c.abrupt("return",(p.buffer=g,p.start(0),p));case 12:return c.next=14,r(l,h,d,f);case 14:return c.abrupt("return",d);case 15:case"end":return c.stop()}}),c)})));return function(e,t,n){return c.apply(this,arguments)}}();return{render:function(e,t,n){var r=s.get(t);return void 0!==r?Promise.resolve(r):c(e,t,n)}}}}(An,ee,cn,an,Kn),$n=function(e,t,n,r,i){return function(e){function o(e,a){var s;_classCallCheck(this,o);var u=r(e),c=i(u),l=_objectSpread(_objectSpread({},Re),a),h=t(u,c?null:e.baseLatency,l);return s=_callSuper(this,o,[e,!1,h,c?n(l.feedback,l.feedforward):null]),function(e){var t;e.getFrequencyResponse=(t=e.getFrequencyResponse,function(n,r,i){if(n.length!==r.length||r.length!==i.length)throw De();return t.call(e,n,r,i)})}(h),s._nativeIIRFilterNode=h,s}return _inherits(o,e),_createClass(o,[{key:"getFrequencyResponse",value:function(e,t,n){return this._nativeIIRFilterNode.getFrequencyResponse(e,t,n)}}])}(e)}(gn,(At=Zn,function(e,t,n){if(void 0===e.createIIRFilter)return At(e,t,n);var r=e.createIIRFilter(n.feedforward,n.feedback);return Ve(r,n),r}),Jn,un,ln),er=function(e,t,n,r,i){return function(o,a){var s=a.listener,u=void 0===s.forwardX?function(){var u=t(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),c=i(a),l=r(a,256,9,0),h=function(t,r){var i=n(a,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:r});return i.connect(u,0,t),i.start(),Object.defineProperty(i.offset,"defaultValue",{get:function(){return r}}),e({context:o},c,i.offset,R,D)},f=[0,0,-1,0,1,0],p=[0,0,0];return l.onaudioprocess=function(e){var t=e.inputBuffer,n=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];n.some((function(e,t){return e!==f[t]}))&&(s.setOrientation.apply(s,n),f=n);var r=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];r.some((function(e,t){return e!==p[t]}))&&(s.setPosition.apply(s,r),p=r)},u.connect(l),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}}():s,c=u.forwardX,l=u.forwardY,h=u.forwardZ,f=u.positionX,p=u.positionY,d=u.positionZ,m=u.upX,v=u.upY,g=u.upZ;return{get forwardX(){return c},get forwardY(){return l},get forwardZ(){return h},get positionX(){return f},get positionY(){return p},get positionZ(){return d},get upX(){return m},get upY(){return v},get upZ(){return g}}}}(Nn,zn,Gn,jt,ln),tr=new WeakMap,nr=function(e,t,n,r,i,o){return function(n){function a(n,o){var s;return _classCallCheck(this,a),(s=_callSuper(this,a,[n]))._nativeContext=n,_.set(_assertThisInitialized(s),n),r(n)&&i.set(n,new Set),s._destination=new e(_assertThisInitialized(s),o),s._listener=t(_assertThisInitialized(s),n),s._onstatechange=null,s}return _inherits(a,n),_createClass(a,[{key:"currentTime",get:function(){return this._nativeContext.currentTime}},{key:"destination",get:function(){return this._destination}},{key:"listener",get:function(){return this._listener}},{key:"onstatechange",get:function(){return this._onstatechange},set:function(e){var t="function"==typeof e?o(this,e):null;this._nativeContext.onstatechange=t;var n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===t?e:n}},{key:"sampleRate",get:function(){return this._nativeContext.sampleRate}},{key:"state",get:function(){return this._nativeContext.state}}])}(n)}(En,er,fn,ln,tr,en),rr=function(e,t,n,r,i,o){return function(a,s){var u=a.createOscillator();return Ve(u,s),Be(u,s,"detune"),Be(u,s,"frequency"),void 0!==s.periodicWave?u.setPeriodicWave(s.periodicWave):Le(u,s,"type"),t(n,(function(){return n(a)}))||Ue(u),t(r,(function(){return r(a)}))||o(u,a),t(i,(function(){return i(a)}))||He(u),e(a,u),u}}(Tn,tn,Yt,Xt,Zt,$t),ir=function(e,t,n,r,i,o,a){return function(e){function s(e,a){var u;_classCallCheck(this,s);var c=i(e),l=_objectSpread(_objectSpread({},Lt),a),h=n(c,l),f=o(c),p=f?r():null,d=e.sampleRate/2;return(u=_callSuper(this,s,[e,!1,h,p]))._detune=t(_assertThisInitialized(u),f,h.detune,153600,-153600),u._frequency=t(_assertThisInitialized(u),f,h.frequency,d,-d),u._nativeOscillatorNode=h,u._onended=null,u._oscillatorNodeRenderer=p,null!==u._oscillatorNodeRenderer&&void 0!==l.periodicWave&&(u._oscillatorNodeRenderer.periodicWave=l.periodicWave),u}return _inherits(s,e),_createClass(s,[{key:"detune",get:function(){return this._detune}},{key:"frequency",get:function(){return this._frequency}},{key:"onended",get:function(){return this._onended},set:function(e){var t="function"==typeof e?a(this,e):null;this._nativeOscillatorNode.onended=t;var n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===t?e:n}},{key:"type",get:function(){return this._nativeOscillatorNode.type},set:function(e){this._nativeOscillatorNode.type=e,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}},{key:"setPeriodicWave",value:function(e){this._nativeOscillatorNode.setPeriodicWave(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=e)}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){L(this);var n=function(){e._nativeOscillatorNode.removeEventListener("ended",n),setTimeout((function(){j(e)&&V(e)}),1e3)};this._nativeOscillatorNode.addEventListener("ended",n)}}},{key:"stop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._nativeOscillatorNode.stop(e),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=e)}}])}(e)}(gn,Nn,rr,function(e,t,n,r,i){return function(){var o=new WeakMap,a=null,s=null,u=null;return{set periodicWave(e){a=e},set start(e){s=e},set stop(e){u=e},render:function(c,l,h){var f,p=o.get(l);return void 0!==p?Promise.resolve(p):(f=_asyncToGenerator(_regeneratorRuntime().mark((function c(l,h,f){var p,d,m;return _regeneratorRuntime().wrap((function(c){for(;;)switch(c.prev=c.next){case 0:if(p=n(l),(d=M(p,h))||(m={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===a?void 0:a,type:p.type},p=t(h,m),null!==s&&p.start(s),null!==u&&p.stop(u)),o.set(h,p),!d){c.next=11;break}return c.next=7,e(h,l.detune,p.detune,f);case 7:return c.next=9,e(h,l.frequency,p.frequency,f);case 9:c.next=15;break;case 11:return c.next=13,r(h,l.detune,p.detune,f);case 13:return c.next=15,r(h,l.frequency,p.frequency,f);case 15:return c.next=17,i(l,h,p,f);case 17:return c.abrupt("return",p);case 18:case"end":return c.stop()}}),c)}))),function(e,t,n){return f.apply(this,arguments)})(c,l,h)}}}}(Pn,rr,ee,On,an),un,ln,en),or=(Ot=An,function(e,t){var n=Ot(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),r=e.createBuffer(1,2,e.sampleRate);return n.buffer=r,n.loop=!0,n.connect(t),n.start(),function(){n.stop(),n.disconnect(t)}}),ar=function(e,t,n,r,i){return function(o,a){var s=a.curve,u=a.oversample,c=_objectWithoutProperties(a,_excluded2),l=o.createWaveShaper(),h=o.createWaveShaper();Ve(l,c),Ve(h,c);var f=n(o,_objectSpread(_objectSpread({},c),{},{gain:1})),p=n(o,_objectSpread(_objectSpread({},c),{},{gain:-1})),d=n(o,_objectSpread(_objectSpread({},c),{},{gain:1})),m=n(o,_objectSpread(_objectSpread({},c),{},{gain:-1})),v=null,g=!1,y=null,_={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(e){f.channelCount=e,p.channelCount=e,l.channelCount=e,d.channelCount=e,h.channelCount=e,m.channelCount=e},get channelCountMode(){return l.channelCountMode},set channelCountMode(e){f.channelCountMode=e,p.channelCountMode=e,l.channelCountMode=e,d.channelCountMode=e,h.channelCountMode=e,m.channelCountMode=e},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e,p.channelInterpretation=e,l.channelInterpretation=e,d.channelInterpretation=e,h.channelInterpretation=e,m.channelInterpretation=e},get context(){return l.context},get curve(){return y},set curve(n){if(null!==n&&n.length<2)throw t();if(null===n)l.curve=n,h.curve=n;else{var i=n.length,a=new Float32Array(i+2-i%2),s=new Float32Array(i+2-i%2);a[0]=n[0],s[0]=-n[i-1];for(var u=Math.ceil((i+1)/2),c=(i+1)/2-1,p=1;p<u;p+=1){var d=p/u*c,m=Math.floor(d),_=Math.ceil(d);a[p]=m===_?n[m]:(1-(d-m))*n[m]+(1-(_-d))*n[_],s[p]=m===_?-n[i-1-m]:-(1-(d-m))*n[i-1-m]-(1-(_-d))*n[i-1-_]}a[u]=i%2==1?n[u-1]:(n[u-2]+n[u-1])/2,l.curve=a,h.curve=s}y=n,g&&(r(y)&&null===v?v=e(o,f):null!==v&&(v(),v=null))},get inputs(){return[f]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get oversample(){return l.oversample},set oversample(e){l.oversample=e,h.oversample=e},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return null!==s&&(_.curve=s instanceof Float32Array?s:new Float32Array(s)),u!==_.oversample&&(_.oversample=u),i(Ze(_,d),(function(){f.connect(l).connect(d),f.connect(p).connect(h).connect(m).connect(d),g=!0,r(y)&&(v=e(o,f))}),(function(){f.disconnect(l),l.disconnect(d),f.disconnect(p),p.disconnect(h),h.disconnect(m),m.disconnect(d),g=!1,null!==v&&(v(),v=null)}))}}(or,qe,Je,Qt,Rn),sr=function(e,t,n,r,i,o,a){return function(s,u){var c=s.createWaveShaper();if(null!==o&&"webkitAudioContext"===o.name)return n(s,u);Ve(c,u);var l=null===u.curve||u.curve instanceof Float32Array?u.curve:new Float32Array(u.curve);if(null!==l&&l.length<2)throw t();Le(c,{curve:l},"curve"),Le(c,u,"oversample");var h=null,f=!1;return a(c,"curve",(function(e){return function(){return e.call(c)}}),(function(t){return function(n){return t.call(c,n),f&&(r(n)&&null===h?h=e(s,c):r(n)||null===h||(h(),h=null)),n}})),i(c,(function(){f=!0,r(c.curve)&&(h=e(s,c))}),(function(){f=!1,null!==h&&(h(),h=null)}))}}(or,qe,ar,Qt,Rn,pn,Wt),ur=function(e,t,n,r,i,o,a,s,u){return function(c,l){var h=l.coneInnerAngle,f=l.coneOuterAngle,p=l.coneOuterGain,d=l.distanceModel,m=l.maxDistance,v=l.orientationX,g=l.orientationY,y=l.orientationZ,_=l.panningModel,k=l.positionX,b=l.positionY,S=l.positionZ,w=l.refDistance,x=l.rolloffFactor,T=_objectWithoutProperties(l,_excluded3),C=c.createPanner();if(T.channelCount>2)throw a();if("max"===T.channelCountMode)throw a();Ve(C,T);var P={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},A=n(c,_objectSpread(_objectSpread({},P),{},{channelInterpretation:"speakers",numberOfInputs:6})),O=r(c,_objectSpread(_objectSpread({},T),{},{gain:1})),M=r(c,_objectSpread(_objectSpread({},P),{},{gain:1})),N=r(c,_objectSpread(_objectSpread({},P),{},{gain:0})),I=r(c,_objectSpread(_objectSpread({},P),{},{gain:0})),E=r(c,_objectSpread(_objectSpread({},P),{},{gain:0})),q=r(c,_objectSpread(_objectSpread({},P),{},{gain:0})),D=r(c,_objectSpread(_objectSpread({},P),{},{gain:0})),R=i(c,256,6,1),j=o(c,_objectSpread(_objectSpread({},P),{},{curve:new Float32Array([1,1]),oversample:"none"})),z=[v,g,y],F=[k,b,S];R.onaudioprocess=function(e){var t=e.inputBuffer,n=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];n.some((function(e,t){return e!==z[t]}))&&(C.setOrientation.apply(C,n),z=n);var r=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];r.some((function(e,t){return e!==F[t]}))&&(C.setPosition.apply(C,r),F=r)},Object.defineProperty(N.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(I.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(E.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(q.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(D.gain,"defaultValue",{get:function(){return 0}});var L={get bufferSize(){},get channelCount(){return C.channelCount},set channelCount(e){if(e>2)throw a();O.channelCount=e,C.channelCount=e},get channelCountMode(){return C.channelCountMode},set channelCountMode(e){if("max"===e)throw a();O.channelCountMode=e,C.channelCountMode=e},get channelInterpretation(){return C.channelInterpretation},set channelInterpretation(e){O.channelInterpretation=e,C.channelInterpretation=e},get coneInnerAngle(){return C.coneInnerAngle},set coneInnerAngle(e){C.coneInnerAngle=e},get coneOuterAngle(){return C.coneOuterAngle},set coneOuterAngle(e){C.coneOuterAngle=e},get coneOuterGain(){return C.coneOuterGain},set coneOuterGain(e){if(e<0||e>1)throw t();C.coneOuterGain=e},get context(){return C.context},get distanceModel(){return C.distanceModel},set distanceModel(e){C.distanceModel=e},get inputs(){return[O]},get maxDistance(){return C.maxDistance},set maxDistance(e){if(e<0)throw new RangeError;C.maxDistance=e},get numberOfInputs(){return C.numberOfInputs},get numberOfOutputs(){return C.numberOfOutputs},get orientationX(){return M.gain},get orientationY(){return N.gain},get orientationZ(){return I.gain},get panningModel(){return C.panningModel},set panningModel(e){C.panningModel=e},get positionX(){return E.gain},get positionY(){return q.gain},get positionZ(){return D.gain},get refDistance(){return C.refDistance},set refDistance(e){if(e<0)throw new RangeError;C.refDistance=e},get rolloffFactor(){return C.rolloffFactor},set rolloffFactor(e){if(e<0)throw new RangeError;C.rolloffFactor=e},addEventListener:function(){return O.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return O.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return O.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}};return h!==L.coneInnerAngle&&(L.coneInnerAngle=h),f!==L.coneOuterAngle&&(L.coneOuterAngle=f),p!==L.coneOuterGain&&(L.coneOuterGain=p),d!==L.distanceModel&&(L.distanceModel=d),m!==L.maxDistance&&(L.maxDistance=m),v!==L.orientationX.value&&(L.orientationX.value=v),g!==L.orientationY.value&&(L.orientationY.value=g),y!==L.orientationZ.value&&(L.orientationZ.value=y),_!==L.panningModel&&(L.panningModel=_),k!==L.positionX.value&&(L.positionX.value=k),b!==L.positionY.value&&(L.positionY.value=b),S!==L.positionZ.value&&(L.positionZ.value=S),w!==L.refDistance&&(L.refDistance=w),x!==L.rolloffFactor&&(L.rolloffFactor=x),1===z[0]&&0===z[1]&&0===z[2]||C.setOrientation.apply(C,_toConsumableArray(z)),0===F[0]&&0===F[1]&&0===F[2]||C.setPosition.apply(C,_toConsumableArray(F)),u(Ze(L,C),(function(){O.connect(C),e(O,j,0,0),j.connect(M).connect(A,0,0),j.connect(N).connect(A,0,1),j.connect(I).connect(A,0,2),j.connect(E).connect(A,0,3),j.connect(q).connect(A,0,4),j.connect(D).connect(A,0,5),A.connect(R).connect(c.destination)}),(function(){O.disconnect(C),s(O,j,0,0),j.disconnect(M),M.disconnect(A),j.disconnect(N),N.disconnect(A),j.disconnect(I),I.disconnect(A),j.disconnect(E),E.disconnect(A),j.disconnect(q),q.disconnect(A),j.disconnect(D),D.disconnect(A),A.disconnect(R),R.disconnect(c.destination)}))}}(K,qe,zn,Je,jt,sr,zt,$,Rn),cr=(Mt=ur,function(e,t){var n=e.createPanner();return void 0===n.orientationX?Mt(e,t):(Ve(n,t),Be(n,t,"orientationX"),Be(n,t,"orientationY"),Be(n,t,"orientationZ"),Be(n,t,"positionX"),Be(n,t,"positionY"),Be(n,t,"positionZ"),Le(n,t,"coneInnerAngle"),Le(n,t,"coneOuterAngle"),Le(n,t,"coneOuterGain"),Le(n,t,"distanceModel"),Le(n,t,"maxDistance"),Le(n,t,"panningModel"),Le(n,t,"refDistance"),Le(n,t,"rolloffFactor"),n)}),lr=function(e,t,n,r,i,o){return function(e){function a(e,s){var u;_classCallCheck(this,a);var c=i(e),l=_objectSpread(_objectSpread({},Vt),s),h=n(c,l),f=o(c);return(u=_callSuper(this,a,[e,!1,h,f?r():null]))._nativePannerNode=h,u._orientationX=t(_assertThisInitialized(u),f,h.orientationX,R,D),u._orientationY=t(_assertThisInitialized(u),f,h.orientationY,R,D),u._orientationZ=t(_assertThisInitialized(u),f,h.orientationZ,R,D),u._positionX=t(_assertThisInitialized(u),f,h.positionX,R,D),u._positionY=t(_assertThisInitialized(u),f,h.positionY,R,D),u._positionZ=t(_assertThisInitialized(u),f,h.positionZ,R,D),u}return _inherits(a,e),_createClass(a,[{key:"coneInnerAngle",get:function(){return this._nativePannerNode.coneInnerAngle},set:function(e){this._nativePannerNode.coneInnerAngle=e}},{key:"coneOuterAngle",get:function(){return this._nativePannerNode.coneOuterAngle},set:function(e){this._nativePannerNode.coneOuterAngle=e}},{key:"coneOuterGain",get:function(){return this._nativePannerNode.coneOuterGain},set:function(e){this._nativePannerNode.coneOuterGain=e}},{key:"distanceModel",get:function(){return this._nativePannerNode.distanceModel},set:function(e){this._nativePannerNode.distanceModel=e}},{key:"maxDistance",get:function(){return this._nativePannerNode.maxDistance},set:function(e){this._nativePannerNode.maxDistance=e}},{key:"orientationX",get:function(){return this._orientationX}},{key:"orientationY",get:function(){return this._orientationY}},{key:"orientationZ",get:function(){return this._orientationZ}},{key:"panningModel",get:function(){return this._nativePannerNode.panningModel},set:function(e){this._nativePannerNode.panningModel=e}},{key:"positionX",get:function(){return this._positionX}},{key:"positionY",get:function(){return this._positionY}},{key:"positionZ",get:function(){return this._positionZ}},{key:"refDistance",get:function(){return this._nativePannerNode.refDistance},set:function(e){this._nativePannerNode.refDistance=e}},{key:"rolloffFactor",get:function(){return this._nativePannerNode.rolloffFactor},set:function(e){this._nativePannerNode.rolloffFactor=e}}])}(e)}(gn,Nn,cr,function(e,t,n,r,i,o,a,s,u,c){return function(){var l=new WeakMap,h=null;return{render:function(f,p,d){var m,v=l.get(p);return void 0!==v?Promise.resolve(v):(m=_asyncToGenerator(_regeneratorRuntime().mark((function f(p,d,m){var v,g,y,_,k,b,S,w,x,T,C,P,A,O,N,I,E,q,D,R;return _regeneratorRuntime().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:if(v=null,g=o(p),y={channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation},_=_objectSpread(_objectSpread({},y),{},{coneInnerAngle:g.coneInnerAngle,coneOuterAngle:g.coneOuterAngle,coneOuterGain:g.coneOuterGain,distanceModel:g.distanceModel,maxDistance:g.maxDistance,panningModel:g.panningModel,refDistance:g.refDistance,rolloffFactor:g.rolloffFactor}),k=M(g,d),"bufferSize"in g?v=r(d,_objectSpread(_objectSpread({},y),{},{gain:1})):k||(b=_objectSpread(_objectSpread({},_),{},{orientationX:g.orientationX.value,orientationY:g.orientationY.value,orientationZ:g.orientationZ.value,positionX:g.positionX.value,positionY:g.positionY.value,positionZ:g.positionZ.value}),g=i(d,b)),l.set(d,null===v?g:v),null===v){f.next=21;break}if(null!==h){f.next=9;break}if(null!==a){f.next=7;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 7:S=new a(6,p.context.length,d.sampleRate),(w=t(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6})).connect(S.destination),h=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,r){var i;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===r?1:0}),e.next=3,s(S,t,i.offset,m);case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 2:for(t=e.sent,r=0;r<6;r+=1)t[r].connect(w,0,r),t[r].start(0);return e.abrupt("return",c(S));case 5:case"end":return e.stop()}}),e)})))();case 9:return f.next=11,h;case 11:return x=f.sent,T=r(d,_objectSpread(_objectSpread({},y),{},{gain:1})),f.next=15,u(p,d,T,m);case 15:for(C=[],P=0;P<x.numberOfChannels;P+=1)C.push(x.getChannelData(P));for(A=[C[0][0],C[1][0],C[2][0]],O=[C[3][0],C[4][0],C[5][0]],N=r(d,_objectSpread(_objectSpread({},y),{},{gain:1})),I=i(d,_objectSpread(_objectSpread({},_),{},{orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:O[0],positionY:O[1],positionZ:O[2]})),T.connect(N).connect(I.inputs[0]),I.connect(v),E=128;E<x.length;E+=128)q=[C[0][E],C[1][E],C[2][E]],D=[C[3][E],C[4][E],C[5][E]],(q.some((function(e,t){return e!==A[t]}))||D.some((function(e,t){return e!==O[t]})))&&(A=q,O=D,R=E/d.sampleRate,N.gain.setValueAtTime(0,R),N=r(d,_objectSpread(_objectSpread({},y),{},{gain:0})),I=i(d,_objectSpread(_objectSpread({},_),{},{orientationX:A[0],orientationY:A[1],orientationZ:A[2],positionX:O[0],positionY:O[1],positionZ:O[2]})),N.gain.setValueAtTime(1,R),T.connect(N).connect(I.inputs[0]),I.connect(v));return f.abrupt("return",v);case 21:if(!k){f.next=36;break}return f.next=24,e(d,p.orientationX,g.orientationX,m);case 24:return f.next=26,e(d,p.orientationY,g.orientationY,m);case 26:return f.next=28,e(d,p.orientationZ,g.orientationZ,m);case 28:return f.next=30,e(d,p.positionX,g.positionX,m);case 30:return f.next=32,e(d,p.positionY,g.positionY,m);case 32:return f.next=34,e(d,p.positionZ,g.positionZ,m);case 34:f.next=48;break;case 36:return f.next=38,s(d,p.orientationX,g.orientationX,m);case 38:return f.next=40,s(d,p.orientationY,g.orientationY,m);case 40:return f.next=42,s(d,p.orientationZ,g.orientationZ,m);case 42:return f.next=44,s(d,p.positionX,g.positionX,m);case 44:return f.next=46,s(d,p.positionY,g.positionY,m);case 46:return f.next=48,s(d,p.positionZ,g.positionZ,m);case 48:if(!Z(g)){f.next=53;break}return f.next=51,u(p,d,g.inputs[0],m);case 51:f.next=55;break;case 53:return f.next=55,u(p,d,g,m);case 55:return f.abrupt("return",g);case 56:case"end":return f.stop()}}),f)}))),function(e,t,n){return m.apply(this,arguments)})(f,p,d)}}}}(Pn,zn,Gn,Je,cr,ee,cn,On,an,Kn),un,ln),hr=function(e,t,n){return function(){function r(i,o){_classCallCheck(this,r);var a=t(i),s=function(e){var t=e.imag,n=e.real;return _objectSpread(_objectSpread({},e),{},void 0===t?void 0===n?{imag:[0,0],real:[0,0]}:{imag:Array.from(n,(function(){return 0})),real:n}:void 0===n?{imag:t,real:Array.from(t,(function(){return 0}))}:{imag:t,real:n})}(_objectSpread(_objectSpread({},Gt),o)),u=e(a,s);return n.add(u),u}return _createClass(r,null,[{key:Symbol.hasInstance,value:function(e){return null!==e&&"object"==_typeof(e)&&Object.getPrototypeOf(e)===r.prototype||n.has(e)}}])}()}(function(e){return function(t,n){var r=n.disableNormalization,i=n.imag,o=n.real,a=i instanceof Float32Array?i:new Float32Array(i),s=o instanceof Float32Array?o:new Float32Array(o),u=t.createPeriodicWave(s,a,{disableNormalization:r});if(Array.from(i).length<2)throw e();return u}}(I),un,new WeakSet),fr=function(e,t){return function(n,r){var i=r.channelCountMode;if("clamped-max"===i)throw t();if(void 0===n.createStereoPanner)return e(n,r);var o=n.createStereoPanner();return Ve(o,r),Be(o,r,"pan"),Object.defineProperty(o,"channelCountMode",{get:function(){return i},set:function(e){if(e!==i)throw t()}}),o}}(function(e,t,n,r,i,o){var a=new Float32Array([1,1]),s=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},c=_objectSpread(_objectSpread({},u),{},{oversample:"none"}),l=function(e,o,l,h,f){if(1===o)return function(e,t,i,o){for(var l=new Float32Array(16385),h=new Float32Array(16385),f=0;f<16385;f+=1){var p=f/16384*s;l[f]=Math.cos(p),h[f]=Math.sin(p)}var d=n(e,_objectSpread(_objectSpread({},u),{},{gain:0})),m=r(e,_objectSpread(_objectSpread({},c),{},{curve:l})),v=r(e,_objectSpread(_objectSpread({},c),{},{curve:a})),g=n(e,_objectSpread(_objectSpread({},u),{},{gain:0})),y=r(e,_objectSpread(_objectSpread({},c),{},{curve:h}));return{connectGraph:function(){t.connect(d),t.connect(v.inputs[0]),t.connect(g),v.connect(i),i.connect(m.inputs[0]),i.connect(y.inputs[0]),m.connect(d.gain),y.connect(g.gain),d.connect(o,0,0),g.connect(o,0,1)},disconnectGraph:function(){t.disconnect(d),t.disconnect(v.inputs[0]),t.disconnect(g),v.disconnect(i),i.disconnect(m.inputs[0]),i.disconnect(y.inputs[0]),m.disconnect(d.gain),y.disconnect(g.gain),d.disconnect(o,0,0),g.disconnect(o,0,1)}}}(e,l,h,f);if(2===o)return function(e,i,o,l){for(var h=new Float32Array(16385),f=new Float32Array(16385),p=new Float32Array(16385),d=new Float32Array(16385),m=Math.floor(8192.5),v=0;v<16385;v+=1)if(v>m){var g=(v-m)/(16384-m)*s;h[v]=Math.cos(g),f[v]=Math.sin(g),p[v]=0,d[v]=1}else{var y=v/(16384-m)*s;h[v]=1,f[v]=0,p[v]=Math.cos(y),d[v]=Math.sin(y)}var _=t(e,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),k=n(e,_objectSpread(_objectSpread({},u),{},{gain:0})),b=r(e,_objectSpread(_objectSpread({},c),{},{curve:h})),S=n(e,_objectSpread(_objectSpread({},u),{},{gain:0})),w=r(e,_objectSpread(_objectSpread({},c),{},{curve:f})),x=r(e,_objectSpread(_objectSpread({},c),{},{curve:a})),T=n(e,_objectSpread(_objectSpread({},u),{},{gain:0})),C=r(e,_objectSpread(_objectSpread({},c),{},{curve:p})),P=n(e,_objectSpread(_objectSpread({},u),{},{gain:0})),A=r(e,_objectSpread(_objectSpread({},c),{},{curve:d}));return{connectGraph:function(){i.connect(_),i.connect(x.inputs[0]),_.connect(k,0),_.connect(S,0),_.connect(T,1),_.connect(P,1),x.connect(o),o.connect(b.inputs[0]),o.connect(w.inputs[0]),o.connect(C.inputs[0]),o.connect(A.inputs[0]),b.connect(k.gain),w.connect(S.gain),C.connect(T.gain),A.connect(P.gain),k.connect(l,0,0),T.connect(l,0,0),S.connect(l,0,1),P.connect(l,0,1)},disconnectGraph:function(){i.disconnect(_),i.disconnect(x.inputs[0]),_.disconnect(k,0),_.disconnect(S,0),_.disconnect(T,1),_.disconnect(P,1),x.disconnect(o),o.disconnect(b.inputs[0]),o.disconnect(w.inputs[0]),o.disconnect(C.inputs[0]),o.disconnect(A.inputs[0]),b.disconnect(k.gain),w.disconnect(S.gain),C.disconnect(T.gain),A.disconnect(P.gain),k.disconnect(l,0,0),T.disconnect(l,0,0),S.disconnect(l,0,1),P.disconnect(l,0,1)}}}(e,l,h,f);throw i()};return function(t,r){var a=r.channelCount,s=r.channelCountMode,u=r.pan,c=_objectWithoutProperties(r,_excluded4);if("max"===s)throw i();var h=e(t,_objectSpread(_objectSpread({},c),{},{channelCount:1,channelCountMode:s,numberOfInputs:2})),f=n(t,_objectSpread(_objectSpread({},c),{},{channelCount:a,channelCountMode:s,gain:1})),p=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:u}),d=l(t,a,f,p,h),m=d.connectGraph,v=d.disconnectGraph;Object.defineProperty(p.gain,"defaultValue",{get:function(){return 0}}),Object.defineProperty(p.gain,"minValue",{get:function(){return-1}});var g={get bufferSize(){},get channelCount(){return f.channelCount},set channelCount(e){var n;f.channelCount!==e&&(y&&v(),n=l(t,e,f,p,h),m=n.connectGraph,v=n.disconnectGraph,y&&m()),f.channelCount=e},get channelCountMode(){return f.channelCountMode},set channelCountMode(e){if("clamped-max"===e||"max"===e)throw i();f.channelCountMode=e},get channelInterpretation(){return f.channelInterpretation},set channelInterpretation(e){f.channelInterpretation=e},get context(){return f.context},get inputs(){return[f]},get numberOfInputs(){return f.numberOfInputs},get numberOfOutputs(){return f.numberOfOutputs},get pan(){return p.gain},addEventListener:function(){return f.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},dispatchEvent:function(){return f.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return f.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},y=!1;return o(Ze(g,h),(function(){m(),y=!0}),(function(){v(),y=!1}))}}(zn,Xe,Je,sr,zt,Rn),zt),pr=function(e,t,n,r,i,o){return function(e){function a(e,s){var u;_classCallCheck(this,a);var c=i(e),l=_objectSpread(_objectSpread({},Bt),s),h=n(c,l),f=o(c);return(u=_callSuper(this,a,[e,!1,h,f?r():null]))._pan=t(_assertThisInitialized(u),f,h.pan),u}return _inherits(a,e),_createClass(a,[{key:"pan",get:function(){return this._pan}}])}(e)}(gn,Nn,fr,function(e,t,n,r,i){return function(){var o=new WeakMap;return{render:function(a,s,u){var c,l=o.get(s);return void 0!==l?Promise.resolve(l):(c=_asyncToGenerator(_regeneratorRuntime().mark((function a(s,u,c){var l,h,f;return _regeneratorRuntime().wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(l=n(s),(h=M(l,u))||(f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,pan:l.pan.value},l=t(u,f)),o.set(u,l),!h){a.next=9;break}return a.next=7,e(u,s.pan,l.pan,c);case 7:a.next=11;break;case 9:return a.next=11,r(u,s.pan,l.pan,c);case 11:if(!Z(l)){a.next=16;break}return a.next=14,i(s,u,l.inputs[0],c);case 14:a.next=18;break;case 16:return a.next=18,i(s,u,l,c);case 18:return a.abrupt("return",l);case 19:case"end":return a.stop()}}),a)}))),function(e,t,n){return c.apply(this,arguments)})(a,s,u)}}}}(Pn,fr,ee,On,an),un,ln),dr=function(e,t,n){return function(){var r=new WeakMap;return{render:function(i,o,a){var s,u=r.get(o);return void 0!==u?Promise.resolve(u):(s=_asyncToGenerator(_regeneratorRuntime().mark((function i(o,a,s){var u,c;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(u=t(o),M(u,a)||(c={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,curve:u.curve,oversample:u.oversample},u=e(a,c)),r.set(a,u),!Z(u)){i.next=8;break}return i.next=6,n(o,a,u.inputs[0],s);case 6:i.next=10;break;case 8:return i.next=10,n(o,a,u,s);case 10:return i.abrupt("return",u);case 11:case"end":return i.stop()}}),i)}))),function(e,t,n){return s.apply(this,arguments)})(i,o,a)}}}}(sr,ee,an),mr=function(e,t,n,r,i,o){return function(e){function a(e,t){var s;_classCallCheck(this,a);var u=i(e),c=_objectSpread(_objectSpread({},Ht),t),l=n(u,c);return(s=_callSuper(this,a,[e,!0,l,o(u)?r():null]))._isCurveNullified=!1,s._nativeWaveShaperNode=l,s}return _inherits(a,e),_createClass(a,[{key:"curve",get:function(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve},set:function(e){if(null===e)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(e.length<2)throw t();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=e}}},{key:"oversample",get:function(){return this._nativeWaveShaperNode.oversample},set:function(e){this._nativeWaveShaperNode.oversample=e}}])}(e)}(gn,qe,sr,dr,un,ln),vr=function(e){return null!==e&&e.isSecureContext}(nn),gr=function(e){return function(t,n,r){Object.defineProperties(e,{currentFrame:{configurable:!0,get:function(){return Math.round(t*n)}},currentTime:{configurable:!0,get:function(){return t}}});try{return r()}finally{null!==e&&(delete e.currentFrame,delete e.currentTime)}}}(nn),yr=new WeakMap,_r=function(e,t){return function(n){var r=e.get(n);if(void 0!==r)return r;if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new t(1,1,8e3),e.set(n,r),r}}(yr,cn),kr=function(e){return null===e?null:e.hasOwnProperty("AudioWorkletNode")?e.AudioWorkletNode:null}(nn),br=vr?function(e,t,n,r,i,o,a,s,u,c,l,h){return function(f,p){var d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{credentials:"omit"},m=o(f),v=new URL(p,h.location.href).toString();if(void 0!==m.audioWorklet)return Promise.all([i(p),Promise.resolve(e(l,l))]).then((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1],i=_slicedToArray(C(n,v),2),o=i[0],u=i[1],c=r?u:u.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),l=new Blob(["".concat(o,";(registerProcessor=>{").concat(c,"\n})((n,p)=>registerProcessor(n,class extends p{").concat(r?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));","process(i,o,p){").concat(r?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));","return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))")],{type:"application/javascript; charset=utf-8"}),h=URL.createObjectURL(l);return m.audioWorklet.addModule(h,d).then((function(){if(!s(m))return a(m).audioWorklet.addModule(h,d)})).finally((function(){return URL.revokeObjectURL(h)}))}));var g=c.get(f);if(void 0!==g&&g.has(p))return Promise.resolve();var y=u.get(f);if(void 0!==y){var _=y.get(p);if(void 0!==_)return _}var k=i(p).then((function(e){var t=_slicedToArray(C(e,v),2),r=t[0],i=t[1];return n("".concat(r,";((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{").concat(i,"\n})})(window,'_AWGS')"))})).then((function(){var e=h._AWGS.pop();if(void 0===e)throw new SyntaxError;r(m.currentTime,m.sampleRate,(function(){return e(_createClass((function e(){_classCallCheck(this,e)})),void 0,(function(e,n){if(""===e.trim())throw t();var r=S.get(m);if(void 0!==r){if(r.has(e))throw t();A(n),P(n.parameterDescriptors),r.set(e,n)}else A(n),P(n.parameterDescriptors),S.set(m,new Map([[e,n]]))}),m.sampleRate,void 0,void 0)}))}));return void 0===y?u.set(f,new Map([[p,k]])):y.set(p,k),k.then((function(){var e=c.get(f);void 0===e?c.set(f,new Set([p])):e.add(p)})).finally((function(){var e=u.get(f);void 0!==e&&e.delete(p)})),k}}(tn,zt,function(e){return function(t){return new Promise((function(n,r){if(null!==e){var i=e.document.head;if(null===i)r(new SyntaxError);else{var o=e.document.createElement("script"),a=new Blob([t],{type:"application/javascript"}),s=URL.createObjectURL(a),u=e.onerror,c=function(){e.onerror=u,URL.revokeObjectURL(s)};e.onerror=function(t,n,i,o,a){return n===s||n===e.location.href&&1===i&&1===o?(c(),r(a),!1):null!==u?u(t,n,i,o,a):void 0},o.onerror=function(){c(),r(new SyntaxError)},o.onload=function(){c(),n()},o.src=s,o.type="module",i.appendChild(o)}}else r(new SyntaxError)}))}}(nn),gr,function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(t);case 3:if(!(n=e.sent).ok){e.next=6;break}return e.abrupt("return",n.text());case 6:e.next=10;break;case 8:e.prev=8,e.t0=e.catch(0);case 10:throw new DOMException("","AbortError");case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),un,_r,ln,new WeakMap,new WeakMap,function(e,t){return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var r,i,o,a,s,u,c;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==e){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==t){n.next=4;break}return n.abrupt("return",!1);case 4:return r=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new t(1,128,8e3),o=URL.createObjectURL(r),a=!1,s=!1,n.prev=6,n.next=9,i.audioWorklet.addModule(o);case 9:return u=new e(i,"a",{numberOfOutputs:0}),c=i.createOscillator(),u.port.onmessage=function(){return a=!0},u.onprocessorerror=function(){return s=!0},c.connect(u),n.next=15,i.startRendering();case 15:n.next=19;break;case 17:n.prev=17,n.t0=n.catch(6);case 19:return n.prev=19,URL.revokeObjectURL(o),n.finish(19);case 22:return n.abrupt("return",a&&!s);case 23:case"end":return n.stop()}}),n,null,[[6,17,19,22]])})))}(kr,cn),nn):void 0,Sr=function(e,t){return function(n){return e(n)||t(n)}}(dn,ln),wr=function(e,t,n,r,i,o,a,s,u,c,l,h,f,p,d,m,v,g,y,_){return function(d){function k(t,n){var r;return _classCallCheck(this,k),(r=_callSuper(this,k,[t,n]))._nativeContext=t,r._audioWorklet=void 0===e?void 0:{addModule:function(t,n){return e(_assertThisInitialized(r),t,n)}},r}return _inherits(k,d),_createClass(k,[{key:"audioWorklet",get:function(){return this._audioWorklet}},{key:"createAnalyser",value:function(){return new t(this)}},{key:"createBiquadFilter",value:function(){return new i(this)}},{key:"createBuffer",value:function(e,t,r){return new n({length:t,numberOfChannels:e,sampleRate:r})}},{key:"createBufferSource",value:function(){return new r(this)}},{key:"createChannelMerger",value:function(){return new o(this,{numberOfInputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}},{key:"createChannelSplitter",value:function(){return new a(this,{numberOfOutputs:arguments.length>0&&void 0!==arguments[0]?arguments[0]:6})}},{key:"createConstantSource",value:function(){return new s(this)}},{key:"createConvolver",value:function(){return new u(this)}},{key:"createDelay",value:function(){return new l(this,{maxDelayTime:arguments.length>0&&void 0!==arguments[0]?arguments[0]:1})}},{key:"createDynamicsCompressor",value:function(){return new h(this)}},{key:"createGain",value:function(){return new f(this)}},{key:"createIIRFilter",value:function(e,t){return new p(this,{feedback:t,feedforward:e})}},{key:"createOscillator",value:function(){return new m(this)}},{key:"createPanner",value:function(){return new v(this)}},{key:"createPeriodicWave",value:function(e,t){return new g(this,_objectSpread(_objectSpread({},arguments.length>2&&void 0!==arguments[2]?arguments[2]:{disableNormalization:!1}),{},{imag:t,real:e}))}},{key:"createStereoPanner",value:function(){return new y(this)}},{key:"createWaveShaper",value:function(){return new _(this)}},{key:"decodeAudioData",value:function(e,t,n){return c(this._nativeContext,e).then((function(e){return"function"==typeof t&&t(e),e})).catch((function(e){throw"function"==typeof n&&n(e),e}))}}])}(d)}(br,yn,xn,In,Dn,Fn,Ln,Bn,Hn,function(e,t,n,r,i,o,a,s,u,c,l){return function(n,r){var h=a(n)?n:o(n);if(i.has(r)){var f=new DOMException("","DataCloneError");return Promise.reject(f)}try{i.add(r)}catch(e){}return t(u,(function(){return u(h)}))?h.decodeAudioData(r).then((function(n){return t(s,(function(){return s(n)}))||l(n),e.add(n),n})):new Promise((function(t,n){var i=function(){try{!function(e){(new MessageChannel).port1.postMessage(e,[e])}(r)}catch(e){}},o=function(e){n(e),i()};try{h.decodeAudioData(r,(function(n){"function"!=typeof n.copyFromChannel&&(c(n),E(n)),e.add(n),i(),t(n)}),(function(e){o(null===e?new DOMException("","EncodingError"):e)}))}catch(e){o(e)}}))}}(_n,tn,0,0,new WeakSet,un,Sr,N,Fe,Sn,wn),Qn,Yn,Xn,$n,nr,ir,lr,hr,pr,mr),xr=function(e,t,n,r){return function(e){function t(e,i){var o;_classCallCheck(this,t);var a=n(e),s=function(e,t){return e.createMediaElementSource(t.mediaElement)}(a,i);if(r(a))throw TypeError();return(o=_callSuper(this,t,[e,!0,s,null]))._nativeMediaElementAudioSourceNode=s,o}return _inherits(t,e),_createClass(t,[{key:"mediaElement",get:function(){return this._nativeMediaElementAudioSourceNode.mediaElement}}])}(e)}(gn,0,un,ln),Tr=function(e,t,n,r){return function(e){function t(e,i){var o;_classCallCheck(this,t);var a=n(e);if(r(a))throw new TypeError;var s=function(e,t){var n=e.createMediaStreamDestination();return Ve(n,t),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:function(){return 0}}),n}(a,_objectSpread(_objectSpread({},ze),i));return(o=_callSuper(this,t,[e,!1,s,null]))._nativeMediaStreamAudioDestinationNode=s,o}return _inherits(t,e),_createClass(t,[{key:"stream",get:function(){return this._nativeMediaStreamAudioDestinationNode.stream}}])}(e)}(gn,0,un,ln),Cr=function(e,t,n,r){return function(e){function t(e,i){var o;_classCallCheck(this,t);var a=n(e),s=function(e,t){var n=t.mediaStream,r=n.getAudioTracks();r.sort((function(e,t){return e.id<t.id?-1:e.id>t.id?1:0}));var i=r.slice(0,1),o=e.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(o,"mediaStream",{value:n}),o}(a,i);if(r(a))throw new TypeError;return(o=_callSuper(this,t,[e,!0,s,null]))._nativeMediaStreamAudioSourceNode=s,o}return _inherits(t,e),_createClass(t,[{key:"mediaStream",get:function(){return this._nativeMediaStreamAudioSourceNode.mediaStream}}])}(e)}(gn,0,un,ln),Pr=function(e,t,n){return function(e){function r(e,i){_classCallCheck(this,r);var o=n(e);return _callSuper(this,r,[e,!0,t(o,i),null])}return _inherits(r,e),_createClass(r)}(e)}(gn,function(e,t){return function(n,r){var i=r.mediaStreamTrack;if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);var o=new MediaStream([i]),a=n.createMediaStreamSource(o);if("audio"!==i.kind)throw e();if(t(n))throw new TypeError;return a}}(qe,ln),un),Ar=function(e,t,n,r,i,o,a,s,u){return function(e){function c(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(_classCallCheck(this,c),null===u)throw new Error("Missing the native AudioContext constructor.");var i=new u(t);if(null===i)throw r();if(!function(e){return void 0===e||"number"==typeof e||"string"==typeof e&&("balanced"===e||"interactive"===e||"playback"===e)}(t.latencyHint))throw new TypeError("The provided value '".concat(t.latencyHint,"' is not a valid enum value of type AudioContextLatencyCategory."));if(void 0!==t.sampleRate&&i.sampleRate!==t.sampleRate)throw n();e=_callSuper(this,c,[i,2]);var o=t.latencyHint,a=i.sampleRate;if(e._baseLatency="number"==typeof i.baseLatency?i.baseLatency:"balanced"===o?512/a:"interactive"===o||void 0===o?256/a:"playback"===o?1024/a:128*Math.max(2,Math.min(128,Math.round(o*a/128)))/a,e._nativeAudioContext=i,"webkitAudioContext"===u.name?(e._nativeGainNode=i.createGain(),e._nativeOscillatorNode=i.createOscillator(),e._nativeGainNode.gain.value=1e-37,e._nativeOscillatorNode.connect(e._nativeGainNode).connect(i.destination),e._nativeOscillatorNode.start()):(e._nativeGainNode=null,e._nativeOscillatorNode=null),e._state=null,"running"===i.state){e._state="suspended";var s=function(){"suspended"===e._state&&(e._state=null),i.removeEventListener("statechange",s)};i.addEventListener("statechange",s)}return e}return _inherits(c,e),_createClass(c,[{key:"baseLatency",get:function(){return this._baseLatency}},{key:"state",get:function(){return null!==this._state?this._state:this._nativeAudioContext.state}},{key:"close",value:function(){var e=this;return"closed"===this.state?this._nativeAudioContext.close().then((function(){throw t()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((function(){null!==e._nativeGainNode&&null!==e._nativeOscillatorNode&&(e._nativeOscillatorNode.stop(),e._nativeGainNode.disconnect(),e._nativeOscillatorNode.disconnect()),W(e)})))}},{key:"createMediaElementSource",value:function(e){return new i(this,{mediaElement:e})}},{key:"createMediaStreamDestination",value:function(){return new o(this)}},{key:"createMediaStreamSource",value:function(e){return new a(this,{mediaStream:e})}},{key:"createMediaStreamTrackSource",value:function(e){return new s(this,{mediaStreamTrack:e})}},{key:"resume",value:function(){var e=this;return"suspended"===this._state?new Promise((function(t,n){var r=function(){e._nativeAudioContext.removeEventListener("statechange",r),"running"===e._nativeAudioContext.state?t():e.resume().then(t,n)};e._nativeAudioContext.addEventListener("statechange",r)})):this._nativeAudioContext.resume().catch((function(e){if(void 0===e||15===e.code)throw t();throw e}))}},{key:"suspend",value:function(){return this._nativeAudioContext.suspend().catch((function(e){if(void 0===e)throw t();throw e}))}}])}(e)}(wr,qe,zt,Ut,xr,Tr,Cr,Pr,pn),Or=(Nt=tr,function(e){var t=Nt.get(e);if(void 0===t)throw new Error("The context has no set of AudioWorkletNodes.");return t}),Mr=(It=Or,function(e,t){It(e).add(t)}),Nr=function(e){return function(t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=t[arguments.length>2&&void 0!==arguments[2]?arguments[2]:0];if(void 0===i)throw e();return ce(n)?i.connect(n,0,r):i.connect(n,0)}}(I),Ir=function(e){return function(t,n){e(t).delete(n)}}(Or),Er=function(e){return function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return void 0===n?t.forEach((function(e){return e.disconnect()})):"number"==typeof n?Ne(e,t,n).disconnect():ce(n)?void 0===r?t.forEach((function(e){return e.disconnect(n)})):void 0===i?Ne(e,t,r).disconnect(n,0):Ne(e,t,r).disconnect(n,0,i):void 0===r?t.forEach((function(e){return e.disconnect(n)})):Ne(e,t,r).disconnect(n,0)}}(I),qr=new WeakMap,Dr=function(e,t){return function(n){return t(e,n)}}(qr,z),Rr=function(e,t,n,r,i,o,a,s,u,c,l,h,f){return function(p,d,m,v){if(0===v.numberOfInputs&&0===v.numberOfOutputs)throw u();var g=Array.isArray(v.outputChannelCount)?v.outputChannelCount:Array.from(v.outputChannelCount);if(g.some((function(e){return e<1})))throw u();if(g.length!==v.numberOfOutputs)throw t();if("explicit"!==v.channelCountMode)throw u();var y=v.channelCount*v.numberOfInputs,_=g.reduce((function(e,t){return e+t}),0),k=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(y+k>6||_>6)throw u();for(var b=new MessageChannel,S=[],x=[],T=0;T<v.numberOfInputs;T+=1)S.push(a(p,{channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation,gain:1})),x.push(i(p,{channelCount:v.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:v.channelCount}));var C=[];if(void 0!==m.parameterDescriptors){var P,A=_createForOfIteratorHelper(m.parameterDescriptors);try{var O=function(){var e=P.value,t=e.defaultValue,n=e.maxValue,r=e.minValue,i=e.name,a=o(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==v.parameterData[i]?v.parameterData[i]:void 0===t?0:t});Object.defineProperties(a.offset,{defaultValue:{get:function(){return void 0===t?0:t}},maxValue:{get:function(){return void 0===n?R:n}},minValue:{get:function(){return void 0===r?D:r}}}),C.push(a)};for(A.s();!(P=A.n()).done;)O()}catch(e){A.e(e)}finally{A.f()}}for(var M=r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,y+k)}),N=Qe(d,p.sampleRate),I=s(p,N,y+k,Math.max(1,_)),E=i(p,{channelCount:Math.max(1,_),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,_)}),q=[],j=0;j<v.numberOfOutputs;j+=1)q.push(r(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:g[j]}));for(var z=0;z<v.numberOfInputs;z+=1){S[z].connect(x[z]);for(var F=0;F<v.channelCount;F+=1)x[z].connect(M,F,z*v.channelCount+F)}var L=new _e(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((function(e,t){var n=e.name,r=C[t];return r.connect(M,0,y+t),r.start(0),[n,r.offset]})));M.connect(I);var V,G,B=v.channelInterpretation,U=null,H=0===v.numberOfOutputs?[I]:q,Q={get bufferSize(){return N},get channelCount(){return v.channelCount},set channelCount(e){throw n()},get channelCountMode(){return v.channelCountMode},set channelCountMode(e){throw n()},get channelInterpretation(){return B},set channelInterpretation(e){for(var t=0,n=S;t<n.length;t++){n[t].channelInterpretation=e}B=e},get context(){return I.context},get inputs(){return S},get numberOfInputs(){return v.numberOfInputs},get numberOfOutputs(){return v.numberOfOutputs},get onprocessorerror(){return U},set onprocessorerror(e){"function"==typeof U&&Q.removeEventListener("processorerror",U),"function"==typeof(U="function"==typeof e?e:null)&&Q.addEventListener("processorerror",U)},get parameters(){return L},get port(){return b.port2},addEventListener:function(){return I.addEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])},connect:e.bind(null,H),disconnect:c.bind(null,H),dispatchEvent:function(){return I.dispatchEvent(arguments.length<=0?void 0:arguments[0])},removeEventListener:function(){return I.removeEventListener(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},W=new Map;b.port1.addEventListener=(V=b.port1.addEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){var r="function"==typeof t[1]?t[1]:"object"==_typeof(t[1])&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==r){var i=W.get(t[1]);void 0!==i?t[1]=i:(t[1]=function(e){l(p.currentTime,p.sampleRate,(function(){return r(e)}))},W.set(r,t[1]))}}return V.call(b.port1,t[0],t[1],t[2])}),b.port1.removeEventListener=(G=b.port1.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("message"===t[0]){var r=W.get(t[1]);void 0!==r&&(W.delete(t[1]),t[1]=r)}return G.call(b.port1,t[0],t[1],t[2])});var Y=null;Object.defineProperty(b.port1,"onmessage",{get:function(){return Y},set:function(e){"function"==typeof Y&&b.port1.removeEventListener("message",Y),"function"==typeof(Y="function"==typeof e?e:null)&&(b.port1.addEventListener("message",Y),b.port1.start())}}),m.prototype.port=b.port1;var X=null;(function(e,t,n,r){var i=w.get(e);void 0===i&&(i=new WeakMap,w.set(e,i));var o=We(n,r);return i.set(t,o),o})(p,Q,m,v).then((function(e){return X=e}));var Z=we(v.numberOfInputs,v.channelCount),K=we(v.numberOfOutputs,g),J=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce((function(e,t){var n=t.name;return _objectSpread(_objectSpread({},e),{},_defineProperty({},n,new Float32Array(128)))}),{}),$=!0,ee=function(){v.numberOfOutputs>0&&I.disconnect(E);for(var e=0,t=0;e<v.numberOfOutputs;e+=1){for(var n=q[e],r=0;r<g[e];r+=1)E.disconnect(n,t+r,r);t+=g[e]}};I.onaudioprocess=function(e){var t=e.inputBuffer,n=e.outputBuffer;if(null!==X)for(var r=function(e){for(var r=0;r<v.numberOfInputs;r+=1)for(var i=0;i<v.channelCount;i+=1)be(t,Z[r],i,i,e);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((function(n,r){var i=n.name;be(t,J,i,y+r,e)}));for(var o=0;o<v.numberOfInputs;o+=1)for(var a=0;a<g[o];a+=1)0===K[o][a].byteLength&&(K[o][a]=new Float32Array(128));try{var s=h(Q),u=Z.map((function(e,t){return s[t].size>0?e:[]})),c=l(p.currentTime+e/p.sampleRate,p.sampleRate,(function(){return X.process(u,K,J)}));$=c;for(var f=0,d=0;f<v.numberOfOutputs;f+=1){for(var _=0;_<g[f];_+=1)Se(n,K[f],_,d+_,e);d+=g[f]}}catch(e){$=!1,Q.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}))}if(!$){for(var k=0;k<v.numberOfInputs;k+=1){S[k].disconnect(x[k]);for(var b=0;b<v.channelCount;b+=1)x[e].disconnect(M,b,k*v.channelCount+b)}if(void 0!==m.parameterDescriptors)for(var w=m.parameterDescriptors.length,T=0;T<w;T+=1){var P=C[T];P.disconnect(M,0,y+T),P.stop()}return M.disconnect(I),I.onaudioprocess=null,te?ee():ie(),1}},i=0;i<N&&!r(i);i+=128);};var te=!1,ne=a(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),re=function(){return I.connect(ne).connect(p.destination)},ie=function(){I.disconnect(ne),ne.disconnect()};return re(),f(Q,(function(){if($){ie(),v.numberOfOutputs>0&&I.connect(E);for(var e=0,t=0;e<v.numberOfOutputs;e+=1){for(var n=q[e],r=0;r<g[e];r+=1)E.connect(n,t+r,r);t+=g[e]}}te=!0}),(function(){$&&(re(),ee()),te=!1}))}}(Nr,I,qe,zn,Xe,Gn,Je,jt,zt,Er,gr,Dr,Rn),jr=function(e,t,n,r,i){return function(o,a,s,u,c,l){if(null!==s)try{var h=new s(o,u,l),f=new Map,p=null;if(Object.defineProperties(h,{channelCount:{get:function(){return l.channelCount},set:function(){throw e()}},channelCountMode:{get:function(){return"explicit"},set:function(){throw e()}},onprocessorerror:{get:function(){return p},set:function(e){"function"==typeof p&&h.removeEventListener("processorerror",p),"function"==typeof(p="function"==typeof e?e:null)&&h.addEventListener("processorerror",p)}}}),h.addEventListener=(v=h.addEventListener,function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if("processorerror"===n[0]){var i="function"==typeof n[1]?n[1]:"object"==_typeof(n[1])&&null!==n[1]&&"function"==typeof n[1].handleEvent?n[1].handleEvent:null;if(null!==i){var o=f.get(n[1]);void 0!==o?n[1]=o:(n[1]=function(e){"error"===e.type?(Object.defineProperties(e,{type:{value:"processorerror"}}),i(e)):i(new ErrorEvent(n[0],_objectSpread({},e)))},f.set(i,n[1]))}}return v.call(h,"error",n[1],n[2]),(e=v).call.apply(e,[h].concat(n))}),h.removeEventListener=(m=h.removeEventListener,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if("processorerror"===t[0]){var r=f.get(t[1]);void 0!==r&&(f.delete(t[1]),t[1]=r)}return m.call(h,"error",t[1],t[2]),m.call(h,t[0],t[1],t[2])}),0!==l.numberOfOutputs){var d=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(d).connect(o.destination),i(h,(function(){return d.disconnect()}),(function(){return d.connect(o.destination)}))}return h}catch(e){if(11===e.code)throw r();throw e}var m,v;if(void 0===c)throw r();return function(e){var t=(new MessageChannel).port1;try{t.postMessage(e)}finally{t.close()}}(l),t(o,a,c,l)}}(qe,Rr,Je,zt,Rn),zr=function(e,t,n,r,i,o,a,s,u,c,l,h,f,p,d,m){return function(v,g,y){var _=new WeakMap,k=null;return{render:function(b,S,w){s(S,b);var x,T=_.get(S);return void 0!==T?Promise.resolve(T):(x=_asyncToGenerator(_regeneratorRuntime().mark((function s(b,S,w){var x,T,C,P,A,O,N,I,E,q,D,R,j,z,F,L,V,G,B,U,H,Q,W,Y,X,Z,K,J,$,ee,te,ne,re;return _regeneratorRuntime().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(x=l(b),T=null,C=M(x,S),P=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount),null===h){for(A=P.reduce((function(e,t){return e+t}),0),O=i(S,{channelCount:Math.max(1,A),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,A)}),N=[],I=0;I<b.numberOfOutputs;I+=1)N.push(r(S,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:P[I]}));(E=a(S,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})).connect=t.bind(null,N),E.disconnect=u.bind(null,N),T=[O,N,E]}else C||(x=new h(S,v));if(_.set(S,null===T?x:T[2]),null===T){s.next=38;break}if(null!==k){s.next=26;break}if(void 0!==y){s.next=7;break}throw new Error("Missing the processor constructor.");case 7:if(null!==f){s.next=9;break}throw new Error("Missing the native OfflineAudioContext constructor.");case 9:if(q=b.channelCount*b.numberOfInputs,D=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,R=q+D,j=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,s,u,c,l,h,v,y,_,k,x,T;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=new f(R,128*Math.ceil(b.context.length/128),S.sampleRate),n=[],s=[],u=0;u<g.numberOfInputs;u+=1)n.push(a(t,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),s.push(i(t,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));return e.next=4,Promise.all(Array.from(b.parameters.values()).map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:n.value}),e.next=3,p(t,n,r.offset,w);case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 4:for(c=e.sent,l=r(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,q+D)}),h=0;h<g.numberOfInputs;h+=1)for(n[h].connect(s[h]),v=0;v<g.channelCount;v+=1)s[h].connect(l,v,h*g.channelCount+v);y=_createForOfIteratorHelper(c.entries());try{for(y.s();!(_=y.n()).done;)k=_slicedToArray(_.value,2),x=k[0],(T=k[1]).connect(l,0,q+x),T.start(0)}catch(e){y.e(e)}finally{y.f()}return l.connect(t.destination),e.next=12,Promise.all(n.map((function(e){return d(b,t,e,w)})));case 12:return e.abrupt("return",m(t));case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s.t0=xe,s.t1=b,0!==R){s.next=16;break}s.t2=null,s.next=19;break;case 16:return s.next=18,j();case 18:s.t2=s.sent;case 19:s.t3=s.t2,s.t4=S,s.t5=g,s.t6=P,s.t7=y,s.t8=c,k=(0,s.t0)(s.t1,s.t3,s.t4,s.t5,s.t6,s.t7,s.t8);case 26:return s.next=28,k;case 28:for(z=s.sent,F=n(S,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),L=_slicedToArray(T,3),V=L[0],G=L[1],B=L[2],null!==z&&(F.buffer=z,F.start(0)),F.connect(V),U=0,H=0;U<b.numberOfOutputs;U+=1){for(Q=G[U],W=0;W<P[U];W+=1)V.connect(Q,H+W,W);H+=P[U]}return s.abrupt("return",B);case 38:if(!C){s.next=58;break}Y=_createForOfIteratorHelper(b.parameters.entries()),s.prev=40,Y.s();case 42:if((X=Y.n()).done){s.next=48;break}return Z=_slicedToArray(X.value,2),K=Z[0],J=Z[1],s.next=46,e(S,J,x.parameters.get(K),w);case 46:s.next=42;break;case 48:s.next=53;break;case 50:s.prev=50,s.t9=s.catch(40),Y.e(s.t9);case 53:return s.prev=53,Y.f(),s.finish(53);case 56:s.next=75;break;case 58:$=_createForOfIteratorHelper(b.parameters.entries()),s.prev=59,$.s();case 61:if((ee=$.n()).done){s.next=67;break}return te=_slicedToArray(ee.value,2),ne=te[0],re=te[1],s.next=65,p(S,re,x.parameters.get(ne),w);case 65:s.next=61;break;case 67:s.next=72;break;case 69:s.prev=69,s.t10=s.catch(59),$.e(s.t10);case 72:return s.prev=72,$.f(),s.finish(72);case 75:return s.next=77,d(b,S,x,w);case 77:return s.abrupt("return",x);case 78:case"end":return s.stop()}}),s,null,[[40,50,53,56],[59,69,72,75]])}))),function(e,t,n){return x.apply(this,arguments)})(b,S,w)}}}}(Pn,Nr,An,zn,Xe,Gn,Je,Ir,Er,gr,ee,kr,cn,On,an,Kn),Fr=function(e){return function(t){return e.get(t)}}(yr),Lr=function(e){return function(t,n){e.set(t,n)}}(qr),Vr=vr?function(e,t,n,r,i,o,a,s,u,c,l,h,f){return function(t){function l(t,f,p){var d,m;_classCallCheck(this,l);var v=s(t),g=u(v),y=function(e){return _objectSpread(_objectSpread({},e),{},{outputChannelCount:void 0!==e.outputChannelCount?e.outputChannelCount:1===e.numberOfInputs&&1===e.numberOfOutputs?[e.channelCount]:Array.from({length:e.numberOfOutputs},(function(){return 1}))})}(_objectSpread(_objectSpread({},ke),p)),_=S.get(v),k=null==_?void 0:_.get(f),b=g||"closed"!==v.state?v:null!==(m=a(v))&&void 0!==m?m:v,w=i(b,g?null:t.baseLatency,c,f,k,y);d=_callSuper(this,l,[t,!0,w,g?r(f,y,k):null]);var x=[];w.parameters.forEach((function(e,t){var r=n(d,g,e);x.push([t,r])})),d._nativeAudioWorkletNode=w,d._onprocessorerror=null,d._parameters=new _e(x),g&&e(v,d);var T=o(d).activeInputs;return h(w,T),d}return _inherits(l,t),_createClass(l,[{key:"onprocessorerror",get:function(){return this._onprocessorerror},set:function(e){var t="function"==typeof e?f(this,e):null;this._nativeAudioWorkletNode.onprocessorerror=t;var n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===t?e:n}},{key:"parameters",get:function(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}},{key:"port",get:function(){return this._nativeAudioWorkletNode.port}}])}(t)}(Mr,gn,Nn,zr,jr,U,Fr,un,ln,kr,0,Lr,en):void 0,Gr=function(e,t){return function(n,r,i){if(null===t)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new t(n,r,i)}catch(t){if("SyntaxError"===t.name)throw e();throw t}}}(zt,cn),Br=function(e,t,n,r,i,o,a,s){var u=[];return function(c,l){return n(c).render(c,l,u).then((function(){return Promise.all(Array.from(r(l)).map((function(e){return n(e).render(e,l,u)})))})).then((function(){return i(l)})).then((function(n){return"function"!=typeof n.copyFromChannel?(a(n),E(n)):t(o,(function(){return o(n)}))||s(n),e.add(n),n}))}}(_n,tn,on,Or,Kn,N,Sn,wn),Ur=function(e,t,n,r,i){return function(e){function o(e,n,i){var a,s;if(_classCallCheck(this,o),"number"==typeof e&&void 0!==n&&void 0!==i)s={length:n,numberOfChannels:e,sampleRate:i};else{if("object"!=_typeof(e))throw new Error("The given parameters are not valid.");s=e}var u=_objectSpread(_objectSpread({},Ft),s),c=u.length,l=u.numberOfChannels,h=u.sampleRate,f=r(l,c,h);return t(Fe,(function(){return Fe(f)}))||f.addEventListener("statechange",function(){var e=0,t=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(n){"running"===a._state&&(e>0?(f.removeEventListener("statechange",t),n.stopImmediatePropagation(),a._waitForThePromiseToSettle(n)):e+=1)}));return t}()),(a=_callSuper(this,o,[f,l]))._length=c,a._nativeOfflineAudioContext=f,a._state=null,a}return _inherits(o,e),_createClass(o,[{key:"length",get:function(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}},{key:"state",get:function(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}},{key:"startRendering",value:function(){var e=this;return"running"===this._state?Promise.reject(n()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally((function(){e._state=null,W(e)})))}},{key:"_waitForThePromiseToSettle",value:function(e){var t=this;null===this._state?this._nativeOfflineAudioContext.dispatchEvent(e):setTimeout((function(){return t._waitForThePromiseToSettle(e)}))}}])}(e)}(wr,tn,qe,Gr,Br),Hr=function(e,t){return function(n){var r=e.get(n);return t(r)||t(n)}}(_,dn),Qr=(Et=v,qt=mn,function(e){return Et.has(e)||qt(e)}),Wr=(Dt=y,Rt=vn,function(e){return Dt.has(e)||Rt(e)}),Yr=function(e,t){return function(n){var r=e.get(n);return t(r)||t(n)}}(_,ln),Xr=function(){return(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r,i,o,a,s,u,c,l,h,f,p,d,m,v){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t(n,n)&&t(r,r)&&t(o,o)&&t(a,a)&&t(u,u)&&t(c,c)&&t(l,l)&&t(h,h)&&t(f,f)&&t(p,p)&&t(d,d))){e.next=4;break}return e.next=3,Promise.all([t(i,i),t(s,s),t(m,m),t(v,v)]);case 3:return e.abrupt("return",e.sent.every((function(e){return e})));case 4:return e.abrupt("return",!1);case 5:case"end":return e.stop()}}),e)}))),function(t,n,r,i,o,a,s,u,c,l,h,f,p,d,m,v){return e.apply(this,arguments)})(tn,function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createBuffer(1,1,44100);if(void 0===t.copyToChannel)return!0;var n=new Float32Array(2);try{t.copyFromChannel(n,0,0)}catch(e){return!1}return!0}}(cn),function(e){return function(){if(null===e)return!1;if(void 0!==e.prototype&&void 0!==e.prototype.close)return!0;var t=new e,n=void 0!==t.close;try{t.close()}catch(e){}return n}}(pn),function(e){return function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);return new Promise((function(e){var n,r=!0,i=function(n){r&&(r=!1,t.startRendering(),e(n instanceof TypeError))};try{n=t.decodeAudioData(null,(function(){}),i)}catch(e){i(e)}void 0!==n&&n.catch(i)}))}}(cn),function(e){return function(){if(null===e)return!1;var t;try{t=new e({latencyHint:"balanced"})}catch(e){return!1}return t.close(),!0}}(pn),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createGain(),n=t.connect(t)===t;return t.disconnect(t),n}}(cn),function(e,t){return _asyncToGenerator(_regeneratorRuntime().mark((function n(){var r,i,o,a,s,u;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null!==e){n.next=2;break}return n.abrupt("return",!0);case 2:if(null!==t){n.next=4;break}return n.abrupt("return",!1);case 4:return r=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new t(1,128,8e3),o=URL.createObjectURL(r),a=!1,n.prev=6,n.next=9,i.audioWorklet.addModule(o);case 9:return s=new e(i,"a",{numberOfOutputs:0}),u=i.createOscillator(),s.port.onmessage=function(){return a=!0},u.connect(s),u.start(0),n.next=15,i.startRendering();case 15:if(n.t0=a,n.t0){n.next=19;break}return n.next=19,new Promise((function(e){return setTimeout(e,5)}));case 19:n.next=23;break;case 21:n.prev=21,n.t1=n.catch(6);case 23:return n.prev=23,URL.revokeObjectURL(o),n.finish(23);case 26:return n.abrupt("return",a);case 27:case"end":return n.stop()}}),n,null,[[6,21,23,26]])})))}(kr,cn),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createChannelMerger();if("max"===t.channelCountMode)return!0;try{t.channelCount=2}catch(e){return!0}return!1}}(cn),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100);return void 0===t.createConstantSource||t.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY}}(cn),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100),n=t.createConvolver();n.buffer=t.createBuffer(1,1,t.sampleRate);try{n.buffer=t.createBuffer(1,1,t.sampleRate)}catch(e){return!1}return!0}}(cn),function(e){return function(){if(null===e)return!1;var t=new e(1,1,44100).createConvolver();try{t.channelCount=1}catch(e){return!1}return!0}}(cn),Kt,function(e){return function(){return null!==e&&e.hasOwnProperty("isSecureContext")}}(nn),function(e){return function(){if(null===e)return!1;var t=new e;try{return t.createMediaStreamSource(new MediaStream),!1}catch(e){return!0}}}(pn),function(e){return function(){if(null===e)return Promise.resolve(!1);var t=new e(1,1,44100);if(void 0===t.createStereoPanner)return Promise.resolve(!0);if(void 0===t.createConstantSource)return Promise.resolve(!0);var n=t.createConstantSource(),r=t.createStereoPanner();return n.channelCount=1,n.offset.value=1,r.channelCount=1,n.start(),n.connect(r).connect(t.destination),t.startRendering().then((function(e){return 1!==e.getChannelData(0)[0]}))}}(cn),Jt);var e};function Zr(e,t){if(!e)throw new Error(t)}function Kr(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;if(!(t<=e&&e<=n))throw new RangeError("Value must be within [".concat(t,", ").concat(n,"], got: ").concat(e))}function Jr(e){e.isOffline||"running"===e.state||ni('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}var $r=console;function ei(e){$r=e}function ti(){var e;(e=$r).log.apply(e,arguments)}function ni(){var e;(e=$r).warn.apply(e,arguments)}function ri(e){return void 0===e}function ii(e){return!ri(e)}function oi(e){return"function"==typeof e}function ai(e){return"number"==typeof e}function si(e){return"[object Object]"===Object.prototype.toString.call(e)&&e.constructor===Object}function ui(e){return"boolean"==typeof e}function ci(e){return Array.isArray(e)}function li(e){return"string"==typeof e}function hi(e){return li(e)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(e)}var fi="object"==("undefined"==typeof self?"undefined":_typeof(self))?self:null,pi=fi&&(fi.hasOwnProperty("AudioContext")||fi.hasOwnProperty("webkitAudioContext"));function di(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==("undefined"==typeof Reflect?"undefined":_typeof(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function mi(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}Object.create,Object.create;var vi=function(){return _createClass((function e(t,n,r){_classCallCheck(this,e),this._callback=t,this._type=n,this._updateInterval=r,this._createClock()}),[{key:"_createWorker",value:function(){var e=new Blob(["\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ".concat((1e3*this._updateInterval).toFixed(1),";\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t")],{type:"text/javascript"}),t=URL.createObjectURL(e),n=new Worker(t);n.onmessage=this._callback.bind(this),this._worker=n}},{key:"_createTimeout",value:function(){var e=this;this._timeout=setTimeout((function(){e._createTimeout(),e._callback()}),1e3*this._updateInterval)}},{key:"_createClock",value:function(){if("worker"===this._type)try{this._createWorker()}catch(e){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}},{key:"_disposeClock",value:function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}},{key:"updateInterval",get:function(){return this._updateInterval},set:function(e){this._updateInterval=Math.max(e,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*e,1))}},{key:"type",get:function(){return this._type},set:function(e){this._disposeClock(),this._type=e,this._createClock()}},{key:"dispose",value:function(){this._disposeClock()}}])}();function gi(e){return Wr(e)}function yi(e){return Qr(e)}function _i(e){return Yr(e)}function ki(e){return Hr(e)}function bi(e){return e instanceof AudioBuffer}function Si(e,t){return"value"===e||gi(t)||yi(t)||bi(t)}function wi(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(!n.length)return e;var i=n.shift();if(si(e)&&si(i))for(var o in i)Si(o,i[o])?e[o]=i[o]:si(i[o])?(e[o]||Object.assign(e,_defineProperty({},o,{})),wi(e[o],i[o])):Object.assign(e,_defineProperty({},o,i[o]));return wi.apply(void 0,[e].concat(n))}function xi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3?arguments[3]:void 0,i={},o=Array.from(t);if(si(o[0])&&r&&!Reflect.has(o[0],r)&&(Object.keys(o[0]).some((function(t){return Reflect.has(e,t)}))||(wi(i,_defineProperty({},r,o[0])),n.splice(n.indexOf(r),1),o.shift())),1===o.length&&si(o[0]))wi(i,o[0]);else for(var a=0;a<n.length;a++)ii(o[a])&&(i[n[a]]=o[a]);return wi(e,i)}function Ti(e,t){return ri(e)?t:e}function Ci(e,t){return t.forEach((function(t){Reflect.has(e,t)&&delete e[t]})),e
/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2019 Yotam Mann
 */}var Pi=function(){return _createClass((function e(){_classCallCheck(this,e),this.debug=!1,this._wasDisposed=!1}),[{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];(this.debug||fi&&this.toString()===fi.TONE_DEBUG_CLASS)&&ti.apply(void 0,[this].concat(t))}},{key:"dispose",value:function(){return this._wasDisposed=!0,this}},{key:"disposed",get:function(){return this._wasDisposed}},{key:"toString",value:function(){return this.name}}],[{key:"getDefaults",value:function(){return{}}}])}();function Ai(e,t){return e>t+1e-6}function Oi(e,t){return Ai(e,t)||Ni(e,t)}function Mi(e,t){return e+1e-6<t}function Ni(e,t){return Math.abs(e-t)<1e-6}function Ii(e,t,n){return Math.max(Math.min(e,n),t)}Pi.version=f;var Ei=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t)).name="Timeline",e._timeline=[];var n=xi(t.getDefaults(),arguments,["memory"]);return e.memory=n.memory,e.increasing=n.increasing,e}return _inherits(t,e),_createClass(t,[{key:"length",get:function(){return this._timeline.length}},{key:"add",value:function(e){if(Zr(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){var t=this._timeline[this.length-1];Zr(Oi(e.time,t.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{var n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){var r=this.length-this.memory;this._timeline.splice(0,r)}return this}},{key:"remove",value:function(e){var t=this._timeline.indexOf(e);return-1!==t&&this._timeline.splice(t,1),this}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(e,t);return-1!==n?this._timeline[n]:null}},{key:"peek",value:function(){return this._timeline[0]}},{key:"shift",value:function(){return this._timeline.shift()}},{key:"getAfter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time",n=this._search(e,t);return n+1<this._timeline.length?this._timeline[n+1]:null}},{key:"getBefore",value:function(e){var t=this._timeline.length;if(t>0&&this._timeline[t-1].time<e)return this._timeline[t-1];var n=this._search(e);return n-1>=0?this._timeline[n-1]:null}},{key:"cancel",value:function(e){if(this._timeline.length>1){var t=this._search(e);if(t>=0)if(Ni(this._timeline[t].time,e)){for(var n=t;n>=0&&Ni(this._timeline[n].time,e);n--)t=n;this._timeline=this._timeline.slice(0,t)}else this._timeline=this._timeline.slice(0,t+1);else this._timeline=[]}else 1===this._timeline.length&&Oi(this._timeline[0].time,e)&&(this._timeline=[]);return this}},{key:"cancelBefore",value:function(e){var t=this._search(e);return t>=0&&(this._timeline=this._timeline.slice(t+1)),this}},{key:"previousEvent",value:function(e){var t=this._timeline.indexOf(e);return t>0?this._timeline[t-1]:null}},{key:"_search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"time";if(0===this._timeline.length)return-1;var n=0,r=this._timeline.length,i=r;if(r>0&&this._timeline[r-1][t]<=e)return r-1;for(;n<i;){var o=Math.floor(n+(i-n)/2),a=this._timeline[o],s=this._timeline[o+1];if(Ni(a[t],e)){for(var u=o;u<this._timeline.length&&Ni(this._timeline[u][t],e);u++)o=u;return o}if(Mi(a[t],e)&&Ai(s[t],e))return o;Ai(a[t],e)?i=o:n=o+1}return-1}},{key:"_iterate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._timeline.length-1;this._timeline.slice(t,n+1).forEach(e)}},{key:"forEach",value:function(e){return this._iterate(e),this}},{key:"forEachBefore",value:function(e,t){var n=this._search(e);return-1!==n&&this._iterate(t,0,n),this}},{key:"forEachAfter",value:function(e,t){var n=this._search(e);return this._iterate(t,n+1),this}},{key:"forEachBetween",value:function(e,t,n){var r=this._search(e),i=this._search(t);return-1!==r&&-1!==i?(this._timeline[r].time!==e&&(r+=1),this._timeline[i].time===t&&(i-=1),this._iterate(n,r,i)):-1===r&&this._iterate(n,0,i),this}},{key:"forEachFrom",value:function(e,t){for(var n=this._search(e);n>=0&&this._timeline[n].time>=e;)n--;return this._iterate(t,n+1),this}},{key:"forEachAtTime",value:function(e,t){var n=this._search(e);if(-1!==n&&Ni(this._timeline[n].time,e)){for(var r=n,i=n;i>=0&&Ni(this._timeline[i].time,e);i--)r=i;this._iterate((function(e){t(e)}),r,n)}return this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._timeline=[],this}}],[{key:"getDefaults",value:function(){return{memory:1/0,increasing:!1}}}])}(Pi),qi=[];function Di(e){qi.push(e)}var Ri=[];function ji(e){Ri.push(e)}var zi=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Emitter",e}return _inherits(t,e),_createClass(t,[{key:"on",value:function(e,t){var n=this;return e.split(/\W+/).forEach((function(e){ri(n._events)&&(n._events={}),n._events.hasOwnProperty(e)||(n._events[e]=[]),n._events[e].push(t)})),this}},{key:"once",value:function(e,t){var n=this,r=function(){t.apply(void 0,arguments),n.off(e,r)};return this.on(e,r),this}},{key:"off",value:function(e,t){var n=this;return e.split(/\W+/).forEach((function(r){if(ri(n._events)&&(n._events={}),n._events.hasOwnProperty(e))if(ri(t))n._events[e]=[];else for(var i=n._events[e],o=i.length-1;o>=0;o--)i[o]===t&&i.splice(o,1)})),this}},{key:"emit",value:function(e){if(this._events&&this._events.hasOwnProperty(e)){for(var t=this._events[e].slice(0),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=t.length;o<a;o++)t[o].apply(this,r)}return this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._events=void 0,this}}],[{key:"mixin",value:function(e){["on","once","off","emit"].forEach((function(n){var r=Object.getOwnPropertyDescriptor(t.prototype,n);Object.defineProperty(e.prototype,n,r)}))}}])}(Pi),Fi=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).isOffline=!1,e}return _inherits(t,e),_createClass(t)}(zi),Li=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t)).name="Context",e._constants=new Map,e._timeouts=new Ei,e._timeoutIds=0,e._initialized=!1,e.isOffline=!1,e._workletModules=new Map;var n=xi(t.getDefaults(),arguments,["context"]);return n.context?e._context=n.context:e._context=function(e){return new Ar(e)}({latencyHint:n.latencyHint}),e._ticker=new vi(e.emit.bind(e,"tick"),n.clockSource,n.updateInterval),e.on("tick",e._timeoutLoop.bind(e)),e._context.onstatechange=function(){e.emit("statechange",e.state)},e._setLatencyHint(n.latencyHint),e.lookAhead=n.lookAhead,e}return _inherits(t,e),_createClass(t,[{key:"initialize",value:function(){var e;return this._initialized||(e=this,qi.forEach((function(t){return t(e)})),this._initialized=!0),this}},{key:"createAnalyser",value:function(){return this._context.createAnalyser()}},{key:"createOscillator",value:function(){return this._context.createOscillator()}},{key:"createBufferSource",value:function(){return this._context.createBufferSource()}},{key:"createBiquadFilter",value:function(){return this._context.createBiquadFilter()}},{key:"createBuffer",value:function(e,t,n){return this._context.createBuffer(e,t,n)}},{key:"createChannelMerger",value:function(e){return this._context.createChannelMerger(e)}},{key:"createChannelSplitter",value:function(e){return this._context.createChannelSplitter(e)}},{key:"createConstantSource",value:function(){return this._context.createConstantSource()}},{key:"createConvolver",value:function(){return this._context.createConvolver()}},{key:"createDelay",value:function(e){return this._context.createDelay(e)}},{key:"createDynamicsCompressor",value:function(){return this._context.createDynamicsCompressor()}},{key:"createGain",value:function(){return this._context.createGain()}},{key:"createIIRFilter",value:function(e,t){return this._context.createIIRFilter(e,t)}},{key:"createPanner",value:function(){return this._context.createPanner()}},{key:"createPeriodicWave",value:function(e,t,n){return this._context.createPeriodicWave(e,t,n)}},{key:"createStereoPanner",value:function(){return this._context.createStereoPanner()}},{key:"createWaveShaper",value:function(){return this._context.createWaveShaper()}},{key:"createMediaStreamSource",value:function(e){return Zr(ki(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}},{key:"createMediaStreamDestination",value:function(){return Zr(ki(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}},{key:"decodeAudioData",value:function(e){return this._context.decodeAudioData(e)}},{key:"currentTime",get:function(){return this._context.currentTime}},{key:"state",get:function(){return this._context.state}},{key:"sampleRate",get:function(){return this._context.sampleRate}},{key:"listener",get:function(){return this.initialize(),this._listener},set:function(e){Zr(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}},{key:"transport",get:function(){return this.initialize(),this._transport},set:function(e){Zr(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}},{key:"draw",get:function(){return this.initialize(),this._draw},set:function(e){Zr(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}},{key:"destination",get:function(){return this.initialize(),this._destination},set:function(e){Zr(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}},{key:"createAudioWorkletNode",value:function(e,t){return function(e,t,n){return Zr(ii(Vr),"This node only works in a secure context (https or localhost)"),new Vr(e,t,n)
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */}(this.rawContext,e,t)}},{key:"addAudioWorkletModule",value:function(e,t){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function n(){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Zr(ii(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(t)||this._workletModules.set(t,this.rawContext.audioWorklet.addModule(e)),n.next=4,this._workletModules.get(t);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"workletsAreReady",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],this._workletModules.forEach((function(e){return t.push(e)})),e.next=4,Promise.all(t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateInterval",get:function(){return this._ticker.updateInterval},set:function(e){this._ticker.updateInterval=e}},{key:"clockSource",get:function(){return this._ticker.type},set:function(e){this._ticker.type=e}},{key:"latencyHint",get:function(){return this._latencyHint}},{key:"_setLatencyHint",value:function(e){var t=0;if(this._latencyHint=e,li(e))switch(e){case"interactive":t=.1;break;case"playback":t=.5;break;case"balanced":t=.25}this.lookAhead=t,this.updateInterval=t/2}},{key:"rawContext",get:function(){return this._context}},{key:"now",value:function(){return this._context.currentTime+this.lookAhead}},{key:"immediate",value:function(){return this._context.currentTime}},{key:"resume",value:function(){return"suspended"===this._context.state&&ki(this._context)?this._context.resume():Promise.resolve()}},{key:"close",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=ki(this._context),!e.t0){e.next=4;break}return e.next=4,this._context.close();case 4:this._initialized&&(t=this,Ri.forEach((function(e){return e(t)})));case 5:case"end":return e.stop()}}),e,this)})))}},{key:"getConstant",value:function(e){if(this._constants.has(e))return this._constants.get(e);for(var t=this._context.createBuffer(1,128,this._context.sampleRate),n=t.getChannelData(0),r=0;r<n.length;r++)n[r]=e;var i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=t,i.loop=!0,i.start(0),this._constants.set(e,i),i}},{key:"dispose",value:function(){var e=this;return _superPropGet(t,"dispose",this,3)([]),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((function(t){return e._constants[t].disconnect()})),this}},{key:"_timeoutLoop",value:function(){for(var e=this.now(),t=this._timeouts.peek();this._timeouts.length&&t&&t.time<=e;)t.callback(),this._timeouts.shift(),t=this._timeouts.peek()}},{key:"setTimeout",value:function(e,t){this._timeoutIds++;var n=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:n+t}),this._timeoutIds}},{key:"clearTimeout",value:function(e){var t=this;return this._timeouts.forEach((function(n){n.id===e&&t._timeouts.remove(n)})),this}},{key:"clearInterval",value:function(e){return this.clearTimeout(e)}},{key:"setInterval",value:function(e,t){var n=this,r=++this._timeoutIds,i=function(){var o=n.now();n._timeouts.add({callback:function(){e(),i()},id:r,time:o+t})};return i(),r}}],[{key:"getDefaults",value:function(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}}])}(Fi);function Vi(e,t){ci(t)?t.forEach((function(t){return Vi(e,t)})):Object.defineProperty(e,t,{enumerable:!0,writable:!1})}function Gi(e,t){ci(t)?t.forEach((function(t){return Gi(e,t)})):Object.defineProperty(e,t,{writable:!0})}var Bi=function(){},Ui=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t)).name="ToneAudioBuffer",e.onload=Bi;var n=xi(t.getDefaults(),arguments,["url","onload","onerror"]);return e.reverse=n.reverse,e.onload=n.onload,n.url&&bi(n.url)||n.url instanceof t?e.set(n.url):li(n.url)&&e.load(n.url).catch(n.onerror),e}return _inherits(t,e),_createClass(t,[{key:"sampleRate",get:function(){return this._buffer?this._buffer.sampleRate:Yi().sampleRate}},{key:"set",value:function(e){var n=this;return e instanceof t?e.loaded?this._buffer=e.get():e.onload=function(){n.set(e),n.onload(n)}:this._buffer=e,this._reversed&&this._reverse(),this}},{key:"get",value:function(){return this._buffer}},{key:"load",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var r,i,o=this;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t.load(e).then((function(e){o.set(e),o.onload(o)})),t.downloads.push(r),n.prev=2,n.next=5,r;case 5:return n.prev=5,i=t.downloads.indexOf(r),t.downloads.splice(i,1),n.finish(5);case 9:return n.abrupt("return",this);case 10:case"end":return n.stop()}}),n,this,[[2,,5,9]])})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._buffer=void 0,this}},{key:"fromArray",value:function(e){for(var t=ci(e)&&e[0].length>0,n=t?e.length:1,r=t?e[0].length:e.length,i=Yi(),o=i.createBuffer(n,r,i.sampleRate),a=t||1!==n?e:[e],s=0;s<n;s++)o.copyToChannel(a[s],s);return this._buffer=o,this}},{key:"toMono",value:function(e){if(ai(e))this.fromArray(this.toArray(e));else{for(var t=new Float32Array(this.length),n=this.numberOfChannels,r=0;r<n;r++)for(var i=this.toArray(r),o=0;o<i.length;o++)t[o]+=i[o];t=t.map((function(e){return e/n})),this.fromArray(t)}return this}},{key:"toArray",value:function(e){if(ai(e))return this.getChannelData(e);if(1===this.numberOfChannels)return this.toArray(0);for(var t=[],n=0;n<this.numberOfChannels;n++)t[n]=this.getChannelData(n);return t}},{key:"getChannelData",value:function(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}},{key:"slice",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.duration,r=Math.floor(e*this.sampleRate),i=Math.floor(n*this.sampleRate);Zr(r<i,"The start time must be less than the end time");for(var o=i-r,a=Yi().createBuffer(this.numberOfChannels,o,this.sampleRate),s=0;s<this.numberOfChannels;s++)a.copyToChannel(this.getChannelData(s).subarray(r,i),s);return new t(a)}},{key:"_reverse",value:function(){if(this.loaded)for(var e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}},{key:"loaded",get:function(){return this.length>0}},{key:"duration",get:function(){return this._buffer?this._buffer.duration:0}},{key:"length",get:function(){return this._buffer?this._buffer.length:0}},{key:"numberOfChannels",get:function(){return this._buffer?this._buffer.numberOfChannels:0}},{key:"reverse",get:function(){return this._reversed},set:function(e){this._reversed!==e&&(this._reversed=e,this._reverse())}}],[{key:"getDefaults",value:function(){return{onerror:Bi,onload:Bi,reverse:!1}}},{key:"fromArray",value:function(e){return(new t).fromArray(e)}},{key:"fromUrl",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var r;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=new t,n.next=3,r.load(e);case 3:return n.abrupt("return",n.sent);case 4:case"end":return n.stop()}}),n)})))}},{key:"load",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var r,i,o,a,s,u,c,l,h;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=e.match(/\[(.+\|?)+\]$/))){n.next=23;break}i=r[1].split("|"),o=i[0],a=_createForOfIteratorHelper(i),n.prev=5,a.s();case 7:if((s=a.n()).done){n.next=14;break}if(u=s.value,!t.supportsType(u)){n.next=12;break}return o=u,n.abrupt("break",14);case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),a.e(n.t0);case 19:return n.prev=19,a.f(),n.finish(19);case 22:e=e.replace(r[0],o);case 23:return c=""===t.baseUrl||t.baseUrl.endsWith("/")?t.baseUrl:t.baseUrl+"/",n.next=26,fetch(c+e);case 26:if((l=n.sent).ok){n.next=29;break}throw new Error("could not load url: "+e);case 29:return n.next=31,l.arrayBuffer();case 31:return h=n.sent,n.next=34,Yi().decodeAudioData(h);case 34:return n.abrupt("return",n.sent);case 35:case"end":return n.stop()}}),n,null,[[5,16,19,22]])})))}},{key:"supportsType",value:function(e){var t=e.split("."),n=t[t.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}},{key:"loaded",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.resolve();case 2:if(!t.downloads.length){e.next=7;break}return e.next=5,t.downloads[0];case 5:e.next=2;break;case 7:case"end":return e.stop()}}),e)})))}}])}(Pi);Ui.baseUrl="",Ui.downloads=[];var Hi=function(e){function t(){var e,n,r,i;return _classCallCheck(this,t),(e=_callSuper(this,t,[{clockSource:"offline",context:_i(arguments[0])?arguments[0]:(n=arguments[0],r=arguments[1]*arguments[2],i=arguments[2],new Ur(n,r,i)),lookAhead:0,updateInterval:_i(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}])).name="OfflineContext",e._currentTime=0,e.isOffline=!0,e._duration=_i(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1],e}return _inherits(t,e),_createClass(t,[{key:"now",value:function(){return this._currentTime}},{key:"currentTime",get:function(){return this._currentTime}},{key:"_renderClock",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var n,r;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=0;case 1:if(!(this._duration-this._currentTime>=0)){t.next=10;break}if(this.emit("tick"),this._currentTime+=128/this.sampleRate,n++,r=Math.floor(this.sampleRate/128),t.t0=e&&n%r==0,!t.t0){t.next=8;break}return t.next=8,new Promise((function(e){return setTimeout(e,1)}));case 8:t.next=1;break;case 10:case"end":return t.stop()}}),t,this)})))}},{key:"render",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var n;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.workletsAreReady();case 2:return t.next=4,this._renderClock(e);case 4:return t.next=6,this._context.startRendering();case 6:return n=t.sent,t.abrupt("return",new Ui(n));case 8:case"end":return t.stop()}}),t,this)})))}},{key:"close",value:function(){return Promise.resolve()}}])}(Li),Qi=new(function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).lookAhead=0,e.latencyHint=0,e.isOffline=!1,e}return _inherits(t,e),_createClass(t,[{key:"createAnalyser",value:function(){return{}}},{key:"createOscillator",value:function(){return{}}},{key:"createBufferSource",value:function(){return{}}},{key:"createBiquadFilter",value:function(){return{}}},{key:"createBuffer",value:function(e,t,n){return{}}},{key:"createChannelMerger",value:function(e){return{}}},{key:"createChannelSplitter",value:function(e){return{}}},{key:"createConstantSource",value:function(){return{}}},{key:"createConvolver",value:function(){return{}}},{key:"createDelay",value:function(e){return{}}},{key:"createDynamicsCompressor",value:function(){return{}}},{key:"createGain",value:function(){return{}}},{key:"createIIRFilter",value:function(e,t){return{}}},{key:"createPanner",value:function(){return{}}},{key:"createPeriodicWave",value:function(e,t,n){return{}}},{key:"createStereoPanner",value:function(){return{}}},{key:"createWaveShaper",value:function(){return{}}},{key:"createMediaStreamSource",value:function(e){return{}}},{key:"createMediaStreamDestination",value:function(){return{}}},{key:"decodeAudioData",value:function(e){return Promise.resolve({})}},{key:"createAudioWorkletNode",value:function(e,t){return{}}},{key:"rawContext",get:function(){return{}}},{key:"addAudioWorkletModule",value:function(e,t){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve());case 1:case"end":return e.stop()}}),e)})))}},{key:"resume",value:function(){return Promise.resolve()}},{key:"setTimeout",value:function(e,t){return 0}},{key:"clearTimeout",value:function(e){return this}},{key:"setInterval",value:function(e,t){return 0}},{key:"clearInterval",value:function(e){return this}},{key:"getConstant",value:function(e){return{}}},{key:"currentTime",get:function(){return 0}},{key:"state",get:function(){return{}}},{key:"sampleRate",get:function(){return 0}},{key:"listener",get:function(){return{}}},{key:"transport",get:function(){return{}}},{key:"draw",get:function(){return{}},set:function(e){}},{key:"destination",get:function(){return{}},set:function(e){}},{key:"now",value:function(){return 0}},{key:"immediate",value:function(){return 0}}])}(Fi)),Wi=Qi;function Yi(){return Wi===Qi&&pi&&Xi(new Li),Wi}function Xi(e){Wi=ki(e)?new Li(e):_i(e)?new Hi(e):e}function Zi(){return Wi.resume()}if(fi&&!fi.TONE_SILENCE_LOGGING){e="v";"dev"===f&&(e="");var Ki=" * Tone.js ".concat(e).concat(f," * ");console.log("%c"+Ki,"background: #000; color: #fff")}function Ji(e){return Math.pow(10,e/20)}function $i(e){return Math.log(e)/Math.LN10*20}function eo(e){return Math.pow(2,e/12)}var to=440;function no(e){return Math.round(ro(e))}function ro(e){return 69+12*Math.log2(e/to)}function io(e){return to*Math.pow(2,(e-69)/12)}var oo=function(e){function t(e,n,r){var i;return _classCallCheck(this,t),(i=_callSuper(this,t)).defaultUnits="s",i._val=n,i._units=r,i.context=e,i._expressions=i._getExpressions(),i}return _inherits(t,e),_createClass(t,[{key:"_getExpressions",value:function(){var e=this;return{hz:{method:function(t){return e._frequencyToUnits(parseFloat(t))},regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:function(t){return e._ticksToUnits(parseInt(t,10))},regexp:/^(\d+)i$/i},m:{method:function(t){return e._beatsToUnits(parseInt(t,10)*e._getTimeSignature())},regexp:/^(\d+)m$/i},n:{method:function(t,n){var r=parseInt(t,10),i="."===n?1.5:1;return 1===r?e._beatsToUnits(e._getTimeSignature())*i:e._beatsToUnits(4/r)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:function(t){return e._expressions[e.defaultUnits].method.call(e,t)},regexp:/^(\d+(?:\.\d+)?)$/},s:{method:function(t){return e._secondsToUnits(parseFloat(t))},regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:function(t){return parseInt(t,10)/e.context.sampleRate},regexp:/^(\d+)samples$/},t:{method:function(t){var n=parseInt(t,10);return e._beatsToUnits(8/(3*Math.floor(n)))},regexp:/^(\d+)t$/i},tr:{method:function(t,n,r){var i=0;return t&&"0"!==t&&(i+=e._beatsToUnits(e._getTimeSignature()*parseFloat(t))),n&&"0"!==n&&(i+=e._beatsToUnits(parseFloat(n))),r&&"0"!==r&&(i+=e._beatsToUnits(parseFloat(r)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}},{key:"valueOf",value:function(){if(this._val instanceof t&&this.fromType(this._val),ri(this._val))return this._noArg();if(li(this._val)&&ri(this._units)){for(var e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(si(this._val)){var n=0;for(var r in this._val)if(ii(this._val[r])){var i=this._val[r];n+=new this.constructor(this.context,r).valueOf()*i}return n}if(ii(this._units)){var o=this._expressions[this._units],a=this._val.toString().trim().match(o.regexp);return a?o.method.apply(this,a.slice(1)):o.method.call(this,this._val)}return li(this._val)?parseFloat(this._val):this._val}},{key:"_frequencyToUnits",value:function(e){return 1/e}},{key:"_beatsToUnits",value:function(e){return 60/this._getBpm()*e}},{key:"_secondsToUnits",value:function(e){return e}},{key:"_ticksToUnits",value:function(e){return e*this._beatsToUnits(1)/this._getPPQ()}},{key:"_noArg",value:function(){return this._now()}},{key:"_getBpm",value:function(){return this.context.transport.bpm.value}},{key:"_getTimeSignature",value:function(){return this.context.transport.timeSignature}},{key:"_getPPQ",value:function(){return this.context.transport.PPQ}},{key:"fromType",value:function(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi()}return this}},{key:"toFrequency",value:function(){return 1/this.toSeconds()}},{key:"toSamples",value:function(){return this.toSeconds()*this.context.sampleRate}},{key:"toMilliseconds",value:function(){return 1e3*this.toSeconds()}}])}(Pi),ao=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="TimeClass",e}return _inherits(t,e),_createClass(t,[{key:"_getExpressions",value:function(){var e=this;return Object.assign(_superPropGet(t,"_getExpressions",this,3)([]),{now:{method:function(t){return e._now()+new e.constructor(e.context,t).valueOf()},regexp:/^\+(.+)/},quantize:{method:function(n){var r=new t(e.context,n).valueOf();return e._secondsToUnits(e.context.transport.nextSubdivision(r))},regexp:/^@(.+)/}})}},{key:"quantize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=new this.constructor(this.context,e).valueOf(),r=this.valueOf();return r+(Math.round(r/n)*n-r)*t}},{key:"toNotation",value:function(){for(var e=this,n=this.toSeconds(),r=["1m"],i=1;i<9;i++){var o=Math.pow(2,i);r.push(o+"n."),r.push(o+"n"),r.push(o+"t")}r.push("0");var a=r[0],s=new t(this.context,r[0]).toSeconds();return r.forEach((function(r){var i=new t(e.context,r).toSeconds();Math.abs(i-n)<Math.abs(s-n)&&(a=r,s=i)})),a}},{key:"toBarsBeatsSixteenths",value:function(){var e=this._beatsToUnits(1),t=this.valueOf()/e;t=parseFloat(t.toFixed(4));var n=Math.floor(t/this._getTimeSignature()),r=t%1*4;t=Math.floor(t)%this._getTimeSignature();var i=r.toString();return i.length>3&&(r=parseFloat(parseFloat(i).toFixed(3))),[n,t,r].join(":")}},{key:"toTicks",value:function(){var e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.round(t*this._getPPQ())}},{key:"toSeconds",value:function(){return this.valueOf()}},{key:"toMidi",value:function(){return no(this.toFrequency())}},{key:"_now",value:function(){return this.context.now()}}])}(oo);function so(e,t){return new ao(Yi(),e,t)}var uo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Frequency",e.defaultUnits="hz",e}return _inherits(t,e),_createClass(t,[{key:"_getExpressions",value:function(){return Object.assign({},_superPropGet(t,"_getExpressions",this,3)([]),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method:function(e){return"midi"===this.defaultUnits?e:t.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method:function(e,n){var r=co[e.toLowerCase()]+12*(parseInt(n,10)+1);return"midi"===this.defaultUnits?r:t.mtof(r)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method:function(e,t,n){var r=1;return e&&"0"!==e&&(r*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),t&&"0"!==t&&(r*=this._beatsToUnits(parseFloat(t))),n&&"0"!==n&&(r*=this._beatsToUnits(parseFloat(n)/4)),r}}})}},{key:"transpose",value:function(e){return new t(this.context,this.valueOf()*eo(e))}},{key:"harmonize",value:function(e){var t=this;return e.map((function(e){return t.transpose(e)}))}},{key:"toMidi",value:function(){return no(this.valueOf())}},{key:"toNote",value:function(){var e=this.toFrequency(),n=Math.log2(e/t.A4),r=Math.round(12*n)+57,i=Math.floor(r/12);return i<0&&(r+=-12*i),lo[r%12]+i.toString()}},{key:"toSeconds",value:function(){return 1/_superPropGet(t,"toSeconds",this,3)([])}},{key:"toTicks",value:function(){var e=this._beatsToUnits(1),t=this.valueOf()/e;return Math.floor(t*this._getPPQ())}},{key:"_noArg",value:function(){return 0}},{key:"_frequencyToUnits",value:function(e){return e}},{key:"_ticksToUnits",value:function(e){return 1/(60*e/(this._getBpm()*this._getPPQ()))}},{key:"_beatsToUnits",value:function(e){return 1/_superPropGet(t,"_beatsToUnits",this,3)([e])}},{key:"_secondsToUnits",value:function(e){return 1/e}}],[{key:"A4",get:function(){return to},set:function(e){!function(e){to=e}(e)}},{key:"mtof",value:function(e){return io(e)}},{key:"ftom",value:function(e){return no(e)}}])}(ao),co={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},lo=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function ho(e,t){return new uo(Yi(),e,t)}var fo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="TransportTime",e}return _inherits(t,e),_createClass(t,[{key:"_now",value:function(){return this.context.transport.seconds}}])}(ao);function po(e,t){return new fo(Yi(),e,t)}var mo=function(e){function t(){var e;_classCallCheck(this,t),e=_callSuper(this,t);var n=xi(t.getDefaults(),arguments,["context"]);return e.defaultContext?e.context=e.defaultContext:e.context=n.context,e}return _inherits(t,e),_createClass(t,[{key:"now",value:function(){return this.context.currentTime+this.context.lookAhead}},{key:"immediate",value:function(){return this.context.currentTime}},{key:"sampleTime",get:function(){return 1/this.context.sampleRate}},{key:"blockTime",get:function(){return 128/this.context.sampleRate}},{key:"toSeconds",value:function(e){return new ao(this.context,e).toSeconds()}},{key:"toFrequency",value:function(e){return new uo(this.context,e).toFrequency()}},{key:"toTicks",value:function(e){return new fo(this.context,e).toTicks()}},{key:"_getPartialProperties",value:function(e){var t=this.get();return Object.keys(t).forEach((function(n){ri(e[n])&&delete t[n]})),t}},{key:"get",value:function(){var e=this,n=this.constructor.getDefaults();return Object.keys(n).forEach((function(r){if(Reflect.has(e,r)){var i=e[r];ii(i)&&ii(i.value)&&ii(i.setValueAtTime)?n[r]=i.value:i instanceof t?n[r]=i._getPartialProperties(n[r]):ci(i)||ai(i)||li(i)||ui(i)?n[r]=i:delete n[r]}})),n}},{key:"set",value:function(e){var n=this;return Object.keys(e).forEach((function(r){Reflect.has(n,r)&&ii(n[r])&&(n[r]&&ii(n[r].value)&&ii(n[r].setValueAtTime)?n[r].value!==e[r]&&(n[r].value=e[r]):n[r]instanceof t?n[r].set(e[r]):n[r]=e[r])})),this}}],[{key:"getDefaults",value:function(){return{context:Yi()}}}])}(Pi),vo=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"stopped";return _classCallCheck(this,t),(e=_callSuper(this,t)).name="StateTimeline",e._initial=n,e.setStateAtTime(e._initial,0),e}return _inherits(t,e),_createClass(t,[{key:"getValueAtTime",value:function(e){var t=this.get(e);return null!==t?t.state:this._initial}},{key:"setStateAtTime",value:function(e,t,n){return Kr(t,0),this.add(Object.assign({},n,{state:e,time:t})),this}},{key:"getLastState",value:function(e,t){for(var n=this._search(t);n>=0;n--){var r=this._timeline[n];if(r.state===e)return r}}},{key:"getNextState",value:function(e,t){var n=this._search(t);if(-1!==n)for(var r=n;r<this._timeline.length;r++){var i=this._timeline[r];if(i.state===e)return i}}}])}(Ei),go=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["param","units","convert"])])).name="Param",e.overridden=!1,e._minOutput=1e-7;var n=xi(t.getDefaults(),arguments,["param","units","convert"]);for(Zr(ii(n.param)&&(gi(n.param)||n.param instanceof t),"param must be an AudioParam");!gi(n.param);)n.param=n.param._param;return e._swappable=!!ii(n.swappable)&&n.swappable,e._swappable?(e.input=e.context.createGain(),e._param=n.param,e.input.connect(e._param)):e._param=e.input=n.param,e._events=new Ei(1e3),e._initialValue=e._param.defaultValue,e.units=n.units,e.convert=n.convert,e._minValue=n.minValue,e._maxValue=n.maxValue,ii(n.value)&&n.value!==e._toType(e._initialValue)&&e.setValueAtTime(n.value,0),e}return _inherits(t,e),_createClass(t,[{key:"value",get:function(){var e=this.now();return this.getValueAtTime(e)},set:function(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}},{key:"minValue",get:function(){return ii(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}},{key:"maxValue",get:function(){return ii(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}},{key:"_is",value:function(e,t){return this.units===t}},{key:"_assertRange",value:function(e){return ii(this.maxValue)&&ii(this.minValue)&&Kr(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}},{key:"_fromType",value:function(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?Ji(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}},{key:"_toType",value:function(e){return this.convert&&"decibels"===this.units?$i(e):e}},{key:"setValueAtTime",value:function(e,t){var n=this.toSeconds(t),r=this._fromType(e);return Zr(isFinite(r)&&isFinite(n),"Invalid argument(s) to setValueAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._assertRange(r),this.log(this.units,"setValueAtTime",e,n),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}},{key:"getValueAtTime",value:function(e){var t=Math.max(this.toSeconds(e),0),n=this._events.getAfter(t),r=this._events.get(t),i=this._initialValue;if(null===r)i=this._initialValue;else if("setTargetAtTime"!==r.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)i=r.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){var o=r.value;if("setTargetAtTime"===r.type){var a=this._events.getBefore(r.time);o=null===a?this._initialValue:a.value}i="linearRampToValueAtTime"===n.type?this._linearInterpolate(r.time,o,n.time,n.value,t):this._exponentialInterpolate(r.time,o,n.time,n.value,t)}else i=r.value;else{var s,u=this._events.getBefore(r.time);s=null===u?this._initialValue:u.value,"setTargetAtTime"===r.type&&(i=this._exponentialApproach(r.time,s,r.value,r.constant,t))}return this._toType(i)}},{key:"setRampPoint",value:function(e){e=this.toSeconds(e);var t=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),0===this._fromType(t)&&(t=this._toType(this._minOutput)),this.setValueAtTime(t,e),this}},{key:"linearRampToValueAtTime",value:function(e,t){var n=this._fromType(e),r=this.toSeconds(t);return Zr(isFinite(n)&&isFinite(r),"Invalid argument(s) to linearRampToValueAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._assertRange(n),this._events.add({time:r,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",e,r),this._param.linearRampToValueAtTime(n,r),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){var n=this._fromType(e);n=Math.max(this._minOutput,n),this._assertRange(n);var r=this.toSeconds(t);return Zr(isFinite(n)&&isFinite(r),"Invalid argument(s) to exponentialRampToValueAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._events.add({time:r,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",e,r),this._param.exponentialRampToValueAtTime(n,r),this}},{key:"exponentialRampTo",value:function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(e,n+this.toSeconds(t)),this}},{key:"linearRampTo",value:function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(e,n+this.toSeconds(t)),this}},{key:"targetRampTo",value:function(e,t,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(e,n,t),this}},{key:"exponentialApproachValueAtTime",value:function(e,t,n){t=this.toSeconds(t),n=this.toSeconds(n);var r=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(e,t,r),this.cancelAndHoldAtTime(t+.9*n),this.linearRampToValueAtTime(e,t+n),this}},{key:"setTargetAtTime",value:function(e,t,n){var r=this._fromType(e);Zr(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");var i=this.toSeconds(t);return this._assertRange(r),Zr(isFinite(r)&&isFinite(i),"Invalid argument(s) to setTargetAtTime: ".concat(JSON.stringify(e),", ").concat(JSON.stringify(t))),this._events.add({constant:n,time:i,type:"setTargetAtTime",value:r}),this.log(this.units,"setTargetAtTime",e,i,n),this._param.setTargetAtTime(r,i,n),this}},{key:"setValueCurveAtTime",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;n=this.toSeconds(n),t=this.toSeconds(t);var i=this._fromType(e[0])*r;this.setValueAtTime(this._toType(i),t);for(var o=n/(e.length-1),a=1;a<e.length;a++){var s=this._fromType(e[a])*r;this.linearRampToValueAtTime(this._toType(s),t+a*o)}return this}},{key:"cancelScheduledValues",value:function(e){var t=this.toSeconds(e);return Zr(isFinite(t),"Invalid argument to cancelScheduledValues: "+JSON.stringify(e)),this._events.cancel(t),this._param.cancelScheduledValues(t),this.log(this.units,"cancelScheduledValues",t),this}},{key:"cancelAndHoldAtTime",value:function(e){var t=this.toSeconds(e),n=this._fromType(this.getValueAtTime(t));Zr(isFinite(t),"Invalid argument to cancelAndHoldAtTime: "+JSON.stringify(e)),this.log(this.units,"cancelAndHoldAtTime",t,"value="+n);var r=this._events.get(t),i=this._events.getAfter(t);return r&&Ni(r.time,t)?i?(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time)):(this._param.cancelAndHoldAtTime(t),this._events.cancel(t+this.sampleTime)):i&&(this._param.cancelScheduledValues(i.time),this._events.cancel(i.time),"linearRampToValueAtTime"===i.type?this.linearRampToValueAtTime(this._toType(n),t):"exponentialRampToValueAtTime"===i.type&&this.exponentialRampToValueAtTime(this._toType(n),t)),this._events.add({time:t,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,t),this}},{key:"rampTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2?arguments[2]:void 0;return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(e,t,n):this.linearRampTo(e,t,n),this}},{key:"apply",value:function(e){var t=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(t),t);var n=this._events.get(t);if(n&&"setTargetAtTime"===n.type)for(var r=this._events.getAfter(n.time),i=r?r.time:t+2,o=(i-t)/10,a=t;a<i;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a);return this._events.forEachAfter(this.context.currentTime,(function(t){"cancelScheduledValues"===t.type?e.cancelScheduledValues(t.time):"setTargetAtTime"===t.type?e.setTargetAtTime(t.value,t.time,t.constant):e[t.type](t.value,t.time)})),this}},{key:"setParam",value:function(e){Zr(this._swappable,"The Param must be assigned as 'swappable' in the constructor");var t=this.input;return t.disconnect(this._param),this.apply(e),this._param=e,t.connect(this._param),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._events.dispose(),this}},{key:"defaultValue",get:function(){return this._toType(this._param.defaultValue)}},{key:"_exponentialApproach",value:function(e,t,n,r,i){return n+(t-n)*Math.exp(-(i-e)/r)}},{key:"_linearInterpolate",value:function(e,t,n,r,i){return t+(i-e)/(n-e)*(r-t)}},{key:"_exponentialInterpolate",value:function(e,t,n,r,i){return t*Math.pow(r/t,(i-e)/(n-e))}}],[{key:"getDefaults",value:function(){return Object.assign(mo.getDefaults(),{convert:!0,units:"number"})}}])}(mo),yo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="ToneAudioNode",e._internalChannels=[],e}return _inherits(t,e),_createClass(t,[{key:"numberOfInputs",get:function(){return ii(this.input)?gi(this.input)||this.input instanceof go?1:this.input.numberOfInputs:0}},{key:"numberOfOutputs",get:function(){return ii(this.output)?this.output.numberOfOutputs:0}},{key:"_isAudioNode",value:function(e){return ii(e)&&(e instanceof t||yi(e))}},{key:"_getInternalNodes",value:function(){var e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}},{key:"_setChannelProperties",value:function(e){this._getInternalNodes().forEach((function(t){t.channelCount=e.channelCount,t.channelCountMode=e.channelCountMode,t.channelInterpretation=e.channelInterpretation}))}},{key:"_getChannelProperties",value:function(){var e=this._getInternalNodes();Zr(e.length>0,"ToneAudioNode does not have any internal nodes");var t=e[0];return{channelCount:t.channelCount,channelCountMode:t.channelCountMode,channelInterpretation:t.channelInterpretation}}},{key:"channelCount",get:function(){return this._getChannelProperties().channelCount},set:function(e){var t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCount:e}))}},{key:"channelCountMode",get:function(){return this._getChannelProperties().channelCountMode},set:function(e){var t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelCountMode:e}))}},{key:"channelInterpretation",get:function(){return this._getChannelProperties().channelInterpretation},set:function(e){var t=this._getChannelProperties();this._setChannelProperties(Object.assign(t,{channelInterpretation:e}))}},{key:"connect",value:function(e){return ko(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}},{key:"toDestination",value:function(){return this.connect(this.context.destination),this}},{key:"toMaster",value:function(){return ni("toMaster() has been renamed toDestination()"),this.toDestination()}},{key:"disconnect",value:function(e){return bo(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}},{key:"chain",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return _o.apply(void 0,[this].concat(t)),this}},{key:"fan",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){return e.connect(t)})),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),ii(this.input)&&(this.input instanceof t?this.input.dispose():yi(this.input)&&this.input.disconnect()),ii(this.output)&&(this.output instanceof t?this.output.dispose():yi(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}])}(mo);function _o(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t.shift();t.reduce((function(e,t){return e instanceof yo?e.connect(t):yi(e)&&ko(e,t),t}),r)}function ko(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;for(Zr(ii(e),"Cannot connect from undefined node"),Zr(ii(t),"Cannot connect to undefined node"),(t instanceof yo||yi(t))&&Zr(t.numberOfInputs>0,"Cannot connect to node with no inputs"),Zr(e.numberOfOutputs>0,"Cannot connect from node with no outputs");t instanceof yo||t instanceof go;)ii(t.input)&&(t=t.input);for(;e instanceof yo;)ii(e.output)&&(e=e.output);gi(t)?e.connect(t,n):e.connect(t,n,r)}function bo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(ii(t))for(;t instanceof yo;)t=t.input;for(;!yi(e);)ii(e.output)&&(e=e.output);gi(t)?e.disconnect(t,n):yi(t)?e.disconnect(t,n,r):e.disconnect()}var So=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["gain","units"])])).name="Gain",e._gainNode=e.context.createGain(),e.input=e._gainNode,e.output=e._gainNode;var n=xi(t.getDefaults(),arguments,["gain","units"]);return e.gain=new go({context:e.context,convert:n.convert,param:e._gainNode.gain,units:n.units,value:n.gain,minValue:n.minValue,maxValue:n.maxValue}),Vi(e,"gain"),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._gainNode.disconnect(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{convert:!0,gain:1,units:"gain"})}}])}(yo),wo=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).onended=Bi,n._startTime=-1,n._stopTime=-1,n._timeout=-1,n.output=new So({context:n.context,gain:0}),n._gainNode=n.output,n.getStateAtTime=function(e){var t=this.toSeconds(e);return-1!==this._startTime&&t>=this._startTime&&(-1===this._stopTime||t<=this._stopTime)?"started":"stopped"},n._fadeIn=e.fadeIn,n._fadeOut=e.fadeOut,n._curve=e.curve,n.onended=e.onended,n}return _inherits(t,e),_createClass(t,[{key:"_startGain",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Zr(-1===this._startTime,"Source cannot be started more than once");var n=this.toSeconds(this._fadeIn);return this._startTime=e+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,e),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(t,e+n):this._gainNode.gain.exponentialApproachValueAtTime(t,e,n)):this._gainNode.gain.setValueAtTime(t,e),this}},{key:"stop",value:function(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}},{key:"_stopGain",value:function(e){var t=this;Zr(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();var n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.context.currentTime),n>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((function(){var e="exponential"===t._curve?2*n:0;t._stopSource(t.now()+e),t._onended()}),this._stopTime-this.context.currentTime),this}},{key:"_onended",value:function(){var e=this;if(this.onended!==Bi&&(this.onended(this),this.onended=Bi,!this.context.isOffline)){var t=function(){return e.dispose()};void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}},{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"cancelStop",value:function(){return this.log("cancelStop"),Zr(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._gainNode.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:Bi})}}])}(yo),xo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["offset"])])).name="ToneConstantSource",e._source=e.context.createConstantSource();var n=xi(t.getDefaults(),arguments,["offset"]);return ko(e._source,e._gainNode),e.offset=new go({context:e.context,convert:n.convert,param:e._source.offset,units:n.units,value:n.offset,minValue:n.minValue,maxValue:n.maxValue}),e}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e){var t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._source.start(t),this}},{key:"_stopSource",value:function(e){this._source.stop(e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(wo.getDefaults(),{convert:!0,offset:1,units:"number"})}}])}(wo),To=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["value","units"])])).name="Signal",e.override=!0;var n=xi(t.getDefaults(),arguments,["value","units"]);return e.output=e._constantSource=new xo({context:e.context,convert:n.convert,offset:n.value,units:n.units,minValue:n.minValue,maxValue:n.maxValue}),e._constantSource.start(0),e.input=e._param=e._constantSource.offset,e}return _inherits(t,e),_createClass(t,[{key:"connect",value:function(e){return Co(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._param.dispose(),this._constantSource.dispose(),this}},{key:"setValueAtTime",value:function(e,t){return this._param.setValueAtTime(e,t),this}},{key:"getValueAtTime",value:function(e){return this._param.getValueAtTime(e)}},{key:"setRampPoint",value:function(e){return this._param.setRampPoint(e),this}},{key:"linearRampToValueAtTime",value:function(e,t){return this._param.linearRampToValueAtTime(e,t),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){return this._param.exponentialRampToValueAtTime(e,t),this}},{key:"exponentialRampTo",value:function(e,t,n){return this._param.exponentialRampTo(e,t,n),this}},{key:"linearRampTo",value:function(e,t,n){return this._param.linearRampTo(e,t,n),this}},{key:"targetRampTo",value:function(e,t,n){return this._param.targetRampTo(e,t,n),this}},{key:"exponentialApproachValueAtTime",value:function(e,t,n){return this._param.exponentialApproachValueAtTime(e,t,n),this}},{key:"setTargetAtTime",value:function(e,t,n){return this._param.setTargetAtTime(e,t,n),this}},{key:"setValueCurveAtTime",value:function(e,t,n,r){return this._param.setValueCurveAtTime(e,t,n,r),this}},{key:"cancelScheduledValues",value:function(e){return this._param.cancelScheduledValues(e),this}},{key:"cancelAndHoldAtTime",value:function(e){return this._param.cancelAndHoldAtTime(e),this}},{key:"rampTo",value:function(e,t,n){return this._param.rampTo(e,t,n),this}},{key:"value",get:function(){return this._param.value},set:function(e){this._param.value=e}},{key:"convert",get:function(){return this._param.convert},set:function(e){this._param.convert=e}},{key:"units",get:function(){return this._param.units}},{key:"overridden",get:function(){return this._param.overridden},set:function(e){this._param.overridden=e}},{key:"maxValue",get:function(){return this._param.maxValue}},{key:"minValue",get:function(){return this._param.minValue}},{key:"apply",value:function(e){return this._param.apply(e),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{convert:!0,units:"number",value:0})}}])}(yo);function Co(e,t,n,r){(t instanceof go||gi(t)||t instanceof To&&t.override)&&(t.cancelScheduledValues(0),t.setValueAtTime(0,0),t instanceof To&&(t.overridden=!0)),ko(e,t,n,r)}var Po=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["value"])])).name="TickParam",e._events=new Ei(1/0),e._multiplier=1;var n=xi(t.getDefaults(),arguments,["value"]);return e._multiplier=n.multiplier,e._events.cancel(0),e._events.add({ticks:0,time:0,type:"setValueAtTime",value:e._fromType(n.value)}),e.setValueAtTime(n.value,0),e}return _inherits(t,e),_createClass(t,[{key:"setTargetAtTime",value:function(e,t,n){t=this.toSeconds(t),this.setRampPoint(t);for(var r=this._fromType(e),i=this._events.get(t),o=Math.round(Math.max(1/n,1)),a=0;a<=o;a++){var s=n*a+t,u=this._exponentialApproach(i.time,i.value,r,n,s);this.linearRampToValueAtTime(this._toType(u),s)}return this}},{key:"setValueAtTime",value:function(e,n){var r=this.toSeconds(n);_superPropGet(t,"setValueAtTime",this,3)([e,n]);var i=this._events.get(r),o=this._events.previousEvent(i),a=this._getTicksUntilEvent(o,r);return i.ticks=Math.max(a,0),this}},{key:"linearRampToValueAtTime",value:function(e,n){var r=this.toSeconds(n);_superPropGet(t,"linearRampToValueAtTime",this,3)([e,n]);var i=this._events.get(r),o=this._events.previousEvent(i),a=this._getTicksUntilEvent(o,r);return i.ticks=Math.max(a,0),this}},{key:"exponentialRampToValueAtTime",value:function(e,t){t=this.toSeconds(t);for(var n=this._fromType(e),r=this._events.get(t),i=Math.round(Math.max(10*(t-r.time),1)),o=(t-r.time)/i,a=0;a<=i;a++){var s=o*a+r.time,u=this._exponentialInterpolate(r.time,r.value,t,n,s);this.linearRampToValueAtTime(this._toType(u),s)}return this}},{key:"_getTicksUntilEvent",value:function(e,t){if(null===e)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(ri(e.ticks)){var n=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(n,e.time)}var r=this._fromType(this.getValueAtTime(e.time)),i=this._fromType(this.getValueAtTime(t)),o=this._events.get(t);return o&&o.time===t&&"setValueAtTime"===o.type&&(i=this._fromType(this.getValueAtTime(t-this.sampleTime))),.5*(t-e.time)*(r+i)+e.ticks}},{key:"getTicksAtTime",value:function(e){var t=this.toSeconds(e),n=this._events.get(t);return Math.max(this._getTicksUntilEvent(n,t),0)}},{key:"getDurationOfTicks",value:function(e,t){var n=this.toSeconds(t),r=this.getTicksAtTime(t);return this.getTimeOfTick(r+e)-n}},{key:"getTimeOfTick",value:function(e){var t=this._events.get(e,"ticks"),n=this._events.getAfter(e,"ticks");if(t&&t.ticks===e)return t.time;if(t&&n&&"linearRampToValueAtTime"===n.type&&t.value!==n.value){var r=this._fromType(this.getValueAtTime(t.time)),i=(this._fromType(this.getValueAtTime(n.time))-r)/(n.time-t.time),o=Math.sqrt(Math.pow(r,2)-2*i*(t.ticks-e)),a=(-r+o)/i;return(a>0?a:(-r-o)/i)+t.time}return t?0===t.value?1/0:t.time+(e-t.ticks)/t.value:e/this._initialValue}},{key:"ticksToTime",value:function(e,t){return this.getDurationOfTicks(e,t)}},{key:"timeToTicks",value:function(e,t){var n=this.toSeconds(t),r=this.toSeconds(e),i=this.getTicksAtTime(n);return this.getTicksAtTime(n+r)-i}},{key:"_fromType",value:function(e){return"bpm"===this.units&&this.multiplier?1/(60/e/this.multiplier):_superPropGet(t,"_fromType",this,3)([e])}},{key:"_toType",value:function(e){return"bpm"===this.units&&this.multiplier?e/this.multiplier*60:_superPropGet(t,"_toType",this,3)([e])}},{key:"multiplier",get:function(){return this._multiplier},set:function(e){var t=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(t,0)}}],[{key:"getDefaults",value:function(){return Object.assign(go.getDefaults(),{multiplier:1,units:"hertz",value:1})}}])}(go),Ao=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["value"])])).name="TickSignal";var n=xi(t.getDefaults(),arguments,["value"]);return e.input=e._param=new Po({context:e.context,convert:n.convert,multiplier:n.multiplier,param:e._constantSource.offset,units:n.units,value:n.value}),e}return _inherits(t,e),_createClass(t,[{key:"ticksToTime",value:function(e,t){return this._param.ticksToTime(e,t)}},{key:"timeToTicks",value:function(e,t){return this._param.timeToTicks(e,t)}},{key:"getTimeOfTick",value:function(e){return this._param.getTimeOfTick(e)}},{key:"getDurationOfTicks",value:function(e,t){return this._param.getDurationOfTicks(e,t)}},{key:"getTicksAtTime",value:function(e){return this._param.getTicksAtTime(e)}},{key:"multiplier",get:function(){return this._param.multiplier},set:function(e){this._param.multiplier=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._param.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(To.getDefaults(),{multiplier:1,units:"hertz",value:1})}}])}(To),Oo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency"])])).name="TickSource",e._state=new vo,e._tickOffset=new Ei;var n=xi(t.getDefaults(),arguments,["frequency"]);return e.frequency=new Ao({context:e.context,units:n.units,value:n.frequency}),Vi(e,"frequency"),e._state.setStateAtTime("stopped",0),e.setTicksAtTime(0,0),e}return _inherits(t,e),_createClass(t,[{key:"state",get:function(){return this.getStateAtTime(this.now())}},{key:"start",value:function(e,t){var n=this.toSeconds(e);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),ii(t)&&this.setTicksAtTime(t,n)),this}},{key:"stop",value:function(e){var t=this.toSeconds(e);if("stopped"===this._state.getValueAtTime(t)){var n=this._state.get(t);n&&n.time>0&&(this._tickOffset.cancel(n.time),this._state.cancel(n.time))}return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this.setTicksAtTime(0,t),this}},{key:"pause",value:function(e){var t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&this._state.setStateAtTime("paused",t),this}},{key:"cancel",value:function(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this}},{key:"getTicksAtTime",value:function(e){var t=this,n=this.toSeconds(e),r=this._state.getLastState("stopped",n),i={state:"paused",time:n};this._state.add(i);var o=r,a=0;return this._state.forEachBetween(r.time,n+this.sampleTime,(function(e){var n=o.time,r=t._tickOffset.get(e.time);r&&r.time>=o.time&&(a=r.ticks,n=r.time),"started"===o.state&&"started"!==e.state&&(a+=t.frequency.getTicksAtTime(e.time)-t.frequency.getTicksAtTime(n)),o=e})),this._state.remove(i),a}},{key:"ticks",get:function(){return this.getTicksAtTime(this.now())},set:function(e){this.setTicksAtTime(e,this.now())}},{key:"seconds",get:function(){return this.getSecondsAtTime(this.now())},set:function(e){var t=this.now(),n=this.frequency.timeToTicks(e,t);this.setTicksAtTime(n,t)}},{key:"getSecondsAtTime",value:function(e){var t=this;e=this.toSeconds(e);var n=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);var i=n,o=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(function(e){var n=i.time,r=t._tickOffset.get(e.time);r&&r.time>=i.time&&(o=r.seconds,n=r.time),"started"===i.state&&"started"!==e.state&&(o+=e.time-n),i=e})),this._state.remove(r),o}},{key:"setTicksAtTime",value:function(e,t){return t=this.toSeconds(t),this._tickOffset.cancel(t),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,t),ticks:e,time:t}),this}},{key:"getStateAtTime",value:function(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}},{key:"getTimeOfTick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now(),n=this._tickOffset.get(t),r=this._state.get(t),i=Math.max(n.time,r.time),o=this.frequency.getTicksAtTime(i)+e-n.ticks;return this.frequency.getTimeOfTick(o)}},{key:"forEachTickBetween",value:function(e,t,n){var r=this,i=this._state.get(e);this._state.forEachBetween(e,t,(function(t){i&&"started"===i.state&&"started"!==t.state&&r.forEachTickBetween(Math.max(i.time,e),t.time-r.sampleTime,n),i=t}));var o=null;if(i&&"started"===i.state){var a=Math.max(i.time,e),s=this.frequency.getTicksAtTime(a),u=s-this.frequency.getTicksAtTime(i.time),c=Math.ceil(u)-u;c=Ni(c,1)?0:c;for(var l=this.frequency.getTimeOfTick(s+c);l<t;){try{n(l,Math.round(this.getTicksAtTime(l)))}catch(e){o=e;break}l+=this.frequency.getDurationOfTicks(1,l)}}if(o)throw o;return this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign({frequency:1,units:"hertz"},mo.getDefaults())}}])}(mo),Mo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["callback","frequency"])])).name="Clock",e.callback=Bi,e._lastUpdate=0,e._state=new vo("stopped"),e._boundLoop=e._loop.bind(_assertThisInitialized(e));var n=xi(t.getDefaults(),arguments,["callback","frequency"]);return e.callback=n.callback,e._tickSource=new Oo({context:e.context,frequency:n.frequency,units:n.units}),e._lastUpdate=0,e.frequency=e._tickSource.frequency,Vi(e,"frequency"),e._state.setStateAtTime("stopped",0),e.context.on("tick",e._boundLoop),e}return _inherits(t,e),_createClass(t,[{key:"state",get:function(){return this._state.getValueAtTime(this.now())}},{key:"start",value:function(e,t){Jr(this.context);var n=this.toSeconds(e);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,t),n<this._lastUpdate&&this.emit("start",n,t)),this}},{key:"stop",value:function(e){var t=this.toSeconds(e);return this.log("stop",t),this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._tickSource.stop(t),t<this._lastUpdate&&this.emit("stop",t),this}},{key:"pause",value:function(e){var t=this.toSeconds(e);return"started"===this._state.getValueAtTime(t)&&(this._state.setStateAtTime("paused",t),this._tickSource.pause(t),t<this._lastUpdate&&this.emit("pause",t)),this}},{key:"ticks",get:function(){return Math.ceil(this.getTicksAtTime(this.now()))},set:function(e){this._tickSource.ticks=e}},{key:"seconds",get:function(){return this._tickSource.seconds},set:function(e){this._tickSource.seconds=e}},{key:"getSecondsAtTime",value:function(e){return this._tickSource.getSecondsAtTime(e)}},{key:"setTicksAtTime",value:function(e,t){return this._tickSource.setTicksAtTime(e,t),this}},{key:"getTimeOfTick",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.now();return this._tickSource.getTimeOfTick(e,t)}},{key:"getTicksAtTime",value:function(e){return this._tickSource.getTicksAtTime(e)}},{key:"nextTickTime",value:function(e,t){var n=this.toSeconds(t),r=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(r+e,n)}},{key:"_loop",value:function(){var e=this,t=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",t,n),t!==n&&(this._state.forEachBetween(t,n,(function(t){switch(t.state){case"started":var n=e._tickSource.getTicksAtTime(t.time);e.emit("start",t.time,n);break;case"stopped":0!==t.time&&e.emit("stop",t.time);break;case"paused":e.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,n,(function(t,n){e.callback(t,n)})))}},{key:"getStateAtTime",value:function(e){var t=this.toSeconds(e);return this._state.getValueAtTime(t)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(mo.getDefaults(),{callback:Bi,frequency:1,units:"hertz"})}}])}(mo);zi.mixin(Mo);var No=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["delayTime","maxDelay"])])).name="Delay";var n=xi(t.getDefaults(),arguments,["delayTime","maxDelay"]),r=e.toSeconds(n.maxDelay);return e._maxDelay=Math.max(r,e.toSeconds(n.delayTime)),e._delayNode=e.input=e.output=e.context.createDelay(r),e.delayTime=new go({context:e.context,param:e._delayNode.delayTime,units:"time",value:n.delayTime,minValue:0,maxValue:e.maxDelay}),Vi(e,"delayTime"),e}return _inherits(t,e),_createClass(t,[{key:"maxDelay",get:function(){return this._maxDelay}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._delayNode.disconnect(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{delayTime:0,maxDelay:1})}}])}(yo);function Io(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Yi().sampleRate;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function i(){var o,a,s,u;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o=Yi(),Xi(a=new Hi(n,t,r)),i.next=4,e(a);case 4:return s=a.render(),Xi(o),i.next=8,s;case 8:return u=i.sent,i.abrupt("return",new Ui(u));case 10:case"end":return i.stop()}}),i)})))}var Eo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t)).name="ToneAudioBuffers",e._buffers=new Map,e._loadingCount=0;var n=xi(t.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");return e.baseUrl=n.baseUrl,Object.keys(n.urls).forEach((function(t){e._loadingCount++;var r=n.urls[t];e.add(t,r,e._bufferLoaded.bind(e,n.onload),n.onerror)})),e}return _inherits(t,e),_createClass(t,[{key:"has",value:function(e){return this._buffers.has(e.toString())}},{key:"get",value:function(e){return Zr(this.has(e),"ToneAudioBuffers has no buffer named: "+e),this._buffers.get(e.toString())}},{key:"_bufferLoaded",value:function(e){this._loadingCount--,0===this._loadingCount&&e&&e()}},{key:"loaded",get:function(){return Array.from(this._buffers).every((function(e){var t=_slicedToArray(e,2);t[0];return t[1].loaded}))}},{key:"add",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bi,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Bi;return li(t)?this._buffers.set(e.toString(),new Ui(this.baseUrl+t,n,r)):this._buffers.set(e.toString(),new Ui(t,n,r)),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._buffers.forEach((function(e){return e.dispose()})),this._buffers.clear(),this}}],[{key:"getDefaults",value:function(){return{baseUrl:"",onerror:Bi,onload:Bi,urls:{}}}}])}(Pi),qo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="MidiClass",e.defaultUnits="midi",e}return _inherits(t,e),_createClass(t,[{key:"_frequencyToUnits",value:function(e){return no(_superPropGet(t,"_frequencyToUnits",this,3)([e]))}},{key:"_ticksToUnits",value:function(e){return no(_superPropGet(t,"_ticksToUnits",this,3)([e]))}},{key:"_beatsToUnits",value:function(e){return no(_superPropGet(t,"_beatsToUnits",this,3)([e]))}},{key:"_secondsToUnits",value:function(e){return no(_superPropGet(t,"_secondsToUnits",this,3)([e]))}},{key:"toMidi",value:function(){return this.valueOf()}},{key:"toFrequency",value:function(){return io(this.toMidi())}},{key:"transpose",value:function(e){return new t(this.context,this.toMidi()+e)}}])}(uo);function Do(e,t){return new qo(Yi(),e,t)}var Ro=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Ticks",e.defaultUnits="i",e}return _inherits(t,e),_createClass(t,[{key:"_now",value:function(){return this.context.transport.ticks}},{key:"_beatsToUnits",value:function(e){return this._getPPQ()*e}},{key:"_secondsToUnits",value:function(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}},{key:"_ticksToUnits",value:function(e){return e}},{key:"toTicks",value:function(){return this.valueOf()}},{key:"toSeconds",value:function(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}])}(fo);function jo(e,t){return new Ro(Yi(),e,t)}var zo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Draw",e.expiration=.25,e.anticipation=.008,e._events=new Ei,e._boundDrawLoop=e._drawLoop.bind(_assertThisInitialized(e)),e._animationFrame=-1,e}return _inherits(t,e),_createClass(t,[{key:"schedule",value:function(e,t){return this._events.add({callback:e,time:this.toSeconds(t)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}},{key:"cancel",value:function(e){return this._events.cancel(this.toSeconds(e)),this}},{key:"_drawLoop",value:function(){for(var e=this.context.currentTime;this._events.length&&this._events.peek().time-this.anticipation<=e;){var t=this._events.shift();t&&e-t.time<=this.expiration&&t.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}])}(mo);Di((function(e){e.draw=new zo({context:e})})),ji((function(e){e.draw.dispose()}));var Fo=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="IntervalTimeline",e._root=null,e._length=0,e}return _inherits(t,e),_createClass(t,[{key:"add",value:function(e){Zr(ii(e.time),"Events must have a time property"),Zr(ii(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();var t=new Lo(e.time,e.time+e.duration,e);for(null===this._root?this._root=t:this._root.insert(t),this._length++;null!==t;)t.updateHeight(),t.updateMax(),this._rebalance(t),t=t.parent;return this}},{key:"remove",value:function(e){if(null!==this._root){var t=[];this._root.search(e.time,t);for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i.event===e){this._removeNode(i),this._length--;break}}}return this}},{key:"length",get:function(){return this._length}},{key:"cancel",value:function(e){var t=this;return this.forEachFrom(e,(function(e){return t.remove(e)})),this}},{key:"_setRoot",value:function(e){this._root=e,null!==this._root&&(this._root.parent=null)}},{key:"_replaceNodeInParent",value:function(e,t){null!==e.parent?(e.isLeftChild()?e.parent.left=t:e.parent.right=t,this._rebalance(e.parent)):this._setRoot(t)}},{key:"_removeNode",value:function(e){if(null===e.left&&null===e.right)this._replaceNodeInParent(e,null);else if(null===e.right)this._replaceNodeInParent(e,e.left);else if(null===e.left)this._replaceNodeInParent(e,e.right);else{var t,n=null;if(e.getBalance()>0)if(null===e.left.right)(t=e.left).right=e.right,n=t;else{for(t=e.left.right;null!==t.right;)t=t.right;t.parent&&(t.parent.right=t.left,n=t.parent,t.left=e.left,t.right=e.right)}else if(null===e.right.left)(t=e.right).left=e.left,n=t;else{for(t=e.right.left;null!==t.left;)t=t.left;t.parent&&(t.parent.left=t.right,n=t.parent,t.left=e.left,t.right=e.right)}null!==e.parent?e.isLeftChild()?e.parent.left=t:e.parent.right=t:this._setRoot(t),n&&this._rebalance(n)}e.dispose()}},{key:"_rotateLeft",value:function(e){var t=e.parent,n=e.isLeftChild(),r=e.right;r&&(e.right=r.left,r.left=e),null!==t?n?t.left=r:t.right=r:this._setRoot(r)}},{key:"_rotateRight",value:function(e){var t=e.parent,n=e.isLeftChild(),r=e.left;r&&(e.left=r.right,r.right=e),null!==t?n?t.left=r:t.right=r:this._setRoot(r)}},{key:"_rebalance",value:function(e){var t=e.getBalance();t>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):t<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}},{key:"get",value:function(e){if(null!==this._root){var t=[];if(this._root.search(e,t),t.length>0){for(var n=t[0],r=1;r<t.length;r++)t[r].low>n.low&&(n=t[r]);return n.event}}return null}},{key:"forEach",value:function(e){if(null!==this._root){var t=[];this._root.traverse((function(e){return t.push(e)})),t.forEach((function(t){t.event&&e(t.event)}))}return this}},{key:"forEachAtTime",value:function(e,t){if(null!==this._root){var n=[];this._root.search(e,n),n.forEach((function(e){e.event&&t(e.event)}))}return this}},{key:"forEachFrom",value:function(e,t){if(null!==this._root){var n=[];this._root.searchAfter(e,n),n.forEach((function(e){e.event&&t(e.event)}))}return this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),null!==this._root&&this._root.traverse((function(e){return e.dispose()})),this._root=null,this}}])}(Pi),Lo=function(){return _createClass((function e(t,n,r){_classCallCheck(this,e),this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=t,this.high=n,this.max=this.high}),[{key:"insert",value:function(e){e.low<=this.low?null===this.left?this.left=e:this.left.insert(e):null===this.right?this.right=e:this.right.insert(e)}},{key:"search",value:function(e,t){e>this.max||(null!==this.left&&this.left.search(e,t),this.low<=e&&this.high>e&&t.push(this),this.low>e||null!==this.right&&this.right.search(e,t))}},{key:"searchAfter",value:function(e,t){this.low>=e&&(t.push(this),null!==this.left&&this.left.searchAfter(e,t)),null!==this.right&&this.right.searchAfter(e,t)}},{key:"traverse",value:function(e){e(this),null!==this.left&&this.left.traverse(e),null!==this.right&&this.right.traverse(e)}},{key:"updateHeight",value:function(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}},{key:"updateMax",value:function(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}},{key:"getBalance",value:function(){var e=0;return null!==this.left&&null!==this.right?e=this.left.height-this.right.height:null!==this.left?e=this.left.height+1:null!==this.right&&(e=-(this.right.height+1)),e}},{key:"isLeftChild",value:function(){return null!==this.parent&&this.parent.left===this}},{key:"left",get:function(){return this._left},set:function(e){this._left=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}},{key:"right",get:function(){return this._right},set:function(e){this._right=e,null!==e&&(e.parent=this),this.updateHeight(),this.updateMax()}},{key:"dispose",value:function(){this.parent=null,this._left=null,this._right=null,this.event=null}}])}(),Vo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["volume"])])).name="Volume";var n=xi(t.getDefaults(),arguments,["volume"]);return e.input=e.output=new So({context:e.context,gain:n.volume,units:"decibels"}),e.volume=e.output.gain,Vi(e,"volume"),e._unmutedVolume=n.volume,e.mute=n.mute,e}return _inherits(t,e),_createClass(t,[{key:"mute",get:function(){return this.volume.value===-1/0},set:function(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{mute:!1,volume:0})}}])}(yo),Go=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="Destination",e.input=new Vo({context:e.context}),e.output=new So({context:e.context}),e.volume=e.input.volume;var n=xi(t.getDefaults(),arguments);return _o(e.input,e.output,e.context.rawContext.destination),e.mute=n.mute,e._internalChannels=[e.input,e.context.rawContext.destination,e.output],e}return _inherits(t,e),_createClass(t,[{key:"mute",get:function(){return this.input.mute},set:function(e){this.input.mute=e}},{key:"chain",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.input.disconnect(),t.unshift(this.input),t.push(this.output),_o.apply(void 0,t),this}},{key:"maxChannelCount",get:function(){return this.context.rawContext.destination.maxChannelCount}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{mute:!1,volume:0})}}])}(yo);Di((function(e){e.destination=new Go({context:e})})),ji((function(e){e.destination.dispose()}));var Bo=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t)).name="TimelineValue",n._timeline=new Ei({memory:10}),n._initialValue=e,n}return _inherits(t,e),_createClass(t,[{key:"set",value:function(e,t){return this._timeline.add({value:e,time:t}),this}},{key:"get",value:function(e){var t=this._timeline.get(e);return t?t.value:this._initialValue}}])}(Pi),Uo=function(){return _createClass((function e(t,n){_classCallCheck(this,e),this.id=e._eventId++;var r=Object.assign(e.getDefaults(),n);this.transport=t,this.callback=r.callback,this._once=r.once,this.time=r.time}),[{key:"invoke",value:function(e){this.callback&&(this.callback(e),this._once&&this.transport.clear(this.id))}},{key:"dispose",value:function(){return this.callback=void 0,this}}],[{key:"getDefaults",value:function(){return{callback:Bi,once:!1,time:0}}}])}();Uo._eventId=0;var Ho=function(e){function t(e,n){var r;_classCallCheck(this,t),(r=_callSuper(this,t,[e,n]))._currentId=-1,r._nextId=-1,r._nextTick=r.time,r._boundRestart=r._restart.bind(_assertThisInitialized(r));var i=Object.assign(t.getDefaults(),n);return r.duration=new Ro(e.context,i.duration).valueOf(),r._interval=new Ro(e.context,i.interval).valueOf(),r._nextTick=i.time,r.transport.on("start",r._boundRestart),r.transport.on("loopStart",r._boundRestart),r.context=r.transport.context,r._restart(),r}return _inherits(t,e),_createClass(t,[{key:"invoke",value:function(e){this._createEvents(e),_superPropGet(t,"invoke",this,3)([e])}},{key:"_createEvents",value:function(e){var t=this.transport.getTicksAtTime(e);t>=this.time&&t>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ro(this.context,this._nextTick).toSeconds()))}},{key:"_restart",value:function(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;var t=this.transport.getTicksAtTime(e);t>this.time&&(this._nextTick=this.time+Math.ceil((t-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new Ro(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new Ro(this.context,this._nextTick).toSeconds())}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}],[{key:"getDefaults",value:function(){return Object.assign({},Uo.getDefaults(),{duration:1/0,interval:1,once:!1})}}])}(Uo),Qo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="Transport",e._loop=new Bo(!1),e._loopStart=0,e._loopEnd=0,e._scheduledEvents={},e._timeline=new Ei,e._repeatedEvents=new Fo,e._syncedSignals=[],e._swingAmount=0;var n=xi(t.getDefaults(),arguments);return e._ppq=n.ppq,e._clock=new Mo({callback:e._processTick.bind(e),context:e.context,frequency:0,units:"bpm"}),e._bindClockEvents(),e.bpm=e._clock.frequency,e._clock.frequency.multiplier=n.ppq,e.bpm.setValueAtTime(n.bpm,0),Vi(e,"bpm"),e._timeSignature=n.timeSignature,e._swingTicks=n.ppq/2,e}return _inherits(t,e),_createClass(t,[{key:"_processTick",value:function(e,t){if(this._swingAmount>0&&t%this._ppq!=0&&t%(2*this._swingTicks)!=0){var n=t%(2*this._swingTicks)/(2*this._swingTicks),r=Math.sin(n*Math.PI)*this._swingAmount;e+=new Ro(this.context,2*this._swingTicks/3).toSeconds()*r}this._loop.get(e)&&t>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),t=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._timeline.forEachAtTime(t,(function(t){return t.invoke(e)}))}},{key:"schedule",value:function(e,t){var n=new Uo(this,{callback:e,time:new fo(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}},{key:"scheduleRepeat",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0,i=new Ho(this,{callback:e,duration:new ao(this.context,r).toTicks(),interval:new ao(this.context,t).toTicks(),time:new fo(this.context,n).toTicks()});return this._addEvent(i,this._repeatedEvents)}},{key:"scheduleOnce",value:function(e,t){var n=new Uo(this,{callback:e,once:!0,time:new fo(this.context,t).toTicks()});return this._addEvent(n,this._timeline)}},{key:"clear",value:function(e){if(this._scheduledEvents.hasOwnProperty(e)){var t=this._scheduledEvents[e.toString()];t.timeline.remove(t.event),t.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}},{key:"_addEvent",value:function(e,t){return this._scheduledEvents[e.id.toString()]={event:e,timeline:t},t.add(e),e.id}},{key:"cancel",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=this.toTicks(t);return this._timeline.forEachFrom(n,(function(t){return e.clear(t.id)})),this._repeatedEvents.forEachFrom(n,(function(t){return e.clear(t.id)})),this}},{key:"_bindClockEvents",value:function(){var e=this;this._clock.on("start",(function(t,n){n=new Ro(e.context,n).toSeconds(),e.emit("start",t,n)})),this._clock.on("stop",(function(t){e.emit("stop",t)})),this._clock.on("pause",(function(t){e.emit("pause",t)}))}},{key:"state",get:function(){return this._clock.getStateAtTime(this.now())}},{key:"start",value:function(e,t){var n;return ii(t)&&(n=this.toTicks(t)),this._clock.start(e,n),this}},{key:"stop",value:function(e){return this._clock.stop(e),this}},{key:"pause",value:function(e){return this._clock.pause(e),this}},{key:"toggle",value:function(e){return e=this.toSeconds(e),"started"!==this._clock.getStateAtTime(e)?this.start(e):this.stop(e),this}},{key:"timeSignature",get:function(){return this._timeSignature},set:function(e){ci(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}},{key:"loopStart",get:function(){return new ao(this.context,this._loopStart,"i").toSeconds()},set:function(e){this._loopStart=this.toTicks(e)}},{key:"loopEnd",get:function(){return new ao(this.context,this._loopEnd,"i").toSeconds()},set:function(e){this._loopEnd=this.toTicks(e)}},{key:"loop",get:function(){return this._loop.get(this.now())},set:function(e){this._loop.set(e,this.now())}},{key:"setLoopPoints",value:function(e,t){return this.loopStart=e,this.loopEnd=t,this}},{key:"swing",get:function(){return this._swingAmount},set:function(e){this._swingAmount=e}},{key:"swingSubdivision",get:function(){return new Ro(this.context,this._swingTicks).toNotation()},set:function(e){this._swingTicks=this.toTicks(e)}},{key:"position",get:function(){var e=this.now(),t=this._clock.getTicksAtTime(e);return new Ro(this.context,t).toBarsBeatsSixteenths()},set:function(e){var t=this.toTicks(e);this.ticks=t}},{key:"seconds",get:function(){return this._clock.seconds},set:function(e){var t=this.now(),n=this._clock.frequency.timeToTicks(e,t);this.ticks=n}},{key:"progress",get:function(){if(this.loop){var e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}},{key:"ticks",get:function(){return this._clock.ticks},set:function(e){if(this._clock.ticks!==e){var t=this.now();if("started"===this.state){var n=this._clock.getTicksAtTime(t),r=this._clock.getTimeOfTick(Math.ceil(n));this.emit("stop",r),this._clock.setTicksAtTime(e,r),this.emit("start",r,this._clock.getSecondsAtTime(r))}else this._clock.setTicksAtTime(e,t)}}},{key:"getTicksAtTime",value:function(e){return Math.round(this._clock.getTicksAtTime(e))}},{key:"getSecondsAtTime",value:function(e){return this._clock.getSecondsAtTime(e)}},{key:"PPQ",get:function(){return this._clock.frequency.multiplier},set:function(e){this._clock.frequency.multiplier=e}},{key:"nextSubdivision",value:function(e){if(e=this.toTicks(e),"started"!==this.state)return 0;var t=this.now(),n=e-this.getTicksAtTime(t)%e;return this._clock.nextTickTime(n,t)}},{key:"syncSignal",value:function(e,t){if(!t){var n=this.now();if(0!==e.getValueAtTime(n)){var r=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);t=e.getValueAtTime(n)/r}else t=0}var i=new So(t);return this.bpm.connect(i),i.connect(e._param),this._syncedSignals.push({initial:e.value,ratio:i,signal:e}),e.value=0,this}},{key:"unsyncSignal",value:function(e){for(var t=this._syncedSignals.length-1;t>=0;t--){var n=this._syncedSignals[t];n.signal===e&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(t,1))}return this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._clock.dispose(),Gi(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(mo.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}}])}(mo);zi.mixin(Qo),Di((function(e){e.transport=new Qo({context:e})})),ji((function(e){e.transport.dispose()}));var Wo=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).input=void 0,n._state=new vo("stopped"),n._synced=!1,n._scheduled=[],n._syncedStart=Bi,n._syncedStop=Bi,n._state.memory=100,n._state.increasing=!0,n._volume=n.output=new Vo({context:n.context,mute:e.mute,volume:e.volume}),n.volume=n._volume.volume,Vi(_assertThisInitialized(n),"volume"),n.onstop=e.onstop,n}return _inherits(t,e),_createClass(t,[{key:"state",get:function(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}},{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"_clampToCurrentTime",value:function(e){return this._synced?e:Math.max(e,this.context.currentTime)}},{key:"start",value:function(e,t,n){var r=this,i=ri(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){var o=this._state.get(i);o&&(o.offset=this.toSeconds(Ti(t,0)),o.duration=n?this.toSeconds(n):void 0);var a=this.context.transport.schedule((function(e){r._start(e,t,n)}),i);this._scheduled.push(a),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Jr(this.context),this._start(i,t,n);else Zr(Ai(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,t,n);return this}},{key:"stop",value:function(e){var t=ri(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(t=this._clampToCurrentTime(t),"started"===this._state.getValueAtTime(t)||ii(this._state.getNextState("started",t))){if(this.log("stop",t),this._synced){var n=this.context.transport.schedule(this._stop.bind(this),t);this._scheduled.push(n)}else this._stop(t);this._state.cancel(t),this._state.setStateAtTime("stopped",t)}return this}},{key:"restart",value:function(e,t,n){return e=this.toSeconds(e),"started"===this._state.getValueAtTime(e)&&(this._state.cancel(e),this._restart(e,t,n)),this}},{key:"sync",value:function(){var e=this;return this._synced||(this._synced=!0,this._syncedStart=function(t,n){if(n>0){var r=e._state.get(n);if(r&&"started"===r.state&&r.time!==n){var i,o=n-e.toSeconds(r.time);r.duration&&(i=e.toSeconds(r.duration)-o),e._start(t,e.toSeconds(r.offset)+o,i)}}},this._syncedStop=function(t){var n=e.context.transport.getSecondsAtTime(Math.max(t-e.sampleTime,0));"started"===e._state.getValueAtTime(n)&&e._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}},{key:"unsync",value:function(){var e=this;return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((function(t){return e.context.transport.clear(t)})),this._scheduled=[],this._state.cancel(0),this._stop(0),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.onstop=Bi,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{mute:!1,onstop:Bi,volume:0})}}])}(yo),Yo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["url","onload"])])).name="ToneBufferSource",e._source=e.context.createBufferSource(),e._internalChannels=[e._source],e._sourceStarted=!1,e._sourceStopped=!1;var n=xi(t.getDefaults(),arguments,["url","onload"]);return ko(e._source,e._gainNode),e._source.onended=function(){return e._stopSource()},e.playbackRate=new go({context:e.context,param:e._source.playbackRate,units:"positive",value:n.playbackRate}),e.loop=n.loop,e.loopStart=n.loopStart,e.loopEnd=n.loopEnd,e._buffer=new Ui(n.url,n.onload,n.onerror),e._internalChannels.push(e._source),e}return _inherits(t,e),_createClass(t,[{key:"fadeIn",get:function(){return this._fadeIn},set:function(e){this._fadeIn=e}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(e){this._fadeOut=e}},{key:"curve",get:function(){return this._curve},set:function(e){this._curve=e}},{key:"start",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Zr(this.buffer.loaded,"buffer is either not set or not loaded");var i=this.toSeconds(e);this._startGain(i,r),t=this.loop?Ti(t,this.loopStart):Ti(t,0);var o=Math.max(this.toSeconds(t),0);if(this.loop){var a=this.toSeconds(this.loopEnd)||this.buffer.duration,s=this.toSeconds(this.loopStart),u=a-s;Oi(o,a)&&(o=(o-s)%u+s),Ni(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,Mi(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(i,o)),ii(n)){var c=this.toSeconds(n);c=Math.max(c,0),this.stop(i+c)}return this}},{key:"_stopSource",value:function(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}},{key:"loopStart",get:function(){return this._source.loopStart},set:function(e){this._source.loopStart=this.toSeconds(e)}},{key:"loopEnd",get:function(){return this._source.loopEnd},set:function(e){this._source.loopEnd=this.toSeconds(e)}},{key:"buffer",get:function(){return this._buffer},set:function(e){this._buffer.set(e)}},{key:"loop",get:function(){return this._source.loop},set:function(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(wo.getDefaults(),{url:new Ui,loop:!1,loopEnd:0,loopStart:0,onload:Bi,onerror:Bi,playbackRate:1})}}])}(wo),Xo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["type"])])).name="Noise",e._source=null;var n=xi(t.getDefaults(),arguments,["type"]);return e._playbackRate=n.playbackRate,e.type=n.type,e._fadeIn=n.fadeIn,e._fadeOut=n.fadeOut,e}return _inherits(t,e),_createClass(t,[{key:"type",get:function(){return this._type},set:function(e){if(Zr(e in Ko,"Noise: invalid type: "+e),this._type!==e&&(this._type=e,"started"===this.state)){var t=this.now();this._stop(t),this._start(t)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._source&&(this._source.playbackRate.value=e)}},{key:"_start",value:function(e){var t=this,n=Ko[this._type];this._source=new Yo({url:n,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:function(){return t.onstop(t)},playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(e),Math.random()*(n.duration-.001))}},{key:"_stop",value:function(e){this._source&&(this._source.stop(this.toSeconds(e)),this._source=null)}},{key:"fadeIn",get:function(){return this._fadeIn},set:function(e){this._fadeIn=e,this._source&&(this._source.fadeIn=this._fadeIn)}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(e){this._fadeOut=e,this._source&&(this._source.fadeOut=this._fadeOut)}},{key:"_restart",value:function(e){this._stop(e),this._start(e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._source&&this._source.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}}])}(Wo),Zo={brown:null,pink:null,white:null},Ko={get brown(){if(!Zo.brown){for(var e=[],t=0;t<2;t++){var n=new Float32Array(220500);e[t]=n;for(var r=0,i=0;i<220500;i++){var o=2*Math.random()-1;n[i]=(r+.02*o)/1.02,r=n[i],n[i]*=3.5}}Zo.brown=(new Ui).fromArray(e)}return Zo.brown},get pink(){if(!Zo.pink){for(var e=[],t=0;t<2;t++){var n=new Float32Array(220500),r=void 0,i=void 0,o=void 0,a=void 0,s=void 0,u=void 0,c=void 0;e[t]=n,r=i=o=a=s=u=c=0;for(var l=0;l<220500;l++){var h=2*Math.random()-1;r=.99886*r+.0555179*h,i=.99332*i+.0750759*h,o=.969*o+.153852*h,a=.8665*a+.3104856*h,s=.55*s+.5329522*h,u=-.7616*u-.016898*h,n[l]=r+i+o+a+s+u+c+.5362*h,n[l]*=.11,c=.115926*h}}Zo.pink=(new Ui).fromArray(e)}return Zo.pink},get white(){if(!Zo.white){for(var e=[],t=0;t<2;t++){var n=new Float32Array(220500);e[t]=n;for(var r=0;r<220500;r++)n[r]=2*Math.random()-1}Zo.white=(new Ui).fromArray(e)}return Zo.white}},Jo=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["volume"])])).name="UserMedia";var n=xi(t.getDefaults(),arguments,["volume"]);return e._volume=e.output=new Vo({context:e.context,volume:n.volume}),e.volume=e._volume.volume,Vi(e,"volume"),e.mute=n.mute,e}return _inherits(t,e),_createClass(t,[{key:"open",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var r,i,o,a;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return Zr(t.supported,"UserMedia is not supported"),"started"===this.state&&this.close(),n.next=3,t.enumerateDevices();case 3:return r=n.sent,ai(e)?this._device=r[e]:(this._device=r.find((function(t){return t.label===e||t.deviceId===e})),!this._device&&r.length>0&&(this._device=r[0]),Zr(ii(this._device),"No matching device "+e)),i={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}},this._device&&(i.audio.deviceId=this._device.deviceId),n.next=9,navigator.mediaDevices.getUserMedia(i);case 9:return o=n.sent,this._stream||(this._stream=o,ko(a=this.context.createMediaStreamSource(o),this.output),this._mediaStream=a),n.abrupt("return",this);case 12:case"end":return n.stop()}}),n,this)})))}},{key:"close",value:function(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((function(e){e.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}},{key:"state",get:function(){return this._stream&&this._stream.active?"started":"stopped"}},{key:"deviceId",get:function(){return this._device?this._device.deviceId:void 0}},{key:"groupId",get:function(){return this._device?this._device.groupId:void 0}},{key:"label",get:function(){return this._device?this._device.label:void 0}},{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.close(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{mute:!1,volume:0})}},{key:"enumerateDevices",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.enumerateDevices();case 2:return e.abrupt("return",e.sent.filter((function(e){return"audioinput"===e.kind})));case 3:case"end":return e.stop()}}),e)})))}},{key:"supported",get:function(){return ii(navigator.mediaDevices)&&ii(navigator.mediaDevices.getUserMedia)}}])}(yo);function $o(e,t){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function n(){var r,i;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=t/e.context.sampleRate,i=new Hi(1,r,e.context.sampleRate),new e.constructor(Object.assign(e.get(),{frequency:2/r,detune:0,context:i})).toDestination().start(0),n.next=4,i.render();case 4:return n.abrupt("return",n.sent.getChannelData(0));case 5:case"end":return n.stop()}}),n)})))}var ea=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type"])])).name="ToneOscillatorNode",e._oscillator=e.context.createOscillator(),e._internalChannels=[e._oscillator];var n=xi(t.getDefaults(),arguments,["frequency","type"]);return ko(e._oscillator,e._gainNode),e.type=n.type,e.frequency=new go({context:e.context,param:e._oscillator.frequency,units:"frequency",value:n.frequency}),e.detune=new go({context:e.context,param:e._oscillator.detune,units:"cents",value:n.detune}),Vi(e,["frequency","detune"]),e}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e){var t=this.toSeconds(e);return this.log("start",t),this._startGain(t),this._oscillator.start(t),this}},{key:"_stopSource",value:function(e){this._oscillator.stop(e)}},{key:"setPeriodicWave",value:function(e){return this._oscillator.setPeriodicWave(e),this}},{key:"type",get:function(){return this._oscillator.type},set:function(e){this._oscillator.type=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(wo.getDefaults(),{detune:0,frequency:440,type:"sine"})}}])}(wo),ta=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type"])])).name="Oscillator",e._oscillator=null;var n=xi(t.getDefaults(),arguments,["frequency","type"]);return e.frequency=new To({context:e.context,units:"frequency",value:n.frequency}),Vi(e,"frequency"),e.detune=new To({context:e.context,units:"cents",value:n.detune}),Vi(e,"detune"),e._partials=n.partials,e._partialCount=n.partialCount,e._type=n.type,n.partialCount&&"custom"!==n.type&&(e._type=e.baseType+n.partialCount.toString()),e.phase=n.phase,e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){var t=this,n=this.toSeconds(e),r=new ea({context:this.context,onended:function(){return t.onstop(t)}});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}},{key:"_stop",value:function(e){var t=this.toSeconds(e);this._oscillator&&this._oscillator.stop(t)}},{key:"_restart",value:function(e){var t=this.toSeconds(e);return this.log("restart",t),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(t),this}},{key:"syncFrequency",value:function(){return this.context.transport.syncSignal(this.frequency),this}},{key:"unsyncFrequency",value:function(){return this.context.transport.unsyncSignal(this.frequency),this}},{key:"_getCachedPeriodicWave",value:function(){var e=this;if("custom"===this._type)return t._periodicWaveCache.find((function(t){return t.phase===e._phase&&(n=t.partials,r=e._partials,n.length===r.length&&n.every((function(e,t){return r[t]===e})));var n,r}));var n=t._periodicWaveCache.find((function(t){return t.type===e._type&&t.phase===e._phase}));return this._partialCount=n?n.partialCount:this._partialCount,n}},{key:"type",get:function(){return this._type},set:function(e){this._type=e;var n=-1!==["sine","square","sawtooth","triangle"].indexOf(e);if(0===this._phase&&n)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=e);else{var r=this._getCachedPeriodicWave();if(ii(r)){var i=r.partials,o=r.wave;this._wave=o,this._partials=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{var a=_slicedToArray(this._getRealImaginary(e,this._phase),2),s=a[0],u=a[1],c=this.context.createPeriodicWave(s,u);this._wave=c,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),t._periodicWaveCache.push({imag:u,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:s,type:this._type,wave:this._wave}),t._periodicWaveCache.length>100&&t._periodicWaveCache.shift()}}}},{key:"baseType",get:function(){return this._type.replace(this.partialCount.toString(),"")},set:function(e){this.partialCount&&"custom"!==this._type&&"custom"!==e?this.type=e+this.partialCount:this.type=e}},{key:"partialCount",get:function(){return this._partialCount},set:function(e){Kr(e,0);var t=this._type,n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(t=n[1]),"custom"!==this._type)this.type=0===e?t:t+e.toString();else{var r=new Float32Array(e);this._partials.forEach((function(e,t){return r[t]=e})),this._partials=Array.from(r),this.type=this._type}}},{key:"_getRealImaginary",value:function(e,t){var n=2048,r=new Float32Array(n),i=new Float32Array(n),o=1;if("custom"===e){if(o=this._partials.length+1,this._partialCount=this._partials.length,n=o,0===this._partials.length)return[r,i]}else{var a=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);a?(o=parseInt(a[2],10)+1,this._partialCount=parseInt(a[2],10),e=a[1],n=o=Math.max(o,2)):this._partialCount=0,this._partials=[]}for(var s=1;s<n;++s){var u=2/(s*Math.PI),c=void 0;switch(e){case"sine":c=s<=o?1:0,this._partials[s-1]=c;break;case"square":c=1&s?2*u:0,this._partials[s-1]=c;break;case"sawtooth":c=u*(1&s?1:-1),this._partials[s-1]=c;break;case"triangle":c=1&s?u*u*2*(s-1>>1&1?-1:1):0,this._partials[s-1]=c;break;case"custom":c=this._partials[s-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}0!==c?(r[s]=-c*Math.sin(t*s),i[s]=c*Math.cos(t*s)):(r[s]=0,i[s]=0)}return[r,i]}},{key:"_inverseFFT",value:function(e,t,n){for(var r=0,i=e.length,o=0;o<i;o++)r+=e[o]*Math.cos(o*n)+t[o]*Math.sin(o*n);return r}},{key:"getInitialValue",value:function(){for(var e=_slicedToArray(this._getRealImaginary(this._type,0),2),t=e[0],n=e[1],r=0,i=2*Math.PI,o=0;o<32;o++)r=Math.max(this._inverseFFT(t,n,o/32*i),r);return Ii(-this._inverseFFT(t,n,this._phase)/r,-1,1)}},{key:"partials",get:function(){return this._partials.slice(0,this.partialCount)},set:function(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}},{key:"phase",get:function(){return this._phase*(180/Math.PI)},set:function(e){this._phase=e*Math.PI/180,this.type=this._type}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}}])}(Wo);ta._periodicWaveCache=[];var na=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["context"]))])}return _inherits(t,e),_createClass(t,[{key:"connect",value:function(e){return Co(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}}])}(yo),ra=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["mapping","length"]))])).name="WaveShaper",e._shaper=e.context.createWaveShaper(),e.input=e._shaper,e.output=e._shaper;var n=xi(t.getDefaults(),arguments,["mapping","length"]);return ci(n.mapping)||n.mapping instanceof Float32Array?e.curve=Float32Array.from(n.mapping):oi(n.mapping)&&e.setMap(n.mapping,n.length),e}return _inherits(t,e),_createClass(t,[{key:"setMap",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,n=new Float32Array(t),r=0,i=t;r<i;r++){var o=r/(i-1)*2-1;n[r]=e(o,r)}return this.curve=n,this}},{key:"curve",get:function(){return this._shaper.curve},set:function(e){this._shaper.curve=e}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(e){Zr(["none","2x","4x"].some((function(t){return t.includes(e)})),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._shaper.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(To.getDefaults(),{length:1024})}}])}(na),ia=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="AudioToGain",e._norm=new ra({context:e.context,mapping:function(e){return(e+1)/2}}),e.input=e._norm,e.output=e._norm,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._norm.dispose(),this}}])}(na),oa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["value"]))])).name="Multiply",e.override=!1;var n=xi(t.getDefaults(),arguments,["value"]);return e._mult=e.input=e.output=new So({context:e.context,minValue:n.minValue,maxValue:n.maxValue}),e.factor=e._param=e._mult.gain,e.factor.setValueAtTime(n.value,0),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(To.getDefaults(),{value:0})}}])}(To),aa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type","modulationType"])])).name="AMOscillator",e._modulationScale=new ia({context:e.context}),e._modulationNode=new So({context:e.context});var n=xi(t.getDefaults(),arguments,["frequency","type","modulationType"]);return e._carrier=new ta({context:e.context,detune:n.detune,frequency:n.frequency,onstop:function(){return e.onstop(e)},phase:n.phase,type:n.type}),e.frequency=e._carrier.frequency,e.detune=e._carrier.detune,e._modulator=new ta({context:e.context,phase:n.phase,type:n.modulationType}),e.harmonicity=new oa({context:e.context,units:"positive",value:n.harmonicity}),e.frequency.chain(e.harmonicity,e._modulator.frequency),e._modulator.chain(e._modulationScale,e._modulationNode.gain),e._carrier.chain(e._modulationNode,e.output),Vi(e,["frequency","detune","harmonicity"]),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){this._modulator.start(e),this._carrier.start(e)}},{key:"_stop",value:function(e){this._modulator.stop(e),this._carrier.stop(e)}},{key:"_restart",value:function(e){this._modulator.restart(e),this._carrier.restart(e)}},{key:"type",get:function(){return this._carrier.type},set:function(e){this._carrier.type=e}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(e){this._carrier.baseType=e}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(e){this._carrier.partialCount=e}},{key:"modulationType",get:function(){return this._modulator.type},set:function(e){this._modulator.type=e}},{key:"phase",get:function(){return this._carrier.phase},set:function(e){this._carrier.phase=e,this._modulator.phase=e}},{key:"partials",get:function(){return this._carrier.partials},set:function(e){this._carrier.partials=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ta.getDefaults(),{harmonicity:1,modulationType:"square"})}}])}(Wo),sa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type","modulationType"])])).name="FMOscillator",e._modulationNode=new So({context:e.context,gain:0});var n=xi(t.getDefaults(),arguments,["frequency","type","modulationType"]);return e._carrier=new ta({context:e.context,detune:n.detune,frequency:0,onstop:function(){return e.onstop(e)},phase:n.phase,type:n.type}),e.detune=e._carrier.detune,e.frequency=new To({context:e.context,units:"frequency",value:n.frequency}),e._modulator=new ta({context:e.context,phase:n.phase,type:n.modulationType}),e.harmonicity=new oa({context:e.context,units:"positive",value:n.harmonicity}),e.modulationIndex=new oa({context:e.context,units:"positive",value:n.modulationIndex}),e.frequency.connect(e._carrier.frequency),e.frequency.chain(e.harmonicity,e._modulator.frequency),e.frequency.chain(e.modulationIndex,e._modulationNode),e._modulator.connect(e._modulationNode.gain),e._modulationNode.connect(e._carrier.frequency),e._carrier.connect(e.output),e.detune.connect(e._modulator.detune),Vi(e,["modulationIndex","frequency","detune","harmonicity"]),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){this._modulator.start(e),this._carrier.start(e)}},{key:"_stop",value:function(e){this._modulator.stop(e),this._carrier.stop(e)}},{key:"_restart",value:function(e){return this._modulator.restart(e),this._carrier.restart(e),this}},{key:"type",get:function(){return this._carrier.type},set:function(e){this._carrier.type=e}},{key:"baseType",get:function(){return this._carrier.baseType},set:function(e){this._carrier.baseType=e}},{key:"partialCount",get:function(){return this._carrier.partialCount},set:function(e){this._carrier.partialCount=e}},{key:"modulationType",get:function(){return this._modulator.type},set:function(e){this._modulator.type=e}},{key:"phase",get:function(){return this._carrier.phase},set:function(e){this._carrier.phase=e,this._modulator.phase=e}},{key:"partials",get:function(){return this._carrier.partials},set:function(e){this._carrier.partials=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ta.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}}])}(Wo),ua=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","width"])])).name="PulseOscillator",e._widthGate=new So({context:e.context,gain:0}),e._thresh=new ra({context:e.context,mapping:function(e){return e<=0?-1:1}});var n=xi(t.getDefaults(),arguments,["frequency","width"]);return e.width=new To({context:e.context,units:"audioRange",value:n.width}),e._triangle=new ta({context:e.context,detune:n.detune,frequency:n.frequency,onstop:function(){return e.onstop(e)},phase:n.phase,type:"triangle"}),e.frequency=e._triangle.frequency,e.detune=e._triangle.detune,e._triangle.chain(e._thresh,e.output),e.width.chain(e._widthGate,e._thresh),Vi(e,["width","frequency","detune"]),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}},{key:"_stop",value:function(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}},{key:"_restart",value:function(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}},{key:"phase",get:function(){return this._triangle.phase},set:function(e){this._triangle.phase=e}},{key:"type",get:function(){return"pulse"}},{key:"baseType",get:function(){return"pulse"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"carrierType",set:function(e){this._triangle.type=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}}])}(Wo),ca=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type","spread"])])).name="FatOscillator",e._oscillators=[];var n=xi(t.getDefaults(),arguments,["frequency","type","spread"]);return e.frequency=new To({context:e.context,units:"frequency",value:n.frequency}),e.detune=new To({context:e.context,units:"cents",value:n.detune}),e._spread=n.spread,e._type=n.type,e._phase=n.phase,e._partials=n.partials,e._partialCount=n.partialCount,e.count=n.count,Vi(e,["frequency","detune"]),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){e=this.toSeconds(e),this._forEach((function(t){return t.start(e)}))}},{key:"_stop",value:function(e){e=this.toSeconds(e),this._forEach((function(t){return t.stop(e)}))}},{key:"_restart",value:function(e){this._forEach((function(t){return t.restart(e)}))}},{key:"_forEach",value:function(e){for(var t=0;t<this._oscillators.length;t++)e(this._oscillators[t],t)}},{key:"type",get:function(){return this._type},set:function(e){this._type=e,this._forEach((function(t){return t.type=e}))}},{key:"spread",get:function(){return this._spread},set:function(e){if(this._spread=e,this._oscillators.length>1){var t=-e/2,n=e/(this._oscillators.length-1);this._forEach((function(e,r){return e.detune.value=t+n*r}))}}},{key:"count",get:function(){return this._oscillators.length},set:function(e){var t=this;if(Kr(e,1),this._oscillators.length!==e){this._forEach((function(e){return e.dispose()})),this._oscillators=[];for(var n=0;n<e;n++){var r=new ta({context:this.context,volume:-6-1.1*e,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:0===n?function(){return t.onstop(t)}:Bi});"custom"===this.type&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[n]=r}this.spread=this._spread,"started"===this.state&&this._forEach((function(e){return e.start()}))}}},{key:"phase",get:function(){return this._phase},set:function(e){var t=this;this._phase=e,this._forEach((function(e,n){return e.phase=t._phase+n/t.count*360}))}},{key:"baseType",get:function(){return this._oscillators[0].baseType},set:function(e){this._forEach((function(t){return t.baseType=e})),this._type=this._oscillators[0].type}},{key:"partials",get:function(){return this._oscillators[0].partials},set:function(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach((function(t){return t.partials=e})))}},{key:"partialCount",get:function(){return this._oscillators[0].partialCount},set:function(e){this._partialCount=e,this._forEach((function(t){return t.partialCount=e})),this._type=this._oscillators[0].type}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.frequency.dispose(),this.detune.dispose(),this._forEach((function(e){return e.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(ta.getDefaults(),{count:3,spread:20,type:"sawtooth"})}}])}(Wo),la=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","modulationFrequency"])])).name="PWMOscillator",e.sourceType="pwm",e._scale=new oa({context:e.context,value:2});var n=xi(t.getDefaults(),arguments,["frequency","modulationFrequency"]);return e._pulse=new ua({context:e.context,frequency:n.modulationFrequency}),e._pulse.carrierType="sine",e.modulationFrequency=e._pulse.frequency,e._modulator=new ta({context:e.context,detune:n.detune,frequency:n.frequency,onstop:function(){return e.onstop(e)},phase:n.phase}),e.frequency=e._modulator.frequency,e.detune=e._modulator.detune,e._modulator.chain(e._scale,e._pulse.width),e._pulse.connect(e.output),Vi(e,["modulationFrequency","frequency","detune"]),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}},{key:"_stop",value:function(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}},{key:"_restart",value:function(e){this._modulator.restart(e),this._pulse.restart(e)}},{key:"type",get:function(){return"pwm"}},{key:"baseType",get:function(){return"pwm"}},{key:"partials",get:function(){return[]}},{key:"partialCount",get:function(){return 0}},{key:"phase",get:function(){return this._modulator.phase},set:function(e){this._modulator.phase=e}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}}])}(Wo),ha={am:aa,fat:ca,fm:sa,oscillator:ta,pulse:ua,pwm:la},fa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type"])])).name="OmniOscillator";var n=xi(t.getDefaults(),arguments,["frequency","type"]);return e.frequency=new To({context:e.context,units:"frequency",value:n.frequency}),e.detune=new To({context:e.context,units:"cents",value:n.detune}),Vi(e,["frequency","detune"]),e.set(n),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e){this._oscillator.start(e)}},{key:"_stop",value:function(e){this._oscillator.stop(e)}},{key:"_restart",value:function(e){return this._oscillator.restart(e),this}},{key:"type",get:function(){var e=this,t="";return["am","fm","fat"].some((function(t){return e._sourceType===t}))&&(t=this._sourceType),t+this._oscillator.type},set:function(e){"fm"===e.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"am"===e.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):"fat"===e.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):"pwm"===e?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===e?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}},{key:"partials",get:function(){return this._oscillator.partials},set:function(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=e)}},{key:"partialCount",get:function(){return this._oscillator.partialCount},set:function(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=e)}},{key:"set",value:function(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),_superPropGet(t,"set",this,3)([e]),this}},{key:"_createNewOscillator",value:function(e){var t=this;if(e!==this._sourceType){this._sourceType=e;var n=ha[e],r=this.now();if(this._oscillator){var i=this._oscillator;i.stop(r),this.context.setTimeout((function(){return i.dispose()}),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=function(){return t.onstop(t)},"started"===this.state&&this._oscillator.start(r)}}},{key:"phase",get:function(){return this._oscillator.phase},set:function(e){this._oscillator.phase=e}},{key:"sourceType",get:function(){return this._sourceType},set:function(e){var t="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(t=this._oscillator.type),"fm"===e?this.type="fm"+t:"am"===e?this.type="am"+t:"fat"===e?this.type="fat"+t:"oscillator"===e?this.type=t:"pulse"===e?this.type="pulse":"pwm"===e&&(this.type="pwm")}},{key:"_getOscType",value:function(e,t){return e instanceof ha[t]}},{key:"baseType",get:function(){return this._oscillator.baseType},set:function(e){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===e||"pwm"===e||(this._oscillator.baseType=e)}},{key:"width",get:function(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}},{key:"count",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0},set:function(e){this._getOscType(this._oscillator,"fat")&&ai(e)&&(this._oscillator.count=e)}},{key:"spread",get:function(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0},set:function(e){this._getOscType(this._oscillator,"fat")&&ai(e)&&(this._oscillator.spread=e)}},{key:"modulationType",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0},set:function(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&li(e)&&(this._oscillator.modulationType=e)}},{key:"modulationIndex",get:function(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}},{key:"harmonicity",get:function(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}},{key:"modulationFrequency",get:function(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",$o(this,e));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ta.getDefaults(),sa.getDefaults(),aa.getDefaults(),ca.getDefaults(),ua.getDefaults(),la.getDefaults())}}])}(Wo),pa=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["value"]))])).override=!1,e.name="Add",e._sum=new So({context:e.context}),e.input=e._sum,e.output=e._sum,e.addend=e._param,_o(e._constantSource,e._sum),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(To.getDefaults(),{value:0})}}])}(To),da=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["min","max"]))])).name="Scale";var n=xi(t.getDefaults(),arguments,["min","max"]);return e._mult=e.input=new oa({context:e.context,value:n.max-n.min}),e._add=e.output=new pa({context:e.context,value:n.min}),e._min=n.min,e._max=n.max,e.input.connect(e.output),e}return _inherits(t,e),_createClass(t,[{key:"min",get:function(){return this._min},set:function(e){this._min=e,this._setRange()}},{key:"max",get:function(){return this._max},set:function(e){this._max=e,this._setRange()}},{key:"_setRange",value:function(){this._add.value=this._min,this._mult.value=this._max-this._min}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._add.dispose(),this._mult.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(na.getDefaults(),{max:1,min:0})}}])}(na),ma=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments))])).name="Zero",e._gain=new So({context:e.context}),e.output=e._gain,e.input=void 0,ko(e.context.getConstant(0),e._gain),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),bo(this.context.getConstant(0),this._gain),this}}])}(na),va=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","min","max"])])).name="LFO",e._stoppedValue=0,e._units="number",e.convert=!0,e._fromType=go.prototype._fromType,e._toType=go.prototype._toType,e._is=go.prototype._is,e._clampValue=go.prototype._clampValue;var n=xi(t.getDefaults(),arguments,["frequency","min","max"]);return e._oscillator=new ta({context:e.context,frequency:n.frequency,type:n.type}),e.frequency=e._oscillator.frequency,e._amplitudeGain=new So({context:e.context,gain:n.amplitude,units:"normalRange"}),e.amplitude=e._amplitudeGain.gain,e._stoppedSignal=new To({context:e.context,units:"audioRange",value:0}),e._zeros=new ma({context:e.context}),e._a2g=new ia({context:e.context}),e._scaler=e.output=new da({context:e.context,max:n.max,min:n.min}),e.units=n.units,e.min=n.min,e.max=n.max,e._oscillator.chain(e._a2g,e._amplitudeGain,e._scaler),e._zeros.connect(e._a2g),e._stoppedSignal.connect(e._a2g),Vi(e,["amplitude","frequency"]),e.phase=n.phase,e}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(0,e),this._oscillator.start(e),this}},{key:"stop",value:function(e){return e=this.toSeconds(e),this._stoppedSignal.setValueAtTime(this._stoppedValue,e),this._oscillator.stop(e),this}},{key:"sync",value:function(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}},{key:"unsync",value:function(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}},{key:"min",get:function(){return this._toType(this._scaler.min)},set:function(e){e=this._fromType(e),this._scaler.min=e}},{key:"max",get:function(){return this._toType(this._scaler.max)},set:function(e){e=this._fromType(e),this._scaler.max=e}},{key:"type",get:function(){return this._oscillator.type},set:function(e){this._oscillator.type=e,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}},{key:"phase",get:function(){return this._oscillator.phase},set:function(e){this._oscillator.phase=e,this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}},{key:"units",get:function(){return this._units},set:function(e){var t=this.min,n=this.max;this._units=e,this.min=t,this.max=n}},{key:"state",get:function(){return this._oscillator.state}},{key:"connect",value:function(e,t,n){return(e instanceof go||e instanceof To)&&(this.convert=e.convert,this.units=e.units),Co(this,e,t,n),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,phase:0,type:"sine",units:"number"})}}])}(yo);function ga(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){Kr(r,e,t),n.set(this,r)}})}}function ya(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(r){Kr(this.toSeconds(r),e,t),n.set(this,r)}})}}var _a=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["url","onload"])])).name="Player",e._activeSources=new Set;var n=xi(t.getDefaults(),arguments,["url","onload"]);return e._buffer=new Ui({onload:e._onload.bind(e,n.onload),onerror:n.onerror,reverse:n.reverse,url:n.url}),e.autostart=n.autostart,e._loop=n.loop,e._loopStart=n.loopStart,e._loopEnd=n.loopEnd,e._playbackRate=n.playbackRate,e.fadeIn=n.fadeIn,e.fadeOut=n.fadeOut,e}return _inherits(t,e),_createClass(t,[{key:"load",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buffer.load(e);case 2:return this._onload(),t.abrupt("return",this);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"_onload",value:function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:Bi)(),this.autostart&&this.start()}},{key:"_onSourceEnd",value:function(e){this.onstop(this),this._activeSources.delete(e),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}},{key:"start",value:function(e,n,r){return _superPropGet(t,"start",this,3)([e,n,r]),this}},{key:"_start",value:function(e,t,n){t=this._loop?Ti(t,this._loopStart):Ti(t,0);var r=this.toSeconds(t);this._synced&&(r*=this._playbackRate);var i=n;n=Ti(n,Math.max(this._buffer.duration-r,0));var o=this.toSeconds(n);o/=this._playbackRate,e=this.toSeconds(e);var a=new Yo({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&ri(i)?a.start(e,r):a.start(e,r,o-this.toSeconds(this.fadeOut))}},{key:"_stop",value:function(e){var t=this.toSeconds(e);this._activeSources.forEach((function(e){return e.stop(t)}))}},{key:"restart",value:function(e,n,r){return _superPropGet(t,"restart",this,3)([e,n,r]),this}},{key:"_restart",value:function(e,t,n){this._stop(e),this._start(e,t,n)}},{key:"seek",value:function(e,t){var n=this.toSeconds(t);if("started"===this._state.getValueAtTime(n)){var r=this.toSeconds(e);this._stop(n),this._start(n,r)}return this}},{key:"setLoopPoints",value:function(e,t){return this.loopStart=e,this.loopEnd=t,this}},{key:"loopStart",get:function(){return this._loopStart},set:function(e){this._loopStart=e,this.buffer.loaded&&Kr(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach((function(t){t.loopStart=e}))}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(e){this._loopEnd=e,this.buffer.loaded&&Kr(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach((function(t){t.loopEnd=e}))}},{key:"buffer",get:function(){return this._buffer},set:function(e){this._buffer.set(e)}},{key:"loop",get:function(){return this._loop},set:function(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach((function(t){t.loop=e})),e)){var t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e;var t=this.now(),n=this._state.getNextState("stopped",t);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((function(e){return e.cancelStop()}))),this._activeSources.forEach((function(n){n.playbackRate.setValueAtTime(e,t)}))}},{key:"reverse",get:function(){return this._buffer.reverse},set:function(e){this._buffer.reverse=e}},{key:"loaded",get:function(){return this._buffer.loaded}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._activeSources.forEach((function(e){return e.dispose()})),this._activeSources.clear(),this._buffer.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:Bi,onerror:Bi,playbackRate:1,reverse:!1})}}])}(Wo);di([ya(0)],_a.prototype,"fadeIn",void 0),di([ya(0)],_a.prototype,"fadeOut",void 0);var ka=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["urls","onload"],"urls")])).name="Players",e.input=void 0,e._players=new Map;var n=xi(t.getDefaults(),arguments,["urls","onload"],"urls");return e._volume=e.output=new Vo({context:e.context,volume:n.volume}),e.volume=e._volume.volume,Vi(e,"volume"),e._buffers=new Eo({urls:n.urls,onload:n.onload,baseUrl:n.baseUrl,onerror:n.onerror}),e.mute=n.mute,e._fadeIn=n.fadeIn,e._fadeOut=n.fadeOut,e}return _inherits(t,e),_createClass(t,[{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"fadeIn",get:function(){return this._fadeIn},set:function(e){this._fadeIn=e,this._players.forEach((function(t){t.fadeIn=e}))}},{key:"fadeOut",get:function(){return this._fadeOut},set:function(e){this._fadeOut=e,this._players.forEach((function(t){t.fadeOut=e}))}},{key:"state",get:function(){return Array.from(this._players).some((function(e){var t=_slicedToArray(e,2);t[0];return"started"===t[1].state}))?"started":"stopped"}},{key:"has",value:function(e){return this._buffers.has(e)}},{key:"player",value:function(e){if(Zr(this.has(e),"No Player with the name ".concat(e," exists on this object")),!this._players.has(e)){var t=new _a({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(e)}).connect(this.output);this._players.set(e,t)}return this._players.get(e)}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"add",value:function(e,t,n){return Zr(!this._buffers.has(e),"A buffer with that name already exists on this object"),this._buffers.add(e,t,n),this}},{key:"stopAll",value:function(e){return this._players.forEach((function(t){return t.stop(e)})),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._volume.dispose(),this.volume.dispose(),this._players.forEach((function(e){return e.dispose()})),this._buffers.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:Bi,onerror:Bi,urls:{},volume:0})}}])}(yo),ba=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["url","onload"])])).name="GrainPlayer",e._loopStart=0,e._loopEnd=0,e._activeSources=[];var n=xi(t.getDefaults(),arguments,["url","onload"]);return e.buffer=new Ui({onload:n.onload,onerror:n.onerror,reverse:n.reverse,url:n.url}),e._clock=new Mo({context:e.context,callback:e._tick.bind(e),frequency:1/n.grainSize}),e._playbackRate=n.playbackRate,e._grainSize=n.grainSize,e._overlap=n.overlap,e.detune=n.detune,e.overlap=n.overlap,e.loop=n.loop,e.playbackRate=n.playbackRate,e.grainSize=n.grainSize,e.loopStart=n.loopStart,e.loopEnd=n.loopEnd,e.reverse=n.reverse,e._clock.on("stop",e._onstop.bind(e)),e}return _inherits(t,e),_createClass(t,[{key:"_start",value:function(e,t,n){t=Ti(t,0),t=this.toSeconds(t),e=this.toSeconds(e);var r=1/this._clock.frequency.getValueAtTime(e);this._clock.start(e,t/r),n&&this.stop(e+this.toSeconds(n))}},{key:"restart",value:function(e,n,r){return _superPropGet(t,"restart",this,3)([e,n,r]),this}},{key:"_restart",value:function(e,t,n){this._stop(e),this._start(e,t,n)}},{key:"_stop",value:function(e){this._clock.stop(e)}},{key:"_onstop",value:function(e){this._activeSources.forEach((function(t){t.fadeOut=0,t.stop(e)})),this.onstop(this)}},{key:"_tick",value:function(e){var t=this,n=this._clock.getTicksAtTime(e),r=n*this._grainSize;if(this.log("offset",r),!this.loop&&r>this.buffer.duration)this.stop(e);else{var i=r<this._overlap?0:this._overlap,o=new Yo({context:this.context,url:this.buffer,fadeIn:i,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:eo(this.detune/100)}).connect(this.output);o.start(e,this._grainSize*n),o.stop(e+this._grainSize/this.playbackRate),this._activeSources.push(o),o.onended=function(){var e=t._activeSources.indexOf(o);-1!==e&&t._activeSources.splice(e,1)}}}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){Kr(e,.001),this._playbackRate=e,this.grainSize=this._grainSize}},{key:"loopStart",get:function(){return this._loopStart},set:function(e){this.buffer.loaded&&Kr(this.toSeconds(e),0,this.buffer.duration),this._loopStart=this.toSeconds(e)}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(e){this.buffer.loaded&&Kr(this.toSeconds(e),0,this.buffer.duration),this._loopEnd=this.toSeconds(e)}},{key:"reverse",get:function(){return this.buffer.reverse},set:function(e){this.buffer.reverse=e}},{key:"grainSize",get:function(){return this._grainSize},set:function(e){this._grainSize=this.toSeconds(e),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}},{key:"overlap",get:function(){return this._overlap},set:function(e){var t=this.toSeconds(e);Kr(t,0),this._overlap=t}},{key:"loaded",get:function(){return this.buffer.loaded}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((function(e){return e.dispose()})),this}}],[{key:"getDefaults",value:function(){return Object.assign(Wo.getDefaults(),{onload:Bi,onerror:Bi,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}}])}(Wo),Sa=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Abs",e._abs=new ra({context:e.context,mapping:function(e){return Math.abs(e)<.001?0:Math.abs(e)}}),e.input=e._abs,e.output=e._abs,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._abs.dispose(),this}}])}(na),wa=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="GainToAudio",e._norm=new ra({context:e.context,mapping:function(e){return 2*Math.abs(e)-1}}),e.input=e._norm,e.output=e._norm,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._norm.dispose(),this}}])}(na),xa=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Negate",e._multiply=new oa({context:e.context,value:-1}),e.input=e._multiply,e.output=e._multiply,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._multiply.dispose(),this}}])}(na),Ta=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["value"]))])).override=!1,e.name="Subtract",e._sum=new So({context:e.context}),e.input=e._sum,e.output=e._sum,e._neg=new xa({context:e.context}),e.subtrahend=e._param,_o(e._constantSource,e._neg,e._sum),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._neg.dispose(),this._sum.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(To.getDefaults(),{value:0})}}])}(To),Ca=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments))])).name="GreaterThanZero",e._thresh=e.output=new ra({context:e.context,length:127,mapping:function(e){return e<=0?0:1}}),e._scale=e.input=new oa({context:e.context,value:1e4}),e._scale.connect(e._thresh),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._scale.dispose(),this._thresh.dispose(),this}}])}(na),Pa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["value"]))])).name="GreaterThan",e.override=!1;var n=xi(t.getDefaults(),arguments,["value"]);return e._subtract=e.input=new Ta({context:e.context,value:n.value}),e._gtz=e.output=new Ca({context:e.context}),e.comparator=e._param=e._subtract.subtrahend,Vi(e,"comparator"),e._subtract.connect(e._gtz),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(To.getDefaults(),{value:0})}}])}(To),Aa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["value"]))])).name="Pow";var n=xi(t.getDefaults(),arguments,["value"]);return e._exponentScaler=e.input=e.output=new ra({context:e.context,mapping:e._expFunc(n.value),length:8192}),e._exponent=n.value,e}return _inherits(t,e),_createClass(t,[{key:"_expFunc",value:function(e){return function(t){return Math.pow(Math.abs(t),e)}}},{key:"value",get:function(){return this._exponent},set:function(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._exponentScaler.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(na.getDefaults(),{value:1})}}])}(na),Oa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["min","max","exponent"]))])).name="ScaleExp";var n=xi(t.getDefaults(),arguments,["min","max","exponent"]);return e.input=e._exp=new Aa({context:e.context,value:n.exponent}),e._exp.connect(e._mult),e}return _inherits(t,e),_createClass(t,[{key:"exponent",get:function(){return this._exp.value},set:function(e){this._exp.value=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._exp.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(da.getDefaults(),{exponent:1})}}])}(da),Ma=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(To.getDefaults(),arguments,["value","units"])])).name="SyncedSignal",e.override=!1;var n=xi(To.getDefaults(),arguments,["value","units"]);return e._lastVal=n.value,e._synced=e.context.transport.scheduleRepeat(e._onTick.bind(e),"1i"),e._syncedCallback=e._anchorValue.bind(e),e.context.transport.on("start",e._syncedCallback),e.context.transport.on("pause",e._syncedCallback),e.context.transport.on("stop",e._syncedCallback),e._constantSource.disconnect(),e._constantSource.stop(0),e._constantSource=e.output=new xo({context:e.context,offset:n.value,units:n.units}).start(0),e.setValueAtTime(n.value,0),e}return _inherits(t,e),_createClass(t,[{key:"_onTick",value:function(e){var n=_superPropGet(t,"getValueAtTime",this,3)([this.context.transport.seconds]);this._lastVal!==n&&(this._lastVal=n,this._constantSource.offset.setValueAtTime(n,e))}},{key:"_anchorValue",value:function(e){var n=_superPropGet(t,"getValueAtTime",this,3)([this.context.transport.seconds]);this._lastVal=n,this._constantSource.offset.cancelAndHoldAtTime(e),this._constantSource.offset.setValueAtTime(n,e)}},{key:"getValueAtTime",value:function(e){var n=new fo(this.context,e).toSeconds();return _superPropGet(t,"getValueAtTime",this,3)([n])}},{key:"setValueAtTime",value:function(e,n){var r=new fo(this.context,n).toSeconds();return _superPropGet(t,"setValueAtTime",this,3)([e,r]),this}},{key:"linearRampToValueAtTime",value:function(e,n){var r=new fo(this.context,n).toSeconds();return _superPropGet(t,"linearRampToValueAtTime",this,3)([e,r]),this}},{key:"exponentialRampToValueAtTime",value:function(e,n){var r=new fo(this.context,n).toSeconds();return _superPropGet(t,"exponentialRampToValueAtTime",this,3)([e,r]),this}},{key:"setTargetAtTime",value:function(e,n,r){var i=new fo(this.context,n).toSeconds();return _superPropGet(t,"setTargetAtTime",this,3)([e,i,r]),this}},{key:"cancelScheduledValues",value:function(e){var n=new fo(this.context,e).toSeconds();return _superPropGet(t,"cancelScheduledValues",this,3)([n]),this}},{key:"setValueCurveAtTime",value:function(e,n,r,i){var o=new fo(this.context,n).toSeconds();return r=this.toSeconds(r),_superPropGet(t,"setValueCurveAtTime",this,3)([e,o,r,i]),this}},{key:"cancelAndHoldAtTime",value:function(e){var n=new fo(this.context,e).toSeconds();return _superPropGet(t,"cancelAndHoldAtTime",this,3)([n]),this}},{key:"setRampPoint",value:function(e){var n=new fo(this.context,e).toSeconds();return _superPropGet(t,"setRampPoint",this,3)([n]),this}},{key:"exponentialRampTo",value:function(e,n,r){var i=new fo(this.context,r).toSeconds();return _superPropGet(t,"exponentialRampTo",this,3)([e,n,i]),this}},{key:"linearRampTo",value:function(e,n,r){var i=new fo(this.context,r).toSeconds();return _superPropGet(t,"linearRampTo",this,3)([e,n,i]),this}},{key:"targetRampTo",value:function(e,n,r){var i=new fo(this.context,r).toSeconds();return _superPropGet(t,"targetRampTo",this,3)([e,n,i]),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}])}(To),Na=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["attack","decay","sustain","release"])])).name="Envelope",e._sig=new To({context:e.context,value:0}),e.output=e._sig,e.input=void 0;var n=xi(t.getDefaults(),arguments,["attack","decay","sustain","release"]);return e.attack=n.attack,e.decay=n.decay,e.sustain=n.sustain,e.release=n.release,e.attackCurve=n.attackCurve,e.releaseCurve=n.releaseCurve,e.decayCurve=n.decayCurve,e}return _inherits(t,e),_createClass(t,[{key:"value",get:function(){return this.getValueAtTime(this.now())}},{key:"_getCurve",value:function(e,t){if(li(e))return e;var n;for(n in Ia)if(Ia[n][t]===e)return n;return e}},{key:"_setCurve",value:function(e,t,n){if(li(n)&&Reflect.has(Ia,n)){var r=Ia[n];si(r)?"_decayCurve"!==e&&(this[e]=r[t]):this[e]=r}else{if(!ci(n)||"_decayCurve"===e)throw new Error("Envelope: invalid curve: "+n);this[e]=n}}},{key:"attackCurve",get:function(){return this._getCurve(this._attackCurve,"In")},set:function(e){this._setCurve("_attackCurve","In",e)}},{key:"releaseCurve",get:function(){return this._getCurve(this._releaseCurve,"Out")},set:function(e){this._setCurve("_releaseCurve","Out",e)}},{key:"decayCurve",get:function(){return this._decayCurve},set:function(e){Zr(["linear","exponential"].some((function(t){return t===e})),"Invalid envelope curve: "+e),this._decayCurve=e}},{key:"triggerAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.log("triggerAttack",e,t),e=this.toSeconds(e);var n=this.toSeconds(this.attack),r=this.toSeconds(this.decay),i=this.getValueAtTime(e);if(i>0&&(n=(1-i)/(1/n)),n<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(t,e);else if("linear"===this._attackCurve)this._sig.linearRampTo(t,n,e);else if("exponential"===this._attackCurve)this._sig.targetRampTo(t,n,e);else{this._sig.cancelAndHoldAtTime(e);for(var o=this._attackCurve,a=1;a<o.length;a++)if(o[a-1]<=i&&i<=o[a]){(o=this._attackCurve.slice(a))[0]=i;break}this._sig.setValueCurveAtTime(o,e,n,t)}if(r&&this.sustain<1){var s=t*this.sustain,u=e+n;this.log("decay",u),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(s,r+u):this._sig.exponentialApproachValueAtTime(s,u,r)}return this}},{key:"triggerRelease",value:function(e){this.log("triggerRelease",e),e=this.toSeconds(e);var t=this.getValueAtTime(e);if(t>0){var n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,e):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,e):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,e):(Zr(ci(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,n,t))}return this}},{key:"getValueAtTime",value:function(e){return this._sig.getValueAtTime(e)}},{key:"triggerAttackRelease",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t=this.toSeconds(t),this.triggerAttack(t,n),this.triggerRelease(t+this.toSeconds(e)),this}},{key:"cancel",value:function(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}},{key:"connect",value:function(e){return Co(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0),this}},{key:"asArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1024;return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){var n,r,i,o,a,s,u;return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e/this.context.sampleRate,r=new Hi(1,n,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),o=i+this.toSeconds(this.release),s=o+(a=.1*o),(u=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/s,decay:n*this.toSeconds(this.decay)/s,release:n*this.toSeconds(this.release)/s,context:r})))._sig.toDestination(),u.triggerAttackRelease(n*(i+a)/s,0),t.next=4,r.render();case 4:return t.abrupt("return",t.sent.getChannelData(0));case 5:case"end":return t.stop()}}),t,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._sig.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}}])}(yo);di([ya(0)],Na.prototype,"attack",void 0),di([ya(0)],Na.prototype,"decay",void 0),di([ga(0,1)],Na.prototype,"sustain",void 0),di([ya(0)],Na.prototype,"release",void 0);var Ia=function(){var e,t,n=[];for(e=0;e<128;e++)n[e]=Math.sin(e/127*(Math.PI/2));var r=[];for(e=0;e<127;e++){t=e/127;var i=Math.sin(t*(2*Math.PI)*6.4-Math.PI/2)+1;r[e]=i/10+.83*t}r[127]=1;var o=[];for(e=0;e<128;e++)o[e]=Math.ceil(e/127*5)/5;var a=[];for(e=0;e<128;e++)t=e/127,a[e]=.5*(1-Math.cos(Math.PI*t));var s,u=[];for(e=0;e<128;e++){t=e/127;var c=4*Math.pow(t,3)+.2,l=Math.cos(c*Math.PI*2*t);u[e]=Math.abs(l*(1-t))}function h(e){for(var t=new Array(e.length),n=0;n<e.length;n++)t[n]=1-e[n];return t}return{bounce:{In:h(u),Out:u},cosine:{In:n,Out:(s=n,s.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:r,Out:h(r)},sine:{In:a,Out:h(a)},step:{In:o,Out:h(o)}}}(),Ea=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)]))._scheduledEvents=[],e._synced=!1,e._original_triggerAttack=e.triggerAttack,e._original_triggerRelease=e.triggerRelease;var n=xi(t.getDefaults(),arguments);return e._volume=e.output=new Vo({context:e.context,volume:n.volume}),e.volume=e._volume.volume,Vi(e,"volume"),e}return _inherits(t,e),_createClass(t,[{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}},{key:"_syncState",value:function(){var e=!1;return this._synced||(this._synced=!0,e=!0),e}},{key:"_syncMethod",value:function(e,t){var n=this,r=this["_original_"+e]=this[e];this[e]=function(){for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];var a=i[t],s=n.context.transport.schedule((function(e){i[t]=e,r.apply(n,i)}),a);n._scheduledEvents.push(s)}}},{key:"unsync",value:function(){var e=this;return this._scheduledEvents.forEach((function(t){return e.context.transport.clear(t)})),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}},{key:"triggerAttackRelease",value:function(e,t,n,r){var i=this.toSeconds(n),o=this.toSeconds(t);return this.triggerAttack(e,i,r),this.triggerRelease(i+o),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{volume:0})}}])}(yo),qa=function(e){function t(){var e;_classCallCheck(this,t),e=_callSuper(this,t,[xi(t.getDefaults(),arguments)]);var n=xi(t.getDefaults(),arguments);return e.portamento=n.portamento,e.onsilence=n.onsilence,e}return _inherits(t,e),_createClass(t,[{key:"triggerAttack",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.log("triggerAttack",e,t,n);var r=this.toSeconds(t);return this._triggerEnvelopeAttack(r,n),this.setNote(e,r),this}},{key:"triggerRelease",value:function(e){this.log("triggerRelease",e);var t=this.toSeconds(e);return this._triggerEnvelopeRelease(t),this}},{key:"setNote",value:function(e,t){var n=this.toSeconds(t),r=e instanceof uo?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(n)>.05){var i=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(r,i,n)}else this.frequency.setValueAtTime(r,n);return this}}],[{key:"getDefaults",value:function(){return Object.assign(Ea.getDefaults(),{detune:0,onsilence:Bi,portamento:0})}}])}(Ea);di([ya(0)],qa.prototype,"portamento",void 0);var Da=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["attack","decay","sustain","release"])])).name="AmplitudeEnvelope",e._gainNode=new So({context:e.context,gain:0}),e.output=e._gainNode,e.input=e._gainNode,e._sig.connect(e._gainNode.gain),e.output=e._gainNode,e.input=e._gainNode,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._gainNode.dispose(),this}}])}(Na),Ra=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="Synth";var n=xi(t.getDefaults(),arguments);return e.oscillator=new fa(Object.assign({context:e.context,detune:n.detune,onstop:function(){return e.onsilence(e)}},n.oscillator)),e.frequency=e.oscillator.frequency,e.detune=e.oscillator.detune,e.envelope=new Da(Object.assign({context:e.context},n.envelope)),e.oscillator.chain(e.envelope,e.output),Vi(e,["oscillator","frequency","detune","envelope"]),e}return _inherits(t,e),_createClass(t,[{key:"_triggerEnvelopeAttack",value:function(e,t){if(this.envelope.triggerAttack(e,t),this.oscillator.start(e),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+r)}}},{key:"_triggerEnvelopeRelease",value:function(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.oscillator.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(qa.getDefaults(),{envelope:Object.assign(Ci(Na.getDefaults(),Object.keys(yo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(Ci(fa.getDefaults(),[].concat(_toConsumableArray(Object.keys(Wo.getDefaults())),["frequency","detune"])),{type:"triangle"})})}}])}(qa),ja=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="ModulationSynth";var n=xi(t.getDefaults(),arguments);return e._carrier=new Ra({context:e.context,oscillator:n.oscillator,envelope:n.envelope,onsilence:function(){return e.onsilence(e)},volume:-10}),e._modulator=new Ra({context:e.context,oscillator:n.modulation,envelope:n.modulationEnvelope,volume:-10}),e.oscillator=e._carrier.oscillator,e.envelope=e._carrier.envelope,e.modulation=e._modulator.oscillator,e.modulationEnvelope=e._modulator.envelope,e.frequency=new To({context:e.context,units:"frequency"}),e.detune=new To({context:e.context,value:n.detune,units:"cents"}),e.harmonicity=new oa({context:e.context,value:n.harmonicity,minValue:0}),e._modulationNode=new So({context:e.context,gain:0}),Vi(e,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"]),e}return _inherits(t,e),_createClass(t,[{key:"_triggerEnvelopeAttack",value:function(e,t){this._carrier._triggerEnvelopeAttack(e,t),this._modulator._triggerEnvelopeAttack(e,t)}},{key:"_triggerEnvelopeRelease",value:function(e){return this._carrier._triggerEnvelopeRelease(e),this._modulator._triggerEnvelopeRelease(e),this}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(qa.getDefaults(),{harmonicity:3,oscillator:Object.assign(Ci(fa.getDefaults(),[].concat(_toConsumableArray(Object.keys(Wo.getDefaults())),["frequency","detune"])),{type:"sine"}),envelope:Object.assign(Ci(Na.getDefaults(),Object.keys(yo.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign(Ci(fa.getDefaults(),[].concat(_toConsumableArray(Object.keys(Wo.getDefaults())),["frequency","detune"])),{type:"square"}),modulationEnvelope:Object.assign(Ci(Na.getDefaults(),Object.keys(yo.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}}])}(qa),za=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="AMSynth",e._modulationScale=new ia({context:e.context}),e.frequency.connect(e._carrier.frequency),e.frequency.chain(e.harmonicity,e._modulator.frequency),e.detune.fan(e._carrier.detune,e._modulator.detune),e._modulator.chain(e._modulationScale,e._modulationNode.gain),e._carrier.chain(e._modulationNode,e.output),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._modulationScale.dispose(),this}}])}(ja),Fa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type"])])).name="BiquadFilter";var n=xi(t.getDefaults(),arguments,["frequency","type"]);return e._filter=e.context.createBiquadFilter(),e.input=e.output=e._filter,e.Q=new go({context:e.context,units:"number",value:n.Q,param:e._filter.Q}),e.frequency=new go({context:e.context,units:"frequency",value:n.frequency,param:e._filter.frequency}),e.detune=new go({context:e.context,units:"cents",value:n.detune,param:e._filter.detune}),e.gain=new go({context:e.context,units:"gain",value:n.gain,param:e._filter.gain}),e.type=n.type,e}return _inherits(t,e),_createClass(t,[{key:"type",get:function(){return this._filter.type},set:function(e){Zr(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),"Invalid filter type: "+e),this._filter.type=e}},{key:"getFrequencyResponse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=new Float32Array(e),n=0;n<e;n++){var r=19980*Math.pow(n/e,2)+20;t[n]=r}var i=new Float32Array(e),o=new Float32Array(e),a=this.context.createBiquadFilter();return a.type=this.type,a.Q.value=this.Q.value,a.frequency.value=this.frequency.value,a.gain.value=this.gain.value,a.getFrequencyResponse(t,i,o),i}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}}])}(yo),La=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type","rolloff"])])).name="Filter",e.input=new So({context:e.context}),e.output=new So({context:e.context}),e._filters=[];var n=xi(t.getDefaults(),arguments,["frequency","type","rolloff"]);return e._filters=[],e.Q=new To({context:e.context,units:"positive",value:n.Q}),e.frequency=new To({context:e.context,units:"frequency",value:n.frequency}),e.detune=new To({context:e.context,units:"cents",value:n.detune}),e.gain=new To({context:e.context,units:"decibels",value:n.gain}),e._type=n.type,e.rolloff=n.rolloff,Vi(e,["detune","frequency","gain","Q"]),e}return _inherits(t,e),_createClass(t,[{key:"type",get:function(){return this._type},set:function(e){Zr(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(e),"Invalid filter type: "+e),this._type=e,this._filters.forEach((function(t){return t.type=e}))}},{key:"rolloff",get:function(){return this._rolloff},set:function(e){var t=ai(e)?e:parseInt(e,10),n=[-12,-24,-48,-96],r=n.indexOf(t);Zr(-1!==r,"rolloff can only be "+n.join(", ")),r+=1,this._rolloff=t,this.input.disconnect(),this._filters.forEach((function(e){return e.disconnect()})),this._filters=new Array(r);for(var i=0;i<r;i++){var o=new Fa({context:this.context});o.type=this._type,this.frequency.connect(o.frequency),this.detune.connect(o.detune),this.Q.connect(o.Q),this.gain.connect(o.gain),this._filters[i]=o}this._internalChannels=this._filters,_o.apply(void 0,[this.input].concat(_toConsumableArray(this._internalChannels),[this.output]))}},{key:"getFrequencyResponse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=new Fa({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(e).map((function(){return 1}));return this._filters.forEach((function(){t.getFrequencyResponse(e).forEach((function(e,t){return n[t]*=e}))})),t.dispose(),n}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._filters.forEach((function(e){e.dispose()})),Gi(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}}])}(yo),Va=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["attack","decay","sustain","release"])])).name="FrequencyEnvelope";var n=xi(t.getDefaults(),arguments,["attack","decay","sustain","release"]);return e._octaves=n.octaves,e._baseFrequency=e.toFrequency(n.baseFrequency),e._exponent=e.input=new Aa({context:e.context,value:n.exponent}),e._scale=e.output=new da({context:e.context,min:e._baseFrequency,max:e._baseFrequency*Math.pow(2,e._octaves)}),e._sig.chain(e._exponent,e._scale),e}return _inherits(t,e),_createClass(t,[{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(e){var t=this.toFrequency(e);Kr(t,0),this._baseFrequency=t,this._scale.min=this._baseFrequency,this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(e){Kr(e,0),this._octaves=e,this._scale.max=this._baseFrequency*Math.pow(2,e)}},{key:"exponent",get:function(){return this._exponent.value},set:function(e){this._exponent.value=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._exponent.dispose(),this._scale.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Na.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}}])}(Na),Ga=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="MonoSynth";var n=xi(t.getDefaults(),arguments);return e.oscillator=new fa(Object.assign(n.oscillator,{context:e.context,detune:n.detune,onstop:function(){return e.onsilence(e)}})),e.frequency=e.oscillator.frequency,e.detune=e.oscillator.detune,e.filter=new La(Object.assign(n.filter,{context:e.context})),e.filterEnvelope=new Va(Object.assign(n.filterEnvelope,{context:e.context})),e.envelope=new Da(Object.assign(n.envelope,{context:e.context})),e.oscillator.chain(e.filter,e.envelope,e.output),e.filterEnvelope.connect(e.filter.frequency),Vi(e,["oscillator","frequency","detune","filter","filterEnvelope","envelope"]),e}return _inherits(t,e),_createClass(t,[{key:"_triggerEnvelopeAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.envelope.triggerAttack(e,t),this.filterEnvelope.triggerAttack(e),this.oscillator.start(e),0===this.envelope.sustain){var n=this.toSeconds(this.envelope.attack),r=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+n+r)}}},{key:"_triggerEnvelopeRelease",value:function(e){this.envelope.triggerRelease(e),this.filterEnvelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(qa.getDefaults(),{envelope:Object.assign(Ci(Na.getDefaults(),Object.keys(yo.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign(Ci(La.getDefaults(),Object.keys(yo.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign(Ci(Va.getDefaults(),Object.keys(yo.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign(Ci(fa.getDefaults(),Object.keys(Wo.getDefaults())),{type:"sawtooth"})})}}])}(qa),Ba=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="DuoSynth";var n=xi(t.getDefaults(),arguments);return e.voice0=new Ga(Object.assign(n.voice0,{context:e.context,onsilence:function(){return e.onsilence(e)}})),e.voice1=new Ga(Object.assign(n.voice1,{context:e.context})),e.harmonicity=new oa({context:e.context,units:"positive",value:n.harmonicity}),e._vibrato=new va({frequency:n.vibratoRate,context:e.context,min:-50,max:50}),e._vibrato.start(),e.vibratoRate=e._vibrato.frequency,e._vibratoGain=new So({context:e.context,units:"normalRange",gain:n.vibratoAmount}),e.vibratoAmount=e._vibratoGain.gain,e.frequency=new To({context:e.context,units:"frequency",value:440}),e.detune=new To({context:e.context,units:"cents",value:n.detune}),e.frequency.connect(e.voice0.frequency),e.frequency.chain(e.harmonicity,e.voice1.frequency),e._vibrato.connect(e._vibratoGain),e._vibratoGain.fan(e.voice0.detune,e.voice1.detune),e.detune.fan(e.voice0.detune,e.voice1.detune),e.voice0.connect(e.output),e.voice1.connect(e.output),Vi(e,["voice0","voice1","frequency","vibratoAmount","vibratoRate"]),e}return _inherits(t,e),_createClass(t,[{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.voice0.envelope.getValueAtTime(e)+this.voice1.envelope.getValueAtTime(e)}},{key:"_triggerEnvelopeAttack",value:function(e,t){this.voice0._triggerEnvelopeAttack(e,t),this.voice1._triggerEnvelopeAttack(e,t)}},{key:"_triggerEnvelopeRelease",value:function(e){return this.voice0._triggerEnvelopeRelease(e),this.voice1._triggerEnvelopeRelease(e),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}],[{key:"getDefaults",value:function(){return wi(qa.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:wi(Ci(Ga.getDefaults(),Object.keys(qa.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:wi(Ci(Ga.getDefaults(),Object.keys(qa.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}}])}(qa),Ua=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="FMSynth";var n=xi(t.getDefaults(),arguments);return e.modulationIndex=new oa({context:e.context,value:n.modulationIndex}),e.frequency.connect(e._carrier.frequency),e.frequency.chain(e.harmonicity,e._modulator.frequency),e.frequency.chain(e.modulationIndex,e._modulationNode),e.detune.fan(e._carrier.detune,e._modulator.detune),e._modulator.connect(e._modulationNode.gain),e._modulationNode.connect(e._carrier.frequency),e._carrier.connect(e.output),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.modulationIndex.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ja.getDefaults(),{modulationIndex:10})}}])}(ja),Ha=[1,1.483,1.932,2.546,2.63,3.897],Qa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="MetalSynth",e._oscillators=[],e._freqMultipliers=[];var n=xi(t.getDefaults(),arguments);e.detune=new To({context:e.context,units:"cents",value:n.detune}),e.frequency=new To({context:e.context,units:"frequency"}),e._amplitude=new So({context:e.context,gain:0}).connect(e.output),e._highpass=new La({Q:0,context:e.context,type:"highpass"}).connect(e._amplitude);for(var r=0;r<Ha.length;r++){var i=new sa({context:e.context,harmonicity:n.harmonicity,modulationIndex:n.modulationIndex,modulationType:"square",onstop:0===r?function(){return e.onsilence(e)}:Bi,type:"square"});i.connect(e._highpass),e._oscillators[r]=i;var o=new oa({context:e.context,value:Ha[r]});e._freqMultipliers[r]=o,e.frequency.chain(o,i.frequency),e.detune.connect(i.detune)}return e._filterFreqScaler=new da({context:e.context,max:7e3,min:e.toFrequency(n.resonance)}),e.envelope=new Na({attack:n.envelope.attack,attackCurve:"linear",context:e.context,decay:n.envelope.decay,release:n.envelope.release,sustain:0}),e.envelope.chain(e._filterFreqScaler,e._highpass.frequency),e.envelope.connect(e._amplitude.gain),e._octaves=n.octaves,e.octaves=n.octaves,e}return _inherits(t,e),_createClass(t,[{key:"_triggerEnvelopeAttack",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.envelope.triggerAttack(e,n),this._oscillators.forEach((function(t){return t.start(e)})),0===this.envelope.sustain&&this._oscillators.forEach((function(n){n.stop(e+t.toSeconds(t.envelope.attack)+t.toSeconds(t.envelope.decay))})),this}},{key:"_triggerEnvelopeRelease",value:function(e){var t=this;return this.envelope.triggerRelease(e),this._oscillators.forEach((function(n){return n.stop(e+t.toSeconds(t.envelope.release))})),this}},{key:"getLevelAtTime",value:function(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}},{key:"modulationIndex",get:function(){return this._oscillators[0].modulationIndex.value},set:function(e){this._oscillators.forEach((function(t){return t.modulationIndex.value=e}))}},{key:"harmonicity",get:function(){return this._oscillators[0].harmonicity.value},set:function(e){this._oscillators.forEach((function(t){return t.harmonicity.value=e}))}},{key:"resonance",get:function(){return this._filterFreqScaler.min},set:function(e){this._filterFreqScaler.min=this.toFrequency(e),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._oscillators.forEach((function(e){return e.dispose()})),this._freqMultipliers.forEach((function(e){return e.dispose()})),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}],[{key:"getDefaults",value:function(){return wi(qa.getDefaults(),{envelope:Object.assign(Ci(Na.getDefaults(),Object.keys(yo.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}}])}(qa),Wa=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="MembraneSynth",e.portamento=0;var n=xi(t.getDefaults(),arguments);return e.pitchDecay=n.pitchDecay,e.octaves=n.octaves,Vi(e,["oscillator","envelope"]),e}return _inherits(t,e),_createClass(t,[{key:"setNote",value:function(e,t){var n=this.toSeconds(t),r=this.toFrequency(e instanceof uo?e.toFrequency():e),i=r*this.octaves;return this.oscillator.frequency.setValueAtTime(i,n),this.oscillator.frequency.exponentialRampToValueAtTime(r,n+this.toSeconds(this.pitchDecay)),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this}}],[{key:"getDefaults",value:function(){return wi(qa.getDefaults(),Ra.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}}])}(Ra);di([ga(0)],Wa.prototype,"octaves",void 0),di([ya(0)],Wa.prototype,"pitchDecay",void 0);var Ya=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="NoiseSynth";var n=xi(t.getDefaults(),arguments);return e.noise=new Xo(Object.assign({context:e.context},n.noise)),e.envelope=new Da(Object.assign({context:e.context},n.envelope)),e.noise.chain(e.envelope,e.output),e}return _inherits(t,e),_createClass(t,[{key:"triggerAttack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return e=this.toSeconds(e),this.envelope.triggerAttack(e,t),this.noise.start(e),0===this.envelope.sustain&&this.noise.stop(e+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}},{key:"triggerRelease",value:function(e){return e=this.toSeconds(e),this.envelope.triggerRelease(e),this.noise.stop(e+this.toSeconds(this.envelope.release)),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}},{key:"triggerAttackRelease",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return t=this.toSeconds(t),e=this.toSeconds(e),this.triggerAttack(t,n),this.triggerRelease(t+e),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.noise.dispose(),this.envelope.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Ea.getDefaults(),{envelope:Object.assign(Ci(Na.getDefaults(),Object.keys(yo.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign(Ci(Xo.getDefaults(),Object.keys(Wo.getDefaults())),{type:"white"})})}}])}(Ea),Xa=new Set;function Za(e){Xa.add(e)}function Ka(e,t){var n='registerProcessor("'.concat(e,'", ').concat(t,")");Xa.add(n)}var Ja=function(e){function t(e){var n;_classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="ToneAudioWorklet",n.workletOptions={},n.onprocessorerror=Bi;var r=URL.createObjectURL(new Blob([Array.from(Xa).join("\n")],{type:"text/javascript"})),i=n._audioWorkletName();return n._dummyGain=n.context.createGain(),n._dummyParam=n._dummyGain.gain,n.context.addAudioWorkletModule(r,i).then((function(){n.disposed||(n._worklet=n.context.createAudioWorkletNode(i,n.workletOptions),n._worklet.onprocessorerror=n.onprocessorerror.bind(n),n.onReady(n._worklet))})),n}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}])}(yo);Za('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n'),Za("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n"),Za("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n"),Ka("feedback-comb-filter",'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');var $a=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["delayTime","resonance"])])).name="FeedbackCombFilter";var n=xi(t.getDefaults(),arguments,["delayTime","resonance"]);return e.input=new So({context:e.context}),e.output=new So({context:e.context}),e.delayTime=new go({context:e.context,value:n.delayTime,units:"time",minValue:0,maxValue:1,param:e._dummyParam,swappable:!0}),e.resonance=new go({context:e.context,value:n.resonance,units:"normalRange",param:e._dummyParam,swappable:!0}),Vi(e,["resonance","delayTime"]),e}return _inherits(t,e),_createClass(t,[{key:"_audioWorkletName",value:function(){return"feedback-comb-filter"}},{key:"onReady",value:function(e){_o(this.input,e,this.output);var t=e.parameters.get("delayTime");this.delayTime.setParam(t);var n=e.parameters.get("feedback");this.resonance.setParam(n)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{delayTime:.1,resonance:.5})}}])}(Ja),es=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","type"])])).name="OnePoleFilter";var n=xi(t.getDefaults(),arguments,["frequency","type"]);return e._frequency=n.frequency,e._type=n.type,e.input=new So({context:e.context}),e.output=new So({context:e.context}),e._createFilter(),e}return _inherits(t,e),_createClass(t,[{key:"_createFilter",value:function(){var e=this,t=this._filter,n=this.toFrequency(this._frequency),r=1/(2*Math.PI*n);if("lowpass"===this._type){var i=1/(r*this.context.sampleRate),o=i-1;this._filter=this.context.createIIRFilter([i,0],[1,o])}else{var a=1/(r*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,a])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((function(){e.disposed||(e.input.disconnect(t),t.disconnect())}),this.blockTime)}},{key:"frequency",get:function(){return this._frequency},set:function(e){this._frequency=e,this._createFilter()}},{key:"type",get:function(){return this._type},set:function(e){this._type=e,this._createFilter()}},{key:"getFrequencyResponse",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,t=new Float32Array(e),n=0;n<e;n++){var r=19980*Math.pow(n/e,2)+20;t[n]=r}var i=new Float32Array(e),o=new Float32Array(e);return this._filter.getFrequencyResponse(t,i,o),i}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{frequency:880,type:"lowpass"})}}])}(yo),ts=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["delayTime","resonance","dampening"])])).name="LowpassCombFilter";var n=xi(t.getDefaults(),arguments,["delayTime","resonance","dampening"]);return e._combFilter=e.output=new $a({context:e.context,delayTime:n.delayTime,resonance:n.resonance}),e.delayTime=e._combFilter.delayTime,e.resonance=e._combFilter.resonance,e._lowpass=e.input=new es({context:e.context,frequency:n.dampening,type:"lowpass"}),e._lowpass.connect(e._combFilter),e}return _inherits(t,e),_createClass(t,[{key:"dampening",get:function(){return this._lowpass.frequency},set:function(e){this._lowpass.frequency=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._combFilter.dispose(),this._lowpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}}])}(yo),ns=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="PluckSynth";var n=xi(t.getDefaults(),arguments);return e._noise=new Xo({context:e.context,type:"pink"}),e.attackNoise=n.attackNoise,e._lfcf=new ts({context:e.context,dampening:n.dampening,resonance:n.resonance}),e.resonance=n.resonance,e.release=n.release,e._noise.connect(e._lfcf),e._lfcf.connect(e.output),e}return _inherits(t,e),_createClass(t,[{key:"dampening",get:function(){return this._lfcf.dampening},set:function(e){this._lfcf.dampening=e}},{key:"triggerAttack",value:function(e,t){var n=this.toFrequency(e);t=this.toSeconds(t);var r=1/n;return this._lfcf.delayTime.setValueAtTime(r,t),this._noise.start(t),this._noise.stop(t+r*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(t),this._lfcf.resonance.setValueAtTime(this.resonance,t),this}},{key:"triggerRelease",value:function(e){return this._lfcf.resonance.linearRampTo(0,this.release,e),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._noise.dispose(),this._lfcf.dispose(),this}}],[{key:"getDefaults",value:function(){return wi(Ea.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}}])}(Ea),rs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["voice","options"])])).name="PolySynth",e._availableVoices=[],e._activeVoices=[],e._voices=[],e._gcTimeout=-1,e._averageActiveVoices=0;var n=xi(t.getDefaults(),arguments,["voice","options"]);Zr(!ai(n.voice),"DEPRECATED: The polyphony count is no longer the first argument.");var r=n.voice.getDefaults();e.options=Object.assign(r,n.options),e.voice=n.voice,e.maxPolyphony=n.maxPolyphony,e._dummyVoice=e._getNextAvailableVoice();var i=e._voices.indexOf(e._dummyVoice);return e._voices.splice(i,1),e._gcTimeout=e.context.setInterval(e._collectGarbage.bind(e),1),e}return _inherits(t,e),_createClass(t,[{key:"activeVoices",get:function(){return this._activeVoices.length}},{key:"_makeVoiceAvailable",value:function(e){this._availableVoices.push(e);var t=this._activeVoices.findIndex((function(t){return t.voice===e}));this._activeVoices.splice(t,1)}},{key:"_getNextAvailableVoice",value:function(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){var e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return e.connect(this.output),this._voices.push(e),e}ni("Max polyphony exceeded. Note dropped.")}},{key:"_collectGarbage",value:function(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){var e=this._availableVoices.shift(),t=this._voices.indexOf(e);this._voices.splice(t,1),this.context.isOffline||e.dispose()}}},{key:"_triggerAttack",value:function(e,t,n){var r=this;e.forEach((function(e){var i=new qo(r.context,e).toMidi(),o=r._getNextAvailableVoice();o&&(o.triggerAttack(e,t,n),r._activeVoices.push({midi:i,voice:o,released:!1}),r.log("triggerAttack",e,t))}))}},{key:"_triggerRelease",value:function(e,t){var n=this;e.forEach((function(e){var r=new qo(n.context,e).toMidi(),i=n._activeVoices.find((function(e){var t=e.midi,n=e.released;return t===r&&!n}));i&&(i.voice.triggerRelease(t),i.released=!0,n.log("triggerRelease",e,t))}))}},{key:"_scheduleEvent",value:function(e,t,n,r){var i=this;Zr(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===e?this._triggerAttack(t,n,r):this._triggerRelease(t,n):this.context.setTimeout((function(){i._scheduleEvent(e,t,n,r)}),n-this.now())}},{key:"triggerAttack",value:function(e,t,n){Array.isArray(e)||(e=[e]);var r=this.toSeconds(t);return this._scheduleEvent("attack",e,r,n),this}},{key:"triggerRelease",value:function(e,t){Array.isArray(e)||(e=[e]);var n=this.toSeconds(t);return this._scheduleEvent("release",e,n),this}},{key:"triggerAttackRelease",value:function(e,t,n,r){var i=this.toSeconds(n);if(this.triggerAttack(e,i,r),ci(t)){Zr(ci(e),"If the duration is an array, the notes must also be an array");for(var o=0;o<e.length;o++){var a=t[Math.min(o,t.length-1)],s=this.toSeconds(a);Zr(s>0,"The duration must be greater than 0"),this.triggerRelease(e[o],i+s)}}else{var u=this.toSeconds(t);Zr(u>0,"The duration must be greater than 0"),this.triggerRelease(e,i+u)}return this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}},{key:"set",value:function(e){var t=Ci(e,["onsilence","context"]);return this.options=wi(this.options,t),this._voices.forEach((function(e){return e.set(t)})),this._dummyVoice.set(t),this}},{key:"get",value:function(){return this._dummyVoice.get()}},{key:"releaseAll",value:function(e){var t=this.toSeconds(e);return this._activeVoices.forEach((function(e){e.voice.triggerRelease(t)})),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._dummyVoice.dispose(),this._voices.forEach((function(e){return e.dispose()})),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}],[{key:"getDefaults",value:function(){return Object.assign(Ea.getDefaults(),{maxPolyphony:32,options:{},voice:Ra})}}])}(Ea),is=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")])).name="Sampler",e._activeSources=new Map;var n=xi(t.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),r={};return Object.keys(n.urls).forEach((function(t){var i=parseInt(t,10);if(Zr(hi(t)||ai(i)&&isFinite(i),"url key is neither a note or midi pitch: "+t),hi(t)){var o=new uo(e.context,t).toMidi();r[o]=n.urls[t]}else ai(i)&&isFinite(i)&&(r[i]=n.urls[i])})),e._buffers=new Eo({urls:r,onload:n.onload,baseUrl:n.baseUrl,onerror:n.onerror}),e.attack=n.attack,e.release=n.release,e.curve=n.curve,e._buffers.loaded&&Promise.resolve().then(n.onload),e}return _inherits(t,e),_createClass(t,[{key:"_findClosest",value:function(e){for(var t=0;t<96;){if(this._buffers.has(e+t))return-t;if(this._buffers.has(e-t))return t;t++}throw new Error("No available buffers for note: "+e)}},{key:"triggerAttack",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.log("triggerAttack",e,t,r),Array.isArray(e)||(e=[e]),e.forEach((function(e){var i=ro(new uo(n.context,e).toFrequency()),o=Math.round(i),a=i-o,s=n._findClosest(o),u=o-s,c=n._buffers.get(u),l=eo(s+a),h=new Yo({url:c,context:n.context,curve:n.curve,fadeIn:n.attack,fadeOut:n.release,playbackRate:l}).connect(n.output);h.start(t,0,c.duration/l,r),ci(n._activeSources.get(o))||n._activeSources.set(o,[]),n._activeSources.get(o).push(h),h.onended=function(){if(n._activeSources&&n._activeSources.has(o)){var e=n._activeSources.get(o),t=e.indexOf(h);-1!==t&&e.splice(t,1)}}})),this}},{key:"triggerRelease",value:function(e,t){var n=this;return this.log("triggerRelease",e,t),Array.isArray(e)||(e=[e]),e.forEach((function(e){var r=new uo(n.context,e).toMidi();if(n._activeSources.has(r)&&n._activeSources.get(r).length){var i=n._activeSources.get(r);t=n.toSeconds(t),i.forEach((function(e){e.stop(t)})),n._activeSources.set(r,[])}})),this}},{key:"releaseAll",value:function(e){var t=this.toSeconds(e);return this._activeSources.forEach((function(e){for(;e.length;)e.shift().stop(t)})),this}},{key:"sync",value:function(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}},{key:"triggerAttackRelease",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=this.toSeconds(n);return this.triggerAttack(e,o,i),ci(t)?(Zr(ci(e),"notes must be an array when duration is array"),e.forEach((function(e,n){var i=t[Math.min(n,t.length-1)];r.triggerRelease(e,o+r.toSeconds(i))}))):this.triggerRelease(e,o+this.toSeconds(t)),this}},{key:"add",value:function(e,t,n){if(Zr(hi(e)||isFinite(e),"note must be a pitch or midi: "+e),hi(e)){var r=new uo(this.context,e).toMidi();this._buffers.add(r,t,n)}else this._buffers.add(e,t,n);return this}},{key:"loaded",get:function(){return this._buffers.loaded}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._buffers.dispose(),this._activeSources.forEach((function(e){e.forEach((function(e){return e.dispose()}))})),this._activeSources.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Ea.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:Bi,onerror:Bi,release:.1,urls:{}})}}])}(Ea);di([ya(0)],is.prototype,"attack",void 0),di([ya(0)],is.prototype,"release",void 0);var os=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["callback","value"])])).name="ToneEvent",e._state=new vo("stopped"),e._startOffset=0;var n=xi(t.getDefaults(),arguments,["callback","value"]);return e._loop=n.loop,e.callback=n.callback,e.value=n.value,e._loopStart=e.toTicks(n.loopStart),e._loopEnd=e.toTicks(n.loopEnd),e._playbackRate=n.playbackRate,e._probability=n.probability,e._humanize=n.humanize,e.mute=n.mute,e._playbackRate=n.playbackRate,e._state.increasing=!0,e._rescheduleEvents(),e}return _inherits(t,e),_createClass(t,[{key:"_rescheduleEvents",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._state.forEachFrom(t,(function(t){var n;if("started"===t.state){-1!==t.id&&e.context.transport.clear(t.id);var r=t.time+Math.round(e.startOffset/e._playbackRate);if(!0===e._loop||ai(e._loop)&&e._loop>1){n=1/0,ai(e._loop)&&(n=e._loop*e._getLoopDuration());var i=e._state.getAfter(r);null!==i&&(n=Math.min(n,i.time-r)),n!==1/0&&(e._state.setStateAtTime("stopped",r+n+1,{id:-1}),n=new Ro(e.context,n));var o=new Ro(e.context,e._getLoopDuration());t.id=e.context.transport.scheduleRepeat(e._tick.bind(e),o,new Ro(e.context,r),n)}else t.id=e.context.transport.schedule(e._tick.bind(e),new Ro(e.context,r))}}))}},{key:"state",get:function(){return this._state.getValueAtTime(this.context.transport.ticks)}},{key:"startOffset",get:function(){return this._startOffset},set:function(e){this._startOffset=e}},{key:"probability",get:function(){return this._probability},set:function(e){this._probability=e}},{key:"humanize",get:function(){return this._humanize},set:function(e){this._humanize=e}},{key:"start",value:function(e){var t=this.toTicks(e);return"stopped"===this._state.getValueAtTime(t)&&(this._state.add({id:-1,state:"started",time:t}),this._rescheduleEvents(t)),this}},{key:"stop",value:function(e){this.cancel(e);var t=this.toTicks(e);if("started"===this._state.getValueAtTime(t)){this._state.setStateAtTime("stopped",t,{id:-1});var n=this._state.getBefore(t),r=t;null!==n&&(r=n.time),this._rescheduleEvents(r)}return this}},{key:"cancel",value:function(e){var t=this;e=Ti(e,-1/0);var n=this.toTicks(e);return this._state.forEachFrom(n,(function(e){t.context.transport.clear(e.id)})),this._state.cancel(n),this}},{key:"_tick",value:function(e){var t=this.context.transport.getTicksAtTime(e);if(!this.mute&&"started"===this._state.getValueAtTime(t)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){var n=.02;ui(this.humanize)||(n=this.toSeconds(this.humanize)),e+=(2*Math.random()-1)*n}this.callback(e,this.value)}}},{key:"_getLoopDuration",value:function(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}},{key:"loop",get:function(){return this._loop},set:function(e){this._loop=e,this._rescheduleEvents()}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._rescheduleEvents()}},{key:"loopEnd",get:function(){return new Ro(this.context,this._loopEnd).toSeconds()},set:function(e){this._loopEnd=this.toTicks(e),this._loop&&this._rescheduleEvents()}},{key:"loopStart",get:function(){return new Ro(this.context,this._loopStart).toSeconds()},set:function(e){this._loopStart=this.toTicks(e),this._loop&&this._rescheduleEvents()}},{key:"progress",get:function(){if(this._loop){var e=this.context.transport.ticks,t=this._state.get(e);if(null!==t&&"started"===t.state){var n=this._getLoopDuration();return(e-t.time)%n/n}return 0}return 0}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.cancel(),this._state.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(mo.getDefaults(),{callback:Bi,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}}])}(mo),as=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["callback","interval"])])).name="Loop";var n=xi(t.getDefaults(),arguments,["callback","interval"]);return e._event=new os({context:e.context,callback:e._tick.bind(e),loop:!0,loopEnd:n.interval,playbackRate:n.playbackRate,probability:n.probability}),e.callback=n.callback,e.iterations=n.iterations,e}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e){return this._event.start(e),this}},{key:"stop",value:function(e){return this._event.stop(e),this}},{key:"cancel",value:function(e){return this._event.cancel(e),this}},{key:"_tick",value:function(e){this.callback(e)}},{key:"state",get:function(){return this._event.state}},{key:"progress",get:function(){return this._event.progress}},{key:"interval",get:function(){return this._event.loopEnd},set:function(e){this._event.loopEnd=e}},{key:"playbackRate",get:function(){return this._event.playbackRate},set:function(e){this._event.playbackRate=e}},{key:"humanize",get:function(){return this._event.humanize},set:function(e){this._event.humanize=e}},{key:"probability",get:function(){return this._event.probability},set:function(e){this._event.probability=e}},{key:"mute",get:function(){return this._event.mute},set:function(e){this._event.mute=e}},{key:"iterations",get:function(){return!0===this._event.loop?1/0:this._event.loop},set:function(e){this._event.loop=e===1/0||e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._event.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(mo.getDefaults(),{interval:"4n",callback:Bi,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}}])}(mo),ss=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["callback","events"])])).name="Part",e._state=new vo("stopped"),e._events=new Set;var n=xi(t.getDefaults(),arguments,["callback","events"]);return e._state.increasing=!0,n.events.forEach((function(t){ci(t)?e.add(t[0],t[1]):e.add(t)})),e}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e,t){var n=this,r=this.toTicks(e);if("started"!==this._state.getValueAtTime(r)){t=Ti(t,this._loop?this._loopStart:0),t=this._loop?Ti(t,this._loopStart):Ti(t,0);var i=this.toTicks(t);this._state.add({id:-1,offset:i,state:"started",time:r}),this._forEach((function(e){n._startNote(e,r,i)}))}return this}},{key:"_startNote",value:function(e,t,n){t-=n,this._loop?e.startOffset>=this._loopStart&&e.startOffset<this._loopEnd?(e.startOffset<n&&(t+=this._getLoopDuration()),e.start(new Ro(this.context,t))):e.startOffset<this._loopStart&&e.startOffset>=n&&(e.loop=!1,e.start(new Ro(this.context,t))):e.startOffset>=n&&e.start(new Ro(this.context,t))}},{key:"startOffset",get:function(){return this._startOffset},set:function(e){var t=this;this._startOffset=e,this._forEach((function(e){e.startOffset+=t._startOffset}))}},{key:"stop",value:function(e){var t=this.toTicks(e);return this._state.cancel(t),this._state.setStateAtTime("stopped",t),this._forEach((function(t){t.stop(e)})),this}},{key:"at",value:function(e,t){for(var n=new fo(this.context,e).toTicks(),r=new Ro(this.context,1).toSeconds(),i=this._events.values(),o=i.next();!o.done;){var a=o.value;if(Math.abs(n-a.startOffset)<r)return ii(t)&&(a.value=t),a;o=i.next()}return ii(t)?(this.add(e,t),this.at(e)):null}},{key:"add",value:function(e,t){e instanceof Object&&Reflect.has(e,"time")&&(e=(t=e).time);var n,r=this.toTicks(e);return t instanceof os?(n=t).callback=this._tick.bind(this):n=new os({callback:this._tick.bind(this),context:this.context,value:t}),n.startOffset=r,n.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(n),this._restartEvent(n),this}},{key:"_restartEvent",value:function(e){var t=this;this._state.forEach((function(n){"started"===n.state?t._startNote(e,n.time,n.offset):e.stop(new Ro(t.context,n.time))}))}},{key:"remove",value:function(e,t){var n=this;return si(e)&&e.hasOwnProperty("time")&&(e=(t=e).time),e=this.toTicks(e),this._events.forEach((function(r){r.startOffset===e&&(ri(t)||ii(t)&&r.value===t)&&(n._events.delete(r),r.dispose())})),this}},{key:"clear",value:function(){return this._forEach((function(e){return e.dispose()})),this._events.clear(),this}},{key:"cancel",value:function(e){return this._forEach((function(t){return t.cancel(e)})),this._state.cancel(this.toTicks(e)),this}},{key:"_forEach",value:function(e){return this._events&&this._events.forEach((function(n){n instanceof t?n._forEach(e):e(n)})),this}},{key:"_setAll",value:function(e,t){this._forEach((function(n){n[e]=t}))}},{key:"_tick",value:function(e,t){this.mute||this.callback(e,t)}},{key:"_testLoopBoundries",value:function(e){this._loop&&(e.startOffset<this._loopStart||e.startOffset>=this._loopEnd)?e.cancel(0):"stopped"===e.state&&this._restartEvent(e)}},{key:"probability",get:function(){return this._probability},set:function(e){this._probability=e,this._setAll("probability",e)}},{key:"humanize",get:function(){return this._humanize},set:function(e){this._humanize=e,this._setAll("humanize",e)}},{key:"loop",get:function(){return this._loop},set:function(e){var t=this;this._loop=e,this._forEach((function(n){n.loopStart=t.loopStart,n.loopEnd=t.loopEnd,n.loop=e,t._testLoopBoundries(n)}))}},{key:"loopEnd",get:function(){return new Ro(this.context,this._loopEnd).toSeconds()},set:function(e){var t=this;this._loopEnd=this.toTicks(e),this._loop&&this._forEach((function(n){n.loopEnd=e,t._testLoopBoundries(n)}))}},{key:"loopStart",get:function(){return new Ro(this.context,this._loopStart).toSeconds()},set:function(e){var t=this;this._loopStart=this.toTicks(e),this._loop&&this._forEach((function(e){e.loopStart=t.loopStart,t._testLoopBoundries(e)}))}},{key:"playbackRate",get:function(){return this._playbackRate},set:function(e){this._playbackRate=e,this._setAll("playbackRate",e)}},{key:"length",get:function(){return this._events.size}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.clear(),this}}],[{key:"getDefaults",value:function(){return Object.assign(os.getDefaults(),{events:[]})}}])}(os);function us(e){var t;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=0;case 1:if(!(t<e.length)){n.next=8;break}return t=hs(t,e),n.next=5,e[t];case 5:t++;case 6:n.next=1;break;case 8:case"end":return n.stop()}}),r)}function cs(e){var t;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=e.length-1;case 1:if(!(t>=0)){n.next=8;break}return t=hs(t,e),n.next=5,e[t];case 5:t--;case 6:n.next=1;break;case 8:case"end":return n.stop()}}),i)}function ls(e,t){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.delegateYield(t(e),"t0",1);case 1:n.next=0;break;case 3:case"end":return n.stop()}}),o)}function hs(e,t){return Ii(e,0,t.length-1)}function fs(e,t){var n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:n=t?0:e.length-1;case 1:return n=hs(n,e),r.next=4,e[n];case 4:t?++n>=e.length-1&&(t=!1):--n<=0&&(t=!0);case 5:r.next=1;break;case 7:case"end":return r.stop()}}),a)}function ps(e){var t,n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=0,n=0;case 1:if(!(t<e.length)){r.next=9;break}return t=hs(t,e),r.next=5,e[t];case 5:n++,t+=n%2?2:-1;case 7:r.next=1;break;case 9:case"end":return r.stop()}}),s)}function ds(e){var t,n;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=e.length-1,n=0;case 1:if(!(t>=0)){r.next=9;break}return t=hs(t,e),r.next=5,e[t];case 5:n++,t+=n%2?-2:1;case 7:r.next=1;break;case 9:case"end":return r.stop()}}),u)}function ms(e){var t,n,r;return _regeneratorRuntime().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:for(t=[],n=0;n<e.length;n++)t.push(n);case 2:if(!(t.length>0)){i.next=8;break}return r=hs(t.splice(Math.floor(t.length*Math.random()),1)[0],e),i.next=6,e[r];case 6:i.next=2;break;case 8:case"end":return i.stop()}}),c)}function vs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"up";return _regeneratorRuntime().mark((function n(){return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:n.t0=(Zr(e.length>0,"The array must have more than one value in it"),t),n.next="up"===n.t0?3:"down"===n.t0?4:"upDown"===n.t0?5:"downUp"===n.t0?6:"alternateUp"===n.t0?7:"alternateDown"===n.t0?8:"random"===n.t0?9:"randomOnce"===n.t0?10:"randomWalk"===n.t0?11:12;break;case 3:return n.delegateYield(ls(e,us),"t1",4);case 4:return n.delegateYield(ls(e,cs),"t2",5);case 5:return n.delegateYield(fs(e,!0),"t3",6);case 6:return n.delegateYield(fs(e,!1),"t4",7);case 7:return n.delegateYield(ls(e,ps),"t5",8);case 8:return n.delegateYield(ls(e,ds),"t6",9);case 9:return n.delegateYield(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Math.floor(Math.random()*t.length),e.next=3,t[n];case 3:e.next=0;break;case 5:case"end":return e.stop()}}),e)}))(e),"t7",10);case 10:return n.delegateYield(ls(e,ms),"t8",11);case 11:return n.delegateYield(_regeneratorRuntime().mark((function e(t){var n;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Math.floor(Math.random()*t.length);case 1:return 0===n?n++:n===t.length-1||Math.random()<.5?n--:n++,e.next=4,t[n];case 4:e.next=1;break;case 6:case"end":return e.stop()}}),e)}))(e),"t9",12);case 12:case"end":return n.stop()}}),n)}))()}var gs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["callback","values","pattern"])])).name="Pattern";var n=xi(t.getDefaults(),arguments,["callback","values","pattern"]);return e.callback=n.callback,e._values=n.values,e._pattern=vs(n.values,n.pattern),e._type=n.pattern,e}return _inherits(t,e),_createClass(t,[{key:"_tick",value:function(e){var t=this._pattern.next();this._value=t.value,this.callback(e,this._value)}},{key:"values",get:function(){return this._values},set:function(e){this._values=e,this.pattern=this._type}},{key:"value",get:function(){return this._value}},{key:"pattern",get:function(){return this._type},set:function(e){this._type=e,this._pattern=vs(this._values,this._type)}}],[{key:"getDefaults",value:function(){return Object.assign(as.getDefaults(),{pattern:"up",values:[],callback:Bi})}}])}(as),ys=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["callback","events","subdivision"])])).name="Sequence",e._part=new ss({callback:e._seqCallback.bind(_assertThisInitialized(e)),context:e.context}),e._events=[],e._eventsArray=[];var n=xi(t.getDefaults(),arguments,["callback","events","subdivision"]);return e._subdivision=e.toTicks(n.subdivision),e.events=n.events,e.loop=n.loop,e.loopStart=n.loopStart,e.loopEnd=n.loopEnd,e.playbackRate=n.playbackRate,e.probability=n.probability,e.humanize=n.humanize,e.mute=n.mute,e.playbackRate=n.playbackRate,e}return _inherits(t,e),_createClass(t,[{key:"_seqCallback",value:function(e,t){null!==t&&this.callback(e,t)}},{key:"events",get:function(){return this._events},set:function(e){this.clear(),this._eventsArray=e,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}},{key:"start",value:function(e,t){return this._part.start(e,t?this._indexTime(t):t),this}},{key:"stop",value:function(e){return this._part.stop(e),this}},{key:"subdivision",get:function(){return new Ro(this.context,this._subdivision).toSeconds()}},{key:"_createSequence",value:function(e){var t=this;return new Proxy(e,{get:function(e,t){return e[t]},set:function(e,n,r){return li(n)&&isFinite(parseInt(n,10))&&ci(r)?e[n]=t._createSequence(r):e[n]=r,t._eventsUpdated(),!0}})}},{key:"_eventsUpdated",value:function(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}},{key:"_rescheduleSequence",value:function(e,t,n){var r=this;e.forEach((function(e,i){var o=i*t+n;if(ci(e))r._rescheduleSequence(e,t/e.length,o);else{var a=new Ro(r.context,o,"i").toSeconds();r._part.add(a,e)}}))}},{key:"_indexTime",value:function(e){return new Ro(this.context,e*this._subdivision+this.startOffset).toSeconds()}},{key:"clear",value:function(){return this._part.clear(),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._part.dispose(),this}},{key:"loop",get:function(){return this._part.loop},set:function(e){this._part.loop=e}},{key:"loopStart",get:function(){return this._loopStart},set:function(e){this._loopStart=e,this._part.loopStart=this._indexTime(e)}},{key:"loopEnd",get:function(){return this._loopEnd},set:function(e){this._loopEnd=e,this._part.loopEnd=0===e?this._indexTime(this._eventsArray.length):this._indexTime(e)}},{key:"startOffset",get:function(){return this._part.startOffset},set:function(e){this._part.startOffset=e}},{key:"playbackRate",get:function(){return this._part.playbackRate},set:function(e){this._part.playbackRate=e}},{key:"probability",get:function(){return this._part.probability},set:function(e){this._part.probability=e}},{key:"progress",get:function(){return this._part.progress}},{key:"humanize",get:function(){return this._part.humanize},set:function(e){this._part.humanize=e}},{key:"length",get:function(){return this._part.length}}],[{key:"getDefaults",value:function(){return Object.assign(Ci(os.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}}])}(os),_s=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["fade"]))])).name="CrossFade",e._panner=e.context.createStereoPanner(),e._split=e.context.createChannelSplitter(2),e._g2a=new wa({context:e.context}),e.a=new So({context:e.context,gain:0}),e.b=new So({context:e.context,gain:0}),e.output=new So({context:e.context}),e._internalChannels=[e.a,e.b];var n=xi(t.getDefaults(),arguments,["fade"]);return e.fade=new To({context:e.context,units:"normalRange",value:n.fade}),Vi(e,"fade"),e.context.getConstant(1).connect(e._panner),e._panner.connect(e._split),e._panner.channelCount=1,e._panner.channelCountMode="explicit",ko(e._split,e.a.gain,0),ko(e._split,e.b.gain,1),e.fade.chain(e._g2a,e._panner.pan),e.a.connect(e.output),e.b.connect(e.output),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{fade:.5})}}])}(yo),ks=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="Effect",n._dryWet=new _s({context:n.context}),n.wet=n._dryWet.fade,n.effectSend=new So({context:n.context}),n.effectReturn=new So({context:n.context}),n.input=new So({context:n.context}),n.output=n._dryWet,n.input.fan(n._dryWet.a,n.effectSend),n.effectReturn.connect(n._dryWet.b),n.wet.setValueAtTime(e.wet,0),n._internalChannels=[n.effectReturn,n.effectSend],Vi(_assertThisInitialized(n),"wet"),n}return _inherits(t,e),_createClass(t,[{key:"connectEffect",value:function(e){return this._internalChannels.push(e),this.effectSend.chain(e,this.effectReturn),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{wet:1})}}])}(yo),bs=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="LFOEffect",n._lfo=new va({context:n.context,frequency:e.frequency,amplitude:e.depth}),n.depth=n._lfo.amplitude,n.frequency=n._lfo.frequency,n.type=e.type,Vi(_assertThisInitialized(n),["frequency","depth"]),n}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e){return this._lfo.start(e),this}},{key:"stop",value:function(e){return this._lfo.stop(e),this}},{key:"sync",value:function(){return this._lfo.sync(),this}},{key:"unsync",value:function(){return this._lfo.unsync(),this}},{key:"type",get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{frequency:1,type:"sine",depth:1})}}])}(ks),Ss=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","baseFrequency","octaves"])])).name="AutoFilter";var n=xi(t.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);return e.filter=new La(Object.assign(n.filter,{context:e.context})),e.connectEffect(e.filter),e._lfo.connect(e.filter.frequency),e.octaves=n.octaves,e.baseFrequency=n.baseFrequency,e}return _inherits(t,e),_createClass(t,[{key:"baseFrequency",get:function(){return this._lfo.min},set:function(e){this._lfo.min=this.toFrequency(e),this.octaves=this._octaves}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._lfo.max=this._lfo.min*Math.pow(2,e)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.filter.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(bs.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}}])}(bs),ws=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["pan"]))])).name="Panner",e._panner=e.context.createStereoPanner(),e.input=e._panner,e.output=e._panner;var n=xi(t.getDefaults(),arguments,["pan"]);return e.pan=new go({context:e.context,param:e._panner.pan,value:n.pan,minValue:-1,maxValue:1}),e._panner.channelCount=n.channelCount,e._panner.channelCountMode="explicit",Vi(e,"pan"),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._panner.disconnect(),this.pan.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{pan:0,channelCount:1})}}])}(yo),xs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency"])])).name="AutoPanner";var n=xi(t.getDefaults(),arguments,["frequency"]);return e._panner=new ws({context:e.context,channelCount:n.channelCount}),e.connectEffect(e._panner),e._lfo.connect(e._panner.pan),e._lfo.min=-1,e._lfo.max=1,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._panner.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(bs.getDefaults(),{channelCount:1})}}])}(bs),Ts=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["smoothing"])])).name="Follower";var n=xi(t.getDefaults(),arguments,["smoothing"]);return e._abs=e.input=new Sa({context:e.context}),e._lowpass=e.output=new es({context:e.context,frequency:1/e.toSeconds(n.smoothing),type:"lowpass"}),e._abs.connect(e._lowpass),e._smoothing=n.smoothing,e}return _inherits(t,e),_createClass(t,[{key:"smoothing",get:function(){return this._smoothing},set:function(e){this._smoothing=e,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._abs.dispose(),this._lowpass.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{smoothing:.05})}}])}(yo),Cs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])])).name="AutoWah";var n=xi(t.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);return e._follower=new Ts({context:e.context,smoothing:n.follower}),e._sweepRange=new Oa({context:e.context,min:0,max:1,exponent:.5}),e._baseFrequency=e.toFrequency(n.baseFrequency),e._octaves=n.octaves,e._inputBoost=new So({context:e.context}),e._bandpass=new La({context:e.context,rolloff:-48,frequency:0,Q:n.Q}),e._peaking=new La({context:e.context,type:"peaking"}),e._peaking.gain.value=n.gain,e.gain=e._peaking.gain,e.Q=e._bandpass.Q,e.effectSend.chain(e._inputBoost,e._follower,e._sweepRange),e._sweepRange.connect(e._bandpass.frequency),e._sweepRange.connect(e._peaking.frequency),e.effectSend.chain(e._bandpass,e._peaking,e.effectReturn),e._setSweepRange(),e.sensitivity=n.sensitivity,Vi(e,["gain","Q"]),e}return _inherits(t,e),_createClass(t,[{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e,this._setSweepRange()}},{key:"follower",get:function(){return this._follower.smoothing},set:function(e){this._follower.smoothing=e}},{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=this.toFrequency(e),this._setSweepRange()}},{key:"sensitivity",get:function(){return $i(1/this._inputBoost.gain.value)},set:function(e){this._inputBoost.gain.value=1/Ji(e)}},{key:"_setSweepRange",value:function(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}}])}(ks);Ka("bit-crusher","\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");var Ps=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["bits"])])).name="BitCrusher";var n=xi(t.getDefaults(),arguments,["bits"]);return e._bitCrusherWorklet=new As({context:e.context,bits:n.bits}),e.connectEffect(e._bitCrusherWorklet),e.bits=e._bitCrusherWorklet.bits,e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._bitCrusherWorklet.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{bits:4})}}])}(ks),As=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="BitCrusherWorklet";var n=xi(t.getDefaults(),arguments);return e.input=new So({context:e.context}),e.output=new So({context:e.context}),e.bits=new go({context:e.context,value:n.bits,units:"positive",minValue:1,maxValue:16,param:e._dummyParam,swappable:!0}),e}return _inherits(t,e),_createClass(t,[{key:"_audioWorkletName",value:function(){return"bit-crusher"}},{key:"onReady",value:function(e){_o(this.input,e,this.output);var t=e.parameters.get("bits");this.bits.setParam(t)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Ja.getDefaults(),{bits:12})}}])}(Ja),Os=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["order"])])).name="Chebyshev";var n=xi(t.getDefaults(),arguments,["order"]);return e._shaper=new ra({context:e.context,length:4096}),e._order=n.order,e.connectEffect(e._shaper),e.order=n.order,e.oversample=n.oversample,e}return _inherits(t,e),_createClass(t,[{key:"_getCoefficient",value:function(e,t,n){return n.has(t)||(0===t?n.set(t,0):1===t?n.set(t,e):n.set(t,2*e*this._getCoefficient(e,t-1,n)-this._getCoefficient(e,t-2,n))),n.get(t)}},{key:"order",get:function(){return this._order},set:function(e){var t=this;this._order=e,this._shaper.setMap((function(n){return t._getCoefficient(n,e,new Map)}))}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._shaper.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{order:1,oversample:"none"})}}])}(ks),Ms=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["channels"])])).name="Split";var n=xi(t.getDefaults(),arguments,["channels"]);return e._splitter=e.input=e.output=e.context.createChannelSplitter(n.channels),e._internalChannels=[e._splitter],e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._splitter.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{channels:2})}}])}(yo),Ns=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["channels"])])).name="Merge";var n=xi(t.getDefaults(),arguments,["channels"]);return e._merger=e.output=e.input=e.context.createChannelMerger(n.channels),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._merger.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{channels:2})}}])}(yo),Is=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="StereoEffect",n.input=new So({context:n.context}),n.input.channelCount=2,n.input.channelCountMode="explicit",n._dryWet=n.output=new _s({context:n.context,fade:e.wet}),n.wet=n._dryWet.fade,n._split=new Ms({context:n.context,channels:2}),n._merge=new Ns({context:n.context,channels:2}),n.input.connect(n._split),n.input.connect(n._dryWet.a),n._merge.connect(n._dryWet.b),Vi(_assertThisInitialized(n),["wet"]),n}return _inherits(t,e),_createClass(t,[{key:"connectEffectLeft",value:function(){var e;this._split.connect(arguments.length<=0?void 0:arguments[0],0,0),_o.apply(void 0,arguments),ko((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e],this._merge,0,0)}},{key:"connectEffectRight",value:function(){var e;this._split.connect(arguments.length<=0?void 0:arguments[0],1,0),_o.apply(void 0,arguments),ko((e=arguments.length-1)<0||arguments.length<=e?void 0:arguments[e],this._merge,0,1)}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{wet:1})}}])}(yo),Es=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).feedback=new To({context:n.context,value:e.feedback,units:"normalRange"}),n._feedbackL=new So({context:n.context}),n._feedbackR=new So({context:n.context}),n._feedbackSplit=new Ms({context:n.context,channels:2}),n._feedbackMerge=new Ns({context:n.context,channels:2}),n._merge.connect(n._feedbackSplit),n._feedbackMerge.connect(n._split),n._feedbackSplit.connect(n._feedbackL,0,0),n._feedbackL.connect(n._feedbackMerge,0,0),n._feedbackSplit.connect(n._feedbackR,1,0),n._feedbackR.connect(n._feedbackMerge,0,1),n.feedback.fan(n._feedbackL.gain,n._feedbackR.gain),Vi(_assertThisInitialized(n),["feedback"]),n}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Is.getDefaults(),{feedback:.5})}}])}(Is),qs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","delayTime","depth"])])).name="Chorus";var n=xi(t.getDefaults(),arguments,["frequency","delayTime","depth"]);return e._depth=n.depth,e._delayTime=n.delayTime/1e3,e._lfoL=new va({context:e.context,frequency:n.frequency,min:0,max:1}),e._lfoR=new va({context:e.context,frequency:n.frequency,min:0,max:1,phase:180}),e._delayNodeL=new No({context:e.context}),e._delayNodeR=new No({context:e.context}),e.frequency=e._lfoL.frequency,Vi(e,["frequency"]),e._lfoL.frequency.connect(e._lfoR.frequency),e.connectEffectLeft(e._delayNodeL),e.connectEffectRight(e._delayNodeR),e._lfoL.connect(e._delayNodeL.delayTime),e._lfoR.connect(e._delayNodeR.delayTime),e.depth=e._depth,e.type=n.type,e.spread=n.spread,e}return _inherits(t,e),_createClass(t,[{key:"depth",get:function(){return this._depth},set:function(e){this._depth=e;var t=this._delayTime*e;this._lfoL.min=Math.max(this._delayTime-t,0),this._lfoL.max=this._delayTime+t,this._lfoR.min=Math.max(this._delayTime-t,0),this._lfoR.max=this._delayTime+t}},{key:"delayTime",get:function(){return 1e3*this._delayTime},set:function(e){this._delayTime=e/1e3,this.depth=this._depth}},{key:"type",get:function(){return this._lfoL.type},set:function(e){this._lfoL.type=e,this._lfoR.type=e}},{key:"spread",get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}},{key:"start",value:function(e){return this._lfoL.start(e),this._lfoR.start(e),this}},{key:"stop",value:function(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}},{key:"sync",value:function(){return this._lfoL.sync(),this._lfoR.sync(),this}},{key:"unsync",value:function(){return this._lfoL.unsync(),this._lfoR.unsync(),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Es.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}}])}(Es),Ds=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["distortion"])])).name="Distortion";var n=xi(t.getDefaults(),arguments,["distortion"]);return e._shaper=new ra({context:e.context,length:4096}),e._distortion=n.distortion,e.connectEffect(e._shaper),e.distortion=n.distortion,e.oversample=n.oversample,e}return _inherits(t,e),_createClass(t,[{key:"distortion",get:function(){return this._distortion},set:function(e){this._distortion=e;var t=100*e,n=Math.PI/180;this._shaper.setMap((function(e){return Math.abs(e)<.001?0:(3+t)*e*20*n/(Math.PI+t*Math.abs(e))}))}},{key:"oversample",get:function(){return this._shaper.oversample},set:function(e){this._shaper.oversample=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._shaper.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{distortion:.4,oversample:"none"})}}])}(ks),Rs=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="FeedbackEffect",n._feedbackGain=new So({context:n.context,gain:e.feedback,units:"normalRange"}),n.feedback=n._feedbackGain.gain,Vi(_assertThisInitialized(n),"feedback"),n.effectReturn.chain(n._feedbackGain,n.effectSend),n}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._feedbackGain.dispose(),this.feedback.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{feedback:.125})}}])}(ks),js=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["delayTime","feedback"])])).name="FeedbackDelay";var n=xi(t.getDefaults(),arguments,["delayTime","feedback"]);return e._delayNode=new No({context:e.context,delayTime:n.delayTime,maxDelay:n.maxDelay}),e.delayTime=e._delayNode.delayTime,e.connectEffect(e._delayNode),Vi(e,"delayTime"),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._delayNode.dispose(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Rs.getDefaults(),{delayTime:.25,maxDelay:1})}}])}(Rs),zs=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="PhaseShiftAllpass",n.input=new So({context:n.context}),n.output=new So({context:n.context}),n.offset90=new So({context:n.context}),n._bank0=n._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),n._bank1=n._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),n._oneSampleDelay=n.context.createIIRFilter([0,1],[1,0]),_o.apply(void 0,[n.input].concat(_toConsumableArray(n._bank0),[n._oneSampleDelay,n.output])),_o.apply(void 0,[n.input].concat(_toConsumableArray(n._bank1),[n.offset90])),n}return _inherits(t,e),_createClass(t,[{key:"_createAllPassFilterBank",value:function(e){var t=this;return e.map((function(e){var n=[[e*e,0,-1],[1,0,-e*e]];return t.context.createIIRFilter(n[0],n[1])}))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((function(e){return e.disconnect()})),this._bank1.forEach((function(e){return e.disconnect()})),this._oneSampleDelay.disconnect(),this}}])}(yo),Fs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency"])])).name="FrequencyShifter";var n=xi(t.getDefaults(),arguments,["frequency"]);e.frequency=new To({context:e.context,units:"frequency",value:n.frequency,minValue:-e.context.sampleRate/2,maxValue:e.context.sampleRate/2}),e._sine=new ea({context:e.context,type:"sine"}),e._cosine=new ta({context:e.context,phase:-90,type:"sine"}),e._sineMultiply=new oa({context:e.context}),e._cosineMultiply=new oa({context:e.context}),e._negate=new xa({context:e.context}),e._add=new pa({context:e.context}),e._phaseShifter=new zs({context:e.context}),e.effectSend.connect(e._phaseShifter),e.frequency.fan(e._sine.frequency,e._cosine.frequency),e._phaseShifter.offset90.connect(e._cosineMultiply),e._cosine.connect(e._cosineMultiply.factor),e._phaseShifter.connect(e._sineMultiply),e._sine.connect(e._sineMultiply.factor),e._sineMultiply.connect(e._negate),e._cosineMultiply.connect(e._add),e._negate.connect(e._add.addend),e._add.connect(e.effectReturn);var r=e.immediate();return e._sine.start(r),e._cosine.start(r),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{frequency:0})}}])}(ks),Ls=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],Vs=[225,556,441,341],Gs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["roomSize","dampening"])])).name="Freeverb",e._combFilters=[],e._allpassFiltersL=[],e._allpassFiltersR=[];var n=xi(t.getDefaults(),arguments,["roomSize","dampening"]);return e.roomSize=new To({context:e.context,value:n.roomSize,units:"normalRange"}),e._allpassFiltersL=Vs.map((function(t){var n=e.context.createBiquadFilter();return n.type="allpass",n.frequency.value=t,n})),e._allpassFiltersR=Vs.map((function(t){var n=e.context.createBiquadFilter();return n.type="allpass",n.frequency.value=t,n})),e._combFilters=Ls.map((function(t,r){var i,o,a=new ts({context:e.context,dampening:n.dampening,delayTime:t});return r<Ls.length/2?(i=e).connectEffectLeft.apply(i,[a].concat(_toConsumableArray(e._allpassFiltersL))):(o=e).connectEffectRight.apply(o,[a].concat(_toConsumableArray(e._allpassFiltersR))),e.roomSize.connect(a.resonance),a})),Vi(e,["roomSize"]),e}return _inherits(t,e),_createClass(t,[{key:"dampening",get:function(){return this._combFilters[0].dampening},set:function(e){this._combFilters.forEach((function(t){return t.dampening=e}))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._allpassFiltersL.forEach((function(e){return e.disconnect()})),this._allpassFiltersR.forEach((function(e){return e.disconnect()})),this._combFilters.forEach((function(e){return e.dispose()})),this.roomSize.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Is.getDefaults(),{roomSize:.7,dampening:3e3})}}])}(Is),Bs=[.06748,.06404,.08212,.09004],Us=[.773,.802,.753,.733],Hs=[347,113,37],Qs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["roomSize"])])).name="JCReverb",e._allpassFilters=[],e._feedbackCombFilters=[];var n=xi(t.getDefaults(),arguments,["roomSize"]);return e.roomSize=new To({context:e.context,value:n.roomSize,units:"normalRange"}),e._scaleRoomSize=new da({context:e.context,min:-.733,max:.197}),e._allpassFilters=Hs.map((function(t){var n=e.context.createBiquadFilter();return n.type="allpass",n.frequency.value=t,n})),e._feedbackCombFilters=Bs.map((function(t,n){var r,i,o=new $a({context:e.context,delayTime:t});return e._scaleRoomSize.connect(o.resonance),o.resonance.value=Us[n],n<Bs.length/2?(r=e).connectEffectLeft.apply(r,_toConsumableArray(e._allpassFilters).concat([o])):(i=e).connectEffectRight.apply(i,_toConsumableArray(e._allpassFilters).concat([o])),o})),e.roomSize.connect(e._scaleRoomSize),Vi(e,["roomSize"]),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._allpassFilters.forEach((function(e){return e.disconnect()})),this._feedbackCombFilters.forEach((function(e){return e.dispose()})),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Is.getDefaults(),{roomSize:.5})}}])}(Is),Ws=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e]))._feedbackL.disconnect(),n._feedbackL.connect(n._feedbackMerge,0,1),n._feedbackR.disconnect(),n._feedbackR.connect(n._feedbackMerge,0,0),Vi(_assertThisInitialized(n),["feedback"]),n}return _inherits(t,e),_createClass(t)}(Es),Ys=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["delayTime","feedback"])])).name="PingPongDelay";var n=xi(t.getDefaults(),arguments,["delayTime","feedback"]);return e._leftDelay=new No({context:e.context,maxDelay:n.maxDelay}),e._rightDelay=new No({context:e.context,maxDelay:n.maxDelay}),e._rightPreDelay=new No({context:e.context,maxDelay:n.maxDelay}),e.delayTime=new To({context:e.context,units:"time",value:n.delayTime}),e.connectEffectLeft(e._leftDelay),e.connectEffectRight(e._rightPreDelay,e._rightDelay),e.delayTime.fan(e._leftDelay.delayTime,e._rightDelay.delayTime,e._rightPreDelay.delayTime),e._feedbackL.disconnect(),e._feedbackL.connect(e._rightDelay),Vi(e,["delayTime"]),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Ws.getDefaults(),{delayTime:.25,maxDelay:1})}}])}(Ws),Xs=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["pitch"])])).name="PitchShift";var n=xi(t.getDefaults(),arguments,["pitch"]);e._frequency=new To({context:e.context}),e._delayA=new No({maxDelay:1,context:e.context}),e._lfoA=new va({context:e.context,min:0,max:.1,type:"sawtooth"}).connect(e._delayA.delayTime),e._delayB=new No({maxDelay:1,context:e.context}),e._lfoB=new va({context:e.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(e._delayB.delayTime),e._crossFade=new _s({context:e.context}),e._crossFadeLFO=new va({context:e.context,min:0,max:1,type:"triangle",phase:90}).connect(e._crossFade.fade),e._feedbackDelay=new No({delayTime:n.delayTime,context:e.context}),e.delayTime=e._feedbackDelay.delayTime,Vi(e,"delayTime"),e._pitch=n.pitch,e._windowSize=n.windowSize,e._delayA.connect(e._crossFade.a),e._delayB.connect(e._crossFade.b),e._frequency.fan(e._lfoA.frequency,e._lfoB.frequency,e._crossFadeLFO.frequency),e.effectSend.fan(e._delayA,e._delayB),e._crossFade.chain(e._feedbackDelay,e.effectReturn);var r=e.now();return e._lfoA.start(r),e._lfoB.start(r),e._crossFadeLFO.start(r),e.windowSize=e._windowSize,e}return _inherits(t,e),_createClass(t,[{key:"pitch",get:function(){return this._pitch},set:function(e){this._pitch=e;var t=0;e<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,t=eo(e-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,t=eo(e)-1),this._frequency.value=t*(1.2/this._windowSize)}},{key:"windowSize",get:function(){return this._windowSize},set:function(e){this._windowSize=this.toSeconds(e),this.pitch=this._pitch}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Rs.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}}])}(Rs),Zs=function(e){function t(){var e,n,r;_classCallCheck(this,t),(r=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","octaves","baseFrequency"])])).name="Phaser";var i=xi(t.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);return r._lfoL=new va({context:r.context,frequency:i.frequency,min:0,max:1}),r._lfoR=new va({context:r.context,frequency:i.frequency,min:0,max:1,phase:180}),r._baseFrequency=r.toFrequency(i.baseFrequency),r._octaves=i.octaves,r.Q=new To({context:r.context,value:i.Q,units:"positive"}),r._filtersL=r._makeFilters(i.stages,r._lfoL),r._filtersR=r._makeFilters(i.stages,r._lfoR),r.frequency=r._lfoL.frequency,r.frequency.value=i.frequency,(e=r).connectEffectLeft.apply(e,_toConsumableArray(r._filtersL)),(n=r).connectEffectRight.apply(n,_toConsumableArray(r._filtersR)),r._lfoL.frequency.connect(r._lfoR.frequency),r.baseFrequency=i.baseFrequency,r.octaves=i.octaves,r._lfoL.start(),r._lfoR.start(),Vi(r,["frequency","Q"]),r}return _inherits(t,e),_createClass(t,[{key:"_makeFilters",value:function(e,t){for(var n=[],r=0;r<e;r++){var i=this.context.createBiquadFilter();i.type="allpass",this.Q.connect(i.Q),t.connect(i.frequency),n.push(i)}return n}},{key:"octaves",get:function(){return this._octaves},set:function(e){this._octaves=e;var t=this._baseFrequency*Math.pow(2,e);this._lfoL.max=t,this._lfoR.max=t}},{key:"baseFrequency",get:function(){return this._baseFrequency},set:function(e){this._baseFrequency=this.toFrequency(e),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((function(e){return e.disconnect()})),this._filtersR.forEach((function(e){return e.disconnect()})),this.frequency.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Is.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}}])}(Is),Ks=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["decay"])])).name="Reverb",e._convolver=e.context.createConvolver(),e.ready=Promise.resolve();var n=xi(t.getDefaults(),arguments,["decay"]);return e._decay=n.decay,e._preDelay=n.preDelay,e.generate(),e.connectEffect(e._convolver),e}return _inherits(t,e),_createClass(t,[{key:"decay",get:function(){return this._decay},set:function(e){Kr(e=this.toSeconds(e),.001),this._decay=e,this.generate()}},{key:"preDelay",get:function(){return this._preDelay},set:function(e){Kr(e=this.toSeconds(e),0),this._preDelay=e,this.generate()}},{key:"generate",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,n,r,i,o,a,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.ready,n=new Hi(2,this._decay+this._preDelay,this.context.sampleRate),r=new Xo({context:n}),i=new Xo({context:n}),o=new Ns({context:n}),r.connect(o,0,0),i.connect(o,0,1),a=new So({context:n}).toDestination(),o.connect(a),r.start(0),i.start(0),a.gain.setValueAtTime(0,0),a.gain.setValueAtTime(1,this._preDelay),a.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay),s=n.render(),this.ready=s.then(Bi),e.next=8,t;case 8:return e.next=10,s;case 10:return this._convolver.buffer=e.sent.get(),e.abrupt("return",this);case 12:case"end":return e.stop()}}),e,this)})))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._convolver.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{decay:1.5,preDelay:.01})}}])}(ks),Js=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="MidSideSplit",e._split=e.input=new Ms({channels:2,context:e.context}),e._midAdd=new pa({context:e.context}),e.mid=new oa({context:e.context,value:Math.SQRT1_2}),e._sideSubtract=new Ta({context:e.context}),e.side=new oa({context:e.context,value:Math.SQRT1_2}),e._split.connect(e._midAdd,0),e._split.connect(e._midAdd.addend,1),e._split.connect(e._sideSubtract,0),e._split.connect(e._sideSubtract.subtrahend,1),e._midAdd.connect(e.mid),e._sideSubtract.connect(e.side),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}])}(yo),$s=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="MidSideMerge",e.mid=new So({context:e.context}),e.side=new So({context:e.context}),e._left=new pa({context:e.context}),e._leftMult=new oa({context:e.context,value:Math.SQRT1_2}),e._right=new Ta({context:e.context}),e._rightMult=new oa({context:e.context,value:Math.SQRT1_2}),e._merge=e.output=new Ns({context:e.context}),e.mid.fan(e._left),e.side.connect(e._left.addend),e.mid.connect(e._right),e.side.connect(e._right.subtrahend),e._left.connect(e._leftMult),e._right.connect(e._rightMult),e._leftMult.connect(e._merge,0,0),e._rightMult.connect(e._merge,0,1),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}])}(yo),eu=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).name="MidSideEffect",n._midSideMerge=new $s({context:n.context}),n._midSideSplit=new Js({context:n.context}),n._midSend=n._midSideSplit.mid,n._sideSend=n._midSideSplit.side,n._midReturn=n._midSideMerge.mid,n._sideReturn=n._midSideMerge.side,n.effectSend.connect(n._midSideSplit),n._midSideMerge.connect(n.effectReturn),n}return _inherits(t,e),_createClass(t,[{key:"connectEffectMid",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this._midSend).chain.apply(e,n.concat([this._midReturn]))}},{key:"connectEffectSide",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=this._sideSend).chain.apply(e,n.concat([this._sideReturn]))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}])}(ks),tu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["width"])])).name="StereoWidener";var n=xi(t.getDefaults(),arguments,["width"]);return e.width=new To({context:e.context,value:n.width,units:"normalRange"}),Vi(e,["width"]),e._twoTimesWidthMid=new oa({context:e.context,value:2}),e._twoTimesWidthSide=new oa({context:e.context,value:2}),e._midMult=new oa({context:e.context}),e._twoTimesWidthMid.connect(e._midMult.factor),e.connectEffectMid(e._midMult),e._oneMinusWidth=new Ta({context:e.context}),e._oneMinusWidth.connect(e._twoTimesWidthMid),ko(e.context.getConstant(1),e._oneMinusWidth),e.width.connect(e._oneMinusWidth.subtrahend),e._sideMult=new oa({context:e.context}),e.width.connect(e._twoTimesWidthSide),e._twoTimesWidthSide.connect(e._sideMult.factor),e.connectEffectSide(e._sideMult),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(eu.getDefaults(),{width:.5})}}])}(eu),nu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","depth"])])).name="Tremolo";var n=xi(t.getDefaults(),arguments,["frequency","depth"]);return e._lfoL=new va({context:e.context,type:n.type,min:1,max:0}),e._lfoR=new va({context:e.context,type:n.type,min:1,max:0}),e._amplitudeL=new So({context:e.context}),e._amplitudeR=new So({context:e.context}),e.frequency=new To({context:e.context,value:n.frequency,units:"frequency"}),e.depth=new To({context:e.context,value:n.depth,units:"normalRange"}),Vi(e,["frequency","depth"]),e.connectEffectLeft(e._amplitudeL),e.connectEffectRight(e._amplitudeR),e._lfoL.connect(e._amplitudeL.gain),e._lfoR.connect(e._amplitudeR.gain),e.frequency.fan(e._lfoL.frequency,e._lfoR.frequency),e.depth.fan(e._lfoR.amplitude,e._lfoL.amplitude),e.spread=n.spread,e}return _inherits(t,e),_createClass(t,[{key:"start",value:function(e){return this._lfoL.start(e),this._lfoR.start(e),this}},{key:"stop",value:function(e){return this._lfoL.stop(e),this._lfoR.stop(e),this}},{key:"sync",value:function(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}},{key:"unsync",value:function(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}},{key:"type",get:function(){return this._lfoL.type},set:function(e){this._lfoL.type=e,this._lfoR.type=e}},{key:"spread",get:function(){return this._lfoR.phase-this._lfoL.phase},set:function(e){this._lfoL.phase=90-e/2,this._lfoR.phase=e/2+90}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(Is.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}}])}(Is),ru=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["frequency","depth"])])).name="Vibrato";var n=xi(t.getDefaults(),arguments,["frequency","depth"]);return e._delayNode=new No({context:e.context,delayTime:0,maxDelay:n.maxDelay}),e._lfo=new va({context:e.context,type:n.type,min:0,max:n.maxDelay,frequency:n.frequency,phase:-90}).start().connect(e._delayNode.delayTime),e.frequency=e._lfo.frequency,e.depth=e._lfo.amplitude,e.depth.value=n.depth,Vi(e,["frequency","depth"]),e.effectSend.chain(e._delayNode,e.effectReturn),e}return _inherits(t,e),_createClass(t,[{key:"type",get:function(){return this._lfo.type},set:function(e){this._lfo.type=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ks.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}}])}(ks),iu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["type","size"])])).name="Analyser",e._analysers=[],e._buffers=[];var n=xi(t.getDefaults(),arguments,["type","size"]);e.input=e.output=e._gain=new So({context:e.context}),e._split=new Ms({context:e.context,channels:n.channels}),e.input.connect(e._split),Kr(n.channels,1);for(var r=0;r<n.channels;r++)e._analysers[r]=e.context.createAnalyser(),e._split.connect(e._analysers[r],r,0);return e.size=n.size,e.type=n.type,e}return _inherits(t,e),_createClass(t,[{key:"getValue",value:function(){var e=this;return this._analysers.forEach((function(t,n){var r=e._buffers[n];"fft"===e._type?t.getFloatFrequencyData(r):"waveform"===e._type&&t.getFloatTimeDomainData(r)})),1===this.channels?this._buffers[0]:this._buffers}},{key:"size",get:function(){return this._analysers[0].frequencyBinCount},set:function(e){var t=this;this._analysers.forEach((function(n,r){n.fftSize=2*e,t._buffers[r]=new Float32Array(e)}))}},{key:"channels",get:function(){return this._analysers.length}},{key:"type",get:function(){return this._type},set:function(e){Zr("waveform"===e||"fft"===e,"Analyser: invalid type: "+e),this._type=e}},{key:"smoothing",get:function(){return this._analysers[0].smoothingTimeConstant},set:function(e){this._analysers.forEach((function(t){return t.smoothingTimeConstant=e}))}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._analysers.forEach((function(e){return e.disconnect()})),this._split.dispose(),this._gain.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}}])}(yo),ou=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="MeterBase",e.input=e.output=e._analyser=new iu({context:e.context,size:256,type:"waveform"}),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._analyser.dispose(),this}}])}(yo),au=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["smoothing"])])).name="Meter",e._rms=0;var n=xi(t.getDefaults(),arguments,["smoothing"]);return e.input=e.output=e._analyser=new iu({context:e.context,size:256,type:"waveform",channels:n.channels}),e.smoothing=n.smoothing,e.normalRange=n.normalRange,e}return _inherits(t,e),_createClass(t,[{key:"getLevel",value:function(){return ni("'getLevel' has been changed to 'getValue'"),this.getValue()}},{key:"getValue",value:function(){var e=this,t=this._analyser.getValue(),n=(1===this.channels?[t]:t).map((function(t){var n=t.reduce((function(e,t){return e+t*t}),0),r=Math.sqrt(n/t.length);return e._rms=Math.max(r,e._rms*e.smoothing),e.normalRange?e._rms:$i(e._rms)}));return 1===this.channels?n[0]:n}},{key:"channels",get:function(){return this._analyser.channels}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._analyser.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(ou.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}}])}(ou),su=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["size"])])).name="FFT";var n=xi(t.getDefaults(),arguments,["size"]);return e.normalRange=n.normalRange,e._analyser.type="fft",e.size=n.size,e}return _inherits(t,e),_createClass(t,[{key:"getValue",value:function(){var e=this;return this._analyser.getValue().map((function(t){return e.normalRange?Ji(t):t}))}},{key:"size",get:function(){return this._analyser.size},set:function(e){this._analyser.size=e}},{key:"smoothing",get:function(){return this._analyser.smoothing},set:function(e){this._analyser.smoothing=e}},{key:"getFrequencyOfIndex",value:function(e){return Zr(0<=e&&e<this.size,"index must be greater than or equal to 0 and less than "+this.size),e*this.context.sampleRate/(2*this.size)}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}}])}(ou),uu=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="DCMeter",e._analyser.type="waveform",e._analyser.size=256,e}return _inherits(t,e),_createClass(t,[{key:"getValue",value:function(){return this._analyser.getValue()[0]}}])}(ou),cu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["size"])])).name="Waveform";var n=xi(t.getDefaults(),arguments,["size"]);return e._analyser.type="waveform",e.size=n.size,e}return _inherits(t,e),_createClass(t,[{key:"getValue",value:function(){return this._analyser.getValue()}},{key:"size",get:function(){return this._analyser.size},set:function(e){this._analyser.size=e}}],[{key:"getDefaults",value:function(){return Object.assign(ou.getDefaults(),{size:1024})}}])}(ou),lu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["solo"])])).name="Solo";var n=xi(t.getDefaults(),arguments,["solo"]);return e.input=e.output=new So({context:e.context}),t._allSolos.has(e.context)||t._allSolos.set(e.context,new Set),t._allSolos.get(e.context).add(e),e.solo=n.solo,e}return _inherits(t,e),_createClass(t,[{key:"solo",get:function(){return this._isSoloed()},set:function(e){e?this._addSolo():this._removeSolo(),t._allSolos.get(this.context).forEach((function(e){return e._updateSolo()}))}},{key:"muted",get:function(){return 0===this.input.gain.value}},{key:"_addSolo",value:function(){t._soloed.has(this.context)||t._soloed.set(this.context,new Set),t._soloed.get(this.context).add(this)}},{key:"_removeSolo",value:function(){t._soloed.has(this.context)&&t._soloed.get(this.context).delete(this)}},{key:"_isSoloed",value:function(){return t._soloed.has(this.context)&&t._soloed.get(this.context).has(this)}},{key:"_noSolos",value:function(){return!t._soloed.has(this.context)||t._soloed.has(this.context)&&0===t._soloed.get(this.context).size}},{key:"_updateSolo",value:function(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),t._allSolos.get(this.context).delete(this),this._removeSolo(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{solo:!1})}}])}(yo);lu._allSolos=new Map,lu._soloed=new Map;var hu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["pan","volume"])])).name="PanVol";var n=xi(t.getDefaults(),arguments,["pan","volume"]);return e._panner=e.input=new ws({context:e.context,pan:n.pan,channelCount:n.channelCount}),e.pan=e._panner.pan,e._volume=e.output=new Vo({context:e.context,volume:n.volume}),e.volume=e._volume.volume,e._panner.connect(e._volume),e.mute=n.mute,Vi(e,["pan","volume"]),e}return _inherits(t,e),_createClass(t,[{key:"mute",get:function(){return this._volume.mute},set:function(e){this._volume.mute=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}}])}(yo),fu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["volume","pan"])])).name="Channel";var n=xi(t.getDefaults(),arguments,["volume","pan"]);return e._solo=e.input=new lu({solo:n.solo,context:e.context}),e._panVol=e.output=new hu({context:e.context,pan:n.pan,volume:n.volume,mute:n.mute,channelCount:n.channelCount}),e.pan=e._panVol.pan,e.volume=e._panVol.volume,e._solo.connect(e._panVol),Vi(e,["pan","volume"]),e}return _inherits(t,e),_createClass(t,[{key:"solo",get:function(){return this._solo.solo},set:function(e){this._solo.solo=e}},{key:"muted",get:function(){return this._solo.muted||this.mute}},{key:"mute",get:function(){return this._panVol.mute},set:function(e){this._panVol.mute=e}},{key:"_getBus",value:function(e){return t.buses.has(e)||t.buses.set(e,new So({context:this.context})),t.buses.get(e)}},{key:"send",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this._getBus(e),r=new So({context:this.context,units:"decibels",gain:t});return this.connect(r),r.connect(n),r}},{key:"receive",value:function(e){return this._getBus(e).connect(this),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}}])}(yo);fu.buses=new Map;var pu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["lowFrequency","highFrequency"])])).name="MultibandSplit",e.input=new So({context:e.context}),e.output=void 0,e.low=new La({context:e.context,frequency:0,type:"lowpass"}),e._lowMidFilter=new La({context:e.context,frequency:0,type:"highpass"}),e.mid=new La({context:e.context,frequency:0,type:"lowpass"}),e.high=new La({context:e.context,frequency:0,type:"highpass"}),e._internalChannels=[e.low,e.mid,e.high];var n=xi(t.getDefaults(),arguments,["lowFrequency","highFrequency"]);return e.lowFrequency=new To({context:e.context,units:"frequency",value:n.lowFrequency}),e.highFrequency=new To({context:e.context,units:"frequency",value:n.highFrequency}),e.Q=new To({context:e.context,units:"positive",value:n.Q}),e.input.fan(e.low,e.high),e.input.chain(e._lowMidFilter,e.mid),e.lowFrequency.fan(e.low.frequency,e._lowMidFilter.frequency),e.highFrequency.fan(e.mid.frequency,e.high.frequency),e.Q.connect(e.low.Q),e.Q.connect(e._lowMidFilter.Q),e.Q.connect(e.mid.Q),e.Q.connect(e.high.Q),Vi(e,["high","mid","low","highFrequency","lowFrequency"]),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),Gi(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}}])}(yo),du=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).name="Listener",e.positionX=new go({context:e.context,param:e.context.rawContext.listener.positionX}),e.positionY=new go({context:e.context,param:e.context.rawContext.listener.positionY}),e.positionZ=new go({context:e.context,param:e.context.rawContext.listener.positionZ}),e.forwardX=new go({context:e.context,param:e.context.rawContext.listener.forwardX}),e.forwardY=new go({context:e.context,param:e.context.rawContext.listener.forwardY}),e.forwardZ=new go({context:e.context,param:e.context.rawContext.listener.forwardZ}),e.upX=new go({context:e.context,param:e.context.rawContext.listener.upX}),e.upY=new go({context:e.context,param:e.context.rawContext.listener.upY}),e.upZ=new go({context:e.context,param:e.context.rawContext.listener.upZ}),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}}])}(yo);Di((function(e){e.listener=new du({context:e})})),ji((function(e){e.listener.dispose()}));var mu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["positionX","positionY","positionZ"])])).name="Panner3D";var n=xi(t.getDefaults(),arguments,["positionX","positionY","positionZ"]);return e._panner=e.input=e.output=e.context.createPanner(),e.panningModel=n.panningModel,e.maxDistance=n.maxDistance,e.distanceModel=n.distanceModel,e.coneOuterGain=n.coneOuterGain,e.coneOuterAngle=n.coneOuterAngle,e.coneInnerAngle=n.coneInnerAngle,e.refDistance=n.refDistance,e.rolloffFactor=n.rolloffFactor,e.positionX=new go({context:e.context,param:e._panner.positionX,value:n.positionX}),e.positionY=new go({context:e.context,param:e._panner.positionY,value:n.positionY}),e.positionZ=new go({context:e.context,param:e._panner.positionZ,value:n.positionZ}),e.orientationX=new go({context:e.context,param:e._panner.orientationX,value:n.orientationX}),e.orientationY=new go({context:e.context,param:e._panner.orientationY,value:n.orientationY}),e.orientationZ=new go({context:e.context,param:e._panner.orientationZ,value:n.orientationZ}),e}return _inherits(t,e),_createClass(t,[{key:"setPosition",value:function(e,t,n){return this.positionX.value=e,this.positionY.value=t,this.positionZ.value=n,this}},{key:"setOrientation",value:function(e,t,n){return this.orientationX.value=e,this.orientationY.value=t,this.orientationZ.value=n,this}},{key:"panningModel",get:function(){return this._panner.panningModel},set:function(e){this._panner.panningModel=e}},{key:"refDistance",get:function(){return this._panner.refDistance},set:function(e){this._panner.refDistance=e}},{key:"rolloffFactor",get:function(){return this._panner.rolloffFactor},set:function(e){this._panner.rolloffFactor=e}},{key:"distanceModel",get:function(){return this._panner.distanceModel},set:function(e){this._panner.distanceModel=e}},{key:"coneInnerAngle",get:function(){return this._panner.coneInnerAngle},set:function(e){this._panner.coneInnerAngle=e}},{key:"coneOuterAngle",get:function(){return this._panner.coneOuterAngle},set:function(e){this._panner.coneOuterAngle=e}},{key:"coneOuterGain",get:function(){return this._panner.coneOuterGain},set:function(e){this._panner.coneOuterGain=e}},{key:"maxDistance",get:function(){return this._panner.maxDistance},set:function(e){this._panner.maxDistance=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}}])}(yo),vu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments)])).name="Recorder";var n=xi(t.getDefaults(),arguments);return e.input=new So({context:e.context}),Zr(t.supported,"Media Recorder API is not available"),e._stream=e.context.createMediaStreamDestination(),e.input.connect(e._stream),e._recorder=new MediaRecorder(e._stream.stream,{mimeType:n.mimeType}),e}return _inherits(t,e),_createClass(t,[{key:"mimeType",get:function(){return this._recorder.mimeType}},{key:"state",get:function(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}},{key:"start",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Zr("started"!==this.state,"Recorder is already started"),t=new Promise((function(e){var t=function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(){n._recorder.removeEventListener("start",t,!1),e()}));n._recorder.addEventListener("start",t,!1)})),this._recorder.start(),e.next=5,t;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function e(){var t,n=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Zr("stopped"!==this.state,"Recorder is not started"),t=new Promise((function(e){var t=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(r){n._recorder.removeEventListener("dataavailable",t,!1),e(r.data)}));n._recorder.addEventListener("dataavailable",t,!1)})),this._recorder.stop(),e.next=5,t;case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"pause",value:function(){return Zr("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this._stream.disconnect(),this}}],[{key:"getDefaults",value:function(){return yo.getDefaults()}},{key:"supported",get:function(){return null!==fi&&Reflect.has(fi,"MediaRecorder")}}])}(yo),gu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["threshold","ratio"])])).name="Compressor",e._compressor=e.context.createDynamicsCompressor(),e.input=e._compressor,e.output=e._compressor;var n=xi(t.getDefaults(),arguments,["threshold","ratio"]);return e.threshold=new go({minValue:e._compressor.threshold.minValue,maxValue:e._compressor.threshold.maxValue,context:e.context,convert:!1,param:e._compressor.threshold,units:"decibels",value:n.threshold}),e.attack=new go({minValue:e._compressor.attack.minValue,maxValue:e._compressor.attack.maxValue,context:e.context,param:e._compressor.attack,units:"time",value:n.attack}),e.release=new go({minValue:e._compressor.release.minValue,maxValue:e._compressor.release.maxValue,context:e.context,param:e._compressor.release,units:"time",value:n.release}),e.knee=new go({minValue:e._compressor.knee.minValue,maxValue:e._compressor.knee.maxValue,context:e.context,convert:!1,param:e._compressor.knee,units:"decibels",value:n.knee}),e.ratio=new go({minValue:e._compressor.ratio.minValue,maxValue:e._compressor.ratio.maxValue,context:e.context,convert:!1,param:e._compressor.ratio,units:"positive",value:n.ratio}),Vi(e,["knee","release","attack","ratio","threshold"]),e}return _inherits(t,e),_createClass(t,[{key:"reduction",get:function(){return this._compressor.reduction}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}}])}(yo),yu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["threshold","smoothing"]))])).name="Gate";var n=xi(t.getDefaults(),arguments,["threshold","smoothing"]);return e._follower=new Ts({context:e.context,smoothing:n.smoothing}),e._gt=new Pa({context:e.context,value:Ji(n.threshold)}),e.input=new So({context:e.context}),e._gate=e.output=new So({context:e.context}),e.input.connect(e._gate),e.input.chain(e._follower,e._gt,e._gate.gain),e}return _inherits(t,e),_createClass(t,[{key:"threshold",get:function(){return $i(this._gt.value)},set:function(e){this._gt.value=Ji(e)}},{key:"smoothing",get:function(){return this._follower.smoothing},set:function(e){this._follower.smoothing=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{smoothing:.1,threshold:-40})}}])}(yo),_u=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments,["threshold"]))])).name="Limiter";var n=xi(t.getDefaults(),arguments,["threshold"]);return e._compressor=e.input=e.output=new gu({context:e.context,ratio:20,attack:0,release:0,threshold:n.threshold}),e.threshold=e._compressor.threshold,Vi(e,"threshold"),e}return _inherits(t,e),_createClass(t,[{key:"reduction",get:function(){return this._compressor.reduction}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._compressor.dispose(),this.threshold.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{threshold:-12})}}])}(yo),ku=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments))])).name="MidSideCompressor";var n=xi(t.getDefaults(),arguments);return e._midSideSplit=e.input=new Js({context:e.context}),e._midSideMerge=e.output=new $s({context:e.context}),e.mid=new gu(Object.assign(n.mid,{context:e.context})),e.side=new gu(Object.assign(n.side,{context:e.context})),e._midSideSplit.mid.chain(e.mid,e._midSideMerge.mid),e._midSideSplit.side.chain(e.side,e._midSideMerge.side),Vi(e,["mid","side"]),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}}])}(yo),bu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[Object.assign(xi(t.getDefaults(),arguments))])).name="MultibandCompressor";var n=xi(t.getDefaults(),arguments);return e._splitter=e.input=new pu({context:e.context,lowFrequency:n.lowFrequency,highFrequency:n.highFrequency}),e.lowFrequency=e._splitter.lowFrequency,e.highFrequency=e._splitter.highFrequency,e.output=new So({context:e.context}),e.low=new gu(Object.assign(n.low,{context:e.context})),e.mid=new gu(Object.assign(n.mid,{context:e.context})),e.high=new gu(Object.assign(n.high,{context:e.context})),e._splitter.low.chain(e.low,e.output),e._splitter.mid.chain(e.mid,e.output),e._splitter.high.chain(e.high,e.output),Vi(e,["high","mid","low","highFrequency","lowFrequency"]),e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}}])}(yo),Su=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["low","mid","high"])])).name="EQ3",e.output=new So({context:e.context}),e._internalChannels=[];var n=xi(t.getDefaults(),arguments,["low","mid","high"]);return e.input=e._multibandSplit=new pu({context:e.context,highFrequency:n.highFrequency,lowFrequency:n.lowFrequency}),e._lowGain=new So({context:e.context,gain:n.low,units:"decibels"}),e._midGain=new So({context:e.context,gain:n.mid,units:"decibels"}),e._highGain=new So({context:e.context,gain:n.high,units:"decibels"}),e.low=e._lowGain.gain,e.mid=e._midGain.gain,e.high=e._highGain.gain,e.Q=e._multibandSplit.Q,e.lowFrequency=e._multibandSplit.lowFrequency,e.highFrequency=e._multibandSplit.highFrequency,e._multibandSplit.low.chain(e._lowGain,e.output),e._multibandSplit.mid.chain(e._midGain,e.output),e._multibandSplit.high.chain(e._highGain,e.output),Vi(e,["low","mid","high","lowFrequency","highFrequency"]),e._internalChannels=[e._multibandSplit],e}return _inherits(t,e),_createClass(t,[{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),Gi(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}}])}(yo),wu=function(e){function t(){var e;_classCallCheck(this,t),(e=_callSuper(this,t,[xi(t.getDefaults(),arguments,["url","onload"])])).name="Convolver",e._convolver=e.context.createConvolver();var n=xi(t.getDefaults(),arguments,["url","onload"]);return e._buffer=new Ui(n.url,(function(t){e.buffer=t,n.onload()})),e.input=new So({context:e.context}),e.output=new So({context:e.context}),e._buffer.loaded&&(e.buffer=e._buffer),e.normalize=n.normalize,e.input.chain(e._convolver,e.output),e}return _inherits(t,e),_createClass(t,[{key:"load",value:function(e){return mi(this,void 0,void 0,_regeneratorRuntime().mark((function t(){return _regeneratorRuntime().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._buffer.load(e);case 2:this.buffer=t.sent;case 3:case"end":return t.stop()}}),t,this)})))}},{key:"buffer",get:function(){return this._buffer.length?this._buffer:null},set:function(e){e&&this._buffer.set(e),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));var t=this._buffer.get();this._convolver.buffer=t||null}},{key:"normalize",get:function(){return this._convolver.normalize},set:function(e){this._convolver.normalize=e}},{key:"dispose",value:function(){return _superPropGet(t,"dispose",this,3)([]),this._buffer.dispose(),this._convolver.disconnect(),this}}],[{key:"getDefaults",value:function(){return Object.assign(yo.getDefaults(),{normalize:!0,onload:Bi})}}])}(yo);function xu(){return Yi().now()}function Tu(){return Yi().immediate()}var Cu=Yi().transport;function Pu(){return Yi().transport}var Au=Yi().destination,Ou=Yi().destination;function Mu(){return Yi().destination}var Nu=Yi().listener;function Iu(){return Yi().listener}var Eu=Yi().draw;function qu(){return Yi().draw}var Du=Yi();function Ru(){return Ui.loaded()}var ju=Ui,zu=Eo,Fu=Yo}])})),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t(require("@tensorflow/tfjs"),require("tone")):"function"==typeof define&&define.amd?define(["tf","Tone"],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))?exports.core=t(require("@tensorflow/tfjs"),require("tone")):e.core=t(e.tf,e.Tone)}(self,(function(__WEBPACK_EXTERNAL_MODULE__2__,__WEBPACK_EXTERNAL_MODULE__9__){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=73)}([,,function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__2__},,,,,,function(e,t,n){n.r(t),n.d(t,"DEFAULT_QUARTERS_PER_MINUTE",(function(){return r})),n.d(t,"DEFAULT_STEPS_PER_BAR",(function(){return i})),n.d(t,"DEFAULT_STEPS_PER_QUARTER",(function(){return o})),n.d(t,"DEFAULT_STEPS_PER_SECOND",(function(){return a})),n.d(t,"DEFAULT_VELOCITY",(function(){return s})),n.d(t,"DEFAULT_PROGRAM",(function(){return u})),n.d(t,"DEFAULT_TICKS_PER_QUARTER",(function(){return c})),n.d(t,"DEFAULT_CHANNEL",(function(){return l})),n.d(t,"DRUM_CHANNEL",(function(){return h})),n.d(t,"NON_DRUM_CHANNELS",(function(){return f})),n.d(t,"DEFAULT_DRUM_PITCH_CLASSES",(function(){return p})),n.d(t,"MIN_MIDI_VELOCITY",(function(){return d})),n.d(t,"MAX_MIDI_VELOCITY",(function(){return m})),n.d(t,"MIDI_VELOCITIES",(function(){return v})),n.d(t,"NO_CHORD",(function(){return g})),n.d(t,"NUM_PITCH_CLASSES",(function(){return y})),n.d(t,"MIN_MIDI_PITCH",(function(){return _})),n.d(t,"MAX_MIDI_PITCH",(function(){return k})),n.d(t,"MIDI_PITCHES",(function(){return b})),n.d(t,"MIN_PIANO_PITCH",(function(){return S})),n.d(t,"MAX_PIANO_PITCH",(function(){return w})),n.d(t,"MIN_DRUM_PITCH",(function(){return x})),n.d(t,"MAX_DRUM_PITCH",(function(){return T})),n.d(t,"MIN_MIDI_PROGRAM",(function(){return C})),n.d(t,"MAX_MIDI_PROGRAM",(function(){return P})),n.d(t,"LO_CLICK_PITCH",(function(){return A})),n.d(t,"HI_CLICK_PITCH",(function(){return O})),n.d(t,"LO_CLICK_CLASS",(function(){return M})),n.d(t,"HI_CLICK_CLASS",(function(){return N}));var r=120,i=16,o=4,a=100,s=80,u=0,c=220,l=0,h=9,f=[0,1,2,3,4,5,6,7,8,10,11,12,13,14,15],p=[[36,35],[38,27,28,31,32,33,34,37,39,40,56,65,66,75,85],[42,44,54,68,69,70,71,73,78,80],[46,67,72,74,79,81],[45,29,41,61,64,84],[48,47,60,63,77,86,87],[50,30,43,62,76,83],[49,55,57,58],[51,52,53,59,82]],d=0,m=127,v=m-d+1,g="N.C.",y=12,_=0,k=127,b=k-_+1,S=21,w=108,x=35,T=81,C=0,P=127,A=89,O=90,M=9,N=10},function(e,t){e.exports=__WEBPACK_EXTERNAL_MODULE__9__},function(e,t,n){n.d(t,"a",(function(){return r}));var r=n(35).tensorflow.magenta.NoteSequence},,function(e,t,n){n.r(t),n.d(t,"Level",(function(){return r})),n.d(t,"verbosity",(function(){return o})),n.d(t,"setVerbosity",(function(){return a})),n.d(t,"log",(function(){return s})),n.d(t,"logWithDuration",(function(){return u}));var r,i=n(15);!function(e){e[e.NONE=0]="NONE",e[e.WARN=5]="WARN",e[e.INFO=10]="INFO",e[e.DEBUG=20]="DEBUG"}(r||(r={}));var o=10;function a(e){}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Magenta.js",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;if(0===n)throw Error("Logging level cannot be NONE.");o>=n&&(5===n?console.warn:console.log)("%c ".concat(t," "),"background:magenta; color:white",e)}function u(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Magenta.js",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;s("".concat(e," in ").concat(((i.d.now()-t)/1e3).toPrecision(3),"s"),n,r)}},function(e,t,n){n.r(t),n.d(t,"MultipleTimeSignatureException",(function(){return o})),n.d(t,"BadTimeSignatureException",(function(){return a})),n.d(t,"NegativeTimeException",(function(){return s})),n.d(t,"MultipleTempoException",(function(){return u})),n.d(t,"QuantizationStatusException",(function(){return c})),n.d(t,"clone",(function(){return l})),n.d(t,"stepsPerQuarterToStepsPerSecond",(function(){return h})),n.d(t,"quantizeToStep",(function(){return f})),n.d(t,"quantizeNoteSequence",(function(){return m})),n.d(t,"isQuantizedSequence",(function(){return v})),n.d(t,"assertIsQuantizedSequence",(function(){return g})),n.d(t,"isRelativeQuantizedSequence",(function(){return y})),n.d(t,"assertIsRelativeQuantizedSequence",(function(){return _})),n.d(t,"isAbsoluteQuantizedSequence",(function(){return k})),n.d(t,"assertIsAbsoluteQuantizedSequence",(function(){return b})),n.d(t,"unquantizeSequence",(function(){return S})),n.d(t,"createQuantizedNoteSequence",(function(){return w})),n.d(t,"mergeInstruments",(function(){return x})),n.d(t,"replaceInstruments",(function(){return T})),n.d(t,"mergeConsecutiveNotes",(function(){return C})),n.d(t,"applySustainControlChanges",(function(){return P})),n.d(t,"concatenate",(function(){return A})),n.d(t,"trim",(function(){return O})),n.d(t,"split",(function(){return I}));var r=n(10),i=n(8),o=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}(),a=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}(),s=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}(),u=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}(),c=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}();function l(e){return r.a.decode(r.a.encode(e).finish())}function h(e,t){return e*t/60}function f(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.5,r=e*t;return Math.floor(r+(1-n))}function p(e){return e.controlChanges.concat(e.textAnnotations)}function d(e){if(e.tempos&&0!==e.tempos.length){if(e.tempos.sort((function(e,t){return e.time-t.time})),0!==e.tempos[0].time&&e.tempos[0].qpm!==i.DEFAULT_QUARTERS_PER_MINUTE)throw new u("NoteSequence has an implicit tempo change from initial "+i.DEFAULT_QUARTERS_PER_MINUTE+" qpm to "+"".concat(e.tempos[0].qpm," qpm at ").concat(e.tempos[0].time," seconds."));for(var t=1;t<e.tempos.length;t++)if(e.tempos[t].qpm!==e.tempos[0].qpm)throw new u("NoteSequence has at least one tempo change from ".concat(e.tempos[0].qpm," qpm to ").concat(e.tempos[t].qpm,"qpm at ").concat(e.tempos[t].time," seconds."))}}function m(e,t){var n=l(e);if(n.quantizationInfo=r.a.QuantizationInfo.create({stepsPerQuarter:t}),n.timeSignatures.length>0){if(n.timeSignatures.sort((function(e,t){return e.time-t.time})),0!==n.timeSignatures[0].time&&(4!==n.timeSignatures[0].numerator||4!==n.timeSignatures[0].denominator))throw new o("NoteSequence has an implicit change from initial 4/4 time signature to ".concat(n.timeSignatures[0].numerator,"/")+n.timeSignatures[0].denominator+" at "+n.timeSignatures[0].time+" seconds.");for(var u=1;u<n.timeSignatures.length;u++){var c=n.timeSignatures[u];if(c.numerator!==n.timeSignatures[0].numerator||c.denominator!==n.timeSignatures[0].denominator)throw new o("NoteSequence has at least one time signature change from "+n.timeSignatures[0].numerator+"/"+n.timeSignatures[0].denominator+" to "+"".concat(c.numerator,"/").concat(c.denominator," ")+"at ".concat(c.time," seconds"))}n.timeSignatures[0].time=0,n.timeSignatures=[n.timeSignatures[0]]}else{var m=r.a.TimeSignature.create({numerator:4,denominator:4,time:0});n.timeSignatures.push(m)}var v,g=n.timeSignatures[0];if(!(v=g.denominator)||v&v-1)throw new a("Denominator is not a power of 2. Time signature: ".concat(g.numerator,"/").concat(g.denominator));if(0===g.numerator)throw new a("Numerator is 0. Time signature: ".concat(g.numerator,"/").concat(g.denominator));if(n.tempos.length>0)d(n),n.tempos[0].time=0,n.tempos=[n.tempos[0]];else{var y=r.a.Tempo.create({qpm:i.DEFAULT_QUARTERS_PER_MINUTE,time:0});n.tempos.push(y)}var _=h(t,n.tempos[0].qpm);return n.totalQuantizedSteps=f(e.totalTime,_),function(e,t){var n,r=_createForOfIteratorHelper(e.notes);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(i.quantizedStartStep=f(i.startTime,t),i.quantizedEndStep=f(i.endTime,t),i.quantizedEndStep===i.quantizedStartStep&&(i.quantizedEndStep+=1),i.quantizedStartStep<0||i.quantizedEndStep<0)throw new s("Got negative note time: start_step = "+i.quantizedStartStep+", end_step = "+i.quantizedEndStep);i.quantizedEndStep>e.totalQuantizedSteps&&(e.totalQuantizedSteps=i.quantizedEndStep)}}catch(e){r.e(e)}finally{r.f()}p(e).forEach((function(e){if(e.quantizedStep=f(e.time,t),e.quantizedStep<0)throw new s("Got negative event time: step = "+e.quantizedStep)}))}(n,_),n}function v(e){return e.quantizationInfo&&(e.quantizationInfo.stepsPerQuarter>0||e.quantizationInfo.stepsPerSecond>0)}function g(e){if(!v(e))throw new c("NoteSequence ".concat(e.id," is not quantized (missing quantizationInfo)"))}function y(e){return e.quantizationInfo&&e.quantizationInfo.stepsPerQuarter>0}function _(e){if(!y(e))throw new c("NoteSequence ".concat(e.id," is not quantized or is quantized based on absolute timing"))}function k(e){return e.quantizationInfo&&e.quantizationInfo.stepsPerSecond>0}function b(e){if(!k(e))throw new c("NoteSequence ".concat(e.id," is not quantized or is quantized based on relative timing"))}function S(e,t){_(e),d(e);var n=l(e);t?n.tempos&&n.tempos.length>0?n.tempos[0].qpm=t:n.tempos.push(r.a.Tempo.create({time:0,qpm:t})):t=e.tempos&&e.tempos.length>0?n.tempos[0].qpm:i.DEFAULT_QUARTERS_PER_MINUTE;var o=function(e){return e/n.quantizationInfo.stepsPerQuarter*(60/t)};return n.totalTime=o(n.totalQuantizedSteps),n.notes.forEach((function(e){e.startTime=o(e.quantizedStartStep),e.endTime=o(e.quantizedEndStep),n.totalTime=Math.max(n.totalTime,e.endTime),delete e.quantizedStartStep,delete e.quantizedEndStep})),p(n).forEach((function(e){e.time=o(e.time)})),delete n.totalQuantizedSteps,delete n.quantizationInfo,n}function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.DEFAULT_STEPS_PER_QUARTER,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.DEFAULT_QUARTERS_PER_MINUTE;return r.a.create({quantizationInfo:{stepsPerQuarter:e},tempos:[{qpm:t}]})}function x(e){var t=l(e),n=t.notes.concat(t.pitchBends).concat(t.controlChanges),r=Array.from(new Set(n.filter((function(e){return!e.isDrum})).map((function(e){return e.program}))));return n.forEach((function(e){e.isDrum?(e.program=0,e.instrument=r.length):e.instrument=r.indexOf(e.program)})),t}function T(e,t){var n=new Set(e.notes.map((function(e){return e.instrument}))),i=new Set(t.notes.map((function(e){return e.instrument}))),o=[];e.notes.forEach((function(e){i.has(e.instrument)||o.push(r.a.Note.create(e))})),t.notes.forEach((function(e){n.has(e.instrument)&&o.push(r.a.Note.create(e))}));var a=l(e);return a.notes=o.sort((function(e,t){return e.instrument-t.instrument||e.quantizedStartStep-t.quantizedStartStep})),a}function C(e){g(e);var t=l(e);t.notes=[];var n=e.notes.sort((function(e,t){return e.instrument-t.instrument||e.quantizedStartStep-t.quantizedStartStep})),i=new r.a.Note;i.pitch=n[0].pitch,i.instrument=n[0].instrument,i.quantizedStartStep=n[0].quantizedStartStep,i.quantizedEndStep=n[0].quantizedEndStep,t.notes.push(i);for(var o=0,a=1;a<n.length;a++){var s=n[a],u=t.notes[o];if(u.instrument===s.instrument&&u.pitch===s.pitch&&s.quantizedStartStep===u.quantizedEndStep&&s.quantizedStartStep%16!=0)t.notes[o].quantizedEndStep+=s.quantizedEndStep-s.quantizedStartStep;else{var c=new r.a.Note;c.pitch=n[a].pitch,c.instrument=n[a].instrument,c.quantizedStartStep=n[a].quantizedStartStep,c.quantizedEndStep=n[a].quantizedEndStep,t.notes.push(c),o++}}return t}function P(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64;if(function(e){e[e.SUSTAIN_ON=0]="SUSTAIN_ON",e[e.SUSTAIN_OFF=1]="SUSTAIN_OFF",e[e.NOTE_ON=2]="NOTE_ON",e[e.NOTE_OFF=3]="NOTE_OFF"}(t||(t={})),v(e))throw new Error("Can only apply sustain to unquantized NoteSequence.");var r,i=l(e),o=[],a=_createForOfIteratorHelper(i.notes);try{for(a.s();!(r=a.n()).done;){var s=r.value;!1===s.isDrum&&(null!==s.startTime&&o.push({time:s.startTime,type:t.NOTE_ON,event:s}),null!==s.endTime&&o.push({time:s.endTime,type:t.NOTE_OFF,event:s}))}}catch(e){a.e(e)}finally{a.f()}var u,c=_createForOfIteratorHelper(i.controlChanges);try{for(c.s();!(u=c.n()).done;){var h=u.value;if(h.controlNumber===n){var f=h.controlValue;f>=64?o.push({time:h.time,type:t.SUSTAIN_ON,event:h}):f<64&&o.push({time:h.time,type:t.SUSTAIN_OFF,event:h})}}}catch(e){c.e(e)}finally{c.f()}o.sort((function(e,t){return e.time-t.time}));for(var p={},d={},m=0,g=0,y=o;g<y.length;g++){var _=y[g];m=_.time;var k=_.type,b=_.event;if(k===t.SUSTAIN_ON)d[b.instrument]=!0;else if(k===t.SUSTAIN_OFF){d[b.instrument]=!1;var S=[];b.instrument in p||(p[b.instrument]=[]);var w,x=_createForOfIteratorHelper(p[b.instrument]);try{for(x.s();!(w=x.n()).done;){var T=w.value;T.endTime<m?(T.endTime=m,m>i.totalTime&&(i.totalTime=m)):S.push(T)}}catch(e){x.e(e)}finally{x.f()}p[b.instrument]=S}else if(k===t.NOTE_ON){if(!0===d[b.instrument]){var C=[];b.instrument in p||(p[b.instrument]=[]);var P,A=_createForOfIteratorHelper(p[b.instrument]);try{for(A.s();!(P=A.n()).done;){var O=P.value;O.pitch===b.pitch?(O.endTime=m,O.startTime===O.endTime&&i.notes.push(O)):C.push(O)}}catch(e){A.e(e)}finally{A.f()}p[b.instrument]=C}b.instrument in p||(p[b.instrument]=[]),p[b.instrument].push(b)}else if(k===t.NOTE_OFF)if(!0===d[b.instrument]);else{var M=p[b.instrument].indexOf(b);M>-1&&p[b.instrument].splice(M,1)}}for(var N=0,I=Object.values(p);N<I.length;N++){var E,q=_createForOfIteratorHelper(I[N]);try{for(q.s();!(E=q.n()).done;){E.value.endTime=m,i.totalTime=m}}catch(e){q.e(e)}finally{q.f()}}return i}function A(e,t){if(t&&t.length!==e.length)throw new Error("Number of sequences to concatenate and their individual\n durations does not match.");if(v(e[0])){for(var n=0;n<e.length;++n)if(g(e[n]),e[n].quantizationInfo.stepsPerQuarter!==e[0].quantizationInfo.stepsPerQuarter)throw new Error("Not all sequences have the same quantizationInfo");return M(e,"totalQuantizedSteps","quantizedStartStep","quantizedEndStep",t)}return M(e,"totalTime","startTime","endTime",t)}function O(e,t,n,r){return v(e)?N(e,t,n,"totalQuantizedSteps","quantizedStartStep","quantizedEndStep",r):N(e,t,n,"totalTime","startTime","endTime",r)}function M(e,t,n,i,o){for(var a,s=0,u=0;u<e.length;++u){var c=o?o[u]:e[u][t];if(0===c)throw Error("Sequence ".concat(e[u].id," has no ").concat(t,", and no individual duration was provided."));0===u?a=l(e[0]):Array.prototype.push.apply(a.notes,e[u].notes.map((function(e){var t=r.a.Note.create(e);return t[n]+=s,t[i]+=s,t}))),s+=c}return a[t]=s,a}function N(e,t,n,r,i,o,a){var s=l(e);s[r]=n,s.notes=s.notes.filter((function(e){return e[i]>=t&&e[i]<=n&&(a||e[o]<=n)})),s[r]-=t;for(var u=0;u<s.notes.length;u++)s.notes[u][i]-=t,s.notes[u][o]-=t,a&&(s.notes[u][o]=Math.min(s.notes[u][o],s[r]));return s}function I(e,t){g(e);for(var n=l(e),i=n.notes.sort((function(e,t){return e.quantizedStartStep-t.quantizedStartStep})),o=[],a=0,s=[],u=0;u<i.length;u++){var c=i[u],h=c.quantizedStartStep,f=c.quantizedEndStep;if(c.quantizedStartStep-=a,c.quantizedEndStep-=a,!(c.quantizedStartStep<0))if(c.quantizedEndStep<=t)s.push(c);else{if(c.quantizedStartStep<t){var p=r.a.Note.create(c);p.quantizedEndStep=t,p.startTime=p.endTime=void 0,s.push(p),c.quantizedStartStep=a+t,c.quantizedEndStep=f}else c.quantizedStartStep=h,c.quantizedEndStep=f;if((c.quantizedEndStep>t||c.quantizedStartStep>t)&&(u-=1),0!==s.length){var d=l(n);d.notes=s,d.totalQuantizedSteps=t,o.push(d)}s=[],a+=t}}if(0!==s.length){var m=l(n);m.notes=s,m.totalQuantizedSteps=t,o.push(m)}return o}},,function(e,t,n){(function(e){n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return u}));var r=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==e)return e;throw new Error("cannot find the global object")}(),i=r.fetch.bind(r),o=r.performance,a=(r.navigator,!!r.webkitOfflineAudioContext),s=void 0!==r.WorkerGlobalScope;function u(e){if(e=a?44100:e,s)throw new Error("Cannot use offline audio context in a web worker.");var t=r.webkitOfflineAudioContext;return a?new t(1,e,e):new r.OfflineAudioContext(1,e,e)}}).call(this,n(21))},,,function(e,t,n){(function(e){var r=t;function i(e,t,n){for(var r=Object.keys(t),i=0;i<r.length;++i)void 0!==e[r[i]]&&n||(e[r[i]]=t[r[i]]);return e}function o(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&i(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}r.asPromise=n(51),r.base64=n(52),r.EventEmitter=n(53),r.float=n(54),r.inquire=n(55),r.utf8=n(56),r.pool=n(57),r.LongBits=n(58),r.isNode=Boolean(void 0!==e&&e&&e.process&&e.process.versions&&e.process.versions.node),r.global=r.isNode&&e||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,r.emptyArray=Object.freeze?Object.freeze([]):[],r.emptyObject=Object.freeze?Object.freeze({}):{},r.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},r.isString=function(e){return"string"==typeof e||e instanceof String},r.isObject=function(e){return e&&"object"==_typeof(e)},r.isset=r.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=_typeof(n)||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},r.Buffer=function(){try{var e=r.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),r._Buffer_from=null,r._Buffer_allocUnsafe=null,r.newBuffer=function(e){return"number"==typeof e?r.Buffer?r._Buffer_allocUnsafe(e):new r.Array(e):r.Buffer?r._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},r.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,r.Long=r.global.dcodeIO&&r.global.dcodeIO.Long||r.global.Long||r.inquire("long"),r.key2Re=/^true|false|0|1$/,r.key32Re=/^-?(?:0|[1-9][0-9]*)$/,r.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,r.longToHash=function(e){return e?r.LongBits.from(e).toHash():r.LongBits.zeroHash},r.longFromHash=function(e,t){var n=r.LongBits.fromHash(e);return r.Long?r.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},r.merge=i,r.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},r.newError=o,r.ProtocolError=o("ProtocolError"),r.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},r.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},r.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},r._configure=function(){var e=r.Buffer;e?(r._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},r._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):r._Buffer_from=r._Buffer_allocUnsafe=null}}).call(this,n(21))},,,function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==("undefined"==typeof window?"undefined":_typeof(window))&&(n=window)}e.exports=n},,function(e,t,n){n.r(t),n.d(t,"NO_EVENT",(function(){return a})),n.d(t,"NOTE_OFF",(function(){return s})),n.d(t,"Melody",(function(){return u})),n.d(t,"MelodyRhythm",(function(){return c})),n.d(t,"MelodyShape",(function(){return l})),n.d(t,"MelodyRegister",(function(){return h}));var r=n(2),i=n(10),o=n(13),a=0,s=1,u=function(){function e(t,n,r){_classCallCheck(this,e),this.events=t,this.minPitch=n,this.maxPitch=r}return _createClass(e,[{key:"toNoteSequence",value:function(e,t){for(var n=o.createQuantizedNoteSequence(e,t),r=null,u=0;u<this.events.length;++u){var c=this.events[u];switch(c){case a:break;case s:r&&(r.quantizedEndStep=u,n.notes.push(r),r=null);break;default:r&&(r.quantizedEndStep=u,n.notes.push(r)),r=i.a.Note.create({pitch:c-2+this.minPitch,quantizedStartStep:u})}}return r&&(r.quantizedEndStep=this.events.length,n.notes.push(r)),n.totalQuantizedSteps=this.events.length,n}}],[{key:"fromNoteSequence",value:function(t,n,r){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=arguments.length>4?arguments[4]:void 0;o.assertIsQuantizedSequence(t);var u=t.notes.sort((function(e,t){return e.quantizedStartStep===t.quantizedStartStep?t.pitch-e.pitch:e.quantizedStartStep-t.quantizedStartStep})),c=new Int32Array(a||t.totalQuantizedSteps),l=-1;return u.forEach((function(e){if(e.quantizedStartStep===l){if(i)return;throw new Error("`NoteSequence` is not monophonic.")}if(e.pitch<n||e.pitch>r)throw Error("`NoteSequence` has a pitch outside of the valid range: "+e.pitch);c[e.quantizedStartStep]=e.pitch-n+2,c[e.quantizedEndStep]=s,l=e.quantizedStartStep})),new e(c,n,r)}}])}(),c=function(){return _createClass((function e(){_classCallCheck(this,e),this.depth=1}),[{key:"extract",value:function(e){for(var t=e.events.length,n=r.buffer([t,1]),i=0;i<t;++i)n.set(e.events[i]>=2?1:0,i,0);return n.toTensor().as2D(t,1)}}])}(),l=function(){return _createClass((function e(){_classCallCheck(this,e),this.depth=3}),[{key:"extract",value:function(e){for(var t=e.events.length,n=r.buffer([t,3]),i=null,o=null,a=0;a<t;++a)if(e.events[a]>=2){if(null!==i){var s;0===n.get(i,0)&&0===n.get(i,1)&&0===n.get(i,2)&&(i=-1),s=e.events[a]<o?0:e.events[a]>o?2:1;for(var u=a;u>i;--u)n.set(1,u,s)}i=a,o=e.events[a]}if(i!==t-1)if(null===i||0===n.get(i,0)&&0===n.get(i,1)&&0===n.get(i,2))for(var c=0;c<t;++c)n.set(1,c,1);else for(var l=t-1;l>i;--l)for(var h=0;h<3;h++)n.set(n.get(i,h),l,h);return n.toTensor().as2D(t,3)}}])}(),h=function(){return _createClass((function e(t){_classCallCheck(this,e),this.boundaryPitches=t,this.depth=t.length+1}),[{key:"meanMelodyPitch",value:function(e){for(var t=0,n=0,r=null,i=0;i<e.events.length;++i)e.events[i]===s?r=null:e.events[i]>=2&&(r=e.minPitch+e.events[i]-2),null!==r&&(t+=r,n+=1);return n?t/n:null}},{key:"extract",value:function(e){var t=e.events.length,n=this.meanMelodyPitch(e);if(null===n)return r.zeros([t,this.depth]);for(var i=0;i<this.boundaryPitches.length&&n>=this.boundaryPitches[i];)i++;for(var o=r.buffer([t,this.depth]),a=0;a<t;++a)o.set(1,a,i);return o.toTensor().as2D(t,this.depth)}}])}()},,,,,,function(e,t,n){n.r(t),n.d(t,"Performance",(function(){return s}));var r=n(10),i=n(8),o=n(13),a=n(12),s=function(){function e(t,n,r,i,o){_classCallCheck(this,e),this.events=t,this.maxShiftSteps=n,this.numVelocityBins=r,this.program=i,this.isDrum=o}return _createClass(e,[{key:"getNumSteps",value:function(){return this.events.filter((function(e){return"time-shift"===e.type})).map((function(e){return e.steps})).reduce((function(e,t){return e+t}),0)}},{key:"setNumSteps",value:function(e){var t=this.getNumSteps();if(t<e){if(this.events.length){var n=this.events[this.events.length-1];if("time-shift"===n.type){var r=Math.min(e-t,this.maxShiftSteps-n.steps);n.steps+=r,t+=r}}for(;t<e;)t+this.maxShiftSteps>e?(this.events.push({type:"time-shift",steps:e-t}),t=e):(this.events.push({type:"time-shift",steps:this.maxShiftSteps}),t+=this.maxShiftSteps)}else if(t>e)for(;this.events.length&&t>e;){var i=this.events[this.events.length-1];"time-shift"===i.type?t-i.steps<e?(i.steps-=t-e,t=e):(this.events.pop(),t-=i.steps):this.events.pop()}}},{key:"toNoteSequence",value:function(e){for(var t=this,n=this.numVelocityBins?Math.ceil((i.MIDI_VELOCITIES-1)/this.numVelocityBins):void 0,o=r.a.create(),s=0,u=void 0,c=new Map,l=i.MIN_MIDI_PITCH;l<=i.MAX_MIDI_PITCH;++l)c.set(l,[]);var h,f=_createForOfIteratorHelper(this.events);try{for(f.s();!(h=f.n()).done;){var p=h.value;switch(p.type){case"note-on":c.get(p.pitch).push([s,u]);break;case"note-off":var d=c.get(p.pitch);if(d.length){var m=_slicedToArray(d.shift(),2),v=m[0],g=m[1];s>v?o.notes.push(r.a.Note.create({pitch:p.pitch,velocity:g,instrument:e,quantizedStartStep:v,quantizedEndStep:s,program:this.program,isDrum:this.isDrum})):a.log("Ignoring zero-length note: (pitch = ".concat(p.pitch,", step = ").concat(s,")"),"Performance")}else a.log("Ignoring note-off with no previous note-on:(pitch = ".concat(p.pitch,", step = ").concat(s,")"),"Performance");break;case"time-shift":s+=p.steps;break;case"velocity-change":if(!n)throw new Error("Unexpected velocity change event: "+p);u=i.MIN_MIDI_VELOCITY+(p.velocityBin-1)*n+1;break;default:throw new Error("Unrecognized performance event: "+p)}}}catch(e){f.e(e)}finally{f.f()}return c.forEach((function(n,i){var u,c=_createForOfIteratorHelper(n);try{for(c.s();!(u=c.n()).done;){var l=_slicedToArray(u.value,2),h=l[0],f=l[1];s>h?o.notes.push(r.a.Note.create({pitch:i,velocity:f,instrument:e,quantizedStartStep:h,quantizedEndStep:s,program:t.program,isDrum:t.isDrum})):a.log("Ignoring zero-length note: (pitch = ".concat(i,", step = ").concat(s,")"),"Performance")}}catch(e){c.e(e)}finally{c.f()}})),o.totalQuantizedSteps=s,o}}],[{key:"fromNoteSequence",value:function(t,n,r,a){o.assertIsQuantizedSequence(t);var s,u=t.notes.filter((function(e,t){return void 0===a||e.instrument===a})),c=u.sort((function(e,t){return e.startTime===t.startTime?e.pitch-t.pitch:e.startTime-t.startTime})),l=c.map((function(e,t){return{step:e.quantizedStartStep,index:t,isOffset:0}})),h=c.map((function(e,t){return{step:e.quantizedEndStep,index:t,isOffset:1}})),f=l.concat(h).sort((function(e,t){return e.step===t.step?e.index===t.index?e.isOffset-t.isOffset:e.index-t.index:e.step-t.step})),p=r?Math.ceil((i.MIDI_VELOCITIES-1)/r):void 0,d=[],m=0,v=r,g=_createForOfIteratorHelper(f);try{for(g.s();!(s=g.n()).done;){var y=s.value;if(y.step>m){for(;y.step>m+n;)d.push({type:"time-shift",steps:n}),m+=n;d.push({type:"time-shift",steps:y.step-m}),m=y.step}if(y.isOffset)d.push({type:"note-off",pitch:c[y.index].pitch});else{if(p){var _=Math.floor((c[y.index].velocity-i.MIN_MIDI_VELOCITY-1)/p)+1;_!==v&&(d.push({type:"velocity-change",velocityBin:_}),v=_)}d.push({type:"note-on",pitch:c[y.index].pitch})}}}catch(e){g.e(e)}finally{g.f()}var k=!!u.some((function(e){return e.isDrum}))&&(!u.some((function(e){return!e.isDrum}))||void 0),b=Array.from(new Set(u.map((function(e){return e.program})))),S=new e(d,n,r,k||1!==b.length?void 0:b[0],k);return S.setNumSteps(t.totalQuantizedSteps),S}}])}()},,,,function(e,t,n){e.exports=h;var r,i=n(18),o=i.LongBits,a=i.base64,s=i.utf8;function u(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function c(){}function l(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new u(c,0,0),this.tail=this.head,this.states=null}var f=function(){return i.Buffer?function(){return(h.create=function(){return new r})()}:function(){return new h}};function p(e,t,n){t[n]=255&e}function d(e,t){this.len=e,this.next=void 0,this.val=t}function m(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function v(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}h.create=f(),h.alloc=function(e){return new i.Array(e)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(e,t,n){return this.tail=this.tail.next=new u(e,t,n),this.len+=t,this},d.prototype=Object.create(u.prototype),d.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new d((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(m,10,o.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=o.from(e);return this._push(m,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=o.from(e).zzEncode();return this._push(m,t.length(),t)},h.prototype.bool=function(e){return this._push(p,1,e?1:0)},h.prototype.fixed32=function(e){return this._push(v,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=o.from(e);return this._push(v,4,t.lo)._push(v,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(i.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(i.float.writeDoubleLE,8,e)};var g=i.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var r=0;r<e.length;++r)t[n+r]=e[r]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(p,1,0);if(i.isString(e)){var n=h.alloc(t=a.length(e));a.decode(e,n,0),e=n}return this.uint32(t)._push(g,t,e)},h.prototype.string=function(e){var t=s.length(e);return t?this.uint32(t)._push(s.write,t,e):this._push(p,1,0)},h.prototype.fork=function(){return this.states=new l(this),this.head=this.tail=new u(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new u(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},h._configure=function(e){r=e,h.create=f(),r._configure()}},function(e,t,n){e.exports=u;var r,i=n(18),o=i.LongBits,a=i.utf8;function s(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function u(e){this.buf=e,this.pos=0,this.len=e.length}var c,l="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new u(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new u(e);throw Error("illegal buffer")},h=function(){return i.Buffer?function(e){return(u.create=function(e){return i.Buffer.isBuffer(e)?new r(e):l(e)})(e)}:l};function f(){var e=new o(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw s(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw s(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function p(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function d(){if(this.pos+8>this.len)throw s(this,8);return new o(p(this.buf,this.pos+=4),p(this.buf,this.pos+=4))}u.create=h(),u.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,u.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,s(this,10);return c}),u.prototype.int32=function(){return 0|this.uint32()},u.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},u.prototype.bool=function(){return 0!==this.uint32()},u.prototype.fixed32=function(){if(this.pos+4>this.len)throw s(this,4);return p(this.buf,this.pos+=4)},u.prototype.sfixed32=function(){if(this.pos+4>this.len)throw s(this,4);return 0|p(this.buf,this.pos+=4)},u.prototype.float=function(){if(this.pos+4>this.len)throw s(this,4);var e=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},u.prototype.double=function(){if(this.pos+8>this.len)throw s(this,4);var e=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},u.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw s(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},u.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},u.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw s(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw s(this)}while(128&this.buf[this.pos++]);return this},u.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},u._configure=function(e){r=e,u.create=h(),r._configure();var t=i.Long?"toLong":"toNumber";i.merge(u.prototype,{int64:function(){return f.call(this)[t](!1)},uint64:function(){return f.call(this)[t](!0)},sint64:function(){return f.call(this).zzDecode()[t](!1)},fixed64:function(){return d.call(this)[t](!0)},sfixed64:function(){return d.call(this)[t](!1)}})}},function(e,t,n){var r,i,o=n(49),a=o.Reader,s=o.Writer,u=o.util,c=o.roots.default||(o.roots.default={});c.tensorflow=((i={}).magenta=((r={}).NoteSequence=function(){function e(e){if(this.timeSignatures=[],this.keySignatures=[],this.tempos=[],this.notes=[],this.pitchBends=[],this.controlChanges=[],this.partInfos=[],this.textAnnotations=[],this.sectionAnnotations=[],this.sectionGroups=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t,n;return e.prototype.id="",e.prototype.filename="",e.prototype.referenceNumber=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.collectionName="",e.prototype.ticksPerQuarter=0,e.prototype.timeSignatures=u.emptyArray,e.prototype.keySignatures=u.emptyArray,e.prototype.tempos=u.emptyArray,e.prototype.notes=u.emptyArray,e.prototype.totalTime=0,e.prototype.totalQuantizedSteps=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.pitchBends=u.emptyArray,e.prototype.controlChanges=u.emptyArray,e.prototype.partInfos=u.emptyArray,e.prototype.sourceInfo=null,e.prototype.textAnnotations=u.emptyArray,e.prototype.sectionAnnotations=u.emptyArray,e.prototype.sectionGroups=u.emptyArray,e.prototype.quantizationInfo=null,e.prototype.subsequenceInfo=null,e.prototype.sequenceMetadata=null,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.id&&e.hasOwnProperty("id")&&t.uint32(10).string(e.id),null!=e.filename&&e.hasOwnProperty("filename")&&t.uint32(18).string(e.filename),null!=e.collectionName&&e.hasOwnProperty("collectionName")&&t.uint32(26).string(e.collectionName),null!=e.ticksPerQuarter&&e.hasOwnProperty("ticksPerQuarter")&&t.uint32(32).int32(e.ticksPerQuarter),null!=e.timeSignatures&&e.timeSignatures.length)for(var n=0;n<e.timeSignatures.length;++n)c.tensorflow.magenta.NoteSequence.TimeSignature.encode(e.timeSignatures[n],t.uint32(42).fork()).ldelim();if(null!=e.keySignatures&&e.keySignatures.length)for(n=0;n<e.keySignatures.length;++n)c.tensorflow.magenta.NoteSequence.KeySignature.encode(e.keySignatures[n],t.uint32(50).fork()).ldelim();if(null!=e.tempos&&e.tempos.length)for(n=0;n<e.tempos.length;++n)c.tensorflow.magenta.NoteSequence.Tempo.encode(e.tempos[n],t.uint32(58).fork()).ldelim();if(null!=e.notes&&e.notes.length)for(n=0;n<e.notes.length;++n)c.tensorflow.magenta.NoteSequence.Note.encode(e.notes[n],t.uint32(66).fork()).ldelim();if(null!=e.totalTime&&e.hasOwnProperty("totalTime")&&t.uint32(73).double(e.totalTime),null!=e.pitchBends&&e.pitchBends.length)for(n=0;n<e.pitchBends.length;++n)c.tensorflow.magenta.NoteSequence.PitchBend.encode(e.pitchBends[n],t.uint32(82).fork()).ldelim();if(null!=e.controlChanges&&e.controlChanges.length)for(n=0;n<e.controlChanges.length;++n)c.tensorflow.magenta.NoteSequence.ControlChange.encode(e.controlChanges[n],t.uint32(90).fork()).ldelim();if(null!=e.partInfos&&e.partInfos.length)for(n=0;n<e.partInfos.length;++n)c.tensorflow.magenta.NoteSequence.PartInfo.encode(e.partInfos[n],t.uint32(98).fork()).ldelim();if(null!=e.sourceInfo&&e.hasOwnProperty("sourceInfo")&&c.tensorflow.magenta.NoteSequence.SourceInfo.encode(e.sourceInfo,t.uint32(106).fork()).ldelim(),null!=e.textAnnotations&&e.textAnnotations.length)for(n=0;n<e.textAnnotations.length;++n)c.tensorflow.magenta.NoteSequence.TextAnnotation.encode(e.textAnnotations[n],t.uint32(114).fork()).ldelim();if(null!=e.quantizationInfo&&e.hasOwnProperty("quantizationInfo")&&c.tensorflow.magenta.NoteSequence.QuantizationInfo.encode(e.quantizationInfo,t.uint32(122).fork()).ldelim(),null!=e.totalQuantizedSteps&&e.hasOwnProperty("totalQuantizedSteps")&&t.uint32(128).int64(e.totalQuantizedSteps),null!=e.subsequenceInfo&&e.hasOwnProperty("subsequenceInfo")&&c.tensorflow.magenta.NoteSequence.SubsequenceInfo.encode(e.subsequenceInfo,t.uint32(138).fork()).ldelim(),null!=e.referenceNumber&&e.hasOwnProperty("referenceNumber")&&t.uint32(144).int64(e.referenceNumber),null!=e.sequenceMetadata&&e.hasOwnProperty("sequenceMetadata")&&c.tensorflow.magenta.SequenceMetadata.encode(e.sequenceMetadata,t.uint32(154).fork()).ldelim(),null!=e.sectionAnnotations&&e.sectionAnnotations.length)for(n=0;n<e.sectionAnnotations.length;++n)c.tensorflow.magenta.NoteSequence.SectionAnnotation.encode(e.sectionAnnotations[n],t.uint32(162).fork()).ldelim();if(null!=e.sectionGroups&&e.sectionGroups.length)for(n=0;n<e.sectionGroups.length;++n)c.tensorflow.magenta.NoteSequence.SectionGroup.encode(e.sectionGroups[n],t.uint32(170).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.id=e.string();break;case 2:r.filename=e.string();break;case 18:r.referenceNumber=u.Long?e.int64().toNumber():e.int64();break;case 3:r.collectionName=e.string();break;case 4:r.ticksPerQuarter=e.int32();break;case 5:r.timeSignatures&&r.timeSignatures.length||(r.timeSignatures=[]),r.timeSignatures.push(c.tensorflow.magenta.NoteSequence.TimeSignature.decode(e,e.uint32()));break;case 6:r.keySignatures&&r.keySignatures.length||(r.keySignatures=[]),r.keySignatures.push(c.tensorflow.magenta.NoteSequence.KeySignature.decode(e,e.uint32()));break;case 7:r.tempos&&r.tempos.length||(r.tempos=[]),r.tempos.push(c.tensorflow.magenta.NoteSequence.Tempo.decode(e,e.uint32()));break;case 8:r.notes&&r.notes.length||(r.notes=[]),r.notes.push(c.tensorflow.magenta.NoteSequence.Note.decode(e,e.uint32()));break;case 9:r.totalTime=e.double();break;case 16:r.totalQuantizedSteps=u.Long?e.int64().toNumber():e.int64();break;case 10:r.pitchBends&&r.pitchBends.length||(r.pitchBends=[]),r.pitchBends.push(c.tensorflow.magenta.NoteSequence.PitchBend.decode(e,e.uint32()));break;case 11:r.controlChanges&&r.controlChanges.length||(r.controlChanges=[]),r.controlChanges.push(c.tensorflow.magenta.NoteSequence.ControlChange.decode(e,e.uint32()));break;case 12:r.partInfos&&r.partInfos.length||(r.partInfos=[]),r.partInfos.push(c.tensorflow.magenta.NoteSequence.PartInfo.decode(e,e.uint32()));break;case 13:r.sourceInfo=c.tensorflow.magenta.NoteSequence.SourceInfo.decode(e,e.uint32());break;case 14:r.textAnnotations&&r.textAnnotations.length||(r.textAnnotations=[]),r.textAnnotations.push(c.tensorflow.magenta.NoteSequence.TextAnnotation.decode(e,e.uint32()));break;case 20:r.sectionAnnotations&&r.sectionAnnotations.length||(r.sectionAnnotations=[]),r.sectionAnnotations.push(c.tensorflow.magenta.NoteSequence.SectionAnnotation.decode(e,e.uint32()));break;case 21:r.sectionGroups&&r.sectionGroups.length||(r.sectionGroups=[]),r.sectionGroups.push(c.tensorflow.magenta.NoteSequence.SectionGroup.decode(e,e.uint32()));break;case 15:r.quantizationInfo=c.tensorflow.magenta.NoteSequence.QuantizationInfo.decode(e,e.uint32());break;case 17:r.subsequenceInfo=c.tensorflow.magenta.NoteSequence.SubsequenceInfo.decode(e,e.uint32());break;case 19:r.sequenceMetadata=c.tensorflow.magenta.SequenceMetadata.decode(e,e.uint32());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.id&&e.hasOwnProperty("id")&&!u.isString(e.id))return"id: string expected";if(null!=e.filename&&e.hasOwnProperty("filename")&&!u.isString(e.filename))return"filename: string expected";if(null!=e.referenceNumber&&e.hasOwnProperty("referenceNumber")&&!(u.isInteger(e.referenceNumber)||e.referenceNumber&&u.isInteger(e.referenceNumber.low)&&u.isInteger(e.referenceNumber.high)))return"referenceNumber: integer|Long expected";if(null!=e.collectionName&&e.hasOwnProperty("collectionName")&&!u.isString(e.collectionName))return"collectionName: string expected";if(null!=e.ticksPerQuarter&&e.hasOwnProperty("ticksPerQuarter")&&!u.isInteger(e.ticksPerQuarter))return"ticksPerQuarter: integer expected";if(null!=e.timeSignatures&&e.hasOwnProperty("timeSignatures")){if(!Array.isArray(e.timeSignatures))return"timeSignatures: array expected";for(var t=0;t<e.timeSignatures.length;++t)if(n=c.tensorflow.magenta.NoteSequence.TimeSignature.verify(e.timeSignatures[t]))return"timeSignatures."+n}if(null!=e.keySignatures&&e.hasOwnProperty("keySignatures")){if(!Array.isArray(e.keySignatures))return"keySignatures: array expected";for(t=0;t<e.keySignatures.length;++t)if(n=c.tensorflow.magenta.NoteSequence.KeySignature.verify(e.keySignatures[t]))return"keySignatures."+n}if(null!=e.tempos&&e.hasOwnProperty("tempos")){if(!Array.isArray(e.tempos))return"tempos: array expected";for(t=0;t<e.tempos.length;++t)if(n=c.tensorflow.magenta.NoteSequence.Tempo.verify(e.tempos[t]))return"tempos."+n}if(null!=e.notes&&e.hasOwnProperty("notes")){if(!Array.isArray(e.notes))return"notes: array expected";for(t=0;t<e.notes.length;++t)if(n=c.tensorflow.magenta.NoteSequence.Note.verify(e.notes[t]))return"notes."+n}if(null!=e.totalTime&&e.hasOwnProperty("totalTime")&&"number"!=typeof e.totalTime)return"totalTime: number expected";if(null!=e.totalQuantizedSteps&&e.hasOwnProperty("totalQuantizedSteps")&&!(u.isInteger(e.totalQuantizedSteps)||e.totalQuantizedSteps&&u.isInteger(e.totalQuantizedSteps.low)&&u.isInteger(e.totalQuantizedSteps.high)))return"totalQuantizedSteps: integer|Long expected";if(null!=e.pitchBends&&e.hasOwnProperty("pitchBends")){if(!Array.isArray(e.pitchBends))return"pitchBends: array expected";for(t=0;t<e.pitchBends.length;++t)if(n=c.tensorflow.magenta.NoteSequence.PitchBend.verify(e.pitchBends[t]))return"pitchBends."+n}if(null!=e.controlChanges&&e.hasOwnProperty("controlChanges")){if(!Array.isArray(e.controlChanges))return"controlChanges: array expected";for(t=0;t<e.controlChanges.length;++t)if(n=c.tensorflow.magenta.NoteSequence.ControlChange.verify(e.controlChanges[t]))return"controlChanges."+n}if(null!=e.partInfos&&e.hasOwnProperty("partInfos")){if(!Array.isArray(e.partInfos))return"partInfos: array expected";for(t=0;t<e.partInfos.length;++t)if(n=c.tensorflow.magenta.NoteSequence.PartInfo.verify(e.partInfos[t]))return"partInfos."+n}if(null!=e.sourceInfo&&e.hasOwnProperty("sourceInfo")&&(n=c.tensorflow.magenta.NoteSequence.SourceInfo.verify(e.sourceInfo)))return"sourceInfo."+n;if(null!=e.textAnnotations&&e.hasOwnProperty("textAnnotations")){if(!Array.isArray(e.textAnnotations))return"textAnnotations: array expected";for(t=0;t<e.textAnnotations.length;++t)if(n=c.tensorflow.magenta.NoteSequence.TextAnnotation.verify(e.textAnnotations[t]))return"textAnnotations."+n}if(null!=e.sectionAnnotations&&e.hasOwnProperty("sectionAnnotations")){if(!Array.isArray(e.sectionAnnotations))return"sectionAnnotations: array expected";for(t=0;t<e.sectionAnnotations.length;++t)if(n=c.tensorflow.magenta.NoteSequence.SectionAnnotation.verify(e.sectionAnnotations[t]))return"sectionAnnotations."+n}if(null!=e.sectionGroups&&e.hasOwnProperty("sectionGroups")){if(!Array.isArray(e.sectionGroups))return"sectionGroups: array expected";for(t=0;t<e.sectionGroups.length;++t){var n;if(n=c.tensorflow.magenta.NoteSequence.SectionGroup.verify(e.sectionGroups[t]))return"sectionGroups."+n}}return null!=e.quantizationInfo&&e.hasOwnProperty("quantizationInfo")&&(n=c.tensorflow.magenta.NoteSequence.QuantizationInfo.verify(e.quantizationInfo))?"quantizationInfo."+n:null!=e.subsequenceInfo&&e.hasOwnProperty("subsequenceInfo")&&(n=c.tensorflow.magenta.NoteSequence.SubsequenceInfo.verify(e.subsequenceInfo))?"subsequenceInfo."+n:null!=e.sequenceMetadata&&e.hasOwnProperty("sequenceMetadata")&&(n=c.tensorflow.magenta.SequenceMetadata.verify(e.sequenceMetadata))?"sequenceMetadata."+n:null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence)return e;var t=new c.tensorflow.magenta.NoteSequence;if(null!=e.id&&(t.id=String(e.id)),null!=e.filename&&(t.filename=String(e.filename)),null!=e.referenceNumber&&(u.Long?(t.referenceNumber=u.Long.fromValue(e.referenceNumber)).unsigned=!1:"string"==typeof e.referenceNumber?t.referenceNumber=parseInt(e.referenceNumber,10):"number"==typeof e.referenceNumber?t.referenceNumber=e.referenceNumber:"object"==_typeof(e.referenceNumber)&&(t.referenceNumber=new u.LongBits(e.referenceNumber.low>>>0,e.referenceNumber.high>>>0).toNumber())),null!=e.collectionName&&(t.collectionName=String(e.collectionName)),null!=e.ticksPerQuarter&&(t.ticksPerQuarter=0|e.ticksPerQuarter),e.timeSignatures){if(!Array.isArray(e.timeSignatures))throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: array expected");t.timeSignatures=[];for(var n=0;n<e.timeSignatures.length;++n){if("object"!=_typeof(e.timeSignatures[n]))throw TypeError(".tensorflow.magenta.NoteSequence.timeSignatures: object expected");t.timeSignatures[n]=c.tensorflow.magenta.NoteSequence.TimeSignature.fromObject(e.timeSignatures[n])}}if(e.keySignatures){if(!Array.isArray(e.keySignatures))throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: array expected");for(t.keySignatures=[],n=0;n<e.keySignatures.length;++n){if("object"!=_typeof(e.keySignatures[n]))throw TypeError(".tensorflow.magenta.NoteSequence.keySignatures: object expected");t.keySignatures[n]=c.tensorflow.magenta.NoteSequence.KeySignature.fromObject(e.keySignatures[n])}}if(e.tempos){if(!Array.isArray(e.tempos))throw TypeError(".tensorflow.magenta.NoteSequence.tempos: array expected");for(t.tempos=[],n=0;n<e.tempos.length;++n){if("object"!=_typeof(e.tempos[n]))throw TypeError(".tensorflow.magenta.NoteSequence.tempos: object expected");t.tempos[n]=c.tensorflow.magenta.NoteSequence.Tempo.fromObject(e.tempos[n])}}if(e.notes){if(!Array.isArray(e.notes))throw TypeError(".tensorflow.magenta.NoteSequence.notes: array expected");for(t.notes=[],n=0;n<e.notes.length;++n){if("object"!=_typeof(e.notes[n]))throw TypeError(".tensorflow.magenta.NoteSequence.notes: object expected");t.notes[n]=c.tensorflow.magenta.NoteSequence.Note.fromObject(e.notes[n])}}if(null!=e.totalTime&&(t.totalTime=Number(e.totalTime)),null!=e.totalQuantizedSteps&&(u.Long?(t.totalQuantizedSteps=u.Long.fromValue(e.totalQuantizedSteps)).unsigned=!1:"string"==typeof e.totalQuantizedSteps?t.totalQuantizedSteps=parseInt(e.totalQuantizedSteps,10):"number"==typeof e.totalQuantizedSteps?t.totalQuantizedSteps=e.totalQuantizedSteps:"object"==_typeof(e.totalQuantizedSteps)&&(t.totalQuantizedSteps=new u.LongBits(e.totalQuantizedSteps.low>>>0,e.totalQuantizedSteps.high>>>0).toNumber())),e.pitchBends){if(!Array.isArray(e.pitchBends))throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: array expected");for(t.pitchBends=[],n=0;n<e.pitchBends.length;++n){if("object"!=_typeof(e.pitchBends[n]))throw TypeError(".tensorflow.magenta.NoteSequence.pitchBends: object expected");t.pitchBends[n]=c.tensorflow.magenta.NoteSequence.PitchBend.fromObject(e.pitchBends[n])}}if(e.controlChanges){if(!Array.isArray(e.controlChanges))throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: array expected");for(t.controlChanges=[],n=0;n<e.controlChanges.length;++n){if("object"!=_typeof(e.controlChanges[n]))throw TypeError(".tensorflow.magenta.NoteSequence.controlChanges: object expected");t.controlChanges[n]=c.tensorflow.magenta.NoteSequence.ControlChange.fromObject(e.controlChanges[n])}}if(e.partInfos){if(!Array.isArray(e.partInfos))throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: array expected");for(t.partInfos=[],n=0;n<e.partInfos.length;++n){if("object"!=_typeof(e.partInfos[n]))throw TypeError(".tensorflow.magenta.NoteSequence.partInfos: object expected");t.partInfos[n]=c.tensorflow.magenta.NoteSequence.PartInfo.fromObject(e.partInfos[n])}}if(null!=e.sourceInfo){if("object"!=_typeof(e.sourceInfo))throw TypeError(".tensorflow.magenta.NoteSequence.sourceInfo: object expected");t.sourceInfo=c.tensorflow.magenta.NoteSequence.SourceInfo.fromObject(e.sourceInfo)}if(e.textAnnotations){if(!Array.isArray(e.textAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: array expected");for(t.textAnnotations=[],n=0;n<e.textAnnotations.length;++n){if("object"!=_typeof(e.textAnnotations[n]))throw TypeError(".tensorflow.magenta.NoteSequence.textAnnotations: object expected");t.textAnnotations[n]=c.tensorflow.magenta.NoteSequence.TextAnnotation.fromObject(e.textAnnotations[n])}}if(e.sectionAnnotations){if(!Array.isArray(e.sectionAnnotations))throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: array expected");for(t.sectionAnnotations=[],n=0;n<e.sectionAnnotations.length;++n){if("object"!=_typeof(e.sectionAnnotations[n]))throw TypeError(".tensorflow.magenta.NoteSequence.sectionAnnotations: object expected");t.sectionAnnotations[n]=c.tensorflow.magenta.NoteSequence.SectionAnnotation.fromObject(e.sectionAnnotations[n])}}if(e.sectionGroups){if(!Array.isArray(e.sectionGroups))throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: array expected");for(t.sectionGroups=[],n=0;n<e.sectionGroups.length;++n){if("object"!=_typeof(e.sectionGroups[n]))throw TypeError(".tensorflow.magenta.NoteSequence.sectionGroups: object expected");t.sectionGroups[n]=c.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(e.sectionGroups[n])}}if(null!=e.quantizationInfo){if("object"!=_typeof(e.quantizationInfo))throw TypeError(".tensorflow.magenta.NoteSequence.quantizationInfo: object expected");t.quantizationInfo=c.tensorflow.magenta.NoteSequence.QuantizationInfo.fromObject(e.quantizationInfo)}if(null!=e.subsequenceInfo){if("object"!=_typeof(e.subsequenceInfo))throw TypeError(".tensorflow.magenta.NoteSequence.subsequenceInfo: object expected");t.subsequenceInfo=c.tensorflow.magenta.NoteSequence.SubsequenceInfo.fromObject(e.subsequenceInfo)}if(null!=e.sequenceMetadata){if("object"!=_typeof(e.sequenceMetadata))throw TypeError(".tensorflow.magenta.NoteSequence.sequenceMetadata: object expected");t.sequenceMetadata=c.tensorflow.magenta.SequenceMetadata.fromObject(e.sequenceMetadata)}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.timeSignatures=[],n.keySignatures=[],n.tempos=[],n.notes=[],n.pitchBends=[],n.controlChanges=[],n.partInfos=[],n.textAnnotations=[],n.sectionAnnotations=[],n.sectionGroups=[]),t.defaults){if(n.id="",n.filename="",n.collectionName="",n.ticksPerQuarter=0,n.totalTime=0,n.sourceInfo=null,n.quantizationInfo=null,u.Long){var r=new u.Long(0,0,!1);n.totalQuantizedSteps=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.totalQuantizedSteps=t.longs===String?"0":0;n.subsequenceInfo=null,u.Long?(r=new u.Long(0,0,!1),n.referenceNumber=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.referenceNumber=t.longs===String?"0":0,n.sequenceMetadata=null}if(null!=e.id&&e.hasOwnProperty("id")&&(n.id=e.id),null!=e.filename&&e.hasOwnProperty("filename")&&(n.filename=e.filename),null!=e.collectionName&&e.hasOwnProperty("collectionName")&&(n.collectionName=e.collectionName),null!=e.ticksPerQuarter&&e.hasOwnProperty("ticksPerQuarter")&&(n.ticksPerQuarter=e.ticksPerQuarter),e.timeSignatures&&e.timeSignatures.length){n.timeSignatures=[];for(var i=0;i<e.timeSignatures.length;++i)n.timeSignatures[i]=c.tensorflow.magenta.NoteSequence.TimeSignature.toObject(e.timeSignatures[i],t)}if(e.keySignatures&&e.keySignatures.length)for(n.keySignatures=[],i=0;i<e.keySignatures.length;++i)n.keySignatures[i]=c.tensorflow.magenta.NoteSequence.KeySignature.toObject(e.keySignatures[i],t);if(e.tempos&&e.tempos.length)for(n.tempos=[],i=0;i<e.tempos.length;++i)n.tempos[i]=c.tensorflow.magenta.NoteSequence.Tempo.toObject(e.tempos[i],t);if(e.notes&&e.notes.length)for(n.notes=[],i=0;i<e.notes.length;++i)n.notes[i]=c.tensorflow.magenta.NoteSequence.Note.toObject(e.notes[i],t);if(null!=e.totalTime&&e.hasOwnProperty("totalTime")&&(n.totalTime=t.json&&!isFinite(e.totalTime)?String(e.totalTime):e.totalTime),e.pitchBends&&e.pitchBends.length)for(n.pitchBends=[],i=0;i<e.pitchBends.length;++i)n.pitchBends[i]=c.tensorflow.magenta.NoteSequence.PitchBend.toObject(e.pitchBends[i],t);if(e.controlChanges&&e.controlChanges.length)for(n.controlChanges=[],i=0;i<e.controlChanges.length;++i)n.controlChanges[i]=c.tensorflow.magenta.NoteSequence.ControlChange.toObject(e.controlChanges[i],t);if(e.partInfos&&e.partInfos.length)for(n.partInfos=[],i=0;i<e.partInfos.length;++i)n.partInfos[i]=c.tensorflow.magenta.NoteSequence.PartInfo.toObject(e.partInfos[i],t);if(null!=e.sourceInfo&&e.hasOwnProperty("sourceInfo")&&(n.sourceInfo=c.tensorflow.magenta.NoteSequence.SourceInfo.toObject(e.sourceInfo,t)),e.textAnnotations&&e.textAnnotations.length)for(n.textAnnotations=[],i=0;i<e.textAnnotations.length;++i)n.textAnnotations[i]=c.tensorflow.magenta.NoteSequence.TextAnnotation.toObject(e.textAnnotations[i],t);if(null!=e.quantizationInfo&&e.hasOwnProperty("quantizationInfo")&&(n.quantizationInfo=c.tensorflow.magenta.NoteSequence.QuantizationInfo.toObject(e.quantizationInfo,t)),null!=e.totalQuantizedSteps&&e.hasOwnProperty("totalQuantizedSteps")&&("number"==typeof e.totalQuantizedSteps?n.totalQuantizedSteps=t.longs===String?String(e.totalQuantizedSteps):e.totalQuantizedSteps:n.totalQuantizedSteps=t.longs===String?u.Long.prototype.toString.call(e.totalQuantizedSteps):t.longs===Number?new u.LongBits(e.totalQuantizedSteps.low>>>0,e.totalQuantizedSteps.high>>>0).toNumber():e.totalQuantizedSteps),null!=e.subsequenceInfo&&e.hasOwnProperty("subsequenceInfo")&&(n.subsequenceInfo=c.tensorflow.magenta.NoteSequence.SubsequenceInfo.toObject(e.subsequenceInfo,t)),null!=e.referenceNumber&&e.hasOwnProperty("referenceNumber")&&("number"==typeof e.referenceNumber?n.referenceNumber=t.longs===String?String(e.referenceNumber):e.referenceNumber:n.referenceNumber=t.longs===String?u.Long.prototype.toString.call(e.referenceNumber):t.longs===Number?new u.LongBits(e.referenceNumber.low>>>0,e.referenceNumber.high>>>0).toNumber():e.referenceNumber),null!=e.sequenceMetadata&&e.hasOwnProperty("sequenceMetadata")&&(n.sequenceMetadata=c.tensorflow.magenta.SequenceMetadata.toObject(e.sequenceMetadata,t)),e.sectionAnnotations&&e.sectionAnnotations.length)for(n.sectionAnnotations=[],i=0;i<e.sectionAnnotations.length;++i)n.sectionAnnotations[i]=c.tensorflow.magenta.NoteSequence.SectionAnnotation.toObject(e.sectionAnnotations[i],t);if(e.sectionGroups&&e.sectionGroups.length)for(n.sectionGroups=[],i=0;i<e.sectionGroups.length;++i)n.sectionGroups[i]=c.tensorflow.magenta.NoteSequence.SectionGroup.toObject(e.sectionGroups[i],t);return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.Note=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.pitch=0,e.prototype.pitchName=0,e.prototype.velocity=0,e.prototype.startTime=0,e.prototype.quantizedStartStep=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.endTime=0,e.prototype.quantizedEndStep=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.numerator=0,e.prototype.denominator=0,e.prototype.instrument=0,e.prototype.program=0,e.prototype.isDrum=!1,e.prototype.part=0,e.prototype.voice=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.pitch&&e.hasOwnProperty("pitch")&&t.uint32(8).int32(e.pitch),null!=e.velocity&&e.hasOwnProperty("velocity")&&t.uint32(16).int32(e.velocity),null!=e.startTime&&e.hasOwnProperty("startTime")&&t.uint32(25).double(e.startTime),null!=e.endTime&&e.hasOwnProperty("endTime")&&t.uint32(33).double(e.endTime),null!=e.numerator&&e.hasOwnProperty("numerator")&&t.uint32(40).int32(e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&t.uint32(48).int32(e.denominator),null!=e.instrument&&e.hasOwnProperty("instrument")&&t.uint32(56).int32(e.instrument),null!=e.program&&e.hasOwnProperty("program")&&t.uint32(64).int32(e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&t.uint32(72).bool(e.isDrum),null!=e.part&&e.hasOwnProperty("part")&&t.uint32(80).int32(e.part),null!=e.pitchName&&e.hasOwnProperty("pitchName")&&t.uint32(88).int32(e.pitchName),null!=e.voice&&e.hasOwnProperty("voice")&&t.uint32(96).int32(e.voice),null!=e.quantizedStartStep&&e.hasOwnProperty("quantizedStartStep")&&t.uint32(104).int64(e.quantizedStartStep),null!=e.quantizedEndStep&&e.hasOwnProperty("quantizedEndStep")&&t.uint32(112).int64(e.quantizedEndStep),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.Note;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.pitch=e.int32();break;case 11:r.pitchName=e.int32();break;case 2:r.velocity=e.int32();break;case 3:r.startTime=e.double();break;case 13:r.quantizedStartStep=u.Long?e.int64().toNumber():e.int64();break;case 4:r.endTime=e.double();break;case 14:r.quantizedEndStep=u.Long?e.int64().toNumber():e.int64();break;case 5:r.numerator=e.int32();break;case 6:r.denominator=e.int32();break;case 7:r.instrument=e.int32();break;case 8:r.program=e.int32();break;case 9:r.isDrum=e.bool();break;case 10:r.part=e.int32();break;case 12:r.voice=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.pitch&&e.hasOwnProperty("pitch")&&!u.isInteger(e.pitch))return"pitch: integer expected";if(null!=e.pitchName&&e.hasOwnProperty("pitchName"))switch(e.pitchName){default:return"pitchName: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:}return null!=e.velocity&&e.hasOwnProperty("velocity")&&!u.isInteger(e.velocity)?"velocity: integer expected":null!=e.startTime&&e.hasOwnProperty("startTime")&&"number"!=typeof e.startTime?"startTime: number expected":null!=e.quantizedStartStep&&e.hasOwnProperty("quantizedStartStep")&&!(u.isInteger(e.quantizedStartStep)||e.quantizedStartStep&&u.isInteger(e.quantizedStartStep.low)&&u.isInteger(e.quantizedStartStep.high))?"quantizedStartStep: integer|Long expected":null!=e.endTime&&e.hasOwnProperty("endTime")&&"number"!=typeof e.endTime?"endTime: number expected":null!=e.quantizedEndStep&&e.hasOwnProperty("quantizedEndStep")&&!(u.isInteger(e.quantizedEndStep)||e.quantizedEndStep&&u.isInteger(e.quantizedEndStep.low)&&u.isInteger(e.quantizedEndStep.high))?"quantizedEndStep: integer|Long expected":null!=e.numerator&&e.hasOwnProperty("numerator")&&!u.isInteger(e.numerator)?"numerator: integer expected":null!=e.denominator&&e.hasOwnProperty("denominator")&&!u.isInteger(e.denominator)?"denominator: integer expected":null!=e.instrument&&e.hasOwnProperty("instrument")&&!u.isInteger(e.instrument)?"instrument: integer expected":null!=e.program&&e.hasOwnProperty("program")&&!u.isInteger(e.program)?"program: integer expected":null!=e.isDrum&&e.hasOwnProperty("isDrum")&&"boolean"!=typeof e.isDrum?"isDrum: boolean expected":null!=e.part&&e.hasOwnProperty("part")&&!u.isInteger(e.part)?"part: integer expected":null!=e.voice&&e.hasOwnProperty("voice")&&!u.isInteger(e.voice)?"voice: integer expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.Note)return e;var t=new c.tensorflow.magenta.NoteSequence.Note;switch(null!=e.pitch&&(t.pitch=0|e.pitch),e.pitchName){case"UNKNOWN_PITCH_NAME":case 0:t.pitchName=0;break;case"F_FLAT_FLAT":case 1:t.pitchName=1;break;case"C_FLAT_FLAT":case 2:t.pitchName=2;break;case"G_FLAT_FLAT":case 3:t.pitchName=3;break;case"D_FLAT_FLAT":case 4:t.pitchName=4;break;case"A_FLAT_FLAT":case 5:t.pitchName=5;break;case"E_FLAT_FLAT":case 6:t.pitchName=6;break;case"B_FLAT_FLAT":case 7:t.pitchName=7;break;case"F_FLAT":case 8:t.pitchName=8;break;case"C_FLAT":case 9:t.pitchName=9;break;case"G_FLAT":case 10:t.pitchName=10;break;case"D_FLAT":case 11:t.pitchName=11;break;case"A_FLAT":case 12:t.pitchName=12;break;case"E_FLAT":case 13:t.pitchName=13;break;case"B_FLAT":case 14:t.pitchName=14;break;case"F":case 15:t.pitchName=15;break;case"C":case 16:t.pitchName=16;break;case"G":case 17:t.pitchName=17;break;case"D":case 18:t.pitchName=18;break;case"A":case 19:t.pitchName=19;break;case"E":case 20:t.pitchName=20;break;case"B":case 21:t.pitchName=21;break;case"F_SHARP":case 22:t.pitchName=22;break;case"C_SHARP":case 23:t.pitchName=23;break;case"G_SHARP":case 24:t.pitchName=24;break;case"D_SHARP":case 25:t.pitchName=25;break;case"A_SHARP":case 26:t.pitchName=26;break;case"E_SHARP":case 27:t.pitchName=27;break;case"B_SHARP":case 28:t.pitchName=28;break;case"F_SHARP_SHARP":case 29:t.pitchName=29;break;case"C_SHARP_SHARP":case 30:t.pitchName=30;break;case"G_SHARP_SHARP":case 31:t.pitchName=31;break;case"D_SHARP_SHARP":case 32:t.pitchName=32;break;case"A_SHARP_SHARP":case 33:t.pitchName=33;break;case"E_SHARP_SHARP":case 34:t.pitchName=34;break;case"B_SHARP_SHARP":case 35:t.pitchName=35}return null!=e.velocity&&(t.velocity=0|e.velocity),null!=e.startTime&&(t.startTime=Number(e.startTime)),null!=e.quantizedStartStep&&(u.Long?(t.quantizedStartStep=u.Long.fromValue(e.quantizedStartStep)).unsigned=!1:"string"==typeof e.quantizedStartStep?t.quantizedStartStep=parseInt(e.quantizedStartStep,10):"number"==typeof e.quantizedStartStep?t.quantizedStartStep=e.quantizedStartStep:"object"==_typeof(e.quantizedStartStep)&&(t.quantizedStartStep=new u.LongBits(e.quantizedStartStep.low>>>0,e.quantizedStartStep.high>>>0).toNumber())),null!=e.endTime&&(t.endTime=Number(e.endTime)),null!=e.quantizedEndStep&&(u.Long?(t.quantizedEndStep=u.Long.fromValue(e.quantizedEndStep)).unsigned=!1:"string"==typeof e.quantizedEndStep?t.quantizedEndStep=parseInt(e.quantizedEndStep,10):"number"==typeof e.quantizedEndStep?t.quantizedEndStep=e.quantizedEndStep:"object"==_typeof(e.quantizedEndStep)&&(t.quantizedEndStep=new u.LongBits(e.quantizedEndStep.low>>>0,e.quantizedEndStep.high>>>0).toNumber())),null!=e.numerator&&(t.numerator=0|e.numerator),null!=e.denominator&&(t.denominator=0|e.denominator),null!=e.instrument&&(t.instrument=0|e.instrument),null!=e.program&&(t.program=0|e.program),null!=e.isDrum&&(t.isDrum=Boolean(e.isDrum)),null!=e.part&&(t.part=0|e.part),null!=e.voice&&(t.voice=0|e.voice),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.pitch=0,n.velocity=0,n.startTime=0,n.endTime=0,n.numerator=0,n.denominator=0,n.instrument=0,n.program=0,n.isDrum=!1,n.part=0,n.pitchName=t.enums===String?"UNKNOWN_PITCH_NAME":0,n.voice=0,u.Long){var r=new u.Long(0,0,!1);n.quantizedStartStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedStartStep=t.longs===String?"0":0;u.Long?(r=new u.Long(0,0,!1),n.quantizedEndStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r):n.quantizedEndStep=t.longs===String?"0":0}return null!=e.pitch&&e.hasOwnProperty("pitch")&&(n.pitch=e.pitch),null!=e.velocity&&e.hasOwnProperty("velocity")&&(n.velocity=e.velocity),null!=e.startTime&&e.hasOwnProperty("startTime")&&(n.startTime=t.json&&!isFinite(e.startTime)?String(e.startTime):e.startTime),null!=e.endTime&&e.hasOwnProperty("endTime")&&(n.endTime=t.json&&!isFinite(e.endTime)?String(e.endTime):e.endTime),null!=e.numerator&&e.hasOwnProperty("numerator")&&(n.numerator=e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&(n.denominator=e.denominator),null!=e.instrument&&e.hasOwnProperty("instrument")&&(n.instrument=e.instrument),null!=e.program&&e.hasOwnProperty("program")&&(n.program=e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&(n.isDrum=e.isDrum),null!=e.part&&e.hasOwnProperty("part")&&(n.part=e.part),null!=e.pitchName&&e.hasOwnProperty("pitchName")&&(n.pitchName=t.enums===String?c.tensorflow.magenta.NoteSequence.PitchName[e.pitchName]:e.pitchName),null!=e.voice&&e.hasOwnProperty("voice")&&(n.voice=e.voice),null!=e.quantizedStartStep&&e.hasOwnProperty("quantizedStartStep")&&("number"==typeof e.quantizedStartStep?n.quantizedStartStep=t.longs===String?String(e.quantizedStartStep):e.quantizedStartStep:n.quantizedStartStep=t.longs===String?u.Long.prototype.toString.call(e.quantizedStartStep):t.longs===Number?new u.LongBits(e.quantizedStartStep.low>>>0,e.quantizedStartStep.high>>>0).toNumber():e.quantizedStartStep),null!=e.quantizedEndStep&&e.hasOwnProperty("quantizedEndStep")&&("number"==typeof e.quantizedEndStep?n.quantizedEndStep=t.longs===String?String(e.quantizedEndStep):e.quantizedEndStep:n.quantizedEndStep=t.longs===String?u.Long.prototype.toString.call(e.quantizedEndStep):t.longs===Number?new u.LongBits(e.quantizedEndStep.low>>>0,e.quantizedEndStep.high>>>0).toNumber():e.quantizedEndStep),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.PitchName=(t={},(n=Object.create(t))[t[0]="UNKNOWN_PITCH_NAME"]=0,n[t[1]="F_FLAT_FLAT"]=1,n[t[2]="C_FLAT_FLAT"]=2,n[t[3]="G_FLAT_FLAT"]=3,n[t[4]="D_FLAT_FLAT"]=4,n[t[5]="A_FLAT_FLAT"]=5,n[t[6]="E_FLAT_FLAT"]=6,n[t[7]="B_FLAT_FLAT"]=7,n[t[8]="F_FLAT"]=8,n[t[9]="C_FLAT"]=9,n[t[10]="G_FLAT"]=10,n[t[11]="D_FLAT"]=11,n[t[12]="A_FLAT"]=12,n[t[13]="E_FLAT"]=13,n[t[14]="B_FLAT"]=14,n[t[15]="F"]=15,n[t[16]="C"]=16,n[t[17]="G"]=17,n[t[18]="D"]=18,n[t[19]="A"]=19,n[t[20]="E"]=20,n[t[21]="B"]=21,n[t[22]="F_SHARP"]=22,n[t[23]="C_SHARP"]=23,n[t[24]="G_SHARP"]=24,n[t[25]="D_SHARP"]=25,n[t[26]="A_SHARP"]=26,n[t[27]="E_SHARP"]=27,n[t[28]="B_SHARP"]=28,n[t[29]="F_SHARP_SHARP"]=29,n[t[30]="C_SHARP_SHARP"]=30,n[t[31]="G_SHARP_SHARP"]=31,n[t[32]="D_SHARP_SHARP"]=32,n[t[33]="A_SHARP_SHARP"]=33,n[t[34]="E_SHARP_SHARP"]=34,n[t[35]="B_SHARP_SHARP"]=35,n),e.TimeSignature=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.numerator=0,e.prototype.denominator=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.numerator&&e.hasOwnProperty("numerator")&&t.uint32(16).int32(e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&t.uint32(24).int32(e.denominator),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.TimeSignature;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.numerator=e.int32();break;case 3:r.denominator=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time?"time: number expected":null!=e.numerator&&e.hasOwnProperty("numerator")&&!u.isInteger(e.numerator)?"numerator: integer expected":null!=e.denominator&&e.hasOwnProperty("denominator")&&!u.isInteger(e.denominator)?"denominator: integer expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.TimeSignature)return e;var t=new c.tensorflow.magenta.NoteSequence.TimeSignature;return null!=e.time&&(t.time=Number(e.time)),null!=e.numerator&&(t.numerator=0|e.numerator),null!=e.denominator&&(t.denominator=0|e.denominator),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.numerator=0,n.denominator=0),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.numerator&&e.hasOwnProperty("numerator")&&(n.numerator=e.numerator),null!=e.denominator&&e.hasOwnProperty("denominator")&&(n.denominator=e.denominator),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.KeySignature=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.key=0,e.prototype.mode=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.key&&e.hasOwnProperty("key")&&t.uint32(16).int32(e.key),null!=e.mode&&e.hasOwnProperty("mode")&&t.uint32(24).int32(e.mode),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.KeySignature;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.key=e.int32();break;case 3:r.mode=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time)return"time: number expected";if(null!=e.key&&e.hasOwnProperty("key"))switch(e.key){default:return"key: enum value expected";case 0:case 1:case 1:case 2:case 3:case 3:case 4:case 5:case 6:case 6:case 7:case 8:case 8:case 9:case 10:case 10:case 11:}if(null!=e.mode&&e.hasOwnProperty("mode"))switch(e.mode){default:return"mode: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:}return null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.KeySignature)return e;var t=new c.tensorflow.magenta.NoteSequence.KeySignature;switch(null!=e.time&&(t.time=Number(e.time)),e.key){case"C":case 0:t.key=0;break;case"C_SHARP":case 1:case"D_FLAT":case 1:t.key=1;break;case"D":case 2:t.key=2;break;case"D_SHARP":case 3:case"E_FLAT":case 3:t.key=3;break;case"E":case 4:t.key=4;break;case"F":case 5:t.key=5;break;case"F_SHARP":case 6:case"G_FLAT":case 6:t.key=6;break;case"G":case 7:t.key=7;break;case"G_SHARP":case 8:case"A_FLAT":case 8:t.key=8;break;case"A":case 9:t.key=9;break;case"A_SHARP":case 10:case"B_FLAT":case 10:t.key=10;break;case"B":case 11:t.key=11}switch(e.mode){case"MAJOR":case 0:t.mode=0;break;case"MINOR":case 1:t.mode=1;break;case"NOT_SPECIFIED":case 2:t.mode=2;break;case"MIXOLYDIAN":case 3:t.mode=3;break;case"DORIAN":case 4:t.mode=4;break;case"PHRYGIAN":case 5:t.mode=5;break;case"LYDIAN":case 6:t.mode=6;break;case"LOCRIAN":case 7:t.mode=7}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.key=t.enums===String?"C":0,n.mode=t.enums===String?"MAJOR":0),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.key&&e.hasOwnProperty("key")&&(n.key=t.enums===String?c.tensorflow.magenta.NoteSequence.KeySignature.Key[e.key]:e.key),null!=e.mode&&e.hasOwnProperty("mode")&&(n.mode=t.enums===String?c.tensorflow.magenta.NoteSequence.KeySignature.Mode[e.mode]:e.mode),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.Key=function(){var e={},t=Object.create(e);return t[e[0]="C"]=0,t[e[1]="C_SHARP"]=1,t.D_FLAT=1,t[e[2]="D"]=2,t[e[3]="D_SHARP"]=3,t.E_FLAT=3,t[e[4]="E"]=4,t[e[5]="F"]=5,t[e[6]="F_SHARP"]=6,t.G_FLAT=6,t[e[7]="G"]=7,t[e[8]="G_SHARP"]=8,t.A_FLAT=8,t[e[9]="A"]=9,t[e[10]="A_SHARP"]=10,t.B_FLAT=10,t[e[11]="B"]=11,t}(),e.Mode=function(){var e={},t=Object.create(e);return t[e[0]="MAJOR"]=0,t[e[1]="MINOR"]=1,t[e[2]="NOT_SPECIFIED"]=2,t[e[3]="MIXOLYDIAN"]=3,t[e[4]="DORIAN"]=4,t[e[5]="PHRYGIAN"]=5,t[e[6]="LYDIAN"]=6,t[e[7]="LOCRIAN"]=7,t}(),e}(),e.Tempo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.qpm=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.qpm&&e.hasOwnProperty("qpm")&&t.uint32(17).double(e.qpm),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.Tempo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.qpm=e.double();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time?"time: number expected":null!=e.qpm&&e.hasOwnProperty("qpm")&&"number"!=typeof e.qpm?"qpm: number expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.Tempo)return e;var t=new c.tensorflow.magenta.NoteSequence.Tempo;return null!=e.time&&(t.time=Number(e.time)),null!=e.qpm&&(t.qpm=Number(e.qpm)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.qpm=0),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.qpm&&e.hasOwnProperty("qpm")&&(n.qpm=t.json&&!isFinite(e.qpm)?String(e.qpm):e.qpm),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.PitchBend=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.bend=0,e.prototype.instrument=0,e.prototype.program=0,e.prototype.isDrum=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.bend&&e.hasOwnProperty("bend")&&t.uint32(16).int32(e.bend),null!=e.instrument&&e.hasOwnProperty("instrument")&&t.uint32(24).int32(e.instrument),null!=e.program&&e.hasOwnProperty("program")&&t.uint32(32).int32(e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&t.uint32(40).bool(e.isDrum),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.PitchBend;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 2:r.bend=e.int32();break;case 3:r.instrument=e.int32();break;case 4:r.program=e.int32();break;case 5:r.isDrum=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time?"time: number expected":null!=e.bend&&e.hasOwnProperty("bend")&&!u.isInteger(e.bend)?"bend: integer expected":null!=e.instrument&&e.hasOwnProperty("instrument")&&!u.isInteger(e.instrument)?"instrument: integer expected":null!=e.program&&e.hasOwnProperty("program")&&!u.isInteger(e.program)?"program: integer expected":null!=e.isDrum&&e.hasOwnProperty("isDrum")&&"boolean"!=typeof e.isDrum?"isDrum: boolean expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.PitchBend)return e;var t=new c.tensorflow.magenta.NoteSequence.PitchBend;return null!=e.time&&(t.time=Number(e.time)),null!=e.bend&&(t.bend=0|e.bend),null!=e.instrument&&(t.instrument=0|e.instrument),null!=e.program&&(t.program=0|e.program),null!=e.isDrum&&(t.isDrum=Boolean(e.isDrum)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.time=0,n.bend=0,n.instrument=0,n.program=0,n.isDrum=!1),null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.bend&&e.hasOwnProperty("bend")&&(n.bend=e.bend),null!=e.instrument&&e.hasOwnProperty("instrument")&&(n.instrument=e.instrument),null!=e.program&&e.hasOwnProperty("program")&&(n.program=e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&(n.isDrum=e.isDrum),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.ControlChange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.quantizedStep=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.controlNumber=0,e.prototype.controlValue=0,e.prototype.instrument=0,e.prototype.program=0,e.prototype.isDrum=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.controlNumber&&e.hasOwnProperty("controlNumber")&&t.uint32(16).int32(e.controlNumber),null!=e.controlValue&&e.hasOwnProperty("controlValue")&&t.uint32(24).int32(e.controlValue),null!=e.instrument&&e.hasOwnProperty("instrument")&&t.uint32(32).int32(e.instrument),null!=e.program&&e.hasOwnProperty("program")&&t.uint32(40).int32(e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&t.uint32(48).bool(e.isDrum),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&t.uint32(56).int64(e.quantizedStep),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.ControlChange;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 7:r.quantizedStep=u.Long?e.int64().toNumber():e.int64();break;case 2:r.controlNumber=e.int32();break;case 3:r.controlValue=e.int32();break;case 4:r.instrument=e.int32();break;case 5:r.program=e.int32();break;case 6:r.isDrum=e.bool();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time?"time: number expected":null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&!(u.isInteger(e.quantizedStep)||e.quantizedStep&&u.isInteger(e.quantizedStep.low)&&u.isInteger(e.quantizedStep.high))?"quantizedStep: integer|Long expected":null!=e.controlNumber&&e.hasOwnProperty("controlNumber")&&!u.isInteger(e.controlNumber)?"controlNumber: integer expected":null!=e.controlValue&&e.hasOwnProperty("controlValue")&&!u.isInteger(e.controlValue)?"controlValue: integer expected":null!=e.instrument&&e.hasOwnProperty("instrument")&&!u.isInteger(e.instrument)?"instrument: integer expected":null!=e.program&&e.hasOwnProperty("program")&&!u.isInteger(e.program)?"program: integer expected":null!=e.isDrum&&e.hasOwnProperty("isDrum")&&"boolean"!=typeof e.isDrum?"isDrum: boolean expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.ControlChange)return e;var t=new c.tensorflow.magenta.NoteSequence.ControlChange;return null!=e.time&&(t.time=Number(e.time)),null!=e.quantizedStep&&(u.Long?(t.quantizedStep=u.Long.fromValue(e.quantizedStep)).unsigned=!1:"string"==typeof e.quantizedStep?t.quantizedStep=parseInt(e.quantizedStep,10):"number"==typeof e.quantizedStep?t.quantizedStep=e.quantizedStep:"object"==_typeof(e.quantizedStep)&&(t.quantizedStep=new u.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber())),null!=e.controlNumber&&(t.controlNumber=0|e.controlNumber),null!=e.controlValue&&(t.controlValue=0|e.controlValue),null!=e.instrument&&(t.instrument=0|e.instrument),null!=e.program&&(t.program=0|e.program),null!=e.isDrum&&(t.isDrum=Boolean(e.isDrum)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.time=0,n.controlNumber=0,n.controlValue=0,n.instrument=0,n.program=0,n.isDrum=!1,u.Long){var r=new u.Long(0,0,!1);n.quantizedStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedStep=t.longs===String?"0":0;return null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.controlNumber&&e.hasOwnProperty("controlNumber")&&(n.controlNumber=e.controlNumber),null!=e.controlValue&&e.hasOwnProperty("controlValue")&&(n.controlValue=e.controlValue),null!=e.instrument&&e.hasOwnProperty("instrument")&&(n.instrument=e.instrument),null!=e.program&&e.hasOwnProperty("program")&&(n.program=e.program),null!=e.isDrum&&e.hasOwnProperty("isDrum")&&(n.isDrum=e.isDrum),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&("number"==typeof e.quantizedStep?n.quantizedStep=t.longs===String?String(e.quantizedStep):e.quantizedStep:n.quantizedStep=t.longs===String?u.Long.prototype.toString.call(e.quantizedStep):t.longs===Number?new u.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber():e.quantizedStep),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.PartInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.part=0,e.prototype.name="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.part&&e.hasOwnProperty("part")&&t.uint32(8).int32(e.part),null!=e.name&&e.hasOwnProperty("name")&&t.uint32(18).string(e.name),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.PartInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.part=e.int32();break;case 2:r.name=e.string();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.part&&e.hasOwnProperty("part")&&!u.isInteger(e.part)?"part: integer expected":null!=e.name&&e.hasOwnProperty("name")&&!u.isString(e.name)?"name: string expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.PartInfo)return e;var t=new c.tensorflow.magenta.NoteSequence.PartInfo;return null!=e.part&&(t.part=0|e.part),null!=e.name&&(t.name=String(e.name)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.part=0,n.name=""),null!=e.part&&e.hasOwnProperty("part")&&(n.part=e.part),null!=e.name&&e.hasOwnProperty("name")&&(n.name=e.name),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.SourceInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sourceType=0,e.prototype.encodingType=0,e.prototype.parser=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.sourceType&&e.hasOwnProperty("sourceType")&&t.uint32(8).int32(e.sourceType),null!=e.encodingType&&e.hasOwnProperty("encodingType")&&t.uint32(16).int32(e.encodingType),null!=e.parser&&e.hasOwnProperty("parser")&&t.uint32(24).int32(e.parser),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.SourceInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sourceType=e.int32();break;case 2:r.encodingType=e.int32();break;case 3:r.parser=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.sourceType&&e.hasOwnProperty("sourceType"))switch(e.sourceType){default:return"sourceType: enum value expected";case 0:case 1:case 2:}if(null!=e.encodingType&&e.hasOwnProperty("encodingType"))switch(e.encodingType){default:return"encodingType: enum value expected";case 0:case 1:case 2:case 3:case 4:}if(null!=e.parser&&e.hasOwnProperty("parser"))switch(e.parser){default:return"parser: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 6:}return null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.SourceInfo)return e;var t=new c.tensorflow.magenta.NoteSequence.SourceInfo;switch(e.sourceType){case"UNKNOWN_SOURCE_TYPE":case 0:t.sourceType=0;break;case"SCORE_BASED":case 1:t.sourceType=1;break;case"PERFORMANCE_BASED":case 2:t.sourceType=2}switch(e.encodingType){case"UNKNOWN_ENCODING_TYPE":case 0:t.encodingType=0;break;case"MUSIC_XML":case 1:t.encodingType=1;break;case"ABC":case 2:t.encodingType=2;break;case"MIDI":case 3:t.encodingType=3;break;case"MUSICNET":case 4:t.encodingType=4}switch(e.parser){case"UNKNOWN_PARSER":case 0:t.parser=0;break;case"MUSIC21":case 1:t.parser=1;break;case"PRETTY_MIDI":case 2:t.parser=2;break;case"MAGENTA_MUSIC_XML":case 3:t.parser=3;break;case"MAGENTA_MUSICNET":case 4:t.parser=4;break;case"MAGENTA_ABC":case 5:t.parser=5;break;case"TONEJS_MIDI_CONVERT":case 6:t.parser=6}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.sourceType=t.enums===String?"UNKNOWN_SOURCE_TYPE":0,n.encodingType=t.enums===String?"UNKNOWN_ENCODING_TYPE":0,n.parser=t.enums===String?"UNKNOWN_PARSER":0),null!=e.sourceType&&e.hasOwnProperty("sourceType")&&(n.sourceType=t.enums===String?c.tensorflow.magenta.NoteSequence.SourceInfo.SourceType[e.sourceType]:e.sourceType),null!=e.encodingType&&e.hasOwnProperty("encodingType")&&(n.encodingType=t.enums===String?c.tensorflow.magenta.NoteSequence.SourceInfo.EncodingType[e.encodingType]:e.encodingType),null!=e.parser&&e.hasOwnProperty("parser")&&(n.parser=t.enums===String?c.tensorflow.magenta.NoteSequence.SourceInfo.Parser[e.parser]:e.parser),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.SourceType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_SOURCE_TYPE"]=0,t[e[1]="SCORE_BASED"]=1,t[e[2]="PERFORMANCE_BASED"]=2,t}(),e.EncodingType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_ENCODING_TYPE"]=0,t[e[1]="MUSIC_XML"]=1,t[e[2]="ABC"]=2,t[e[3]="MIDI"]=3,t[e[4]="MUSICNET"]=4,t}(),e.Parser=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN_PARSER"]=0,t[e[1]="MUSIC21"]=1,t[e[2]="PRETTY_MIDI"]=2,t[e[3]="MAGENTA_MUSIC_XML"]=3,t[e[4]="MAGENTA_MUSICNET"]=4,t[e[5]="MAGENTA_ABC"]=5,t[e[6]="TONEJS_MIDI_CONVERT"]=6,t}(),e}(),e.TextAnnotation=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.quantizedStep=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.text="",e.prototype.annotationType=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.text&&e.hasOwnProperty("text")&&t.uint32(18).string(e.text),null!=e.annotationType&&e.hasOwnProperty("annotationType")&&t.uint32(24).int32(e.annotationType),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&t.uint32(32).int64(e.quantizedStep),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.TextAnnotation;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 4:r.quantizedStep=u.Long?e.int64().toNumber():e.int64();break;case 2:r.text=e.string();break;case 3:r.annotationType=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time)return"time: number expected";if(null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&!(u.isInteger(e.quantizedStep)||e.quantizedStep&&u.isInteger(e.quantizedStep.low)&&u.isInteger(e.quantizedStep.high)))return"quantizedStep: integer|Long expected";if(null!=e.text&&e.hasOwnProperty("text")&&!u.isString(e.text))return"text: string expected";if(null!=e.annotationType&&e.hasOwnProperty("annotationType"))switch(e.annotationType){default:return"annotationType: enum value expected";case 0:case 1:case 2:}return null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.TextAnnotation)return e;var t=new c.tensorflow.magenta.NoteSequence.TextAnnotation;switch(null!=e.time&&(t.time=Number(e.time)),null!=e.quantizedStep&&(u.Long?(t.quantizedStep=u.Long.fromValue(e.quantizedStep)).unsigned=!1:"string"==typeof e.quantizedStep?t.quantizedStep=parseInt(e.quantizedStep,10):"number"==typeof e.quantizedStep?t.quantizedStep=e.quantizedStep:"object"==_typeof(e.quantizedStep)&&(t.quantizedStep=new u.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber())),null!=e.text&&(t.text=String(e.text)),e.annotationType){case"UNKNOWN":case 0:t.annotationType=0;break;case"CHORD_SYMBOL":case 1:t.annotationType=1;break;case"BEAT":case 2:t.annotationType=2}return t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.time=0,n.text="",n.annotationType=t.enums===String?"UNKNOWN":0,u.Long){var r=new u.Long(0,0,!1);n.quantizedStep=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.quantizedStep=t.longs===String?"0":0;return null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.text&&e.hasOwnProperty("text")&&(n.text=e.text),null!=e.annotationType&&e.hasOwnProperty("annotationType")&&(n.annotationType=t.enums===String?c.tensorflow.magenta.NoteSequence.TextAnnotation.TextAnnotationType[e.annotationType]:e.annotationType),null!=e.quantizedStep&&e.hasOwnProperty("quantizedStep")&&("number"==typeof e.quantizedStep?n.quantizedStep=t.longs===String?String(e.quantizedStep):e.quantizedStep:n.quantizedStep=t.longs===String?u.Long.prototype.toString.call(e.quantizedStep):t.longs===Number?new u.LongBits(e.quantizedStep.low>>>0,e.quantizedStep.high>>>0).toNumber():e.quantizedStep),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e.TextAnnotationType=function(){var e={},t=Object.create(e);return t[e[0]="UNKNOWN"]=0,t[e[1]="CHORD_SYMBOL"]=1,t[e[2]="BEAT"]=2,t}(),e}(),e.QuantizationInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.stepsPerQuarter=0,e.prototype.stepsPerSecond=0,Object.defineProperty(e.prototype,"resolution",{get:u.oneOfGetter(t=["stepsPerQuarter","stepsPerSecond"]),set:u.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.stepsPerQuarter&&e.hasOwnProperty("stepsPerQuarter")&&t.uint32(8).int32(e.stepsPerQuarter),null!=e.stepsPerSecond&&e.hasOwnProperty("stepsPerSecond")&&t.uint32(16).int32(e.stepsPerSecond),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.QuantizationInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.stepsPerQuarter=e.int32();break;case 2:r.stepsPerSecond=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";var t={};if(null!=e.stepsPerQuarter&&e.hasOwnProperty("stepsPerQuarter")&&(t.resolution=1,!u.isInteger(e.stepsPerQuarter)))return"stepsPerQuarter: integer expected";if(null!=e.stepsPerSecond&&e.hasOwnProperty("stepsPerSecond")){if(1===t.resolution)return"resolution: multiple values";if(t.resolution=1,!u.isInteger(e.stepsPerSecond))return"stepsPerSecond: integer expected"}return null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.QuantizationInfo)return e;var t=new c.tensorflow.magenta.NoteSequence.QuantizationInfo;return null!=e.stepsPerQuarter&&(t.stepsPerQuarter=0|e.stepsPerQuarter),null!=e.stepsPerSecond&&(t.stepsPerSecond=0|e.stepsPerSecond),t},e.toObject=function(e,t){t||(t={});var n={};return null!=e.stepsPerQuarter&&e.hasOwnProperty("stepsPerQuarter")&&(n.stepsPerQuarter=e.stepsPerQuarter,t.oneofs&&(n.resolution="stepsPerQuarter")),null!=e.stepsPerSecond&&e.hasOwnProperty("stepsPerSecond")&&(n.stepsPerSecond=e.stepsPerSecond,t.oneofs&&(n.resolution="stepsPerSecond")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.SubsequenceInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.startTimeOffset=0,e.prototype.endTimeOffset=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.startTimeOffset&&e.hasOwnProperty("startTimeOffset")&&t.uint32(9).double(e.startTimeOffset),null!=e.endTimeOffset&&e.hasOwnProperty("endTimeOffset")&&t.uint32(17).double(e.endTimeOffset),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.SubsequenceInfo;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.startTimeOffset=e.double();break;case 2:r.endTimeOffset=e.double();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.startTimeOffset&&e.hasOwnProperty("startTimeOffset")&&"number"!=typeof e.startTimeOffset?"startTimeOffset: number expected":null!=e.endTimeOffset&&e.hasOwnProperty("endTimeOffset")&&"number"!=typeof e.endTimeOffset?"endTimeOffset: number expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.SubsequenceInfo)return e;var t=new c.tensorflow.magenta.NoteSequence.SubsequenceInfo;return null!=e.startTimeOffset&&(t.startTimeOffset=Number(e.startTimeOffset)),null!=e.endTimeOffset&&(t.endTimeOffset=Number(e.endTimeOffset)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.startTimeOffset=0,n.endTimeOffset=0),null!=e.startTimeOffset&&e.hasOwnProperty("startTimeOffset")&&(n.startTimeOffset=t.json&&!isFinite(e.startTimeOffset)?String(e.startTimeOffset):e.startTimeOffset),null!=e.endTimeOffset&&e.hasOwnProperty("endTimeOffset")&&(n.endTimeOffset=t.json&&!isFinite(e.endTimeOffset)?String(e.endTimeOffset):e.endTimeOffset),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.SectionAnnotation=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.time=0,e.prototype.sectionId=u.Long?u.Long.fromBits(0,0,!1):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.time&&e.hasOwnProperty("time")&&t.uint32(9).double(e.time),null!=e.sectionId&&e.hasOwnProperty("sectionId")&&t.uint32(32).int64(e.sectionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.SectionAnnotation;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.time=e.double();break;case 4:r.sectionId=u.Long?e.int64().toNumber():e.int64();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.time&&e.hasOwnProperty("time")&&"number"!=typeof e.time?"time: number expected":null!=e.sectionId&&e.hasOwnProperty("sectionId")&&!(u.isInteger(e.sectionId)||e.sectionId&&u.isInteger(e.sectionId.low)&&u.isInteger(e.sectionId.high))?"sectionId: integer|Long expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.SectionAnnotation)return e;var t=new c.tensorflow.magenta.NoteSequence.SectionAnnotation;return null!=e.time&&(t.time=Number(e.time)),null!=e.sectionId&&(u.Long?(t.sectionId=u.Long.fromValue(e.sectionId)).unsigned=!1:"string"==typeof e.sectionId?t.sectionId=parseInt(e.sectionId,10):"number"==typeof e.sectionId?t.sectionId=e.sectionId:"object"==_typeof(e.sectionId)&&(t.sectionId=new u.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber())),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.time=0,u.Long){var r=new u.Long(0,0,!1);n.sectionId=t.longs===String?r.toString():t.longs===Number?r.toNumber():r}else n.sectionId=t.longs===String?"0":0;return null!=e.time&&e.hasOwnProperty("time")&&(n.time=t.json&&!isFinite(e.time)?String(e.time):e.time),null!=e.sectionId&&e.hasOwnProperty("sectionId")&&("number"==typeof e.sectionId?n.sectionId=t.longs===String?String(e.sectionId):e.sectionId:n.sectionId=t.longs===String?u.Long.prototype.toString.call(e.sectionId):t.longs===Number?new u.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber():e.sectionId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.Section=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t;return e.prototype.sectionId=u.Long?u.Long.fromBits(0,0,!1):0,e.prototype.sectionGroup=null,Object.defineProperty(e.prototype,"sectionType",{get:u.oneOfGetter(t=["sectionId","sectionGroup"]),set:u.oneOfSetter(t)}),e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.sectionId&&e.hasOwnProperty("sectionId")&&t.uint32(8).int64(e.sectionId),null!=e.sectionGroup&&e.hasOwnProperty("sectionGroup")&&c.tensorflow.magenta.NoteSequence.SectionGroup.encode(e.sectionGroup,t.uint32(18).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.Section;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sectionId=u.Long?e.int64().toNumber():e.int64();break;case 2:r.sectionGroup=c.tensorflow.magenta.NoteSequence.SectionGroup.decode(e,e.uint32());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";var t={};if(null!=e.sectionId&&e.hasOwnProperty("sectionId")&&(t.sectionType=1,!(u.isInteger(e.sectionId)||e.sectionId&&u.isInteger(e.sectionId.low)&&u.isInteger(e.sectionId.high))))return"sectionId: integer|Long expected";if(null!=e.sectionGroup&&e.hasOwnProperty("sectionGroup")){if(1===t.sectionType)return"sectionType: multiple values";t.sectionType=1;var n=c.tensorflow.magenta.NoteSequence.SectionGroup.verify(e.sectionGroup);if(n)return"sectionGroup."+n}return null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.Section)return e;var t=new c.tensorflow.magenta.NoteSequence.Section;if(null!=e.sectionId&&(u.Long?(t.sectionId=u.Long.fromValue(e.sectionId)).unsigned=!1:"string"==typeof e.sectionId?t.sectionId=parseInt(e.sectionId,10):"number"==typeof e.sectionId?t.sectionId=e.sectionId:"object"==_typeof(e.sectionId)&&(t.sectionId=new u.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber())),null!=e.sectionGroup){if("object"!=_typeof(e.sectionGroup))throw TypeError(".tensorflow.magenta.NoteSequence.Section.sectionGroup: object expected");t.sectionGroup=c.tensorflow.magenta.NoteSequence.SectionGroup.fromObject(e.sectionGroup)}return t},e.toObject=function(e,t){t||(t={});var n={};return null!=e.sectionId&&e.hasOwnProperty("sectionId")&&("number"==typeof e.sectionId?n.sectionId=t.longs===String?String(e.sectionId):e.sectionId:n.sectionId=t.longs===String?u.Long.prototype.toString.call(e.sectionId):t.longs===Number?new u.LongBits(e.sectionId.low>>>0,e.sectionId.high>>>0).toNumber():e.sectionId,t.oneofs&&(n.sectionType="sectionId")),null!=e.sectionGroup&&e.hasOwnProperty("sectionGroup")&&(n.sectionGroup=c.tensorflow.magenta.NoteSequence.SectionGroup.toObject(e.sectionGroup,t),t.oneofs&&(n.sectionType="sectionGroup")),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e.SectionGroup=function(){function e(e){if(this.sections=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sections=u.emptyArray,e.prototype.numTimes=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.sections&&e.sections.length)for(var n=0;n<e.sections.length;++n)c.tensorflow.magenta.NoteSequence.Section.encode(e.sections[n],t.uint32(10).fork()).ldelim();return null!=e.numTimes&&e.hasOwnProperty("numTimes")&&t.uint32(16).int32(e.numTimes),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.NoteSequence.SectionGroup;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.sections&&r.sections.length||(r.sections=[]),r.sections.push(c.tensorflow.magenta.NoteSequence.Section.decode(e,e.uint32()));break;case 2:r.numTimes=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.sections&&e.hasOwnProperty("sections")){if(!Array.isArray(e.sections))return"sections: array expected";for(var t=0;t<e.sections.length;++t){var n=c.tensorflow.magenta.NoteSequence.Section.verify(e.sections[t]);if(n)return"sections."+n}}return null!=e.numTimes&&e.hasOwnProperty("numTimes")&&!u.isInteger(e.numTimes)?"numTimes: integer expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.NoteSequence.SectionGroup)return e;var t=new c.tensorflow.magenta.NoteSequence.SectionGroup;if(e.sections){if(!Array.isArray(e.sections))throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: array expected");t.sections=[];for(var n=0;n<e.sections.length;++n){if("object"!=_typeof(e.sections[n]))throw TypeError(".tensorflow.magenta.NoteSequence.SectionGroup.sections: object expected");t.sections[n]=c.tensorflow.magenta.NoteSequence.Section.fromObject(e.sections[n])}}return null!=e.numTimes&&(t.numTimes=0|e.numTimes),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.sections=[]),t.defaults&&(n.numTimes=0),e.sections&&e.sections.length){n.sections=[];for(var r=0;r<e.sections.length;++r)n.sections[r]=c.tensorflow.magenta.NoteSequence.Section.toObject(e.sections[r],t)}return null!=e.numTimes&&e.hasOwnProperty("numTimes")&&(n.numTimes=e.numTimes),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),e}(),r.SequenceMetadata=function(){function e(e){if(this.genre=[],this.composers=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.title="",e.prototype.artist="",e.prototype.genre=u.emptyArray,e.prototype.composers=u.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=s.create()),null!=e.title&&e.hasOwnProperty("title")&&t.uint32(10).string(e.title),null!=e.artist&&e.hasOwnProperty("artist")&&t.uint32(18).string(e.artist),null!=e.genre&&e.genre.length)for(var n=0;n<e.genre.length;++n)t.uint32(26).string(e.genre[n]);if(null!=e.composers&&e.composers.length)for(n=0;n<e.composers.length;++n)t.uint32(34).string(e.composers[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.SequenceMetadata;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.title=e.string();break;case 2:r.artist=e.string();break;case 3:r.genre&&r.genre.length||(r.genre=[]),r.genre.push(e.string());break;case 4:r.composers&&r.composers.length||(r.composers=[]),r.composers.push(e.string());break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=_typeof(e)||null===e)return"object expected";if(null!=e.title&&e.hasOwnProperty("title")&&!u.isString(e.title))return"title: string expected";if(null!=e.artist&&e.hasOwnProperty("artist")&&!u.isString(e.artist))return"artist: string expected";if(null!=e.genre&&e.hasOwnProperty("genre")){if(!Array.isArray(e.genre))return"genre: array expected";for(var t=0;t<e.genre.length;++t)if(!u.isString(e.genre[t]))return"genre: string[] expected"}if(null!=e.composers&&e.hasOwnProperty("composers")){if(!Array.isArray(e.composers))return"composers: array expected";for(t=0;t<e.composers.length;++t)if(!u.isString(e.composers[t]))return"composers: string[] expected"}return null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.SequenceMetadata)return e;var t=new c.tensorflow.magenta.SequenceMetadata;if(null!=e.title&&(t.title=String(e.title)),null!=e.artist&&(t.artist=String(e.artist)),e.genre){if(!Array.isArray(e.genre))throw TypeError(".tensorflow.magenta.SequenceMetadata.genre: array expected");t.genre=[];for(var n=0;n<e.genre.length;++n)t.genre[n]=String(e.genre[n])}if(e.composers){if(!Array.isArray(e.composers))throw TypeError(".tensorflow.magenta.SequenceMetadata.composers: array expected");for(t.composers=[],n=0;n<e.composers.length;++n)t.composers[n]=String(e.composers[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.genre=[],n.composers=[]),t.defaults&&(n.title="",n.artist=""),null!=e.title&&e.hasOwnProperty("title")&&(n.title=e.title),null!=e.artist&&e.hasOwnProperty("artist")&&(n.artist=e.artist),e.genre&&e.genre.length){n.genre=[];for(var r=0;r<e.genre.length;++r)n.genre[r]=e.genre[r]}if(e.composers&&e.composers.length)for(n.composers=[],r=0;r<e.composers.length;++r)n.composers[r]=e.composers[r];return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),r.VelocityRange=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.min=0,e.prototype.max=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=s.create()),null!=e.min&&e.hasOwnProperty("min")&&t.uint32(8).int32(e.min),null!=e.max&&e.hasOwnProperty("max")&&t.uint32(16).int32(e.max),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof a||(e=a.create(e));for(var n=void 0===t?e.len:e.pos+t,r=new c.tensorflow.magenta.VelocityRange;e.pos<n;){var i=e.uint32();switch(i>>>3){case 1:r.min=e.int32();break;case 2:r.max=e.int32();break;default:e.skipType(7&i)}}return r},e.decodeDelimited=function(e){return e instanceof a||(e=new a(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=_typeof(e)||null===e?"object expected":null!=e.min&&e.hasOwnProperty("min")&&!u.isInteger(e.min)?"min: integer expected":null!=e.max&&e.hasOwnProperty("max")&&!u.isInteger(e.max)?"max: integer expected":null},e.fromObject=function(e){if(e instanceof c.tensorflow.magenta.VelocityRange)return e;var t=new c.tensorflow.magenta.VelocityRange;return null!=e.min&&(t.min=0|e.min),null!=e.max&&(t.max=0|e.max),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.min=0,n.max=0),null!=e.min&&e.hasOwnProperty("min")&&(n.min=e.min),null!=e.max&&e.hasOwnProperty("max")&&(n.max=e.max),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,o.util.toJSONOptions)},e}(),r),i),e.exports=c},function(e,t,n){n.r(t),n.d(t,"converterFromSpec",(function(){return l})),n.d(t,"DataConverter",(function(){return h})),n.d(t,"DrumsConverter",(function(){return f})),n.d(t,"DrumRollConverter",(function(){return p})),n.d(t,"DrumsOneHotConverter",(function(){return d})),n.d(t,"MelodyConverter",(function(){return m})),n.d(t,"MelodyRhythmConverter",(function(){return g})),n.d(t,"MelodyShapeConverter",(function(){return y})),n.d(t,"TrioConverter",(function(){return _})),n.d(t,"TrioRhythmConverter",(function(){return k})),n.d(t,"MultitrackConverter",(function(){return b})),n.d(t,"GrooveConverter",(function(){return S}));var r=n(2),i=n(10),o=n(8);n.d(t,"DEFAULT_DRUM_PITCH_CLASSES",(function(){return o.DEFAULT_DRUM_PITCH_CLASSES}));var a=n(12),s=n(23),u=n(29),c=n(13);function l(e){switch(e.type){case"MelodyConverter":return new m(e.args);case"MelodyRhythmConverter":return new g(e.args);case"MelodyShapeConverter":return new y(e.args);case"DrumsConverter":return new f(e.args);case"DrumRollConverter":return new p(e.args);case"TrioConverter":return new _(e.args);case"TrioRhythmConverter":return new k(e.args);case"DrumsOneHotConverter":return new d(e.args);case"MultitrackConverter":return new b(e.args);case"GrooveConverter":return new S(e.args);default:throw new Error("Unknown DataConverter type: "+e)}}var h=function(){return _createClass((function e(t){_classCallCheck(this,e),this.NUM_SPLITS=0,this.SEGMENTED_BY_TRACK=!1,this.numSteps=t.numSteps,this.numSegments=t.numSegments}),[{key:"tensorSteps",value:function(e){return r.scalar(e.shape[0],"int32")}}])}(),f=function(e){function t(e){var n;_classCallCheck(this,t),(n=_callSuper(this,t,[e])).pitchClasses=e.pitchClasses||o.DEFAULT_DRUM_PITCH_CLASSES,n.pitchToClass=new Map;for(var r=function(e){n.pitchClasses[e].forEach((function(t){n.pitchToClass.set(t,e)}))},i=0;i<n.pitchClasses.length;++i)r(i);return n.depth=n.pitchClasses.length+1,n}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){var t=this;c.assertIsQuantizedSequence(e);for(var n=this.numSteps||e.totalQuantizedSteps,i=r.buffer([n,this.pitchClasses.length+1],"int32"),o=0;o<n;++o)i.set(1,o,-1);return e.notes.forEach((function(e){i.set(1,e.quantizedStartStep,t.pitchToClass.get(e.pitch)),i.set(0,e.quantizedStartStep,-1)})),i.toTensor()}},{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var o,a,s,u,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.createQuantizedNoteSequence(n,r),a=t.argMax(1),e.next=4,a.data();case 4:for(s=e.sent,a.dispose(),u=0;u<s.length;++u)for(l=0;l<this.pitchClasses.length;l++)s[u]>>l&1&&o.notes.push(i.a.Note.create({pitch:this.pitchClasses[l][0],quantizedStartStep:u,quantizedEndStep:u+1,isDrum:!0}));return e.abrupt("return",(o.totalQuantizedSteps=s.length,o));case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(h),p=function(e){function t(){return _classCallCheck(this,t),_callSuper(this,t,arguments)}return _inherits(t,e),_createClass(t,[{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var o,a,s,u,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.createQuantizedNoteSequence(n,r),e.next=3,t.data();case 3:for(a=e.sent,s=0;s<t.shape[0];++s)for(u=a.slice(s*this.pitchClasses.length,(s+1)*this.pitchClasses.length),l=0;l<u.length;++l)u[l]&&o.notes.push(i.a.Note.create({pitch:this.pitchClasses[l][0],quantizedStartStep:s,quantizedEndStep:s+1,isDrum:!0}));return e.abrupt("return",(o.totalQuantizedSteps=t.shape[0],o));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(f),d=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).depth=Math.pow(2,n.pitchClasses.length),n}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){var t=this;c.assertIsRelativeQuantizedSequence(e);var n,i=this.numSteps||e.totalQuantizedSteps,o=Array(i).fill(0),a=_createForOfIteratorHelper(e.notes);try{for(a.s();!(n=a.n()).done;){var s=n.value,u=s.pitch,l=s.quantizedStartStep;o[l]+=Math.pow(2,this.pitchToClass.get(u))}}catch(e){a.e(e)}finally{a.f()}return r.tidy((function(){return r.oneHot(r.tensor1d(o,"int32"),t.depth)}))}}])}(f),m=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).NOTE_OFF=1,n.FIRST_PITCH=2,n.minPitch=e.minPitch,n.maxPitch=e.maxPitch,n.ignorePolyphony=e.ignorePolyphony,n.depth=e.maxPitch-e.minPitch+1+n.FIRST_PITCH,n}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){var t=this,n=s.Melody.fromNoteSequence(e,this.minPitch,this.maxPitch,this.ignorePolyphony,this.numSteps);return r.tidy((function(){return r.oneHot(r.tensor(n.events,[n.events.length],"int32"),t.depth)}))}},{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var i,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=t.argMax(1),e.next=3,i.data();case 3:return o=e.sent,i.dispose(),e.abrupt("return",new s.Melody(o,this.minPitch,this.maxPitch).toNoteSequence(n,r));case 6:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(h),v=function(e){function t(e,n){var r;return _classCallCheck(this,t),(r=_callSuper(this,t,[e])).minPitch=e.minPitch,r.maxPitch=e.maxPitch,r.ignorePolyphony=e.ignorePolyphony,r.melodyControl=n,r.depth=n.depth,r}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){var t=s.Melody.fromNoteSequence(e,this.minPitch,this.maxPitch,this.ignorePolyphony,this.numSteps);return this.melodyControl.extract(t)}}])}(h),g=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,new s.MelodyRhythm])}return _inherits(t,e),_createClass(t,[{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var a,s,u;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=c.createQuantizedNoteSequence(n,r),e.next=3,t.data();case 3:for(s=e.sent,u=0;u<s.length;++u)s[u]&&a.notes.push(i.a.Note.create({pitch:o.DEFAULT_DRUM_PITCH_CLASSES[1][0],quantizedStartStep:u,quantizedEndStep:u+1,isDrum:!0}));return e.abrupt("return",(a.totalQuantizedSteps=s.length,a));case 6:case"end":return e.stop()}}),e)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(v),y=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e,new s.MelodyShape])}return _inherits(t,e),_createClass(t,[{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,r){var o,s,u,l,h;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=c.createQuantizedNoteSequence(n,r),s=t.argMax(1),e.next=4,s.data();case 4:u=e.sent,s.dispose(),l=Math.round((this.maxPitch+this.minPitch)/2),h=0;case 8:if(!(h<u.length)){e.next=19;break}e.t0=u[h],e.next=0===e.t0?12:2===e.t0?14:15;break;case 12:return(l-=1)<this.minPitch&&(l=this.minPitch,a.log("Pitch range exceeded when creating NoteSequence from shape.","MelodyShapeConverter")),e.abrupt("break",15);case 14:(l+=1)>this.maxPitch&&(l=this.maxPitch,a.log("Pitch range exceeded when creating NoteSequence from shape.","MelodyShapeConverter"));case 15:o.notes.push(i.a.Note.create({pitch:l,quantizedStartStep:h,quantizedEndStep:h+1}));case 16:++h,e.next=8;break;case 19:return e.abrupt("return",(o.totalQuantizedSteps=u.length,o));case 20:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(v),_=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).NUM_SPLITS=3,n.MEL_PROG_RANGE=[0,31],n.BASS_PROG_RANGE=[32,39],e.melArgs.numSteps=e.numSteps,e.bassArgs.numSteps=e.numSteps,e.drumsArgs.numSteps=e.numSteps,n.melConverter=new m(e.melArgs),n.bassConverter=new m(e.bassArgs),n.drumsConverter=new d(e.drumsArgs),n.depth=n.melConverter.depth+n.bassConverter.depth+n.drumsConverter.depth,n}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){var t=this;c.assertIsQuantizedSequence(e);var n=c.clone(e),i=c.clone(e),o=c.clone(e);return n.notes=e.notes.filter((function(e){return!e.isDrum&&e.program>=t.MEL_PROG_RANGE[0]&&e.program<=t.MEL_PROG_RANGE[1]})),i.notes=e.notes.filter((function(e){return!e.isDrum&&e.program>=t.BASS_PROG_RANGE[0]&&e.program<=t.BASS_PROG_RANGE[1]})),o.notes=e.notes.filter((function(e){return e.isDrum})),r.tidy((function(){return r.concat([t.melConverter.toTensor(n),t.bassConverter.toTensor(i),t.drumsConverter.toTensor(o)],-1)}))}},{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,i){var o,a,s,u,c,l,h=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.split(t,[this.melConverter.depth,this.bassConverter.depth,this.drumsConverter.depth],-1),e.next=3,this.melConverter.toNoteSequence(s[0],n,i);case 3:return(u=e.sent).notes.forEach((function(e){e.instrument=0,e.program=0})),e.next=7,this.bassConverter.toNoteSequence(s[1],n,i);case 7:return c=e.sent,(o=u.notes).push.apply(o,_toConsumableArray(c.notes.map((function(e){return e.instrument=1,e.program=h.BASS_PROG_RANGE[0],e})))),e.next=11,this.drumsConverter.toNoteSequence(s[2],n,i);case 11:return l=e.sent,e.abrupt("return",((a=u.notes).push.apply(a,_toConsumableArray(l.notes.map((function(e){return e.instrument=2,e})))),s.forEach((function(e){return e.dispose()})),u));case 13:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(h),k=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).NUM_SPLITS=3,n.trioConverter=new _(e),n.depth=3,n}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){var t=this;return r.tidy((function(){var n=t.trioConverter.toTensor(e),i=r.split(n,[t.trioConverter.melConverter.depth,t.trioConverter.bassConverter.depth,t.trioConverter.drumsConverter.depth],1),o=r.argMax(i[0],1),a=r.argMax(i[1],1),s=r.argMax(i[2],1),u=r.greater(o,1),c=r.greater(a,1),l=r.greater(s,0);return r.stack([u,c,l],1)}))}},{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n,a){var s,u,l,h;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.split(t,3,1),e.next=3,Promise.all(s.map((function(e){return e.data()})));case 3:for(u=e.sent,l=c.createQuantizedNoteSequence(n,a),h=0;h<this.numSteps;++h)u[0][h]&&l.notes.push(i.a.Note.create({pitch:72,quantizedStartStep:h,quantizedEndStep:h+1,instrument:0,program:0})),u[1][h]&&l.notes.push(i.a.Note.create({pitch:36,quantizedStartStep:h,quantizedEndStep:h+1,instrument:1,program:32})),u[2][h]&&l.notes.push(i.a.Note.create({pitch:o.DEFAULT_DRUM_PITCH_CLASSES[1][0],quantizedStartStep:h,quantizedEndStep:h+1,instrument:2,isDrum:!0}));return e.abrupt("return",(l.totalQuantizedSteps=this.numSteps,l));case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})}]);var n}(h),b=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[e])).SEGMENTED_BY_TRACK=!0,n.stepsPerQuarter=e.stepsPerQuarter,n.totalSteps=e.totalSteps,n.numVelocityBins=e.numVelocityBins,n.minPitch=e.minPitch?e.minPitch:o.MIN_MIDI_PITCH,n.maxPitch=e.maxPitch?e.maxPitch:o.MAX_MIDI_PITCH,n.numPitches=n.maxPitch-n.minPitch+1,n.performanceEventDepth=2*n.numPitches+n.totalSteps+n.numVelocityBins,n.numPrograms=o.MAX_MIDI_PROGRAM-o.MIN_MIDI_PROGRAM+2,n.endToken=n.performanceEventDepth+n.numPrograms,n.depth=n.endToken+1,n.endTensor=r.tidy((function(){return r.oneHot(r.tensor1d([n.endToken],"int32"),n.depth).as1D()})),n}return _inherits(t,e),_createClass(t,[{key:"trackToTensor",value:function(e){var t=this,n=this.numSteps/this.numSegments,i=void 0;if(e){for(;e.events.length>n-2;)e.events.pop();(i=r.buffer([e.events.length+2],"int32")).set(this.performanceEventDepth+(e.isDrum?this.numPrograms-1:e.program),0),e.events.forEach((function(e,n){switch(e.type){case"note-on":i.set(e.pitch-t.minPitch,n+1);break;case"note-off":i.set(t.numPitches+e.pitch-t.minPitch,n+1);break;case"time-shift":i.set(2*t.numPitches+e.steps-1,n+1);break;case"velocity-change":i.set(2*t.numPitches+t.totalSteps+e.velocityBin-1,n+1);break;default:throw new Error("Unrecognized performance event: "+e)}})),i.set(this.endToken,e.events.length+1)}else i=r.buffer([1],"int32",new Int32Array([this.endToken]));return r.tidy((function(){var e=r.oneHot(i.toTensor(),t.depth);return e.pad([[0,n-e.shape[0]],[0,0]])}))}},{key:"toTensor",value:function(e){var t=this;if(c.assertIsRelativeQuantizedSequence(e),e.quantizationInfo.stepsPerQuarter!==this.stepsPerQuarter)throw new Error("Steps per quarter note mismatch: ".concat(e.quantizationInfo.stepsPerQuarter," != ").concat(this.stepsPerQuarter));var n=c.clone(e);n.notes=e.notes.filter((function(e){return e.pitch>=t.minPitch&&e.pitch<=t.maxPitch}));for(var i=new Set(n.notes.map((function(e){return e.instrument}))),o=Array.from(i).map((function(e){return u.Performance.fromNoteSequence(n,t.totalSteps,t.numVelocityBins,e)})).sort((function(e,t){return t.isDrum?-1:e.isDrum?1:e.program-t.program}));o.length>this.numSegments;)o.pop();for(o.forEach((function(e){return e.setNumSteps(t.totalSteps)}));o.length<this.numSegments;)o.push(void 0);return r.tidy((function(){return r.concat(o.map((function(e){return t.trackToTensor(e)})),0)}))}},{key:"tokensToTrack",value:function(e){var t=this,n=e.indexOf(this.endToken),r=n>=0?n:e.length,i=e.slice(0,r),o=i.filter((function(e){return e<t.performanceEventDepth})),a=i.filter((function(e){return e>=t.performanceEventDepth})),s=_slicedToArray(a.length?a[0]-this.performanceEventDepth<this.numPrograms-1?[a[0]-this.performanceEventDepth,!1]:[0,!0]:[0,!1],2),c=s[0],l=s[1],h=Array.from(o).map((function(e){if(e<t.numPitches)return{type:"note-on",pitch:t.minPitch+e};if(e<2*t.numPitches)return{type:"note-off",pitch:t.minPitch+e-t.numPitches};if(e<2*t.numPitches+t.totalSteps)return{type:"time-shift",steps:e-2*t.numPitches+1};if(e<2*t.numPitches+t.totalSteps+t.numVelocityBins)return{type:"velocity-change",velocityBin:e-2*t.numPitches-t.totalSteps+1};throw new Error("Invalid performance event token: "+e)}));return new u.Performance(h,this.totalSteps,this.numVelocityBins,c,l)}},{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,i,o,a,s=this,u=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=u.length>1&&void 0!==u[1]?u[1]:this.stepsPerQuarter,i=u.length>2?u[2]:void 0,(o=c.createQuantizedNoteSequence(n,i)).totalQuantizedSteps=this.totalSteps,a=r.tidy((function(){return r.split(t.argMax(1),s.numSegments)})),e.next=7,Promise.all(a.map(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.data();case 2:return n=e.sent,r=s.tokensToTrack(n),e.abrupt("return",(t.dispose(),r));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return e.sent.forEach((function(e,t){var n;e.setNumSteps(s.totalSteps),(n=o.notes).push.apply(n,_toConsumableArray(e.toNoteSequence(t).notes))})),e.abrupt("return",o);case 9:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]);var n}(h),S=function(e){function t(e){var n;_classCallCheck(this,t),(n=_callSuper(this,t,[e])).TAPIFY_CHANNEL=3,n.stepsPerQuarter=e.stepsPerQuarter||o.DEFAULT_STEPS_PER_QUARTER,n.pitchClasses=e.pitchClasses||o.DEFAULT_DRUM_PITCH_CLASSES,n.pitchToClass=new Map;for(var r=function(e){n.pitchClasses[e].forEach((function(t){n.pitchToClass.set(t,e)}))},i=0;i<n.pitchClasses.length;++i)r(i);return n.humanize=e.humanize||!1,n.tapify=e.tapify||!1,n.splitInstruments=e.splitInstruments||!1,n.depth=3,n}return _inherits(t,e),_createClass(t,[{key:"toTensor",value:function(e){for(var t=this,n=c.isRelativeQuantizedSequence(e)?e:c.quantizeNoteSequence(e,this.stepsPerQuarter),i=this.numSteps,a=n.tempos&&n.tempos.length?n.tempos[0].qpm:o.DEFAULT_QUARTERS_PER_MINUTE,s=60/a/this.stepsPerQuarter,u=[],l=0;l<i;++l)u.push(new Map);n.notes.forEach((function(e){if(t.tapify||t.pitchToClass.has(e.pitch)){var n=e.quantizedStartStep;if(n>=u.length)throw Error("Model does not support sequences with more than ".concat(i," steps (").concat(i*s," seconds at qpm ").concat(a,")."));var r=t.tapify?t.TAPIFY_CHANNEL:t.pitchToClass.get(e.pitch);(!u[n].has(r)||u[n].get(r).velocity<e.velocity)&&u[n].set(r,e)}}));var h=this.pitchClasses.length,f=r.buffer([i,h]),p=r.buffer([i,h]),d=r.buffer([i,h]);function m(e){if(void 0===e.startTime)return 0;var t=e.startTime;return 2*(e.quantizedStartStep*s-t)/s}for(var v=0;v<i;++v)for(var g=0;g<h;++g){var y=u[v].get(g);f.set(y?1:0,v,g),this.humanize||this.tapify||p.set(y?y.velocity/o.MAX_MIDI_VELOCITY:0,v,g),this.humanize||d.set(y?m(y):0,v,g)}return r.tidy((function(){var e=f.toTensor(),n=p.toTensor(),o=d.toTensor(),a=t.splitInstruments?i*h:i;return r.concat([e.as2D(a,-1),n.as2D(a,-1),o.as2D(a,-1)],1)}))}},{key:"toNoteSequence",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(t,n){var r,a,s,u,c,l,h,f,p,d,m,v,g,y,_,k=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(l=function(e,t,n){return Math.min(Math.max(e,t),n)},r=k.length>2&&void 0!==k[2]?k[2]:o.DEFAULT_QUARTERS_PER_MINUTE,!n||n===this.stepsPerQuarter){e.next=4;break}throw Error("`stepsPerQuarter` is set by the model.");case 4:return n=this.stepsPerQuarter,a=this.splitInstruments?t.shape[0]/this.pitchClasses.length:t.shape[0],s=60/r/this.stepsPerQuarter,u=i.a.create({totalTime:a*s,tempos:[{qpm:r}]}),e.next=10,t.data();case 10:for(c=e.sent,h=this.pitchClasses.length,f=0;f<a;++f)for(p=c.slice(f*h*this.depth,(f+1)*h*this.depth),d=0;d<h;++d)m=p[this.splitInstruments?d*this.depth:d],v=p[this.splitInstruments?d*this.depth+1:h+d],g=p[this.splitInstruments?d*this.depth+2:2*h+d],m>.5&&(y=l(Math.round(v*o.MAX_MIDI_VELOCITY),o.MIN_MIDI_VELOCITY,o.MAX_MIDI_VELOCITY),_=l(g/2,-.5,.5),u.notes.push(i.a.Note.create({pitch:this.pitchClasses[d][0],startTime:(f-_)*s,endTime:(f-_+1)*s,velocity:y,isDrum:!0})));return e.abrupt("return",u);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})}]);var n}(h)},function(e,t,n){n.r(t),n.d(t,"ChordQuality",(function(){return ve})),n.d(t,"ChordSymbolException",(function(){return _e})),n.d(t,"ChordEncodingException",(function(){return ke})),n.d(t,"ChordSymbols",(function(){return be})),n.d(t,"ChordEncoder",(function(){return Se})),n.d(t,"chordEncoderFromType",(function(){return we})),n.d(t,"MajorMinorChordEncoder",(function(){return xe})),n.d(t,"TriadChordEncoder",(function(){return Te})),n.d(t,"PitchChordEncoder",(function(){return Ce}));var r={};n.r(r),n.d(r,"names",(function(){return s})),n.d(r,"tokenize",(function(){return h})),n.d(r,"props",(function(){return d})),n.d(r,"name",(function(){return m})),n.d(r,"pc",(function(){return v})),n.d(r,"midi",(function(){return g})),n.d(r,"midiToFreq",(function(){return y})),n.d(r,"freq",(function(){return _})),n.d(r,"freqToMidi",(function(){return S})),n.d(r,"chroma",(function(){return w})),n.d(r,"oct",(function(){return x})),n.d(r,"stepToLetter",(function(){return T})),n.d(r,"altToAcc",(function(){return P})),n.d(r,"from",(function(){return A})),n.d(r,"build",(function(){return O})),n.d(r,"fromMidi",(function(){return M})),n.d(r,"simplify",(function(){return N})),n.d(r,"enharmonic",(function(){return I}));var i={};n.r(i),n.d(i,"names",(function(){return ae})),n.d(i,"props",(function(){return ue})),n.d(i,"intervals",(function(){return ce})),n.d(i,"notes",(function(){return le})),n.d(i,"exists",(function(){return he})),n.d(i,"supersets",(function(){return fe})),n.d(i,"subsets",(function(){return pe})),n.d(i,"tokenize",(function(){return me}));var o=n(2),a="C C# Db D D# Eb E F F# Gb G G# Ab A A# Bb B".split(" "),s=function(e){return"string"!=typeof e?a.slice():a.filter((function(t){var n=t[1]||" ";return-1!==e.indexOf(n)}))},u=s(" #"),c=s(" b"),l=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function h(e){"string"!=typeof e&&(e="");var t=l.exec(e);return[t[1].toUpperCase(),t[2].replace(/x/g,"##"),t[3],t[4]]}var f=Object.freeze({pc:null,name:null,step:null,alt:null,oct:null,octStr:null,chroma:null,midi:null,freq:null}),p=[0,2,4,5,7,9,11],d=function(e,t){return void 0===t&&(t={}),function(e){return t[e]||(t[e]=function(e){var t=h(e);if(""===t[0]||""!==t[3])return f;var n=t[0],r=t[1],i=t[2],o={letter:n,acc:r,octStr:i,pc:n+r,name:n+r+i,step:(n.charCodeAt(0)+3)%7,alt:"b"===r[0]?-r.length:r.length,oct:i.length?+i:null,chroma:0,midi:null,freq:null};return o.chroma=(p[o.step]+o.alt+120)%12,o.midi=null!==o.oct?p[o.step]+o.alt+12*(o.oct+1):null,o.freq=y(o.midi),Object.freeze(o)}(e))}}(),m=function(e){return d(e).name},v=function(e){return d(e).pc},g=function(e){if("number"!=typeof e&&"string"!=typeof e)return null;var t,n=d(e).midi,r=n||0===n?n:+e;return(t=r)>=0&&t<=127?r:null},y=function(e,t){return void 0===t&&(t=440),"number"==typeof e?Math.pow(2,(e-69)/12)*t:null},_=function(e){return d(e).freq||y(e)},k=Math.log(2),b=Math.log(440),S=function(e){var t=12*(Math.log(e)-b)/k+69;return Math.round(100*t)/100},w=function(e){return d(e).chroma},x=function(e){return d(e).oct},T=function(e){return"CDEFGAB"[e]},C=function(e,t){return Array(t+1).join(e)},P=function(e){return function(e){return"number"!=typeof e?"":function(e){return e<0?C("b",-e):C("#",e)}(e)}(e)},A=function(e,t){void 0===e&&(e={}),void 0===t&&(t=null);var n=t?Object.assign({},d(t),e):e,r=n.step,i=n.alt,o=n.oct;if("number"!=typeof r)return null;var a=T(r);if(!a)return null;var s=a+P(i);return o||0===o?s+o:s},O=A;function M(e,t){return void 0===t&&(t=!1),e=Math.round(e),(!0===t?u:c)[e%12]+(Math.floor(e/12)-1)}var N=function(e,t){void 0===t&&(t=!0);var n=d(e),r=n.alt,i=n.chroma,o=n.midi;if(null===i)return null;var a=!1===t?r<0:r>0;return null===o?v(M(i,a)):M(o,a)},I=function(e){return N(e,!1)},E=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$"),q=[0,2,4,5,7,9,11],D=("1P 2m 2M 3m 3M 4P 5P 6m 6M 7m 7M 8P".split(" "),Object.freeze({name:null,num:null,q:null,step:null,alt:null,dir:null,type:null,simple:null,semitones:null,chroma:null,oct:null})),R=function(e){var t=function(e){var t=E.exec(""+e);return null===t?null:t[1]?[t[1],t[2]]:[t[4],t[3]]}(e);if(null===t)return D;var n,r,i={num:0,q:"d",name:"",type:"M",step:0,dir:-1,simple:1,alt:0,oct:0,semitones:0,chroma:0,ic:0};return i.num=+t[0],i.q=t[1],i.step=function(e){return(Math.abs(e)-1)%7}(i.num),i.type="PMMPPMM"[i.step],"M"===i.type&&"P"===i.q?D:(i.name=""+i.num+i.q,i.dir=i.num<0?-1:1,i.simple=8===i.num||-8===i.num?i.num:i.dir*(i.step+1),i.alt=(n=i.type,"M"===(r=i.q)&&"M"===n||"P"===r&&"P"===n?0:"m"===r&&"M"===n?-1:/^A+$/.test(r)?r.length:/^d+$/.test(r)?"P"===n?-r.length:-r.length-1:null),i.oct=Math.floor((Math.abs(i.num)-1)/7),i.semitones=i.dir*(q[i.step]+i.alt+12*i.oct),i.chroma=(i.dir*(q[i.step]+i.alt)%12+12)%12,Object.freeze(i))},j={};function z(e){return"string"!=typeof e?D:j[e]||(j[e]=R(e))}"P m M m M P d P m M m M".split(" ");var F=[0,2,4,-1,1,3,5],L=F.map((function(e){return Math.floor(7*e/12)})),V=[3,0,4,1,5,2,6],G=function(e,t,n){var r=V[function(e){var t=(e+1)%7;return t<0?7+t:t}(e)],i=Math.floor((e+1)/7);return void 0===t?{step:r,alt:i,dir:n}:{step:r,alt:i,oct:t+4*i+L[r],dir:n}},B=function(e){return function(e,t){return void 0===t&&(t={}),function(n){return t[n]||(t[n]=e(n))}}((function(t){var n=e(t);return null===n.name?null:function(e){var t=e.step,n=e.alt,r=e.oct,i=e.dir;void 0===i&&(i=1);var o=F[t]+7*n;return null===r?[i*o]:[i*o,i*(r-L[t]-4*n)]}(n)}))},U=B(d),H=B(z);function Q(e,t){if(1===arguments.length)return function(t){return Q(e,t)};var n=U(e),r=H(t);if(null===n||null===r)return null;var i=1===n.length?[n[0]+r[0]]:[n[0]+r[0],n[1]+r[1]];return O(G(i[0],i[1]))}var W=n(64),Y=n(65),X=function(e){return w(e)||function(e){return z(e).chroma}(e)||0},Z=function(e){return parseInt(K(e),2)};function K(e){if(function(e){return J.test(e)}(e))return e;if(!Array.isArray(e))return"";var t=[0,0,0,0,0,0,0,0,0,0,0,0];return e.map(X).forEach((function(e){t[e]=1})),t.join("")}var J=/^[01]{12}$/;function $(e,t){return arguments.length>1?$(e)(t):(e=Z(e),function(t){return(t=Z(t))!==e&&(t&e)===t})}function ee(e,t){return arguments.length>1?ee(e)(t):(e=Z(e),function(t){return(t=Z(t))!==e&&(t|e)===t})}"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M".split(" ");var te,ne,re=function(e){var t=Object.keys(e).sort(),n=[],r=[],i=function(e,t,i){n[e]=t,r[i]=r[i]||[],r[i].push(e)};t.forEach((function(t){var n=e[t][0].split(" "),r=e[t][1],o=K(n);i(t,n,o),r&&r.forEach((function(e){return i(e,n,o)}))}));var o=Object.keys(n).sort(),a=function(e){return n[e]};return a.names=function(e){return"string"==typeof e?(r[e]||[]).slice():(!0===e?o:t).slice()},a},ie=re(W),oe=re(Y);te=ie,ne=oe,function(e){return te(e)||ne(e)}.names=function(e){return te.names(e).concat(ne.names(e))},Object.freeze({name:null,intervals:[],names:[],chroma:null,setnum:null});ie.names;var ae=oe.names,se=Object.freeze({name:null,names:[],intervals:[],chroma:null,setnum:null}),ue=function(e,t){return void 0===t&&(t={}),function(e){return t[e]||(t[e]=function(e){var t=oe(e);if(!t)return se;var n={intervals:t,name:e};return n.chroma=K(t),n.setnum=parseInt(n.chroma,2),n.names=oe.names(n.chroma),n}(e))}}(),ce=function(e){return ue(me(e)[1]).intervals};function le(e,t){if(t)return ue(t).intervals.map(Q(e));var n=me(e),r=n[0],i=n[1];return ue(i).intervals.map(Q(r))}var he=function(e){return void 0!==oe(me(e)[1])},fe=function(e){if(!ce(e).length)return[];var t=ee(ce(e));return oe.names().filter((function(e){return t(oe(e))}))},pe=function(e){var t=$(ce(e));return oe.names().filter((function(e){return t(oe(e))}))},de=/^(6|64|7|9|11|13)$/;function me(e){var t=h(e);return""===t[0]?["",e]:"A"===t[0]&&"ug"===t[3]?["","aug"]:de.test(t[2])?[t[0]+t[1],t[2]+t[3]]:[t[0]+t[1]+t[2],t[3]]}var ve,ge=n(8),ye=[["1P","3M","5P"],["1P","3m","5P"],["1P","3M","5A"],["1P","3m","5d"]];!function(e){e[e.Major=0]="Major",e[e.Minor=1]="Minor",e[e.Augmented=2]="Augmented",e[e.Diminished=3]="Diminished",e[e.Other=4]="Other"}(ve||(ve={}));var _e=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}(),ke=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}(),be=function(){return _createClass((function e(){_classCallCheck(this,e)}),null,[{key:"pitches",value:function(e){if(!i.tokenize(e)[0]||!i.exists(e))throw new _e("Unrecognized chord symbol: "+e);return i.notes(e).map(r.chroma)}},{key:"root",value:function(e){var t=i.tokenize(e)[0];if(!t)throw new _e("Chord symbol has unknown root: "+e);return r.chroma(t)}},{key:"quality",value:function(e){if(!i.exists(e))throw new _e("Unrecognized chord symbol: "+e);var t=i.intervals(e),n=ye.map((function(e){return e.every((function(e){return t.includes(e)}))})),r=n.indexOf(!0),o=n.lastIndexOf(!0);return r>=0&&r===o?r:ve.Other}}])}(),Se=function(){return _createClass((function e(){_classCallCheck(this,e)}),[{key:"encodeProgression",value:function(e,t){var n=this,r=e.map((function(e){return n.encode(e)})),i=Array.from(Array(t).keys()).map((function(e){return Math.floor(e*r.length/t)}));return o.stack(i.map((function(e){return r[e]})))}}])}();function we(e){switch(e){case"MajorMinorChordEncoder":return new xe;case"TriadChordEncoder":return new Te;case"PitchChordEncoder":return new Ce;default:throw new Error("Unknown chord encoder type: "+e)}}var xe=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).depth=1+2*ge.NUM_PITCH_CLASSES,e}return _inherits(t,e),_createClass(t,[{key:"index",value:function(e){if(e===ge.NO_CHORD)return 0;var t=be.root(e),n=1+be.quality(e)*ge.NUM_PITCH_CLASSES+t;if(n>=this.depth)throw new ke("Chord is neither major nor minor: "+e);return n}},{key:"encode",value:function(e){var t=this;return o.tidy((function(){return o.oneHot(o.tensor1d([t.index(e)],"int32"),t.depth).as1D()}))}}])}(Se),Te=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).depth=1+4*ge.NUM_PITCH_CLASSES,e}return _inherits(t,e),_createClass(t,[{key:"index",value:function(e){if(e===ge.NO_CHORD)return 0;var t=be.root(e),n=1+be.quality(e)*ge.NUM_PITCH_CLASSES+t;if(n>=this.depth)throw new ke("Chord is not a standard triad: "+e);return n}},{key:"encode",value:function(e){var t=this;return o.tidy((function(){return o.oneHot(o.tensor1d([t.index(e)],"int32"),t.depth).as1D()}))}}])}(Se),Ce=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).depth=1+3*ge.NUM_PITCH_CLASSES,e}return _inherits(t,e),_createClass(t,[{key:"encode",value:function(e){var t=this;return o.tidy((function(){if(e===ge.NO_CHORD)return o.oneHot(o.tensor1d([0],"int32"),t.depth).as1D();var n=be.root(e),r=o.oneHot(o.tensor1d([n],"int32"),ge.NUM_PITCH_CLASSES).as1D(),i=o.buffer([ge.NUM_PITCH_CLASSES]);be.pitches(e).forEach((function(e){return i.set(1,e)}));var a=i.toTensor().as1D(),s=r;return o.concat1d([o.tensor1d([0]),r,a,s])}))}}])}(Se)},,,,,,,,,,,function(e,t,n){n.r(t),n.d(t,"auxiliaryInputFromSpec",(function(){return i})),n.d(t,"AuxiliaryInput",(function(){return o})),n.d(t,"BinaryCounter",(function(){return a}));var r=n(2);function i(e){if("BinaryCounter"===e.type)return new a(e.args);throw new Error("Unknown auxiliary input: "+e)}var o=_createClass((function e(t){_classCallCheck(this,e),this.depth=t})),a=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[e.numBits])}return _inherits(t,e),_createClass(t,[{key:"getTensors",value:function(e){for(var t=r.buffer([e,this.depth]),n=0;n<e;++n)for(var i=0;i<this.depth;++i)t.set(Math.floor((n+1)/Math.pow(2,i))%2?1:-1,n,i);return t.toTensor().as2D(e,this.depth)}}])}(o)},function(e,t,n){e.exports=n(50)},function(e,t,n){var r=t;function i(){r.util._configure(),r.Writer._configure(r.BufferWriter),r.Reader._configure(r.BufferReader)}r.build="minimal",r.Writer=n(33),r.BufferWriter=n(59),r.Reader=n(34),r.BufferReader=n(60),r.util=n(18),r.rpc=n(61),r.roots=n(63),r.configure=i,i()},function(e,t,n){e.exports=function(e,t){for(var n=new Array(arguments.length-1),r=0,i=2,o=!0;i<arguments.length;)n[r++]=arguments[i++];return new Promise((function(i,a){n[r]=function(e){if(o)if(o=!1,e)a(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];i.apply(null,t)}};try{e.apply(t||null,n)}catch(e){o&&(o=!1,a(e))}}))}},function(e,t,n){var r=t;r.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var i=new Array(64),o=new Array(123),a=0;a<64;)o[i[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;r.encode=function(e,t,n){for(var r,o=null,a=[],s=0,u=0;t<n;){var c=e[t++];switch(u){case 0:a[s++]=i[c>>2],r=(3&c)<<4,u=1;break;case 1:a[s++]=i[r|c>>4],r=(15&c)<<2,u=2;break;case 2:a[s++]=i[r|c>>6],a[s++]=i[63&c],u=0}s>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,a)),s=0)}return u&&(a[s++]=i[r],a[s++]=61,1===u&&(a[s++]=61)),o?(s&&o.push(String.fromCharCode.apply(String,a.slice(0,s))),o.join("")):String.fromCharCode.apply(String,a.slice(0,s))},r.decode=function(e,t,n){for(var r,i=n,a=0,s=0;s<e.length;){var u=e.charCodeAt(s++);if(61===u&&a>1)break;if(void 0===(u=o[u]))throw Error("invalid encoding");switch(a){case 0:r=u,a=1;break;case 1:t[n++]=r<<2|(48&u)>>4,r=u,a=2;break;case 2:t[n++]=(15&r)<<4|(60&u)>>2,r=u,a=3;break;case 3:t[n++]=(3&r)<<6|u,a=0}}if(1===a)throw Error("invalid encoding");return n-i},r.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){function r(){this._listeners={}}e.exports=r,r.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},r.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],r=0;r<n.length;)n[r].fn===t?n.splice(r,1):++r;return this},r.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],r=1;r<arguments.length;)n.push(arguments[r++]);for(r=0;r<t.length;)t[r].fn.apply(t[r++].ctx,n)}return this}},function(e,t,n){function r(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),r=128===n[3];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3]}function o(e,r,i){t[0]=e,r[i]=n[3],r[i+1]=n[2],r[i+2]=n[1],r[i+3]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],t[0]}function s(e,r){return n[3]=e[r],n[2]=e[r+1],n[1]=e[r+2],n[0]=e[r+3],t[0]}e.writeFloatLE=r?i:o,e.writeFloatBE=r?o:i,e.readFloatLE=r?a:s,e.readFloatBE=r?s:a}():function(){function t(e,t,n,r){var i=t<0?1:0;if(i&&(t=-t),0===t)e(1/t>0?0:2147483648,n,r);else if(isNaN(t))e(2143289344,n,r);else if(t>34028234663852886e22)e((i<<31|2139095040)>>>0,n,r);else if(t<11754943508222875e-54)e((i<<31|Math.round(t/1401298464324817e-60))>>>0,n,r);else{var o=Math.floor(Math.log(t)/Math.LN2);e((i<<31|o+127<<23|8388607&Math.round(t*Math.pow(2,-o)*8388608))>>>0,n,r)}}function n(e,t,n){var r=e(t,n),i=2*(r>>31)+1,o=r>>>23&255,a=8388607&r;return 255===o?a?NaN:i*(1/0):0===o?1401298464324817e-60*i*a:i*Math.pow(2,o-150)*(a+8388608)}e.writeFloatLE=t.bind(null,i),e.writeFloatBE=t.bind(null,o),e.readFloatLE=n.bind(null,a),e.readFloatBE=n.bind(null,s)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),r=128===n[7];function i(e,r,i){t[0]=e,r[i]=n[0],r[i+1]=n[1],r[i+2]=n[2],r[i+3]=n[3],r[i+4]=n[4],r[i+5]=n[5],r[i+6]=n[6],r[i+7]=n[7]}function o(e,r,i){t[0]=e,r[i]=n[7],r[i+1]=n[6],r[i+2]=n[5],r[i+3]=n[4],r[i+4]=n[3],r[i+5]=n[2],r[i+6]=n[1],r[i+7]=n[0]}function a(e,r){return n[0]=e[r],n[1]=e[r+1],n[2]=e[r+2],n[3]=e[r+3],n[4]=e[r+4],n[5]=e[r+5],n[6]=e[r+6],n[7]=e[r+7],t[0]}function s(e,r){return n[7]=e[r],n[6]=e[r+1],n[5]=e[r+2],n[4]=e[r+3],n[3]=e[r+4],n[2]=e[r+5],n[1]=e[r+6],n[0]=e[r+7],t[0]}e.writeDoubleLE=r?i:o,e.writeDoubleBE=r?o:i,e.readDoubleLE=r?a:s,e.readDoubleBE=r?s:a}():function(){function t(e,t,n,r,i,o){var a=r<0?1:0;if(a&&(r=-r),0===r)e(0,i,o+t),e(1/r>0?0:2147483648,i,o+n);else if(isNaN(r))e(0,i,o+t),e(2146959360,i,o+n);else if(r>17976931348623157e292)e(0,i,o+t),e((a<<31|2146435072)>>>0,i,o+n);else{var s;if(r<22250738585072014e-324)e((s=r/5e-324)>>>0,i,o+t),e((a<<31|s/4294967296)>>>0,i,o+n);else{var u=Math.floor(Math.log(r)/Math.LN2);1024===u&&(u=1023),e(4503599627370496*(s=r*Math.pow(2,-u))>>>0,i,o+t),e((a<<31|u+1023<<20|1048576*s&1048575)>>>0,i,o+n)}}}function n(e,t,n,r,i){var o=e(r,i+t),a=e(r,i+n),s=2*(a>>31)+1,u=a>>>20&2047,c=4294967296*(1048575&a)+o;return 2047===u?c?NaN:s*(1/0):0===u?5e-324*s*c:s*Math.pow(2,u-1075)*(c+4503599627370496)}e.writeDoubleLE=t.bind(null,i,0,4),e.writeDoubleBE=t.bind(null,o,4,0),e.readDoubleLE=n.bind(null,a,0,4),e.readDoubleBE=n.bind(null,s,4,0)}(),e}function i(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function o(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function s(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=r(r)},function(module,exports,__webpack_require__){function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){var r=t;r.length=function(e){for(var t=0,n=0,r=0;r<e.length;++r)(n=e.charCodeAt(r))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(r+1))?(++r,t+=4):t+=3;return t},r.read=function(e,t,n){if(n-t<1)return"";for(var r,i=null,o=[],a=0;t<n;)(r=e[t++])<128?o[a++]=r:r>191&&r<224?o[a++]=(31&r)<<6|63&e[t++]:r>239&&r<365?(r=((7&r)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,o[a++]=55296+(r>>10),o[a++]=56320+(1023&r)):o[a++]=(15&r)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),a=0);return i?(a&&i.push(String.fromCharCode.apply(String,o.slice(0,a))),i.join("")):String.fromCharCode.apply(String,o.slice(0,a))},r.write=function(e,t,n){for(var r,i,o=n,a=0;a<e.length;++a)(r=e.charCodeAt(a))<128?t[n++]=r:r<2048?(t[n++]=r>>6|192,t[n++]=63&r|128):55296==(64512&r)&&56320==(64512&(i=e.charCodeAt(a+1)))?(r=65536+((1023&r)<<10)+(1023&i),++a,t[n++]=r>>18|240,t[n++]=r>>12&63|128,t[n++]=r>>6&63|128,t[n++]=63&r|128):(t[n++]=r>>12|224,t[n++]=r>>6&63|128,t[n++]=63&r|128);return n-o}},function(e,t,n){e.exports=function(e,t,n){var r=n||8192,i=r>>>1,o=null,a=r;return function(n){if(n<1||n>i)return e(n);a+n>r&&(o=e(r),a=0);var s=t.call(o,a,a+=n);return 7&a&&(a=1+(7|a)),s}}},function(e,t,n){e.exports=i;var r=n(18);function i(e,t){this.lo=e>>>0,this.hi=t>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var a=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(e){if(0===e)return o;var t=e<0;t&&(e=-e);var n=e>>>0,r=(e-n)/4294967296>>>0;return t&&(r=~r>>>0,n=~n>>>0,++n>4294967295&&(n=0,++r>4294967295&&(r=0))),new i(n,r)},i.from=function(e){if("number"==typeof e)return i.fromNumber(e);if(r.isString(e)){if(!r.Long)return i.fromNumber(parseInt(e,10));e=r.Long.fromString(e)}return e.low||e.high?new i(e.low>>>0,e.high>>>0):o},i.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(e){return r.Long?new r.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var s=String.prototype.charCodeAt;i.fromHash=function(e){return e===a?o:new i((s.call(e,0)|s.call(e,1)<<8|s.call(e,2)<<16|s.call(e,3)<<24)>>>0,(s.call(e,4)|s.call(e,5)<<8|s.call(e,6)<<16|s.call(e,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},i.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},i.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){e.exports=o;var r=n(33);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(18);function o(){r.call(this)}function a(e,t,n){e.length<40?i.utf8.write(e,t,n):t.utf8Write?t.utf8Write(e,n):t.write(e,n)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var r=0;r<e.length;)t[n++]=e[r++]}},o.prototype.bytes=function(e){i.isString(e)&&(e=i._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(o.writeBytesBuffer,t,e),this},o.prototype.string=function(e){var t=i.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},o._configure()},function(e,t,n){e.exports=o;var r=n(34);(o.prototype=Object.create(r.prototype)).constructor=o;var i=n(18);function o(e){r.call(this,e)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},o._configure()},function(e,t,n){t.Service=n(62)},function(e,t,n){e.exports=i;var r=n(18);function i(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");r.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(i.prototype=Object.create(r.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function e(t,n,i,o,a){if(!o)throw TypeError("request must be specified");var s=this;if(!a)return r.asPromise(e,s,t,n,i,o);if(s.rpcImpl)try{return s.rpcImpl(t,n[s.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(e,n){if(e)return s.emit("error",e,t),a(e);if(null!==n){if(!(n instanceof i))try{n=i[s.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return s.emit("error",e,t),a(e)}return s.emit("data",n,t),a(null,n)}s.end(!0)}))}catch(e){return s.emit("error",e,t),void setTimeout((function(){a(e)}),0)}else setTimeout((function(){a(Error("already ended"))}),0)},i.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){e.exports={}},function(e){e.exports=JSON.parse('{"chromatic":["1P 2m 2M 3m 3M 4P 4A 5P 6m 6M 7m 7M"],"lydian":["1P 2M 3M 4A 5P 6M 7M"],"major":["1P 2M 3M 4P 5P 6M 7M",["ionian"]],"mixolydian":["1P 2M 3M 4P 5P 6M 7m",["dominant"]],"dorian":["1P 2M 3m 4P 5P 6M 7m"],"aeolian":["1P 2M 3m 4P 5P 6m 7m",["minor"]],"phrygian":["1P 2m 3m 4P 5P 6m 7m"],"locrian":["1P 2m 3m 4P 5d 6m 7m"],"melodic minor":["1P 2M 3m 4P 5P 6M 7M"],"melodic minor second mode":["1P 2m 3m 4P 5P 6M 7m"],"lydian augmented":["1P 2M 3M 4A 5A 6M 7M"],"lydian dominant":["1P 2M 3M 4A 5P 6M 7m",["lydian b7"]],"melodic minor fifth mode":["1P 2M 3M 4P 5P 6m 7m",["hindu","mixolydian b6M"]],"locrian #2":["1P 2M 3m 4P 5d 6m 7m",["half-diminished"]],"altered":["1P 2m 3m 3M 5d 6m 7m",["super locrian","diminished whole tone","pomeroy"]],"harmonic minor":["1P 2M 3m 4P 5P 6m 7M"],"phrygian dominant":["1P 2m 3M 4P 5P 6m 7m",["spanish","phrygian major"]],"half-whole diminished":["1P 2m 3m 3M 4A 5P 6M 7m",["dominant diminished"]],"diminished":["1P 2M 3m 4P 5d 6m 6M 7M",["whole-half diminished"]],"major pentatonic":["1P 2M 3M 5P 6M",["pentatonic"]],"lydian pentatonic":["1P 3M 4A 5P 7M",["chinese"]],"mixolydian pentatonic":["1P 3M 4P 5P 7m",["indian"]],"locrian pentatonic":["1P 3m 4P 5d 7m",["minor seven flat five pentatonic"]],"minor pentatonic":["1P 3m 4P 5P 7m"],"minor six pentatonic":["1P 3m 4P 5P 6M"],"minor hexatonic":["1P 2M 3m 4P 5P 7M"],"flat three pentatonic":["1P 2M 3m 5P 6M",["kumoi"]],"flat six pentatonic":["1P 2M 3M 5P 6m"],"major flat two pentatonic":["1P 2m 3M 5P 6M"],"whole tone pentatonic":["1P 3M 5d 6m 7m"],"ionian pentatonic":["1P 3M 4P 5P 7M"],"lydian #5P pentatonic":["1P 3M 4A 5A 7M"],"lydian dominant pentatonic":["1P 3M 4A 5P 7m"],"minor #7M pentatonic":["1P 3m 4P 5P 7M"],"super locrian pentatonic":["1P 3m 4d 5d 7m"],"in-sen":["1P 2m 4P 5P 7m"],"iwato":["1P 2m 4P 5d 7m"],"hirajoshi":["1P 2M 3m 5P 6m"],"kumoijoshi":["1P 2m 4P 5P 6m"],"pelog":["1P 2m 3m 5P 6m"],"vietnamese 1":["1P 3m 4P 5P 6m"],"vietnamese 2":["1P 3m 4P 5P 7m"],"prometheus":["1P 2M 3M 4A 6M 7m"],"prometheus neopolitan":["1P 2m 3M 4A 6M 7m"],"ritusen":["1P 2M 4P 5P 6M"],"scriabin":["1P 2m 3M 5P 6M"],"piongio":["1P 2M 4P 5P 6M 7m"],"major blues":["1P 2M 3m 3M 5P 6M"],"minor blues":["1P 3m 4P 5d 5P 7m",["blues"]],"composite blues":["1P 2M 3m 3M 4P 5d 5P 6M 7m"],"augmented":["1P 2A 3M 5P 5A 7M"],"augmented heptatonic":["1P 2A 3M 4P 5P 5A 7M"],"dorian #4":["1P 2M 3m 4A 5P 6M 7m"],"lydian diminished":["1P 2M 3m 4A 5P 6M 7M"],"whole tone":["1P 2M 3M 4A 5A 7m"],"leading whole tone":["1P 2M 3M 4A 5A 7m 7M"],"lydian minor":["1P 2M 3M 4A 5P 6m 7m"],"locrian major":["1P 2M 3M 4P 5d 6m 7m",["arabian"]],"neopolitan":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan minor":["1P 2m 3m 4P 5P 6m 7M"],"neopolitan major":["1P 2m 3m 4P 5P 6M 7M",["dorian b2"]],"neopolitan major pentatonic":["1P 3M 4P 5d 7m"],"romanian minor":["1P 2M 3m 5d 5P 6M 7m"],"double harmonic lydian":["1P 2m 3M 4A 5P 6m 7M"],"harmonic major":["1P 2M 3M 4P 5P 6m 7M"],"double harmonic major":["1P 2m 3M 4P 5P 6m 7M",["gypsy"]],"egyptian":["1P 2M 4P 5P 7m"],"hungarian minor":["1P 2M 3m 4A 5P 6m 7M"],"hungarian major":["1P 2A 3M 4A 5P 6M 7m"],"oriental":["1P 2m 3M 4P 5d 6M 7m"],"spanish heptatonic":["1P 2m 3m 3M 4P 5P 6m 7m"],"flamenco":["1P 2m 3m 3M 4A 5P 7m"],"balinese":["1P 2m 3m 4P 5P 6m 7M"],"todi raga":["1P 2m 3m 4A 5P 6m 7M"],"malkos raga":["1P 3m 4P 6m 7m"],"kafi raga":["1P 3m 3M 4P 5P 6M 7m 7M"],"purvi raga":["1P 2m 3M 4P 4A 5P 6m 7M"],"persian":["1P 2m 3M 4P 5d 6m 7M"],"bebop":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop dominant":["1P 2M 3M 4P 5P 6M 7m 7M"],"bebop minor":["1P 2M 3m 3M 4P 5P 6M 7m"],"bebop major":["1P 2M 3M 4P 5P 5A 6M 7M"],"bebop locrian":["1P 2m 3m 4P 5d 5P 6m 7m"],"minor bebop":["1P 2M 3m 4P 5P 6m 7m 7M"],"mystery #1":["1P 2m 3M 5d 6m 7m"],"enigmatic":["1P 2m 3M 5d 6m 7m 7M"],"minor six diminished":["1P 2M 3m 4P 5P 6m 6M 7M"],"ionian augmented":["1P 2M 3M 4P 5A 6M 7M"],"lydian #9":["1P 2m 3M 4A 5P 6M 7M"],"ichikosucho":["1P 2M 3M 4P 5d 5P 6M 7M"],"six tone symmetric":["1P 2m 3M 4P 5A 6M"]}')},function(e){e.exports=JSON.parse('{"4":["1P 4P 7m 10m",["quartal"]],"5":["1P 5P"],"7":["1P 3M 5P 7m",["Dominant","Dom"]],"9":["1P 3M 5P 7m 9M",["79"]],"11":["1P 5P 7m 9M 11P"],"13":["1P 3M 5P 7m 9M 13M",["13_"]],"64":["5P 8P 10M"],"M":["1P 3M 5P",["Major",""]],"M#5":["1P 3M 5A",["augmented","maj#5","Maj#5","+","aug"]],"M#5add9":["1P 3M 5A 9M",["+add9"]],"M13":["1P 3M 5P 7M 9M 13M",["maj13","Maj13"]],"M13#11":["1P 3M 5P 7M 9M 11A 13M",["maj13#11","Maj13#11","M13+4","M13#4"]],"M6":["1P 3M 5P 13M",["6"]],"M6#11":["1P 3M 5P 6M 11A",["M6b5","6#11","6b5"]],"M69":["1P 3M 5P 6M 9M",["69"]],"M69#11":["1P 3M 5P 6M 9M 11A"],"M7#11":["1P 3M 5P 7M 11A",["maj7#11","Maj7#11","M7+4","M7#4"]],"M7#5":["1P 3M 5A 7M",["maj7#5","Maj7#5","maj9#5","M7+"]],"M7#5sus4":["1P 4P 5A 7M"],"M7#9#11":["1P 3M 5P 7M 9A 11A"],"M7add13":["1P 3M 5P 6M 7M 9M"],"M7b5":["1P 3M 5d 7M"],"M7b6":["1P 3M 6m 7M"],"M7b9":["1P 3M 5P 7M 9m"],"M7sus4":["1P 4P 5P 7M"],"M9":["1P 3M 5P 7M 9M",["maj9","Maj9"]],"M9#11":["1P 3M 5P 7M 9M 11A",["maj9#11","Maj9#11","M9+4","M9#4"]],"M9#5":["1P 3M 5A 7M 9M",["Maj9#5"]],"M9#5sus4":["1P 4P 5A 7M 9M"],"M9b5":["1P 3M 5d 7M 9M"],"M9sus4":["1P 4P 5P 7M 9M"],"Madd9":["1P 3M 5P 9M",["2","add9","add2"]],"Maj7":["1P 3M 5P 7M",["maj7","M7"]],"Mb5":["1P 3M 5d"],"Mb6":["1P 3M 13m"],"Msus2":["1P 2M 5P",["add9no3","sus2"]],"Msus4":["1P 4P 5P",["sus","sus4"]],"Maddb9":["1P 3M 5P 9m"],"11b9":["1P 5P 7m 9m 11P"],"13#11":["1P 3M 5P 7m 9M 11A 13M",["13+4","13#4"]],"13#9":["1P 3M 5P 7m 9A 13M",["13#9_"]],"13#9#11":["1P 3M 5P 7m 9A 11A 13M"],"13b5":["1P 3M 5d 6M 7m 9M"],"13b9":["1P 3M 5P 7m 9m 13M"],"13b9#11":["1P 3M 5P 7m 9m 11A 13M"],"13no5":["1P 3M 7m 9M 13M"],"13sus4":["1P 4P 5P 7m 9M 13M",["13sus"]],"69#11":["1P 3M 5P 6M 9M 11A"],"7#11":["1P 3M 5P 7m 11A",["7+4","7#4","7#11_","7#4_"]],"7#11b13":["1P 3M 5P 7m 11A 13m",["7b5b13"]],"7#5":["1P 3M 5A 7m",["+7","7aug","aug7"]],"7#5#9":["1P 3M 5A 7m 9A",["7alt","7#5#9_","7#9b13_"]],"7#5b9":["1P 3M 5A 7m 9m"],"7#5b9#11":["1P 3M 5A 7m 9m 11A"],"7#5sus4":["1P 4P 5A 7m"],"7#9":["1P 3M 5P 7m 9A",["7#9_"]],"7#9#11":["1P 3M 5P 7m 9A 11A",["7b5#9"]],"7#9#11b13":["1P 3M 5P 7m 9A 11A 13m"],"7#9b13":["1P 3M 5P 7m 9A 13m"],"7add6":["1P 3M 5P 7m 13M",["67","7add13"]],"7b13":["1P 3M 7m 13m"],"7b5":["1P 3M 5d 7m"],"7b6":["1P 3M 5P 6m 7m"],"7b9":["1P 3M 5P 7m 9m"],"7b9#11":["1P 3M 5P 7m 9m 11A",["7b5b9"]],"7b9#9":["1P 3M 5P 7m 9m 9A"],"7b9b13":["1P 3M 5P 7m 9m 13m"],"7b9b13#11":["1P 3M 5P 7m 9m 11A 13m",["7b9#11b13","7b5b9b13"]],"7no5":["1P 3M 7m"],"7sus4":["1P 4P 5P 7m",["7sus"]],"7sus4b9":["1P 4P 5P 7m 9m",["susb9","7susb9","7b9sus","7b9sus4","phryg"]],"7sus4b9b13":["1P 4P 5P 7m 9m 13m",["7b9b13sus4"]],"9#11":["1P 3M 5P 7m 9M 11A",["9+4","9#4","9#11_","9#4_"]],"9#11b13":["1P 3M 5P 7m 9M 11A 13m",["9b5b13"]],"9#5":["1P 3M 5A 7m 9M",["9+"]],"9#5#11":["1P 3M 5A 7m 9M 11A"],"9b13":["1P 3M 7m 9M 13m"],"9b5":["1P 3M 5d 7m 9M"],"9no5":["1P 3M 7m 9M"],"9sus4":["1P 4P 5P 7m 9M",["9sus"]],"m":["1P 3m 5P"],"m#5":["1P 3m 5A",["m+","mb6"]],"m11":["1P 3m 5P 7m 9M 11P",["_11"]],"m11A 5":["1P 3m 6m 7m 9M 11P"],"m11b5":["1P 3m 7m 12d 2M 4P",["h11","_11b5"]],"m13":["1P 3m 5P 7m 9M 11P 13M",["_13"]],"m6":["1P 3m 4P 5P 13M",["_6"]],"m69":["1P 3m 5P 6M 9M",["_69"]],"m7":["1P 3m 5P 7m",["minor7","_","_7"]],"m7#5":["1P 3m 6m 7m"],"m7add11":["1P 3m 5P 7m 11P",["m7add4"]],"m7b5":["1P 3m 5d 7m",["half-diminished","h7","_7b5"]],"m9":["1P 3m 5P 7m 9M",["_9"]],"m9#5":["1P 3m 6m 7m 9M"],"m9b5":["1P 3m 7m 12d 2M",["h9","-9b5"]],"mMaj7":["1P 3m 5P 7M",["mM7","_M7"]],"mMaj7b6":["1P 3m 5P 6m 7M",["mM7b6"]],"mM9":["1P 3m 5P 7M 9M",["mMaj9","-M9"]],"mM9b6":["1P 3m 5P 6m 7M 9M",["mMaj9b6"]],"mb6M7":["1P 3m 6m 7M"],"mb6b9":["1P 3m 6m 9m"],"o":["1P 3m 5d",["mb5","dim"]],"o7":["1P 3m 5d 13M",["diminished","m6b5","dim7"]],"o7M7":["1P 3m 5d 6M 7M"],"oM7":["1P 3m 5d 7M"],"sus24":["1P 2M 4P 5P",["sus4add9"]],"+add#9":["1P 3M 5A 9A"],"madd4":["1P 3m 4P 5P"],"madd9":["1P 3m 5P 9M"]}')},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),i=new WeakMap;t.keySignatureKeys=["Cb","Gb","Db","Ab","Eb","Bb","F","C","G","D","A","E","B","F#","C#"];var o=function(){function e(e){var n=this;this.tempos=[],this.timeSignatures=[],this.keySignatures=[],this.meta=[],this.name="",i.set(this,480),e&&(i.set(this,e.header.ticksPerBeat),e.tracks.forEach((function(e){return e.forEach((function(e){e.meta&&("timeSignature"===e.type?n.timeSignatures.push({ticks:e.absoluteTime,timeSignature:[e.numerator,e.denominator]}):"setTempo"===e.type?n.tempos.push({bpm:6e7/e.microsecondsPerBeat,ticks:e.absoluteTime}):"keySignature"===e.type&&n.keySignatures.push({key:t.keySignatureKeys[e.key+7],scale:0===e.scale?"major":"minor",ticks:e.absoluteTime}))}))})),e.tracks[0].forEach((function(e){e.meta&&("trackName"===e.type?n.name=e.text:"text"!==e.type&&"cuePoint"!==e.type&&"marker"!==e.type&&"lyrics"!==e.type||n.meta.push({text:e.text,ticks:e.absoluteTime,type:e.type}))})),this.update())}return e.prototype.update=function(){var e=this,t=0,n=0;this.tempos.sort((function(e,t){return e.ticks-t.ticks})),this.tempos.forEach((function(r,i){var o=i>0?e.tempos[i-1].bpm:e.tempos[0].bpm,a=r.ticks/e.ppq-n,s=60/o*a;r.time=s+t,t=r.time,n+=a})),this.timeSignatures.sort((function(e,t){return e.ticks-t.ticks})),this.timeSignatures.forEach((function(t,n){var r=n>0?e.timeSignatures[n-1]:e.timeSignatures[0],i=(t.ticks-r.ticks)/e.ppq/r.timeSignature[0]/(r.timeSignature[1]/4);r.measures=r.measures||0,t.measures=i+r.measures}))},e.prototype.ticksToSeconds=function(e){var t=r.search(this.tempos,e);if(-1!==t){var n=this.tempos[t],i=n.time,o=(e-n.ticks)/this.ppq;return i+60/n.bpm*o}return e/this.ppq*.5},e.prototype.ticksToMeasures=function(e){var t=r.search(this.timeSignatures,e);if(-1!==t){var n=this.timeSignatures[t],i=(e-n.ticks)/this.ppq;return n.measures+i/(n.timeSignature[0]/n.timeSignature[1])/4}return e/this.ppq/4},Object.defineProperty(e.prototype,"ppq",{get:function(){return i.get(this)},enumerable:!0,configurable:!0}),e.prototype.secondsToTicks=function(e){var t=r.search(this.tempos,e,"time");if(-1!==t){var n=this.tempos[t],i=(e-n.time)/(60/n.bpm);return Math.round(n.ticks+i*this.ppq)}var o=e/.5;return Math.round(o*this.ppq)},e.prototype.toJSON=function(){return{keySignatures:this.keySignatures,meta:this.meta,name:this.name,ppq:this.ppq,tempos:this.tempos.map((function(e){return{bpm:e.bpm,ticks:e.ticks}})),timeSignatures:this.timeSignatures}},e.prototype.fromJSON=function(e){this.name=e.name,this.tempos=e.tempos.map((function(e){return Object.assign({},e)})),this.timeSignatures=e.timeSignatures.map((function(e){return Object.assign({},e)})),this.keySignatures=e.keySignatures.map((function(e){return Object.assign({},e)})),this.meta=e.meta.map((function(e){return Object.assign({},e)})),i.set(this,e.ppq),this.update()},e.prototype.setTempo=function(e){this.tempos=[{bpm:e,ticks:0}],this.update()},e}();t.Header=o},function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))},i=this&&this.__generator||function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(79),a=n(174),s=n(66),u=n(81),c=function(){function e(e){var t=this,n=null;e&&(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(n=o.parseMidi(e)).tracks.forEach((function(e){var t=0;e.forEach((function(e){t+=e.deltaTime,e.absoluteTime=t}))})),n.tracks=function(e){for(var t=[],n=0;n<e.length;n++)for(var r=t.length,i=new Map,o=Array(16).fill(0),a=0,s=e[n];a<s.length;a++){var u=s[a],c=r,l=u.channel;if(void 0!==l){"programChange"===u.type&&(o[l]=u.programNumber);var h=o[l]+" "+l;i.has(h)?c=i.get(h):(c=r+i.size,i.set(h,c))}t[c]||t.push([]),t[c].push(u)}return t}(n.tracks)),this.header=new s.Header(n),this.tracks=[],e&&(this.tracks=n.tracks.map((function(e){return new u.Track(e,t.header)})),1===n.header.format&&0===this.tracks[0].duration&&this.tracks.shift())}return e.fromUrl=function(t){return r(this,void 0,void 0,(function(){var n;return i(this,(function(r){switch(r.label){case 0:return[4,fetch(t)];case 1:return(n=r.sent()).ok?[4,n.arrayBuffer()]:[3,3];case 2:return[2,new e(r.sent())];case 3:throw new Error("could not load "+t)}}))}))},Object.defineProperty(e.prototype,"name",{get:function(){return this.header.name},set:function(e){this.header.name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){var e=this.tracks.map((function(e){return e.duration}));return Math.max.apply(Math,e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){var e=this.tracks.map((function(e){return e.durationTicks}));return Math.max.apply(Math,e)},enumerable:!0,configurable:!0}),e.prototype.addTrack=function(){var e=new u.Track(void 0,this.header);return this.tracks.push(e),e},e.prototype.toArray=function(){return a.encode(this)},e.prototype.toJSON=function(){return{header:this.header.toJSON(),tracks:this.tracks.map((function(e){return e.toJSON()}))}},e.prototype.fromJSON=function(e){var t=this;this.header=new s.Header,this.header.fromJSON(e.header),this.tracks=e.tracks.map((function(e){var n=new u.Track(void 0,t.header);return n.fromJSON(e),n}))},e.prototype.clone=function(){var t=new e;return t.fromJSON(this.toJSON()),t},e}();t.Midi=c;var l=n(81);t.Track=l.Track;var h=n(66);t.Header=h.Header},,,,,,function(e,t,n){n.r(t),n.d(t,"aux_inputs",(function(){return r})),n.d(t,"chords",(function(){return i})),n.d(t,"constants",(function(){return o})),n.d(t,"data",(function(){return a})),n.d(t,"logging",(function(){return s})),n.d(t,"melodies",(function(){return u})),n.d(t,"performance",(function(){return c})),n.d(t,"sequences",(function(){return l})),n.d(t,"MetronomeCallbackObject",(function(){return f})),n.d(t,"Metronome",(function(){return p})),n.d(t,"MidiConversionError",(function(){return g})),n.d(t,"midiToSequenceProto",(function(){return y})),n.d(t,"sequenceProtoToMidi",(function(){return _})),n.d(t,"urlToBlob",(function(){return k})),n.d(t,"blobToNoteSequence",(function(){return b})),n.d(t,"urlToNoteSequence",(function(){return S})),n.d(t,"BasePlayerCallback",(function(){return C})),n.d(t,"BasePlayer",(function(){return P})),n.d(t,"Player",(function(){return O})),n.d(t,"SoundFontPlayer",(function(){return N})),n.d(t,"PlayerWithClick",(function(){return I})),n.d(t,"MIDIPlayer",(function(){return E})),n.d(t,"BaseRecorderCallback",(function(){return q})),n.d(t,"Recorder",(function(){return D})),n.d(t,"BaseVisualizer",(function(){return j})),n.d(t,"PianoRollCanvasVisualizer",(function(){return z})),n.d(t,"Visualizer",(function(){return F})),n.d(t,"BaseSVGVisualizer",(function(){return L})),n.d(t,"PianoRollSVGVisualizer",(function(){return V})),n.d(t,"WaterfallSVGVisualizer",(function(){return G})),n.d(t,"ScrollType",(function(){return M})),n.d(t,"StaffSVGVisualizer",(function(){return B}));var r=n(48),i=n(37),o=n(8),a=n(36),s=n(12),u=n(23),c=n(29),l=n(13),h=n(9),f=_createClass((function e(){_classCallCheck(this,e)})),p=function(){return _createClass((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;_classCallCheck(this,e),this.clicksPerQuarter=1,this.muted=!1,this.loClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.loClickNote="c5",this.hiClickNote="g5",this.ticking=!1,this.startedAt=null,this.step=-1,this.reset(),this.callbackObject=t,this.clicksPerQuarter=n}),[{key:"isTicking",value:function(){return this.ticking}},{key:"getStartedAt",value:function(){return this.startedAt}},{key:"getOffsetTime",value:function(){return h.immediate()-this.startedAt}},{key:"start",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:120;this.reset(),this.ticking=!0,this.callbackObject.click||(this.callbackObject.click=function(){}),this.callbackObject.quarter||(this.callbackObject.quarter=function(){}),this.callbackObject.bar||(this.callbackObject.bar=function(){});var n=0,r=4*this.clicksPerQuarter;h.Transport.scheduleRepeat((function(t){e.startedAt||(e.startedAt=t);var i=t-e.startedAt;e.step++;var o=e.step%r,a=Math.floor(o/e.clicksPerQuarter),s=o%e.clicksPerQuarter;e.callbackObject.click(i,o),0===s&&e.callbackObject.quarter(i,a),e.muted||(0===o?e.hiClick.triggerAttack(e.hiClickNote,t,.1):e.loClick.triggerAttack(e.loClickNote,t,.1)),0===o&&(e.callbackObject.bar(i,n),n++)}),r+"n"),h.Transport.bpm.value=t,h.Transport.start()}},{key:"stop",value:function(){this.ticking=!1,h.Transport.cancel(),h.Transport.stop()}},{key:"reset",value:function(){this.muted=!1,this.ticking=!1,this.step=-1,this.startedAt=null}}])}(),d=n(67),m=n(15),v=n(10),g=function(){function e(t){var n;return _classCallCheck(this,e),n=_callSuper(this,e,[t]),Object.setPrototypeOf(_assertThisInitialized(n),(this instanceof e?this.constructor:void 0).prototype),n}return _inherits(e,_wrapNativeSuper(Error)),_createClass(e)}();function y(e){var t=new d.Midi(e),n=v.a.create();n.ticksPerQuarter=t.header.ppq,n.sourceInfo=v.a.SourceInfo.create({parser:v.a.SourceInfo.Parser.TONEJS_MIDI_CONVERT,encodingType:v.a.SourceInfo.EncodingType.MIDI});var r,i=_createForOfIteratorHelper(t.header.timeSignatures);try{for(i.s();!(r=i.n()).done;){var a=r.value;n.timeSignatures.push(v.a.TimeSignature.create({time:t.header.ticksToSeconds(a.ticks),numerator:a.timeSignature[0],denominator:a.timeSignature[1]}))}}catch(e){i.e(e)}finally{i.f()}n.timeSignatures.length||n.timeSignatures.push(v.a.TimeSignature.create({time:0,numerator:4,denominator:4}));var s,u=_createForOfIteratorHelper(t.header.tempos);try{for(u.s();!(s=u.n()).done;){var c=s.value;n.tempos.push(v.a.Tempo.create({time:c.time,qpm:c.bpm}))}}catch(e){u.e(e)}finally{u.f()}var l,h=-1,f=_createForOfIteratorHelper(t.tracks);try{for(f.s();!(l=f.n()).done;){var p=l.value;p.notes.length>0&&(h+=1);var m,g=_createForOfIteratorHelper(p.notes);try{for(g.s();!(m=g.n()).done;){var y=m.value,_=y.time,k=_+y.duration;n.notes.push(v.a.Note.create({instrument:h,program:p.instrument.number,startTime:_,endTime:k,pitch:y.midi,velocity:Math.floor(y.velocity*o.MIDI_VELOCITIES),isDrum:p.instrument.percussion})),k>n.totalTime&&(n.totalTime=k)}}catch(e){g.e(e)}finally{g.f()}var b,S=Object.values(p.controlChanges),w=_createForOfIteratorHelper([].concat.apply([],S));try{for(w.s();!(b=w.n()).done;){var x=b.value;n.controlChanges.push(v.a.ControlChange.create({time:x.time,controlNumber:x.number,controlValue:Math.floor(x.value*(o.MIDI_VELOCITIES-1)),instrument:h,program:p.instrument.number,isDrum:p.instrument.percussion}))}}catch(e){w.e(e)}finally{w.f()}}}catch(e){f.e(e)}finally{f.f()}return n}function _(e){l.isQuantizedSequence(e)&&(e=l.unquantizeSequence(e));var t=new d.Midi;t.fromJSON({header:{name:"",ppq:e.ticksPerQuarter||o.DEFAULT_TICKS_PER_QUARTER,tempos:[],timeSignatures:[],keySignatures:[],meta:[]},tracks:[]});var n=Array.from(e.tempos||[]);0===n.length&&n.push({time:0,qpm:o.DEFAULT_QUARTERS_PER_MINUTE}),n.sort((function(e,t){return e.time-t.time}));for(var r=0,i=n;r<i.length;r++){var a=i[r];t.header.tempos.push({ticks:t.header.secondsToTicks(a.time),bpm:a.qpm}),t.header.update()}if(e.timeSignatures&&0!==e.timeSignatures.length){var s,u=_createForOfIteratorHelper(e.timeSignatures);try{for(u.s();!(s=u.n()).done;){var c=s.value;t.header.timeSignatures.push({ticks:t.header.secondsToTicks(c.time),timeSignature:[c.numerator,c.denominator]})}}catch(e){u.e(e)}finally{u.f()}}else t.header.timeSignatures.push({ticks:0,timeSignature:[4,4]});t.header.update();var h,f=new Map,p=_createForOfIteratorHelper(e.notes);try{for(p.s();!(h=p.n()).done;){var m=h.value,v=m.instrument?m.instrument:0,g=void 0===m.program?o.DEFAULT_PROGRAM:m.program,y=!!m.isDrum,_=JSON.stringify([v,g,y]);f.has(_)||f.set(_,{notes:[],controlChanges:[]}),f.get(_).notes.push(m)}}catch(e){p.e(e)}finally{p.f()}var k,b=_createForOfIteratorHelper(e.controlChanges);try{for(b.s();!(k=b.n()).done;){var S=k.value,w=S.instrument?S.instrument:0,x=void 0===S.program?o.DEFAULT_PROGRAM:S.program,T=!!S.isDrum,C=JSON.stringify([w,x,T]);f.has(C)||f.set(C,{notes:[],controlChanges:[]}),f.get(C).controlChanges.push(S)}}catch(e){b.e(e)}finally{b.f()}return f.forEach((function(e,n){var r=_slicedToArray(JSON.parse(n).slice(1),2),i=r[0],a=r[1],s=t.addTrack();s.channel=a?o.DRUM_CHANNEL:o.NON_DRUM_CHANNELS[(t.tracks.length-1)%o.NON_DRUM_CHANNELS.length],s.instrument.number=i;var u,c=_createForOfIteratorHelper(e.notes);try{for(c.s();!(u=c.n()).done;){var l=u.value,h=void 0===l.velocity?o.DEFAULT_VELOCITY:l.velocity;s.addNote({midi:l.pitch,time:l.startTime,duration:l.endTime-l.startTime,velocity:(h+1)/o.MIDI_VELOCITIES})}}catch(e){c.e(e)}finally{c.f()}var f,p=_createForOfIteratorHelper(e.controlChanges);try{for(p.s();!(f=p.n()).done;){var d=f.value;s.addCC({number:d.controlNumber,value:d.controlValue,time:d.time})}}catch(e){p.e(e)}finally{p.f()}})),t.toArray()}function k(e){return new Promise((function(t,n){Object(m.a)(e).then((function(e){return e.blob()})).then((function(e){t(e)})).catch((function(e){return n(e)}))}))}function b(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){try{var i=y(r.result);t(i)}catch(e){n(e)}},r.onerror=function(e){return n(e)},r.readAsArrayBuffer(e)}))}function S(e){return k(e).then(b)}var w=function(){return _createClass((function e(t){_classCallCheck(this,e),this.FADE_SECONDS=.1,this.baseURL=t,this.buffers=new h.ToneAudioBuffers,this.sourceMap=new Map,this.initialized=!1}),[{key:"initialize",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(this.baseURL+"/instrument.json").then((function(e){return e.json()})).then((function(e){t.name=e.name,t.minPitch=e.minPitch,t.maxPitch=e.maxPitch,t.durationSeconds=e.durationSeconds,t.releaseSeconds=e.releaseSeconds,t.percussive=e.percussive,t.velocities=e.velocities,t.initialized=!0}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"sampleInfoToName",value:function(e){return this.velocities?"p".concat(e.pitch,"_v").concat(e.velocity):"p"+e.pitch}},{key:"sampleNameToURL",value:function(e){return"".concat(this.baseURL,"/").concat(e,".mp3")}},{key:"nearestVelocity",value:function(e){if(!this.velocities)return e;e||(e=o.DEFAULT_VELOCITY);var t=void 0,n=o.MIDI_VELOCITIES;return this.velocities.forEach((function(r){var i=Math.abs(r-e);i<n&&(t=r,n=i)})),t}},{key:"loadSamples",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r,i=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.initialized,e.t0){e.next=4;break}return e.next=4,this.initialize();case 4:if(n=t.filter((function(e){return!(e.pitch<i.minPitch||e.pitch>i.maxPitch)||(s.log("Pitch ".concat(e.pitch," is outside the valid range for ").concat(i.name,", ignoring."),"SoundFont"),!1)})).map((function(e){return i.sampleInfoToName({pitch:e.pitch,velocity:i.nearestVelocity(e.velocity)})})),r=Array.from(new Set(n)).filter((function(e){return!i.buffers.has(e)})).map((function(e){return{name:e,url:i.sampleNameToURL(e)}})),e.t1=r.length>0,!e.t1){e.next=11;break}return r.forEach((function(e){return i.buffers.add(e.name,e.url)})),e.next=10,h.loaded();case 10:s.log("Loaded samples for ".concat(this.name,"."),"SoundFont");case 11:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"playNote",value:function(e,t,n,r,i){var o=this.getBuffer(e,t);if(o){r>this.durationSeconds&&s.log("Requested note duration longer than sample duration: ".concat(r," > ").concat(this.durationSeconds),"SoundFont");var a=new h.ToneBufferSource({url:o,fadeOut:this.FADE_SECONDS}).connect(i);if(a.start(n,0,void 0,1),!this.percussive&&r<this.durationSeconds){var u=new h.ToneBufferSource({url:o,fadeOut:this.FADE_SECONDS}).connect(i);a.stop(n+r+this.FADE_SECONDS),u.start(n+r,this.durationSeconds,void 0,1)}}}},{key:"playNoteDown",value:function(e,t,n){var r=this.getBuffer(e,t);if(r){var i=new h.ToneBufferSource(r).connect(n);i.start(0,0,void 0,1),this.sourceMap.has(e)&&this.sourceMap.get(e).stop(h.now()+this.FADE_SECONDS,this.FADE_SECONDS),this.sourceMap.set(e,i)}}},{key:"playNoteUp",value:function(e,t,n){if(this.sourceMap.has(e)){var r=this.getBuffer(e,t);r&&(new h.ToneBufferSource({url:r,fadeOut:this.FADE_SECONDS}).connect(n).start(0,this.durationSeconds,void 0,1),this.sourceMap.get(e).stop(h.now()+this.FADE_SECONDS,this.FADE_SECONDS),this.sourceMap.delete(e))}}},{key:"getBuffer",value:function(e,t){if(!this.initialized)throw new Error("Instrument is not initialized.");if(!(e<this.minPitch||e>this.maxPitch)){var n=this.sampleInfoToName({pitch:e,velocity:this.nearestVelocity(t)});if(!this.buffers.has(n))throw new Error("Buffer not found for ".concat(this.name,": ").concat(n));var r=this.buffers.get(n);if(!r.loaded)throw new Error("Buffer not loaded for ".concat(this.name,": ").concat(n));return r}s.log("Pitch ".concat(e," is outside the valid range for ").concat(this.name," (").concat(this.minPitch,"-").concat(this.maxPitch,")"),"SoundFont")}}]);var e,t}(),x=function(){return _createClass((function e(t){_classCallCheck(this,e),this.baseURL=t,this.instruments=new Map,this.initialized=!1}),[{key:"initialize",value:(t=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(m.a)(this.baseURL+"/soundfont.json").then((function(e){return e.json()})).then((function(e){for(var n in t.name=e.name,e.instruments){var r="".concat(t.baseURL,"/").concat(e.instruments[n]);t.instruments.set("drums"===n?"drums":+n,new w(r))}t.initialized=!0}));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"loadSamples",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var n,r=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.initialized,e.t0){e.next=4;break}return e.next=4,this.initialize();case 4:return n=new Map,t.forEach((function(e){e.isDrum=e.isDrum||!1,e.program=e.program||0;var t=e.isDrum?"drums":e.program,i={pitch:e.pitch,velocity:e.velocity};n.has(t)?n.get(t).push(i):r.instruments.has(t)?n.set(t,[i]):s.log("No instrument in ".concat(r.name," for: program=").concat(e.program,", isDrum=").concat(e.isDrum),"SoundFont")})),e.next=8,Promise.all(Array.from(n.keys()).map((function(e){return r.instruments.get(e).loadSamples(n.get(e))})));case 8:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})},{key:"playNote",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=arguments.length>6?arguments[6]:void 0,u=o?"drums":i;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(u)?this.instruments.get(u).playNote(e,t,n,r,a):s.log("No instrument in ".concat(this.name," for: program=").concat(i,", isDrum=").concat(o),"SoundFont")}},{key:"playNoteDown",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=r?"drums":n;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(o)?this.instruments.get(o).playNoteDown(e,t,i):s.log("No instrument in ".concat(this.name," for: program=").concat(n,", isDrum=").concat(r),"SoundFont")}},{key:"playNoteUp",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0,o=r?"drums":n;if(!this.initialized)throw new Error("SoundFont is not initialized.");this.instruments.has(o)?this.instruments.get(o).playNoteUp(e,t,i):s.log("No instrument in ".concat(this.name," for: program=").concat(n,", isDrum=").concat(r),"SoundFont")}}]);var e,t}();function T(e,t){return e.quantizedStartStep<t.quantizedStartStep?-1:e.quantizedStartStep>t.quantizedStartStep?1:e.pitch<t.pitch?-1:1}var C=_createClass((function e(){_classCallCheck(this,e)})),P=function(){return _createClass((function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=arguments.length>1?arguments[1]:void 0;_classCallCheck(this,e),this.playClick=t,this.callbackObject=n,this.desiredQPM=void 0}),[{key:"setTempo",value:function(e){this.desiredQPM=e,"started"===h.Transport.state&&(h.Transport.bpm.value=e)}},{key:"makeClickSequence",value:function(e){for(var t=l.clone(e),n=t.notes.map((function(e){return e.quantizedEndStep})),r=Math.max.apply(Math,_toConsumableArray(n)),i=0;i<r;i+=4){var a={pitch:i%16==0?o.LO_CLICK_PITCH:o.HI_CLICK_PITCH,quantizedStartStep:i,isDrum:!0,quantizedEndStep:i+1};t.notes.push(a)}return t.notes.sort(T),t}},{key:"resumeContext",value:function(){h.context.resume()}},{key:"start",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("started"===this.getPlayState())throw new Error("Cannot start playback; player is already playing.");if("paused"===this.getPlayState())throw new Error("Cannot `start()` a paused player; use `resume()`.");if("stopped"!==h.Transport.state)throw new Error("Cannot start playback while `Tone.Transport` is in use.");this.resumeContext();var i=l.isQuantizedSequence(e);if(this.playClick&&i&&(e=this.makeClickSequence(e)),t?h.Transport.bpm.value=t:e.tempos&&e.tempos.length>0&&e.tempos[0].qpm>0?h.Transport.bpm.value=e.tempos[0].qpm:h.Transport.bpm.value=o.DEFAULT_QUARTERS_PER_MINUTE,i)e=l.unquantizeSequence(e,t);else if(t)throw new Error("Cannot specify a `qpm` for a non-quantized sequence.");var a=new h.Part((function(e,t){n.currentPart===a&&(n.playNote(e,t),n.callbackObject&&h.Draw.schedule((function(){n.callbackObject.run(t,e)}),e))}),e.notes.map((function(e){return[e.startTime,e]})));return this.currentPart=a,this.desiredQPM&&(h.Transport.bpm.value=this.desiredQPM),this.currentPart.start(void 0,r),"started"!==h.Transport.state&&h.Transport.start(),new Promise((function(t){n.scheduledStop=h.Transport.schedule((function(){n.stop(),t(),n.callbackObject&&n.callbackObject.stop()}),"+"+e.totalTime)}))}},{key:"stop",value:function(){this.isPlaying()&&(this.currentPart.stop(),h.Transport.stop(),this.currentPart=null),h.Transport.clear(this.scheduledStop),this.scheduledStop=void 0,this.desiredQPM=void 0}},{key:"pause",value:function(){if(!this.isPlaying())throw new Error("Cannot pause playback while the player is stopped.");h.Transport.pause()}},{key:"resume",value:function(){if("paused"!==this.getPlayState())throw new Error('Cannot resume playback while "'.concat(this.getPlayState(),'".'));h.Transport.start()}},{key:"seekTo",value:function(e){if(!this.isPlaying())throw new Error("Cannot seek while the player is stopped.");h.Transport.seconds=e}},{key:"isPlaying",value:function(){return!!this.currentPart}},{key:"getPlayState",value:function(){return this.isPlaying()?h.Transport.state:"stopped"}}])}(),A=function(){function e(){var t=this;_classCallCheck(this,e),this.DRUM_PITCH_TO_CLASS=new Map,this.kick=(new h.MembraneSynth).toDestination(),this.tomLow=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomMid=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.tomHigh=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.01,decay:.5,sustain:0}}).toDestination(),this.closedHihat=new h.MetalSynth({frequency:400,envelope:{attack:.001,decay:.1,release:.8},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.openHihat=new h.MetalSynth({frequency:400,envelope:{attack:.001,decay:.5,release:.8,sustain:1},harmonicity:5.1,modulationIndex:32,resonance:4e3,octaves:1}).toDestination(),this.ride=(new h.MetalSynth).toDestination(),this.crash=new h.MetalSynth({frequency:300,envelope:{attack:.001,decay:1,release:3},harmonicity:5.1,modulationIndex:64,resonance:4e3,octaves:1.5}).toDestination(),this.snare=new h.NoiseSynth({noise:{type:"white"},envelope:{attack:.005,decay:.05,sustain:.1,release:.4}}).toDestination(),this.loClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.pitchPlayers=[function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.kick.triggerAttackRelease("C2","8n",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.snare.triggerAttackRelease("16n",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.closedHihat.triggerAttack(e,.3,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.openHihat.triggerAttack(e,.3,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomLow.triggerAttack("G3",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomMid.triggerAttack("C4",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.tomHigh.triggerAttack("F4",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.crash.triggerAttack(e,1,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.ride.triggerAttack(e,.5,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.loClick.triggerAttack("G5",e,n)},function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5;return t.hiClick.triggerAttack("C6",e,n)}];for(var n=function(e){o.DEFAULT_DRUM_PITCH_CLASSES[e].forEach((function(n){t.DRUM_PITCH_TO_CLASS.set(n,e)}))},r=0;r<o.DEFAULT_DRUM_PITCH_CLASSES.length;++r)n(r);this.DRUM_PITCH_TO_CLASS.set(o.LO_CLICK_PITCH,o.LO_CLICK_CLASS),this.DRUM_PITCH_TO_CLASS.set(o.HI_CLICK_PITCH,o.HI_CLICK_CLASS)}return _createClass(e,[{key:"playNote",value:function(e,t,n){this.pitchPlayers[this.DRUM_PITCH_TO_CLASS.get(e)](t,n)}}],[{key:"getInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}])}(),O=function(e){function t(){var e;return _classCallCheck(this,t),(e=_callSuper(this,t,arguments)).drumKit=A.getInstance(),e.bassSynth=new h.Synth({volume:5,oscillator:{type:"triangle"}}).toDestination(),e.polySynth=(new h.PolySynth).toDestination(),e}return _inherits(t,e),_createClass(t,[{key:"playNote",value:function(e,t){var n=t.hasOwnProperty("velocity")?t.velocity/o.MAX_MIDI_VELOCITY:void 0;if(t.isDrum)this.drumKit.playNote(t.pitch,e,n);else{var r=h.Frequency(t.pitch,"midi").toFrequency(),i=t.endTime-t.startTime;this.getSynth(t.instrument,t.program).triggerAttackRelease(r,i,e,n)}}},{key:"getSynth",value:function(e,t){return void 0!==t&&t>=32&&t<=39?this.bassSynth:this.polySynth}}])}(P);O.tone=h;var M,N=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h.Master,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,a=arguments.length>4?arguments[4]:void 0;return _classCallCheck(this,t),(n=_callSuper(this,t,[!1,a])).soundFont=new x(e),n.output=r,n.programOutputs=i,n.drumOutputs=o,n}return _inherits(t,e),_createClass(t,[{key:"loadSamples",value:(r=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.soundFont.loadSamples(t.notes.map((function(e){return{pitch:e.pitch,velocity:e.velocity,program:e.program||0,isDrum:e.isDrum||!1}})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"loadAllSamples",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t,n,r,i,a,s,u,c=arguments;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=c.length>0&&void 0!==c[0]?c[0]:0,n=c.length>1&&void 0!==c[1]&&c[1],r=v.a.create(),i=n?o.MIN_DRUM_PITCH:o.MIN_PIANO_PITCH,a=n?o.MAX_DRUM_PITCH:o.MAX_PIANO_PITCH,s=i;s<=a;s++)for(u=o.MIN_MIDI_VELOCITY;u<o.MAX_MIDI_VELOCITY;u++)r.notes.push({pitch:s,velocity:u,program:t,isDrum:n});return e.abrupt("return",this.loadSamples(r));case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"resumeContext",value:function(){h.context.resume()}},{key:"start",value:function(e,n){var r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.resumeContext(),this.loadSamples(e).then((function(){return _superPropGet(t,"start",r,3)([e,n,i])}))}},{key:"playNote",value:function(e,t){this.soundFont.playNote(t.pitch,t.velocity,e,t.endTime-t.startTime,t.program,t.isDrum,this.getAudioNodeOutput(t))}},{key:"playNoteDown",value:function(e){this.soundFont.playNoteDown(e.pitch,e.velocity,e.program,e.isDrum,this.getAudioNodeOutput(e))}},{key:"playNoteUp",value:function(e){this.soundFont.playNoteUp(e.pitch,e.velocity,e.program,e.isDrum,this.getAudioNodeOutput(e))}},{key:"getAudioNodeOutput",value:function(e){var t=this.output;return this.programOutputs&&!e.isDrum?this.programOutputs.has(e.program)&&(t=this.programOutputs.get(e.program)):this.drumOutputs&&e.isDrum&&this.drumOutputs.has(e.pitch)&&(t=this.drumOutputs.get(e.pitch)),t}}]);var n,r}(P),I=function(e){function t(e){return _classCallCheck(this,t),_callSuper(this,t,[!0,e])}return _inherits(t,e),_createClass(t)}(O),E=function(e){function t(e){var n;return _classCallCheck(this,t),(n=_callSuper(this,t,[!1,e])).outputs=[],n.outputChannel=0,n.availableOutputs=[],n.NOTE_ON=144,n.NOTE_OFF=128,n}return _inherits(t,e),_createClass(t,[{key:"requestMIDIAccess",value:(n=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",navigator.requestMIDIAccess?new Promise((function(e,n){navigator.requestMIDIAccess().then((function(n){n.addEventListener("statechange",(function(e){return t.initOutputs(n)})),e(t.initOutputs(n))}),(function(e){return console.log("Something went wrong",n(e))}))})):null);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"initOutputs",value:function(e){for(var t=e.outputs.values(),n=t.next();n&&!n.done;n=t.next())this.availableOutputs.push(n.value);return this.availableOutputs}},{key:"playNote",value:function(e,t){for(var n=t.velocity||100,r=1e3*(t.endTime-t.startTime),i=[this.NOTE_ON+this.outputChannel,t.pitch,n],o=[this.NOTE_OFF+this.outputChannel,t.pitch,n],a=this.outputs?this.outputs:this.availableOutputs,s=0;s<a.length;s++)this.sendMessageToOutput(a[s],i),this.sendMessageToOutput(a[s],o,m.d.now()+r)}},{key:"sendMessageToOutput",value:function(e,t,n){e&&e.send(t,n)}},{key:"playNoteDown",value:function(e){for(var t=[this.NOTE_ON,e.pitch,e.velocity],n=this.outputs?this.outputs:this.availableOutputs,r=0;r<n.length;r++)this.sendMessageToOutput(n[r],t)}},{key:"playNoteUp",value:function(e){for(var t=[this.NOTE_OFF,e.pitch,e.velocity],n=this.outputs?this.outputs:this.availableOutputs,r=0;r<n.length;r++)this.sendMessageToOutput(n[r],t,e.endTime-e.startTime)}}]);var n}(P),q=_createClass((function e(){_classCallCheck(this,e)})),D=function(){return _createClass((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;_classCallCheck(this,e),this.notes=[],this.midiInputs=[],this.loClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.hiClick=new h.MembraneSynth({pitchDecay:.008,envelope:{attack:.001,decay:.3,sustain:0}}).toDestination(),this.config={playClick:t.playClick,qpm:t.qpm||o.DEFAULT_QUARTERS_PER_MINUTE,playCountIn:t.playCountIn,startRecordingAtFirstNote:t.startRecordingAtFirstNote||!1},this.callbackObject=n,this.recording=!1,this.onNotes=new Map}),[{key:"initialize",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var t=this;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,navigator.requestMIDIAccess().then((function(e){return t.midiReady(e)}),(function(e){return console.log("Something went wrong",e)}));case 2:case"end":return e.stop()}}),e)}))),function(){return e.apply(this,arguments)})},{key:"midiReady",value:function(e){s.log("Initialized Recorder","Recorder");for(var t=e.inputs.values(),n=t.next();n&&!n.done;n=t.next())this.midiInputs.push(n.value)}},{key:"isRecording",value:function(){return this.recording}},{key:"setTempo",value:function(e){this.config.qpm=e,"started"===h.Transport.state&&(h.Transport.bpm.value=e)}},{key:"enablePlayClick",value:function(e){this.config.playClick=e}},{key:"enablePlayCountIn",value:function(e){this.config.playCountIn=e}},{key:"initClickLoop",value:function(){var e=this,t=0;this.clickLoop=new h.Loop((function(n){t%4==0?e.loClick.triggerAttack("G5",n):e.hiClick.triggerAttack("C6",n),t++,e.config.playCountIn&&4===t&&(h.Transport.stop(),e.clickLoop.stop())}),"4n")}},{key:"getMIDIInputs",value:function(){return this.midiInputs}},{key:"start",value:function(e){var t,n=this,r=_createForOfIteratorHelper(e||this.midiInputs);try{for(r.s();!(t=r.n()).done;){t.value.onmidimessage=function(e){n.midiMessageReceived(e)}}}catch(e){r.e(e)}finally{r.f()}if(this.config.playClick||this.config.playCountIn?(this.initClickLoop(),h.Transport.bpm.value=this.config.qpm,h.Transport.start(),this.clickLoop.start()):this.clickLoop=null,this.recording=!0,this.firstNoteTimestamp=void 0,this.notes=[],this.onNotes=new Map,!this.startRecordingAtFirstNote){var i=Date.now();this.firstNoteTimestamp=i}}},{key:"stop",value:function(){var e=this;this.recording=!1;var t=Date.now();this.onNotes.forEach((function(n,r){e.noteOff(r,t)}));var n,r=_createForOfIteratorHelper(this.midiInputs);try{for(r.s();!(n=r.n()).done;){n.value.onmidimessage=null}}catch(e){r.e(e)}finally{r.f()}return this.clickLoop&&(h.Transport.stop(),this.clickLoop.stop()),0===this.notes.length?null:this.getNoteSequence()}},{key:"getNoteSequence",value:function(){return 0===this.notes.length?null:v.a.create({notes:this.notes,totalTime:this.notes[this.notes.length-1].endTime})}},{key:"reset",value:function(){var e=this.stop();return this.firstNoteTimestamp=void 0,this.notes=[],this.onNotes=new Map,e}},{key:"midiMessageReceived",value:function(e){if(this.recording){var t=(void 0!==e.timeStamp&&0!==e.timeStamp?e.timeStamp:m.d.now())+m.d.timing.navigationStart;void 0===this.firstNoteTimestamp&&(this.firstNoteTimestamp=t);var n=e.data[0]>>4,r=e.data[1],i=e.data.length>2?e.data[2]:1,o=e.srcElement;8===n||9===n&&0===i?(this.callbackObject&&this.callbackObject.noteOff&&this.callbackObject.noteOff(r,i,o),this.noteOff(r,t),this.callbackObject&&this.callbackObject.run&&this.callbackObject.run(this.getNoteSequence())):9===n&&(this.callbackObject&&this.callbackObject.noteOn&&this.callbackObject.noteOn(r,i,o),this.noteOn(r,i,t))}}},{key:"noteOn",value:function(e,t,n){var r=new v.a.Note;r.pitch=e,r.startTime=(n-this.firstNoteTimestamp)/1e3,r.velocity=t,this.onNotes.set(e,r)}},{key:"noteOff",value:function(e,t){var n=this.onNotes.get(e);n&&(n.endTime=(t-this.firstNoteTimestamp)/1e3,this.notes.push(n)),this.onNotes.delete(e)}}]);var e}(),R=n(83),j=function(){return _createClass((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e);var r=l.isQuantizedSequence(t),i=t.tempos&&t.tempos.length>0?t.tempos[0].qpm:void 0;this.noteSequence=r?l.unquantizeSequence(t,i):t,this.config={noteHeight:n.noteHeight||6,noteSpacing:n.noteSpacing||1,pixelsPerTimeStep:n.pixelsPerTimeStep||30,noteRGB:n.noteRGB||"8, 41, 64",activeNoteRGB:n.activeNoteRGB||"240, 84, 119",minPitch:n.minPitch,maxPitch:n.maxPitch};var o=this.getSize();this.width=o.width,this.height=o.height}),[{key:"updateMinMaxPitches",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.config.minPitch||!this.config.maxPitch){void 0===this.config.minPitch&&(this.config.minPitch=o.MAX_MIDI_PITCH),void 0===this.config.maxPitch&&(this.config.maxPitch=o.MIN_MIDI_PITCH);var t,n=_createForOfIteratorHelper(this.noteSequence.notes);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.config.minPitch=Math.min(r.pitch,this.config.minPitch),this.config.maxPitch=Math.max(r.pitch,this.config.maxPitch)}}catch(e){n.e(e)}finally{n.f()}e||(this.config.minPitch-=2,this.config.maxPitch+=2)}}},{key:"getSize",value:function(){this.updateMinMaxPitches();var e=(this.config.maxPitch-this.config.minPitch)*this.config.noteHeight,t=this.noteSequence.totalTime;if(!t)throw new Error("The sequence you are using with the visualizer does not have a totalQuantizedSteps or totalTime field set, so the visualizer can't be horizontally sized correctly.");return{width:t*this.config.pixelsPerTimeStep,height:e}}},{key:"getNotePosition",value:function(e,t){var n=this.getNoteEndTime(e)-this.getNoteStartTime(e),r=this.getNoteStartTime(e)*this.config.pixelsPerTimeStep,i=Math.max(this.config.pixelsPerTimeStep*n-this.config.noteSpacing,1);return{x:r,y:this.height-(e.pitch-this.config.minPitch)*this.config.noteHeight,w:i,h:this.config.noteHeight}}},{key:"scrollIntoViewIfNeeded",value:function(e,t){if(e&&this.parentElement){var n=this.parentElement.getBoundingClientRect().width;t>this.parentElement.scrollLeft+n&&(this.parentElement.scrollLeft=t-20)}}},{key:"getNoteStartTime",value:function(e){return Math.round(1e8*e.startTime)/1e8}},{key:"getNoteEndTime",value:function(e){return Math.round(1e8*e.endTime)/1e8}},{key:"isPaintingActiveNote",value:function(e,t){var n=this.getNoteStartTime(e)===this.getNoteStartTime(t),r=this.getNoteStartTime(e)<=this.getNoteStartTime(t)&&this.getNoteEndTime(e)>=this.getNoteEndTime(t);return n||r}}])}(),z=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};_classCallCheck(this,t),(r=_callSuper(this,t,[e,i])).ctx=n.getContext("2d"),r.parentElement=n.parentElement;var o=window.devicePixelRatio||1;return r.ctx&&(r.ctx.canvas.width=o*r.width,r.ctx.canvas.height=o*r.height,n.style.width=r.width+"px",n.style.height=r.height+"px",r.ctx.scale(o,o)),r.redraw(),r}return _inherits(t,e),_createClass(t,[{key:"redraw",value:function(e,t){var n;this.clear();for(var r=0;r<this.noteSequence.notes.length;r++){var i=this.noteSequence.notes[r],o=this.getNotePosition(i,r),a=i.velocity?i.velocity/100+.2:1,s=e&&this.isPaintingActiveNote(i,e),u="rgba(".concat(s?this.config.activeNoteRGB:this.config.noteRGB,",\n  ").concat(a,")");this.redrawNote(o.x,o.y,o.w,o.h,u),s&&i===e&&(n=o.x)}return this.scrollIntoViewIfNeeded(t,n),n}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"clearActiveNotes",value:function(){this.redraw()}},{key:"redrawNote",value:function(e,t,n,r,i){this.ctx.fillStyle=i,this.ctx.fillRect(Math.round(e),Math.round(t),Math.round(n),Math.round(r))}}])}(j),F=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,t),r=_callSuper(this,t,[e,n,i]),s.log("mm.Visualizer is deprecated, and will be removed in a future          version. Please use mm.PianoRollCanvasVisualizer instead","mm.Visualizer",5),r}return _inherits(t,e),_createClass(t)}(z),L=function(e){function t(e){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return _classCallCheck(this,t),(n=_callSuper(this,t,[e,r])).drawn=!1,n}return _inherits(t,e),_createClass(t,[{key:"redraw",value:function(e,t){if(this.drawn||this.draw(),!e)return null;var n;this.unfillActiveRect(this.svg);for(var r=0;r<this.noteSequence.notes.length;r++){var i=this.noteSequence.notes[r];if(e&&this.isPaintingActiveNote(i,e)){var o=this.svg.querySelector('rect[data-index="'.concat(r,'"]'));this.fillActiveRect(o,i),i===e&&(n=parseFloat(o.getAttribute("x")))}}return this.scrollIntoViewIfNeeded(t,n),n}},{key:"fillActiveRect",value:function(e,t){e.setAttribute("fill",this.getNoteFillColor(t,!0)),e.classList.add("active")}},{key:"unfillActiveRect",value:function(e){for(var t=e.querySelectorAll("rect.active"),n=0;n<t.length;++n){var r=t[n],i=this.getNoteFillColor(this.noteSequence.notes[parseInt(r.getAttribute("data-index"),10)],!1);r.setAttribute("fill",i),r.classList.remove("active")}}},{key:"draw",value:function(){for(var e=0;e<this.noteSequence.notes.length;e++){var t=this.noteSequence.notes[e],n=this.getNotePosition(t,e),r=this.getNoteFillColor(t,!1),i=[["index",e],["instrument",t.instrument],["program",t.program],["isDrum",!0===t.isDrum],["pitch",t.pitch]],o=[["--midi-velocity",String(void 0!==t.velocity?t.velocity:127)]];this.drawNote(n.x,n.y,n.w,n.h,r,i,o)}this.drawn=!0}},{key:"getNoteFillColor",value:function(e,t){var n=e.velocity?e.velocity/100+.2:1;return"rgba(".concat(t?this.config.activeNoteRGB:this.config.noteRGB,",\n  ").concat(n,")")}},{key:"drawNote",value:function(e,t,n,r,i,o,a){if(this.svg){var s=document.createElementNS("http://www.w3.org/2000/svg","rect");s.classList.add("note"),s.setAttribute("fill",i),s.setAttribute("x",""+Math.round(e)),s.setAttribute("y",""+Math.round(t)),s.setAttribute("width",""+Math.round(n)),s.setAttribute("height",""+Math.round(r)),o.forEach((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];void 0!==r&&(s.dataset[n]=""+r)})),a.forEach((function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];s.style.setProperty(n,r)})),this.svg.appendChild(s)}}},{key:"clear",value:function(){this.svg.innerHTML="",this.drawn=!1}},{key:"clearActiveNotes",value:function(){this.unfillActiveRect(this.svg)}}])}(j),V=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_classCallCheck(this,t),r=_callSuper(this,t,[e,i]),!(n instanceof SVGSVGElement))throw new Error("This visualizer requires an <svg> element to display the visualization");r.svg=n,r.parentElement=n.parentElement;var o=r.getSize();return r.width=o.width,r.height=o.height,r.svg.style.width=r.width+"px",r.svg.style.height=r.height+"px",r.clear(),r.draw(),r}return _inherits(t,e),_createClass(t)}(L),G=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(_classCallCheck(this,t),(r=_callSuper(this,t,[e,i])).NOTES_PER_OCTAVE=12,r.WHITE_NOTES_PER_OCTAVE=7,r.LOW_C=24,r.firstDrawnOctave=0,r.lastDrawnOctave=6,!(n instanceof HTMLDivElement))throw new Error("This visualizer requires a <div> element to display the visualization");r.config.whiteNoteWidth=i.whiteNoteWidth||20,r.config.blackNoteWidth=i.blackNoteWidth||2*r.config.whiteNoteWidth/3,r.config.whiteNoteHeight=i.whiteNoteHeight||70,r.config.blackNoteHeight=i.blackNoteHeight||140/3,r.config.showOnlyOctavesUsed=i.showOnlyOctavesUsed,r.setupDOM(n);var o=r.getSize();return r.width=o.width,r.height=o.height,r.svg.style.width=r.width+"px",r.svg.style.height=r.height+"px",r.svgPiano.style.width=r.width+"px",r.svgPiano.style.height=r.config.whiteNoteHeight+"px",r.parentElement.style.width=r.width+r.config.whiteNoteWidth+"px",r.parentElement.scrollTop=r.parentElement.scrollHeight,r.clear(),r.drawPiano(),r.draw(),r}return _inherits(t,e),_createClass(t,[{key:"setupDOM",value:function(e){this.parentElement=document.createElement("div"),this.parentElement.classList.add("waterfall-notes-container");var t=Math.max(e.getBoundingClientRect().height,200);this.parentElement.style.paddingTop=t-this.config.whiteNoteHeight+"px",this.parentElement.style.height=t-this.config.whiteNoteHeight+"px",this.parentElement.style.boxSizing="border-box",this.parentElement.style.overflowX="hidden",this.parentElement.style.overflowY="auto",this.svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgPiano=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.svg.classList.add("waterfall-notes"),this.svgPiano.classList.add("waterfall-piano"),this.parentElement.appendChild(this.svg),e.innerHTML="",e.appendChild(this.parentElement),e.appendChild(this.svgPiano)}},{key:"redraw",value:function(e,t){if(this.drawn||this.draw(),!e)return null;this.clearActiveNotes(),this.parentElement.style.paddingTop=this.parentElement.style.height;for(var n=0;n<this.noteSequence.notes.length;n++){var r=this.noteSequence.notes[n];if(e&&this.isPaintingActiveNote(r,e)){var i=this.svg.querySelector('rect[data-index="'.concat(n,'"]'));this.fillActiveRect(i,r);var o=this.svgPiano.querySelector('rect[data-pitch="'.concat(r.pitch,'"]'));if(this.fillActiveRect(o,r),r===e){var a=parseFloat(i.getAttribute("y")),s=parseFloat(i.getAttribute("height"));return a<this.parentElement.scrollTop-s&&(this.parentElement.scrollTop=a+s),a}}}return null}},{key:"getSize",value:function(){this.updateMinMaxPitches(!0);var e=52;if(this.config.showOnlyOctavesUsed){for(var t=!1,n=!1,r=1;r<7;r++){var i=this.LOW_C+this.NOTES_PER_OCTAVE*r;!t&&i>this.config.minPitch&&(this.firstDrawnOctave=r-1,t=!0),!n&&i>this.config.maxPitch&&(this.lastDrawnOctave=r-1,n=!0)}e=(this.lastDrawnOctave-this.firstDrawnOctave+1)*this.WHITE_NOTES_PER_OCTAVE}var o=e*this.config.whiteNoteWidth,a=this.noteSequence.totalTime;if(!a)throw new Error("The sequence you are using with the visualizer does not have a totalQuantizedSteps or totalTime field set, so the visualizer can't be horizontally sized correctly.");return{width:o,height:Math.max(a*this.config.pixelsPerTimeStep,1)}}},{key:"getNotePosition",value:function(e,t){var n=this.svgPiano.querySelector('rect[data-pitch="'.concat(e.pitch,'"]'));if(!n)return null;var r=this.getNoteEndTime(e)-this.getNoteStartTime(e),i=Number(n.getAttribute("x")),o=Number(n.getAttribute("width")),a=Math.max(this.config.pixelsPerTimeStep*r-this.config.noteSpacing,1);return{x:i,y:this.height-this.getNoteStartTime(e)*this.config.pixelsPerTimeStep-a,w:o,h:a}}},{key:"drawPiano",value:function(){this.svgPiano.innerHTML="";var e=this.config.whiteNoteWidth-this.config.blackNoteWidth/2,t=[1,3,6,8,10],n=0,r=0;this.config.showOnlyOctavesUsed?r=this.firstDrawnOctave*this.NOTES_PER_OCTAVE+this.LOW_C:(r=this.LOW_C-3,this.drawWhiteKey(r,n),this.drawWhiteKey(r+2,this.config.whiteNoteWidth),r+=3,n=2*this.config.whiteNoteWidth);for(var i=this.firstDrawnOctave;i<=this.lastDrawnOctave;i++)for(var o=0;o<this.NOTES_PER_OCTAVE;o++)-1===t.indexOf(o)&&(this.drawWhiteKey(r,n),n+=this.config.whiteNoteWidth),r++;this.config.showOnlyOctavesUsed?(r=this.firstDrawnOctave*this.NOTES_PER_OCTAVE+this.LOW_C,n=-this.config.whiteNoteWidth):(this.drawWhiteKey(r,n),r=this.LOW_C-3,this.drawBlackKey(r+1,e),r+=3,n=this.config.whiteNoteWidth);for(var a=this.firstDrawnOctave;a<=this.lastDrawnOctave;a++)for(var s=0;s<this.NOTES_PER_OCTAVE;s++)-1!==t.indexOf(s)?this.drawBlackKey(r,n+e):n+=this.config.whiteNoteWidth,r++}},{key:"drawWhiteKey",value:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","rect");return n.dataset.pitch=String(e),n.setAttribute("x",String(t)),n.setAttribute("y","0"),n.setAttribute("width",String(this.config.whiteNoteWidth)),n.setAttribute("height",String(this.config.whiteNoteHeight)),n.setAttribute("fill","white"),n.setAttribute("original-fill","white"),n.setAttribute("stroke","black"),n.setAttribute("stroke-width","3px"),n.classList.add("white"),this.svgPiano.appendChild(n),n}},{key:"drawBlackKey",value:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","rect");return n.dataset.pitch=String(e),n.setAttribute("x",String(t)),n.setAttribute("y","0"),n.setAttribute("width",String(this.config.blackNoteWidth)),n.setAttribute("height",String(this.config.blackNoteHeight)),n.setAttribute("fill","black"),n.setAttribute("original-fill","black"),n.setAttribute("stroke","black"),n.setAttribute("stroke-width","3px"),n.classList.add("black"),this.svgPiano.appendChild(n),n}},{key:"clearActiveNotes",value:function(){_superPropGet(t,"unfillActiveRect",this,3)([this.svg]);for(var e=this.svgPiano.querySelectorAll("rect.active"),n=0;n<e.length;++n){var r=e[n];r.setAttribute("fill",r.getAttribute("original-fill")),r.classList.remove("active")}}}])}(L);!function(e){e[e.PAGE=0]="PAGE",e[e.NOTE=1]="NOTE",e[e.BAR=2]="BAR"}(M||(M={}));var B=function(e){function t(e,n){var r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,t),r=_callSuper(this,t,[e,i]),(void 0===i.pixelsPerTimeStep||i.pixelsPerTimeStep<=0)&&(r.config.pixelsPerTimeStep=0),r.instruments=i.instruments||[],r.render=new R.StaffSVGRender(r.getScoreInfo(e),{noteHeight:r.config.noteHeight,noteSpacing:r.config.noteSpacing,pixelsPerTimeStep:r.config.pixelsPerTimeStep,noteRGB:r.config.noteRGB,activeNoteRGB:r.config.activeNoteRGB,defaultKey:i.defaultKey||0,scrollType:i.scrollType||M.PAGE},n),r.drawnNotes=e.notes.length,r.clear(),r.redraw(),r}return _inherits(t,e),_createClass(t,[{key:"clear",value:function(){this.render.clear()}},{key:"redraw",value:function(e,t){this.drawnNotes!==this.noteSequence.notes.length&&(this.render.scoreInfo=this.getScoreInfo(this.noteSequence));var n=e?this.getNoteInfo(e):void 0;return this.render.redraw(n,t)}},{key:"isNoteInInstruments",value:function(e){return void 0===e.instrument||0===this.instruments.length||this.instruments.indexOf(e.instrument)>=0}},{key:"timeToQuarters",value:function(e){var t=e*this.noteSequence.tempos[0].qpm/60;return Math.round(16*t)/16}},{key:"getNoteInfo",value:function(e){var t=this.timeToQuarters(e.startTime);return{start:t,length:this.timeToQuarters(e.endTime)-t,pitch:e.pitch,intensity:e.velocity}}},{key:"getScoreInfo",value:function(e){var t=this,n=[];return e.notes.forEach((function(e){t.isNoteInInstruments(e)&&n.push(t.getNoteInfo(e))})),{notes:n,tempos:e.tempos?e.tempos.map((function(e){return{start:t.timeToQuarters(e.time),qpm:e.qpm}})):[],keySignatures:e.keySignatures?e.keySignatures.map((function(e){return{start:t.timeToQuarters(e.time),key:e.key}})):[],timeSignatures:e.timeSignatures?e.timeSignatures.map((function(e){return{start:t.timeToQuarters(e.time),numerator:e.numerator,denominator:e.denominator}})):[]}}},{key:"clearActiveNotes",value:function(){this.redraw()}}])}(j)},,,,,,function(e,t,n){t.parseMidi=n(172),t.writeMidi=n(173)},function(e,t,n){function r(e,t,n){void 0===n&&(n="ticks");var r=0,i=e.length,o=i;if(i>0&&e[i-1][n]<=t)return i-1;for(;r<o;){var a=Math.floor(r+(o-r)/2),s=e[a],u=e[a+1];if(s[n]===t){for(var c=a;c<e.length;c++)e[c][n]===t&&(a=c);return a}if(s[n]<t&&u[n]>t)return a;s[n]>t?o=a:s[n]<t&&(r=a+1)}return-1}Object.defineProperty(t,"__esModule",{value:!0}),t.search=r,t.insert=function(e,t,n){if(void 0===n&&(n="ticks"),e.length){var i=r(e,t[n],n);e.splice(i+1,0,t)}else e.push(t)}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(80),i=n(82),o=n(176),a=n(177),s=n(178),u=n(180),c=new WeakMap,l=function(){function e(e,t){var n=this;if(this.name="",this.notes=[],this.controlChanges=o.createControlChanges(),this.pitchBends=[],c.set(this,t),e){var r=e.find((function(e){return"trackName"===e.type}));this.name=r?r.text:""}if(this.instrument=new s.Instrument(e,this),this.channel=0,e){for(var i=e.filter((function(e){return"noteOn"===e.type})),a=e.filter((function(e){return"noteOff"===e.type})),u=function(){var e=i.shift();l.channel=e.channel;var t=a.findIndex((function(t){return t.noteNumber===e.noteNumber&&t.absoluteTime>=e.absoluteTime}));if(-1!==t){var n=a.splice(t,1)[0];l.addNote({durationTicks:n.absoluteTime-e.absoluteTime,midi:e.noteNumber,noteOffVelocity:n.velocity/127,ticks:e.absoluteTime,velocity:e.velocity/127})}},l=this;i.length;)u();e.filter((function(e){return"controller"===e.type})).forEach((function(e){n.addCC({number:e.controllerType,ticks:e.absoluteTime,value:e.value/127})})),e.filter((function(e){return"pitchBend"===e.type})).forEach((function(e){n.addPitchBend({ticks:e.absoluteTime,value:e.value/Math.pow(2,13)})}))}}return e.prototype.addNote=function(e){var t=c.get(this),n=new u.Note({midi:0,ticks:0,velocity:1},{ticks:0,velocity:0},t);return Object.assign(n,e),r.insert(this.notes,n,"ticks"),this},e.prototype.addCC=function(e){var t=c.get(this),n=new i.ControlChange({controllerType:e.number},t);return delete e.number,Object.assign(n,e),Array.isArray(this.controlChanges[n.number])||(this.controlChanges[n.number]=[]),r.insert(this.controlChanges[n.number],n,"ticks"),this},e.prototype.addPitchBend=function(e){var t=c.get(this),n=new a.PitchBend({},t);return Object.assign(n,e),r.insert(this.pitchBends,n,"ticks"),this},Object.defineProperty(e.prototype,"duration",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].time+this.notes[this.notes.length-1].duration,t=0;t<this.notes.length-1;t++){var n=this.notes[t].time+this.notes[t].duration;e<n&&(e=n)}return e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"durationTicks",{get:function(){if(!this.notes.length)return 0;for(var e=this.notes[this.notes.length-1].ticks+this.notes[this.notes.length-1].durationTicks,t=0;t<this.notes.length-1;t++){var n=this.notes[t].ticks+this.notes[t].durationTicks;e<n&&(e=n)}return e},enumerable:!0,configurable:!0}),e.prototype.fromJSON=function(e){var t=this;for(var n in this.name=e.name,this.channel=e.channel,this.instrument=new s.Instrument(void 0,this),this.instrument.fromJSON(e.instrument),e.controlChanges)e.controlChanges[n]&&e.controlChanges[n].forEach((function(e){t.addCC({number:e.number,ticks:e.ticks,value:e.value})}));e.notes.forEach((function(e){t.addNote({durationTicks:e.durationTicks,midi:e.midi,ticks:e.ticks,velocity:e.velocity})}))},e.prototype.toJSON=function(){for(var e={},t=0;t<127;t++)this.controlChanges.hasOwnProperty(t)&&(e[t]=this.controlChanges[t].map((function(e){return e.toJSON()})));return{channel:this.channel,controlChanges:e,pitchBends:this.pitchBends.map((function(e){return e.toJSON()})),instrument:this.instrument.toJSON(),name:this.name,notes:this.notes.map((function(e){return e.toJSON()}))}},e}();t.Track=l},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.controlChangeNames={1:"modulationWheel",2:"breath",4:"footController",5:"portamentoTime",7:"volume",8:"balance",10:"pan",64:"sustain",65:"portamentoTime",66:"sostenuto",67:"softPedal",68:"legatoFootswitch",84:"portamentoControl"},t.controlChangeIds=Object.keys(t.controlChangeNames).reduce((function(e,n){return e[t.controlChangeNames[n]]=n,e}),{});var r=new WeakMap,i=new WeakMap,o=function(){function e(e,t){r.set(this,t),i.set(this,e.controllerType),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"number",{get:function(){return i.get(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return t.controlChangeNames[this.number]?t.controlChangeNames[this.number]:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return r.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=r.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{number:this.number,ticks:this.ticks,time:this.time,value:this.value}},e}();t.ControlChange=o},function(e,t,n){self,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==_typeof(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=4)}([function(e,t,n){n.r(t),n.d(t,"SVGNS",(function(){return r})),n.d(t,"drawSVGPath",(function(){return i})),n.d(t,"drawSVGText",(function(){return o})),n.d(t,"createSVGGroupChild",(function(){return a})),n.d(t,"setFade",(function(){return s}));var r="http://www.w3.org/2000/svg";function i(e,t,n,i,o,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=document.createElementNS(r,"path");return u.setAttributeNS(null,"d",t),u.setAttributeNS(null,"transform","translate(".concat(n,", ").concat(i,") scale(").concat(o,", ").concat(a,")")),u.setAttributeNS(null,"opacity",""+s),e.appendChild(u),u}function o(e,t,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1,c=document.createElementNS(r,"text");c.setAttributeNS(null,"font-family","Times"),c.setAttributeNS(null,"font-size",o),a&&c.setAttributeNS(null,"font-weight","bold"),c.setAttributeNS(null,"transform","translate(".concat(n,", ").concat(i,") scale(").concat(s,", ").concat(u,")"));var l=document.createTextNode(t);return c.appendChild(l),e.appendChild(c),c}function a(e,t){var n=document.createElementNS(r,"g");return n.setAttribute("data-id",t),e.appendChild(n),n}function s(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=e.querySelector("animate");if(!o){(o=document.createElementNS(r,"animate")).setAttributeNS(null,"attributeName","opacity"),o.setAttributeNS(null,"dur","4s"),o.setAttributeNS(null,"fill","freeze"),o.setAttributeNS(null,"keyTimes","0; 0.25; 0.5; 0.75; 1");var a=(n+3*i)/4;o.setAttributeNS(null,"values","".concat(n,"; ").concat(a,"; ").concat(i,"; ").concat(a,"; ").concat(n))}return t?o.setAttributeNS(null,"repeatCount","indefinite"):o.setAttributeNS(null,"repeatCount","1"),e.appendChild(o),e}},function(e,t,n){n.r(t),n.d(t,"PATH_SCALE",(function(){return r})),n.d(t,"staffLinePath",(function(){return o})),n.d(t,"extraLinePath",(function(){return a})),n.d(t,"barPath",(function(){return s})),n.d(t,"stemPath",(function(){return u})),n.d(t,"singleFlagPath",(function(){return c})),n.d(t,"multiFlagPath",(function(){return l})),n.d(t,"tiePath",(function(){return h})),n.d(t,"dotPath",(function(){return f})),n.d(t,"NOTE_PATHS",(function(){return p})),n.d(t,"REST_PATHS",(function(){return d})),n.d(t,"CLEF_PATHS",(function(){return m})),n.d(t,"ACCIDENTAL_PATHS",(function(){return v}));var r=100,i="M 0,10 C 0,-15 35,-50 80,-50 110,-50 125,-35 125,-10 \n125,15 90,50 45,50 15,50 0,35 0,10 Z",o="m 0,0 h 100",a="m -25,0 h 175",s="m 0,-200 v 400",u="m 0,0 v 100 h 15 v -100 z",c="M0,0 h 12 c 7,100 175,156 62,314 79,-177 -49,\n-193 -61,-200 l -13,-5 z",l="m 0,0 h 10 c 6,72 173,64 84,227 44,-120 -44,\n-123 -94,-167 z",h="M 0,25 C 10,46 30,67 50,67 69,67 90,47 100,25 94,\n65 73,89 50,89 26,89 5,63 0,25 Z",f="M 5 -20 a 20 20 0 1 0 0.00001 0 z",p={4:{path:"m 0,0 c 0,-37 49,-51 79,-51 31,0 83,13 83,51 0,39 \n-55,51 -84,51 C 49,51 0,37 0,0 Z m 111,31 c 13,-19 0,-58 -22,-68 -33,-15 \n-53,10 -39,49 9,27 48,39 61,19 z",width:150,stemVSteps:0,stemAnchor:0,flags:0},2:{path:"m 0,10 c 0,-25 35,-60 80,-60 15,0 45,4 45,40 C 125,16 \n89,50 45,50 17,50 0,36 0,10 Z m 71,7 c 17,-11 45,-34 38,-45 -7,-10 -39,1 \n-57,12 -19,11 -42,31 -36,42 6,10 37,2 55,-9 z",width:125,stemVSteps:7,stemAnchor:-10,flags:0},1:{path:i,width:125,stemVSteps:7,stemAnchor:-10,flags:0},.5:{path:i,width:125,stemVSteps:7,stemAnchor:-10,flags:1},.25:{path:i,width:125,stemVSteps:9,stemAnchor:-10,flags:2},.125:{path:i,width:125,stemVSteps:11,stemAnchor:-10,flags:3},.0625:{path:i,width:125,stemVSteps:13,stemAnchor:-10,flags:4}},d={4:"m 0,-50 h 125 v -50 H 0 Z",2:"M 0,0 H 125 V -50 H 0 Z",1:"m 0,-25 c 39,-39 37,-75 8,-120 l 6,-5 61,103 C \n40,-13 31,4 73,71 l -5,5 C 14,52 16,125 67,144 l -4,6 C -37,102 -1,22 59,60 Z",.5:"m 52,-47 c 26,-2 42,-21 48,-42 l 12,4 L 64,83 52,79 \n88,-49 c 0,0 -17,22 -57,22 -16,0 -31,-13 -31,-27 0,-18 10,-31 27,-31 17,0 \n33,15 25,38 z",.25:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 l -36,128 12,4 77,-270 z",.125:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 L 68,20 C 61,37 46,51 24,52 32,29 16,14 -1,14 c \n-17,0 -27,13 -27,31 0,14 15,27 31,27 38,0 55,-20 57,-22 l -36,128 12,4 \n105,-369 z",.0625:"m 158,-292 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -17,61 \nv 0 c -6,21 -22,40 -48,42 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 \n15,27 31,27 40,0 57,-22 57,-22 l -20,69 c -7,18 -22,33 -45,35 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 L 68,20 C \n61,37 46,51 24,52 32,29 16,14 -1,14 c -17,0 -27,13 -27,31 0,14 15,27 31,27 \n38,0 55,-20 57,-22 l -36,128 12,4 134,-469 z"},m={50:{path:"m 101,-199 c -49,0 -100,28 -100,83 0,39 58,57 82,26 15,-20 \n-4,-47 -32,-47 -23,1 -25,0 -25,-8 0,-22 40,-46 71,-41 91,16 67,208 -105,302 \n75,-27 198,-94 211,-201 6,-66 -42,-114 -102,-114 z m 143,33 c -13,0 -23,11 \n-23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 z m 2,83 c \n-13,0 -23,11 -23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 \nz",upper:-4,lower:3},71:{path:"M 139,48 C 102,57 76,120 131,151 41,128 64,24 129,2 L \n117,-57 C -32,47 26,217 166,182 Z m 12,-1 27,131 C 242,153 216,46 151,47 \nZ m -35,-177 c 34,-23 82,-117 50,-140 -23,-17 -71,33 -50,140 z m -10,10 c \n-23,-77 -20,-200 48,-213 19,-4 89,171 -26,266 l 13,66 c 120,-6 137,155 \n39,191 l 12,58 c 30,131 -137,145 -138,47 0,-29 37,-59 63,-37 21,18 25,71 \n-25,70 32,42 103,0 91,-65 L 167,193 C 56,232 -112,63 106,-120 Z",upper:-7,lower:8}},v=[null,"m -49,-121 v 52 l -29,9 v -48 h -8 v 51 l -20,6 v 29 l \n20,-6 v 70 l -20,6 v 30 l 20,-6 v 51 h 8 V 69 l 30,-8 v 50 h 8 V 58 l 20,-6 \nV 23 l -20,6 v -71 l 20,-6 v -29 l -20,6 v -50 z m 1,82 v 71 l -29,9 v -71 z","M -106,-166 V 67 c 52,-42 85,-56 85,-94 0,-47 -46,-51 \n-73,-22 v -117 z m 31,120 c 20,0 42,46 -20,91 V -7 c 0,-28 10,-39 20,-39 z","m -81,-58 v -48 H -92 V 73 l 60,-13 v 50 h 11 V -72 Z m \n50,24 v 58 l -50,11 v -58 z"]},function(e,t,n){n.r(t),n.d(t,"MIN_RESOLUTION",(function(){return r})),n.d(t,"STEM_WIDTH",(function(){return i})),n.d(t,"LINE_STROKE",(function(){return o})),n.d(t,"COMPACT_SPACING",(function(){return a}));var r=.0625,i=15,o=1,a=150},function(e,t,n){n.r(t),n.d(t,"MAX_QUARTER_DIVISION",(function(){return c})),n.d(t,"ScrollType",(function(){return r})),n.d(t,"StaffSVGRender",(function(){return l}));var r,i=n(2),o=n(0),a=n(1),s=[{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,0,1,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,0,3,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,2,0,0,2,0,2,0,0,3]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-7],accidental:[3,0,3,0,3,0,0,3,0,3,0,0]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,2,0,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,3,0,0]}],u=[{accidental:1,pitches:[]},{accidental:2,pitches:[70,75,68,73,66]},{accidental:1,pitches:[78,73]},{accidental:2,pitches:[70,75,68]},{accidental:1,pitches:[78,73,80,75]},{accidental:2,pitches:[70]},{accidental:2,pitches:[70,75,68,73,66,71]},{accidental:1,pitches:[78]},{accidental:2,pitches:[70,75,68,73]},{accidental:1,pitches:[78,73,80]},{accidental:2,pitches:[70,75]},{accidental:1,pitches:[78,73,80,75,70]}],c=16;!function(e){e[e.PAGE=0]="PAGE",e[e.NOTE=1]="NOTE",e[e.BAR=2]="BAR"}(r||(r={}));var l=function(){return _createClass((function e(t,n,o){var s=this;_classCallCheck(this,e),this.handleScrollEvent=function(e){s.lastKnownScrollLeft=s.parentElement.scrollLeft,s.ticking||window.requestAnimationFrame((function(){s.changeAndDrawSignaturesIfNeeded(s.lastKnownScrollLeft),s.ticking=!1})),s.ticking=!0},this.scoreInfo=t,this.config={noteHeight:n.noteHeight||6,noteSpacing:n.noteSpacing||1,pixelsPerTimeStep:n.pixelsPerTimeStep||30,noteRGB:n.noteRGB||"8, 41, 64",activeNoteRGB:n.activeNoteRGB||"240, 84, 119"},this.div=o,this.timeSignatureNumerator=4,this.timeSignatureDenominator=4,this.key=n.defaultKey||0,this.scrollType=n.scrollType||r.PAGE,this.scale=this.config.noteHeight/a.PATH_SCALE,(void 0===n.pixelsPerTimeStep||n.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0,this.config.noteSpacing=i.COMPACT_SPACING*this.scale),this.clear(),this.redraw()}),[{key:"clear",value:function(){for(;this.div.lastChild;)this.div.removeChild(this.div.lastChild);this.div.style.overflow="visible",this.div.style.position="relative",this.overlaySVG=document.createElementNS(o.SVGNS,"svg"),this.overlaySVG.style.position="absolute",this.div.appendChild(this.overlaySVG),this.overlayG=Object(o.createSVGGroupChild)(this.overlaySVG,"overlay"),this.signaturesBlinking=!1,this.signaturesQuarters=0,this.parentElement=document.createElement("div"),this.parentElement.style.overflow="auto",this.div.appendChild(this.parentElement),this.ticking=!1,this.lastKnownScrollLeft=0,this.parentElement.addEventListener("scroll",this.handleScrollEvent),this.staffSVG=document.createElementNS(o.SVGNS,"svg"),this.parentElement.appendChild(this.staffSVG),this.staffG=Object(o.createSVGGroupChild)(this.staffSVG,"staff"),this.linesG=Object(o.createSVGGroupChild)(this.staffSVG,"lines"),this.setStroke(this.linesG),this.staffG.appendChild(this.linesG),this.musicG=Object(o.createSVGGroupChild)(this.staffSVG,"music"),this.setFill(this.musicG),this.setStroke(this.musicG,0),this.staffG.appendChild(this.musicG),this.signaturesG=Object(o.createSVGGroupChild)(this.staffSVG,"signatures"),this.staffG.appendChild(this.signaturesG);var e=0,t=0;this.scoreInfo.notes.forEach((function(n){e+=n.pitch,++t}));var n=e/t;this.clef=n<60?50:71,this.signaturesList=[{x:0,q:0}],this.signatureCurrent=0,this.signatureNext=0,this.changeKeySignatureIfNeeded(0),this.changeTimeSignatureIfNeeded(0),this.vStepSize=this.config.noteHeight/2,this.hStepSize=this.config.pixelsPerTimeStep,this.staffOffset=0,this.height=0,this.width=0,this.musicBlockMap=new Map,this.playingNotes=[],this.lastBar=0,this.barAccidentals={},this.lastQ=-1}},{key:"isPaintingActiveNote",value:function(e,t){var n=e.start===t.start,r=e.start<=t.start&&e.start+e.length>=t.start+t.length;return n||r}},{key:"redraw",value:function(e,t){var n=this,i=-1,a=0===this.config.pixelsPerTimeStep;if(e){var s=[];this.playingNotes.forEach((function(t){n.isPaintingActiveNote(t,e)?s.push(t):n.highlightElement(n.getGroup(t),!1)})),this.playingNotes=s;var u=this.getGroup(e);if(u){this.playingNotes.push(e),this.highlightElement(u,!0),i=u.getBoundingClientRect().left-this.staffSVG.getBoundingClientRect().left;var c=e.start,l=u.getAttribute("data-is-bar-beginning");(this.scrollType!==r.BAR||l)&&this.scrollIntoViewIfNeeded(t,i),!a&&this.signaturesBlinking&&c>=this.signaturesQuarters&&(this.signaturesBlinking=!1,Object(o.setFade)(this.overlayG,this.signaturesBlinking))}}else{this.setDetails();var h=-1===this.lastQ,f=0,p=0;h?(p=this.drawSignatures(this.overlayG,f,!0,!0,!0),a&&(this.width=0,p+=this.config.noteSpacing),p+=this.drawRests(this.initialRest,f+p)):f=this.width,this.musicBlockMap.forEach((function(e,t){a||(f=n.quartersToTime(t)*n.hStepSize),t>n.lastQ?(p+=n.drawMusicBlock(e,f+p),n.lastQ=t):t===n.lastQ&&(p+=n.drawRests(e,f+p))}));var d=this.staffSVG.getBoundingClientRect(),m=this.musicG.getBoundingClientRect();if(this.updateVerticalBoundaries(m.top-d.top,m.bottom-d.top),a)this.width+=p;else{var v=this.musicBlockMap.get(this.lastQ),g=this.quartersToTime(this.lastQ+v.notes[0].length);this.width=g*this.config.pixelsPerTimeStep}this.staffSVG.setAttributeNS(null,"width",""+this.width),this.redrawStaff(this.linesG,0,this.width)}return i}},{key:"drawMusicBlock",value:function(e,t){var n=this,r=e.notes[0].start,s=this.drawBarIfNeeded(r,t);s+=this.drawSignaturesIfNeeded(r,t+s);for(var u=0,c=4;c>=i.MIN_RESOLUTION&&!u;c/=2)c<=e.notes[0].length&&(u=c);if(0===u){var l=0===e.notes[0].length?"[infinite]":""+4/e.notes[0].length;console.warn(" StaffRender ","background:orange; color:white","StaffRender does not handle notes shorther than 1/".concat(4/i.MIN_RESOLUTION,"th, and this score tries to draw a 1/").concat(l,"th. Shortest possible note will be drawn instead.")),u=i.MIN_RESOLUTION}var h,f=a.NOTE_PATHS[u];if(f.stemAnchor&&(h=Object(o.createSVGGroupChild)(this.musicG,"stem")),e.notes.forEach((function(r){for(var i=r.vSteps*n.vStepSize,c=2*(r.vSteps>0?Math.floor(r.vSteps/2):Math.ceil(r.vSteps/2)),l=r.vSteps>0?-2:2,h=c;Math.abs(h)>4;h+=l)Object(o.drawSVGPath)(n.linesG,a.extraLinePath,t+s,h*n.vStepSize,n.scale,1);if(r.g=r.tiedFrom?r.tiedFrom.g:Object(o.createSVGGroupChild)(n.musicG,"".concat(r.start,"-").concat(r.pitch)),e.isBarBeginning&&r.g.setAttribute("data-is-bar-beginning","true"),r.tiedFrom){var p=t+s-r.tiedFrom.xHeadRight;Object(o.drawSVGPath)(r.g,a.tiePath,r.tiedFrom.xHeadRight,i,p/a.PATH_SCALE,n.scale*(r.vSteps<0?-1:1),r.opacity)}Object(o.drawSVGPath)(r.g,f.path,t+s,i,n.scale,n.scale,r.opacity),r.xHeadRight=t+s+f.width*n.scale,1.5*u<=r.length&&Object(o.drawSVGPath)(r.g,a.dotPath,t+s+f.width*n.scale+n.vStepSize/2,i-n.vStepSize/2,n.scale,n.scale,r.opacity),0!==r.accidental&&Object(o.drawSVGPath)(r.g,a.ACCIDENTAL_PATHS[r.accidental],t+s,i,n.scale,n.scale,r.opacity)})),f.stemAnchor){var p,d,m=t+s,v=f.stemAnchor*this.scale,g=e.minVStep+e.maxVStep<0,y=f.flags>2?2*(f.flags-2):0;if(g?(p=e.maxVStep*this.vStepSize-v,d=(e.minVStep+7+y)*this.vStepSize):(m+=(f.width-i.STEM_WIDTH)*this.scale,p=e.minVStep*this.vStepSize+v,d=(e.maxVStep-7-y)*this.vStepSize),Object(o.drawSVGPath)(h,a.stemPath,m,p,this.scale,(d-p)/a.PATH_SCALE),1===f.flags)Object(o.drawSVGPath)(h,a.singleFlagPath,m,d,this.scale,this.scale*(g?-1:1),1);else if(f.flags>1)for(var _=0;_<f.flags;++_)Object(o.drawSVGPath)(h,a.multiFlagPath,m,d,this.scale,this.scale*(g?-1:1),1),d+=(g?-2:2)*this.vStepSize}return 0===this.config.pixelsPerTimeStep&&(s+=f.width*this.scale,h&&(s+=h.getBoundingClientRect().width),s+=this.config.noteSpacing),s+=this.drawRests(e,t+s)}},{key:"drawBarIfNeeded",value:function(e,t){var n=0,r=this.lastBar+this.getBarLength();return 0!==e&&e>=r&&(this.config.pixelsPerTimeStep>0?t-=this.config.noteSpacing:n=this.config.noteSpacing,Object(o.drawSVGPath)(this.linesG,a.barPath,t,0,1,this.scale),this.lastBar=r),n}},{key:"drawRests",value:function(e,t){var n=0,r=e.restToNextLength;if(r){this.config.pixelsPerTimeStep>0&&(t+=this.quartersToTime(e.notes[0].length)*this.hStepSize);var s,u=e.notes[0].start+e.notes[0].length,c=0,l=this.lastBar+this.getBarLength()-u;for(r>l&&(c=r-l,r=l),s=4;s>this.getBarLength()&&s>=i.MIN_RESOLUTION;s/=2);for(var h=s;(r||c)&&h>=i.MIN_RESOLUTION;){if(h<=r){n+=this.drawBarIfNeeded(u,t+n),n+=this.drawSignaturesIfNeeded(u,t+n);var f=Object(o.drawSVGPath)(this.musicG,a.REST_PATHS[h],t+n,0,this.scale,this.scale);this.config.pixelsPerTimeStep>0?t+=this.quartersToTime(h)*this.hStepSize:(n+=f.getBoundingClientRect().width,n+=this.config.noteSpacing),u+=h,r-=h}if(c&&r<=0){var p=this.getBarLength();for(c>p?(r=p,c-=p):(r=c,c=0),s=4;s>this.getBarLength()&&s>=i.MIN_RESOLUTION;s/=2);h=s}r<h&&(h/=2)}}return n}},{key:"redrawStaff",value:function(e,t,n){var r=e.querySelector('g[data-id="staff-five-lines"]');if(r)r.setAttributeNS(null,"transform","scale(".concat(n/a.PATH_SCALE,", 1)"));else{r=Object(o.createSVGGroupChild)(e,"staff-five-lines");for(var i=-4;i<=4;i+=2)Object(o.drawSVGPath)(r,a.staffLinePath,t,0+i*this.vStepSize,n/a.PATH_SCALE,1)}return r}},{key:"clearSignatureOverlay",value:function(){for(;this.overlayG.lastChild;)this.overlayG.removeChild(this.overlayG.lastChild)}},{key:"drawSignaturesIfNeeded",value:function(e,t){var n=0,r=this.changeKeySignatureIfNeeded(e),a=this.changeTimeSignatureIfNeeded(e);if(r||a){var s=i.COMPACT_SPACING*this.scale*(this.config.pixelsPerTimeStep>0?3:2);this.signaturesList.push({x:t-s,q:e}),null===this.signatureNext&&(this.signatureNext=t);var u=e>0?Object(o.createSVGGroupChild)(this.signaturesG,"signatures"):this.overlayG;n+=this.drawSignatures(u,t+n,!1,r,a)}return 0===this.config.pixelsPerTimeStep?n:0}},{key:"drawSignatures",value:function(e,t,n,r,s){var c,l=this,h=i.COMPACT_SPACING*this.scale,f=h,p=e===this.overlayG||this.config.pixelsPerTimeStep>0;if(p){(c=document.createElementNS(o.SVGNS,"rect")).setAttributeNS(null,"x",""+t),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width","1"),c.setAttributeNS(null,"height","1"),c.setAttribute("data-id","background"),e.appendChild(c);var d=document.defaultView.getComputedStyle(this.div.parentElement);c.setAttributeNS(null,"fill",d.getPropertyValue("background-color"))}if(n){var m=Object(o.drawSVGPath)(e,a.CLEF_PATHS[this.clef].path,t+f,0,this.scale,this.scale);this.setFill(m),f+=3*h}if(r){var v=u[this.key].accidental,g=71===this.clef?0:14;u[this.key].pitches.forEach((function(n){var r=l.getPitchDetails(n).vSteps,i=Object(o.drawSVGPath)(e,a.ACCIDENTAL_PATHS[v],t+f,(g+r)*l.vStepSize,l.scale,l.scale);l.setFill(i),f+=i.getBoundingClientRect().width}))}if(s){var y=Object(o.createSVGGroupChild)(e,"time-key"),_=2.85*this.config.noteHeight+"px";Object(o.drawSVGText)(y,""+this.timeSignatureNumerator,t+f,-.5,_,!0),Object(o.drawSVGText)(y,""+this.timeSignatureDenominator,t+f,4*this.vStepSize-.5,_,!0),this.setFill(y),f+=y.getBoundingClientRect().width+h}var k=this.redrawStaff(e,t,f);this.setStroke(k);var b=this.div.getBoundingClientRect(),S=e.getBoundingClientRect();if(this.updateVerticalBoundaries(S.top-b.top,S.bottom-b.top),p&&(c.setAttributeNS(null,"y",""+-this.staffOffset),c.setAttributeNS(null,"height",""+this.height),c.setAttributeNS(null,"width",""+f)),e===this.overlayG){this.overlaySVG.setAttributeNS(null,"width",""+(f+5));for(var w=0;w<5;++w){var x=Object(o.drawSVGPath)(e,a.stemPath,f+w,w*w-this.staffOffset,1/i.STEM_WIDTH,(this.height-2*w*w)/a.PATH_SCALE,(w-5)*(w-5)*2/a.PATH_SCALE);this.setFill(x)}}if(this.config.pixelsPerTimeStep>0){var T=0===this.signaturesQuarters;return T&&(this.signaturesQuarters=this.timeToQuarters(f/this.hStepSize)),(T||t>0)&&(this.signaturesBlinking=!0,Object(o.setFade)(e,this.signaturesBlinking)),0}return f}},{key:"changeKeySignatureIfNeeded",value:function(e){if(this.scoreInfo.keySignatures){for(var t=this.key,n=0;n<this.scoreInfo.keySignatures.length&&this.scoreInfo.keySignatures[n].start<=e;++n)t=this.scoreInfo.keySignatures[n].key;if(t!==this.key)return this.key=t,!0}return!1}},{key:"changeTimeSignatureIfNeeded",value:function(e){if(this.scoreInfo.timeSignatures){for(var t=this.timeSignatureNumerator,n=this.timeSignatureDenominator,r=0;r<this.scoreInfo.timeSignatures.length&&this.scoreInfo.timeSignatures[r].start<=e;++r)t=this.scoreInfo.timeSignatures[r].numerator,n=this.scoreInfo.timeSignatures[r].denominator;if(t!==this.timeSignatureNumerator||n!==this.timeSignatureDenominator)return this.timeSignatureNumerator=t,this.timeSignatureDenominator=n,!0}return!1}},{key:"changeAndDrawSignaturesIfNeeded",value:function(e){var t;if(e<this.signatureCurrent||null!==this.signatureNext&&this.signatureNext<=e){t=this.signaturesList[0].q,this.signatureNext=null;for(var n=0;n<this.signaturesList.length;++n){if(e<this.signaturesList[n].x){this.signatureNext=this.signaturesList[n].x;break}this.signatureCurrent=this.signaturesList[n].x,t=this.signaturesList[n].q}}if(void 0!==t){var r=this.key,i=this.timeSignatureNumerator,a=this.timeSignatureDenominator;this.changeKeySignatureIfNeeded(t),this.changeTimeSignatureIfNeeded(t),this.clearSignatureOverlay(),this.drawSignatures(this.overlayG,0,!0,!0,!0),this.key=r,this.timeSignatureNumerator=i,this.timeSignatureDenominator=a}this.config.pixelsPerTimeStep>0&&0===e&&(this.signatureNext=0,this.signaturesBlinking=!0,Object(o.setFade)(this.overlayG,this.signaturesBlinking))}},{key:"getBarLength",value:function(){return 4*this.timeSignatureNumerator/this.timeSignatureDenominator}},{key:"scrollIntoViewIfNeeded",value:function(e,t){if(e)if(this.scrollType===r.PAGE){var n=this.parentElement.getBoundingClientRect().width;t>this.parentElement.scrollLeft+n&&(this.parentElement.scrollLeft=t-20)}else{var i=this.parentElement.getBoundingClientRect().width;this.parentElement.scrollLeft=t-.5*i}}},{key:"updateVerticalBoundaries",value:function(e,t){var n=0;if(e<0){this.staffOffset-=e;var r="translate(0, ".concat(this.staffOffset,")");this.overlayG.setAttributeNS(null,"transform",r),this.staffG.setAttributeNS(null,"transform",r),n=this.height-e}if((n=Math.max(n,t-e))>this.height){this.height=n,this.overlaySVG.setAttributeNS(null,"height",""+this.height),this.staffSVG.setAttributeNS(null,"height",""+this.height);for(var i=this.div.querySelectorAll('rect[data-id="background"]'),o=0;o<i.length;++o){var a=i[o];a.setAttributeNS(null,"y",""+-this.staffOffset),a.setAttributeNS(null,"height",""+this.height)}}}},{key:"setFill",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.setAttributeNS(null,"fill",this.getColor(t))}},{key:"setStroke",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i.LINE_STROKE,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e.setAttributeNS(null,"stroke",this.getColor(n)),e.setAttributeNS(null,"stroke-width",""+t)}},{key:"getColor",value:function(e){return"rgb(".concat(e?this.config.activeNoteRGB:this.config.noteRGB,")")}},{key:"getOpacity",value:function(e){return e?e/127*.8+.2:1}},{key:"getGroup",value:function(e){var t=e.start,n=e.pitch;return this.staffSVG.querySelector('g[data-id="'.concat(t,"-").concat(n,'"]'))}},{key:"highlightElement",value:function(e,t){e.setAttribute("fill",this.getColor(t)),e.setAttribute("stroke",this.getColor(t))}},{key:"getBarBeginnings",value:function(){var e=new Set,t=0;this.scoreInfo.notes.forEach((function(e){e.start+e.length>t&&(t=e.start+e.length)}));var n=this.scoreInfo.timeSignatures?this.scoreInfo.timeSignatures.slice(0):[{start:0,numerator:4,denominator:4}];n.sort((function(e,t){return e.start-t.start}));for(var r=0,i=0;i<n.length;++i)for(var o=i===n.length-1?t:n[i].start,a=4*n[i].numerator/n[i].denominator;r<o;r+=a)e.add(r);return e}},{key:"quartersToTime",value:function(e){return e/this.scoreInfo.tempos[0].qpm*60}},{key:"timeToQuarters",value:function(e){return e*this.scoreInfo.tempos[0].qpm/60}},{key:"setDetails",value:function(){var e=this,t=new Map,n=this.getBarBeginnings(),r=new Set(n);this.scoreInfo.notes.slice().sort((function(e,t){return e.start-t.start})).forEach((function(n){var i=e.getQNote(n);r.add(i.start),r.add(i.start+i.length),t.has(i.start)?t.get(i.start).push(i):t.set(i.start,[i])})),Array.from(r).sort((function(e,t){return e-t})).forEach((function(n){var r=[];t.forEach((function(t){t.forEach((function(t){var i=e.splitQNote(t,n);i&&r.push(i)}))})),r.forEach((function(e){t.has(e.start)?t.get(e.start).push(e):t.set(e.start,[e])}))})),t=new Map(Array.from(t).sort((function(e,t){return e[0]-t[0]})));var i=this.key,o=null,a=0,s=n[Symbol.iterator](),u=s.next();t.forEach((function(t,n){var r={maxVStep:Number.MAX_SAFE_INTEGER,minVStep:Number.MIN_SAFE_INTEGER,restToNextLength:0,isBarBeginning:!1,notes:[]};e.changeKeySignatureIfNeeded(n);var i=u.value+e.getBarLength();!u.done&&n>=i&&(u=s.next(),e.barAccidentals={},r.isBarBeginning=!0),t.forEach((function(t){e.analyzePitch(t,n),r.minVStep=Math.max(t.vSteps,r.minVStep),r.maxVStep=Math.min(t.vSteps,r.maxVStep),r.notes.push(t)})),o&&(o.restToNextLength=n-a),e.musicBlockMap.set(n,r),o=r,a=n+r.notes[0].length})),this.initialRest={maxVStep:0,minVStep:0,restToNextLength:this.musicBlockMap.values().next().value.notes[0].start,isBarBeginning:!0,notes:[{start:0,length:0,vSteps:0,accidental:0,opacity:0,pitch:0,xHeadRight:0}]},this.key=i}},{key:"getQNote",value:function(e){return{start:e.start,length:e.length,vSteps:0,accidental:0,opacity:this.getOpacity(e.intensity),pitch:e.pitch,xHeadRight:0}}},{key:"splitQNote",value:function(e,t){var n=e.start+e.length-t;return t>e.start&&n>0?(e.length-=n,{start:t,length:n,vSteps:e.vSteps,accidental:e.accidental,opacity:e.opacity,pitch:e.pitch,xHeadRight:0,tiedFrom:e}):null}},{key:"analyzePitch",value:function(e,t){var n=this.getPitchDetails(e.pitch);n.vSteps in this.barAccidentals?n.accidental===this.barAccidentals[n.vSteps]?n.accidental=0:(3===this.barAccidentals[n.vSteps]?n.accidental=n.keyAccidental:0===n.accidental&&(n.accidental=3),this.barAccidentals[n.vSteps]=n.accidental):(e.tiedFrom&&(n.accidental=0),this.barAccidentals[n.vSteps]=n.accidental),e.vSteps=n.vSteps,e.accidental=n.accidental}},{key:"getPitchDetails",value:function(e){var t=e-60,n=Math.floor(t/12),r=t-12*n,i=s[this.key].steps[r],o=71===this.clef?6:-6,a=1===u[this.key].accidental?69+(r+3)%12:64+(r+8)%12;return{vSteps:o-7*n+i,accidental:s[this.key].accidental[r],keyAccidental:u[this.key].pitches.indexOf(a)>-1?u[this.key].accidental:0}}}])}()},function(e,t,n){n.r(t);var r=n(3);n.d(t,"MAX_QUARTER_DIVISION",(function(){return r.MAX_QUARTER_DIVISION})),n.d(t,"ScrollType",(function(){return r.ScrollType})),n.d(t,"StaffSVGRender",(function(){return r.StaffSVGRender}))}])},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){function n(e){for(var t,n=new r(e),i=[];!n.eof();){var o=a();i.push(o)}return i;function a(){var e={};e.deltaTime=n.readVarInt();var r=n.readUInt8();if(240&~r){var i;if(128&r)i=n.readUInt8(),t=r;else{if(null===t)throw"Running status byte encountered before status byte";i=r,r=t,e.running=!0}var o=r>>4;switch(e.channel=15&r,o){case 8:return e.type="noteOff",e.noteNumber=i,e.velocity=n.readUInt8(),e;case 9:var a=n.readUInt8();return e.type=0===a?"noteOff":"noteOn",e.noteNumber=i,e.velocity=a,0===a&&(e.byte9=!0),e;case 10:return e.type="noteAftertouch",e.noteNumber=i,e.amount=n.readUInt8(),e;case 11:return e.type="controller",e.controllerType=i,e.value=n.readUInt8(),e;case 12:return e.type="programChange",e.programNumber=i,e;case 13:return e.type="channelAftertouch",e.amount=i,e;case 14:return e.type="pitchBend",e.value=i+(n.readUInt8()<<7)-8192,e;default:throw"Unrecognised MIDI event type: "+o}}else{if(255!==r){if(240==r)return e.type="sysEx",u=n.readVarInt(),e.data=n.readBytes(u),e;if(247==r)return e.type="endSysEx",u=n.readVarInt(),e.data=n.readBytes(u),e;throw"Unrecognised MIDI event type byte: "+r}e.meta=!0;var s=n.readUInt8(),u=n.readVarInt();switch(s){case 0:if(e.type="sequenceNumber",2!==u)throw"Expected length for sequenceNumber event is 2, got "+u;return e.number=n.readUInt16(),e;case 1:return e.type="text",e.text=n.readString(u),e;case 2:return e.type="copyrightNotice",e.text=n.readString(u),e;case 3:return e.type="trackName",e.text=n.readString(u),e;case 4:return e.type="instrumentName",e.text=n.readString(u),e;case 5:return e.type="lyrics",e.text=n.readString(u),e;case 6:return e.type="marker",e.text=n.readString(u),e;case 7:return e.type="cuePoint",e.text=n.readString(u),e;case 32:if(e.type="channelPrefix",1!=u)throw"Expected length for channelPrefix event is 1, got "+u;return e.channel=n.readUInt8(),e;case 33:if(e.type="portPrefix",1!=u)throw"Expected length for portPrefix event is 1, got "+u;return e.port=n.readUInt8(),e;case 47:if(e.type="endOfTrack",0!=u)throw"Expected length for endOfTrack event is 0, got "+u;return e;case 81:if(e.type="setTempo",3!=u)throw"Expected length for setTempo event is 3, got "+u;return e.microsecondsPerBeat=n.readUInt24(),e;case 84:if(e.type="smpteOffset",5!=u)throw"Expected length for smpteOffset event is 5, got "+u;var c=n.readUInt8();return e.frameRate={0:24,32:25,64:29,96:30}[96&c],e.hour=31&c,e.min=n.readUInt8(),e.sec=n.readUInt8(),e.frame=n.readUInt8(),e.subFrame=n.readUInt8(),e;case 88:if(e.type="timeSignature",4!=u)throw"Expected length for timeSignature event is 4, got "+u;return e.numerator=n.readUInt8(),e.denominator=1<<n.readUInt8(),e.metronome=n.readUInt8(),e.thirtyseconds=n.readUInt8(),e;case 89:if(e.type="keySignature",2!=u)throw"Expected length for keySignature event is 2, got "+u;return e.key=n.readInt8(),e.scale=n.readUInt8(),e;case 127:return e.type="sequencerSpecific",e.data=n.readBytes(u),e;default:return e.type="unknownMeta",e.data=n.readBytes(u),e.metatypeByte=s,e}}}}function r(e){this.buffer=e,this.bufferLen=this.buffer.length,this.pos=0}r.prototype.eof=function(){return this.pos>=this.bufferLen},r.prototype.readUInt8=function(){var e=this.buffer[this.pos];return this.pos+=1,e},r.prototype.readInt8=function(){var e=this.readUInt8();return 128&e?e-256:e},r.prototype.readUInt16=function(){return(this.readUInt8()<<8)+this.readUInt8()},r.prototype.readInt16=function(){var e=this.readUInt16();return 32768&e?e-65536:e},r.prototype.readUInt24=function(){return(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},r.prototype.readInt24=function(){var e=this.readUInt24();return 8388608&e?e-16777216:e},r.prototype.readUInt32=function(){return(this.readUInt8()<<24)+(this.readUInt8()<<16)+(this.readUInt8()<<8)+this.readUInt8()},r.prototype.readBytes=function(e){var t=this.buffer.slice(this.pos,this.pos+e);return this.pos+=e,t},r.prototype.readString=function(e){var t=this.readBytes(e);return String.fromCharCode.apply(null,t)},r.prototype.readVarInt=function(){for(var e=0;!this.eof();){var t=this.readUInt8();if(!(128&t))return e+t;e+=127&t,e<<=7}return e},r.prototype.readChunk=function(){var e=this.readString(4),t=this.readUInt32();return{id:e,length:t,data:this.readBytes(t)}},e.exports=function(e){var t=new r(e),i=t.readChunk();if("MThd"!=i.id)throw"Bad MIDI file.  Expected 'MHdr', got: '"+i.id+"'";for(var o=function(e){var t=new r(e),n={format:t.readUInt16(),numTracks:t.readUInt16()},i=t.readUInt16();return 32768&i?(n.framesPerSecond=256-(i>>8),n.ticksPerFrame=255&i):n.ticksPerBeat=i,n}(i.data),a=[],s=0;!t.eof()&&s<o.numTracks;s++){var u=t.readChunk();if("MTrk"!=u.id)throw"Bad MIDI file.  Expected 'MTrk', got: '"+u.id+"'";var c=n(u.data);a.push(c)}return{header:o,tracks:a}}},function(e,t){function n(e,t,n){var o,a=new i,s=t.length,u=null;for(o=0;o<s;o++)!1!==n.running&&(n.running||t[o].running)||(u=null),u=r(a,t[o],u,n.useByte9ForNoteOff);e.writeChunk("MTrk",a.buffer)}function r(e,t,n,r){var i=t.type,o=t.deltaTime,a=t.text||"",s=t.data||[],u=null;switch(e.writeVarInt(o),i){case"sequenceNumber":e.writeUInt8(255),e.writeUInt8(0),e.writeVarInt(2),e.writeUInt16(t.number);break;case"text":e.writeUInt8(255),e.writeUInt8(1),e.writeVarInt(a.length),e.writeString(a);break;case"copyrightNotice":e.writeUInt8(255),e.writeUInt8(2),e.writeVarInt(a.length),e.writeString(a);break;case"trackName":e.writeUInt8(255),e.writeUInt8(3),e.writeVarInt(a.length),e.writeString(a);break;case"instrumentName":e.writeUInt8(255),e.writeUInt8(4),e.writeVarInt(a.length),e.writeString(a);break;case"lyrics":e.writeUInt8(255),e.writeUInt8(5),e.writeVarInt(a.length),e.writeString(a);break;case"marker":e.writeUInt8(255),e.writeUInt8(6),e.writeVarInt(a.length),e.writeString(a);break;case"cuePoint":e.writeUInt8(255),e.writeUInt8(7),e.writeVarInt(a.length),e.writeString(a);break;case"channelPrefix":e.writeUInt8(255),e.writeUInt8(32),e.writeVarInt(1),e.writeUInt8(t.channel);break;case"portPrefix":e.writeUInt8(255),e.writeUInt8(33),e.writeVarInt(1),e.writeUInt8(t.port);break;case"endOfTrack":e.writeUInt8(255),e.writeUInt8(47),e.writeVarInt(0);break;case"setTempo":e.writeUInt8(255),e.writeUInt8(81),e.writeVarInt(3),e.writeUInt24(t.microsecondsPerBeat);break;case"smpteOffset":e.writeUInt8(255),e.writeUInt8(84),e.writeVarInt(5);var c=31&t.hour|{24:0,25:32,29:64,30:96}[t.frameRate];e.writeUInt8(c),e.writeUInt8(t.min),e.writeUInt8(t.sec),e.writeUInt8(t.frame),e.writeUInt8(t.subFrame);break;case"timeSignature":e.writeUInt8(255),e.writeUInt8(88),e.writeVarInt(4),e.writeUInt8(t.numerator);var l=255&Math.floor(Math.log(t.denominator)/Math.LN2);e.writeUInt8(l),e.writeUInt8(t.metronome),e.writeUInt8(t.thirtyseconds||8);break;case"keySignature":e.writeUInt8(255),e.writeUInt8(89),e.writeVarInt(2),e.writeInt8(t.key),e.writeUInt8(t.scale);break;case"sequencerSpecific":e.writeUInt8(255),e.writeUInt8(127),e.writeVarInt(s.length),e.writeBytes(s);break;case"unknownMeta":null!=t.metatypeByte&&(e.writeUInt8(255),e.writeUInt8(t.metatypeByte),e.writeVarInt(s.length),e.writeBytes(s));break;case"sysEx":e.writeUInt8(240),e.writeVarInt(s.length),e.writeBytes(s);break;case"endSysEx":e.writeUInt8(247),e.writeVarInt(s.length),e.writeBytes(s);break;case"noteOff":(u=(!1!==r&&t.byte9||r&&0==t.velocity?144:128)|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteOn":(u=144|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.velocity);break;case"noteAftertouch":(u=160|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.noteNumber),e.writeUInt8(t.amount);break;case"controller":(u=176|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.controllerType),e.writeUInt8(t.value);break;case"programChange":(u=192|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.programNumber);break;case"channelAftertouch":(u=208|t.channel)!==n&&e.writeUInt8(u),e.writeUInt8(t.amount);break;case"pitchBend":(u=224|t.channel)!==n&&e.writeUInt8(u);var h=8192+t.value,f=127&h,p=h>>7&127;e.writeUInt8(f),e.writeUInt8(p);break;default:throw"Unrecognized event type: "+i}return u}function i(){this.buffer=[]}i.prototype.writeUInt8=function(e){this.buffer.push(255&e)},i.prototype.writeInt8=i.prototype.writeUInt8,i.prototype.writeUInt16=function(e){var t=e>>8&255,n=255&e;this.writeUInt8(t),this.writeUInt8(n)},i.prototype.writeInt16=i.prototype.writeUInt16,i.prototype.writeUInt24=function(e){var t=e>>16&255,n=e>>8&255,r=255&e;this.writeUInt8(t),this.writeUInt8(n),this.writeUInt8(r)},i.prototype.writeInt24=i.prototype.writeUInt24,i.prototype.writeUInt32=function(e){var t=e>>24&255,n=e>>16&255,r=e>>8&255,i=255&e;this.writeUInt8(t),this.writeUInt8(n),this.writeUInt8(r),this.writeUInt8(i)},i.prototype.writeInt32=i.prototype.writeUInt32,i.prototype.writeBytes=function(e){this.buffer=this.buffer.concat(Array.prototype.slice.call(e,0))},i.prototype.writeString=function(e){var t,n=e.length,r=[];for(t=0;t<n;t++)r.push(e.codePointAt(t));this.writeBytes(r)},i.prototype.writeVarInt=function(e){if(e<0)throw"Cannot write negative variable-length integer";if(e<=127)this.writeUInt8(e);else{var t=e,n=[];for(n.push(127&t),t>>=7;t;){var r=127&t|128;n.push(r),t>>=7}this.writeBytes(n.reverse())}},i.prototype.writeChunk=function(e,t){this.writeString(e),this.writeUInt32(t.length),this.writeBytes(t)},e.exports=function(e,t){if("object"!=_typeof(e))throw"Invalid MIDI data";t=t||{};var r,o=e.header||{},a=e.tracks||[],s=a.length,u=new i;for(function(e,t,n){var r=null==t.format?1:t.format,o=128;t.timeDivision?o=t.timeDivision:t.ticksPerFrame&&t.framesPerSecond?o=-(255&t.framesPerSecond)<<8|255&t.ticksPerFrame:t.ticksPerBeat&&(o=32767&t.ticksPerBeat);var a=new i;a.writeUInt16(r),a.writeUInt16(n),a.writeUInt16(o),e.writeChunk("MThd",a.buffer)}(u,o,s),r=0;r<s;r++)n(u,a[r],t);return u.buffer}},function(e,t,n){var r=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(79),a=n(66),s=i(n(175));function u(e,t){return{absoluteTime:e.ticks,channel:t,controllerType:e.number,deltaTime:0,type:"controller",value:e.value}}function c(e){return{absoluteTime:0,channel:e.channel,deltaTime:0,programNumber:e.instrument.number,type:"programChange"}}t.encode=function(e){var t={header:{format:1,numTracks:e.tracks.length+1,ticksPerBeat:e.header.ppq},tracks:r([r([{absoluteTime:0,deltaTime:0,meta:!0,text:e.header.name,type:"trackName"}],e.header.keySignatures.map((function(e){return function(e){var t=a.keySignatureKeys.indexOf(e.key);return{absoluteTime:e.ticks,deltaTime:0,key:t+7,meta:!0,scale:"major"===e.scale?0:1,type:"keySignature"}}(e)})),e.header.meta.map((function(e){return{absoluteTime:(t=e).ticks,deltaTime:0,meta:!0,text:t.text,type:t.type};var t})),e.header.tempos.map((function(e){return function(e){return{absoluteTime:e.ticks,deltaTime:0,meta:!0,microsecondsPerBeat:Math.floor(6e7/e.bpm),type:"setTempo"}}(e)})),e.header.timeSignatures.map((function(e){return function(e){return{absoluteTime:e.ticks,deltaTime:0,denominator:e.timeSignature[1],meta:!0,metronome:24,numerator:e.timeSignature[0],thirtyseconds:8,type:"timeSignature"}}(e)})))],e.tracks.map((function(e){return r([(t=e.name,{absoluteTime:0,deltaTime:0,meta:!0,text:t,type:"trackName"}),c(e)],function(e){return s.default(e.notes.map((function(t){return function(e,t){return[{absoluteTime:e.ticks,channel:t,deltaTime:0,noteNumber:e.midi,type:"noteOn",velocity:Math.floor(127*e.velocity)},{absoluteTime:e.ticks+e.durationTicks,channel:t,deltaTime:0,noteNumber:e.midi,type:"noteOff",velocity:Math.floor(127*e.noteOffVelocity)}]}(t,e.channel)})))}(e),function(e){for(var t=[],n=0;n<127;n++)e.controlChanges.hasOwnProperty(n)&&e.controlChanges[n].forEach((function(n){t.push(u(n,e.channel))}));return t}(e),function(e){var t=[];return e.pitchBends.forEach((function(n){t.push(function(e,t){return{absoluteTime:e.ticks,channel:t,deltaTime:0,type:"pitchBend",value:e.value}}(n,e.channel))})),t}(e));var t})))};return t.tracks=t.tracks.map((function(e){e=e.sort((function(e,t){return e.absoluteTime-t.absoluteTime}));var t=0;return e.forEach((function(e){e.deltaTime=e.absoluteTime-t,t=e.absoluteTime,delete e.absoluteTime})),e.push({deltaTime:0,meta:!0,type:"endOfTrack"}),e})),new Uint8Array(o.writeMidi(t))}},function(e,t,n){function r(e){return function e(t,n){for(var r=0;r<t.length;r++){var i=t[r];Array.isArray(i)?e(i,n):n.push(i)}return n}(e,[])}function i(e,t){if("number"!=typeof t)throw new TypeError("Expected the depth to be a number");return function e(t,n,r){r--;for(var i=0;i<t.length;i++){var o=t[i];r>-1&&Array.isArray(o)?e(o,n,r):n.push(o)}return n}(e,[],t)}e.exports=function(e){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return r(e)},e.exports.from=r,e.exports.depth=function(e,t){if(!Array.isArray(e))throw new TypeError("Expected value to be an array");return i(e,t)},e.exports.fromDepth=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(82);t.createControlChanges=function(){return new Proxy({},{get:function(e,t){return e[t]?e[t]:r.controlChangeIds.hasOwnProperty(t)?e[r.controlChangeIds[t]]:void 0},set:function(e,t,n){return r.controlChangeIds.hasOwnProperty(t)?e[r.controlChangeIds[t]]=n:e[t]=n,!0}})}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=new WeakMap,i=function(){function e(e,t){r.set(this,t),this.ticks=e.absoluteTime,this.value=e.value}return Object.defineProperty(e.prototype,"time",{get:function(){return r.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=r.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{ticks:this.ticks,time:this.time,value:this.value}},e}();t.PitchBend=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(179),i=new WeakMap,o=function(){function e(e,t){if(this.number=0,i.set(this,t),this.number=0,e){var n=e.find((function(e){return"programChange"===e.type}));n&&(this.number=n.programNumber)}}return Object.defineProperty(e.prototype,"name",{get:function(){return this.percussion?r.DrumKitByPatchID[this.number]:r.instrumentByPatchID[this.number]},set:function(e){var t=r.instrumentByPatchID.indexOf(e);-1!==t&&(this.number=t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"family",{get:function(){return this.percussion?"drums":r.InstrumentFamilyByID[Math.floor(this.number/8)]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"percussion",{get:function(){return 9===i.get(this).channel},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{family:this.family,name:this.name,number:this.number}},e.prototype.fromJSON=function(e){this.number=e.number},e}();t.Instrument=o},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.instrumentByPatchID=["acoustic grand piano","bright acoustic piano","electric grand piano","honky-tonk piano","electric piano 1","electric piano 2","harpsichord","clavi","celesta","glockenspiel","music box","vibraphone","marimba","xylophone","tubular bells","dulcimer","drawbar organ","percussive organ","rock organ","church organ","reed organ","accordion","harmonica","tango accordion","acoustic guitar (nylon)","acoustic guitar (steel)","electric guitar (jazz)","electric guitar (clean)","electric guitar (muted)","overdriven guitar","distortion guitar","guitar harmonics","acoustic bass","electric bass (finger)","electric bass (pick)","fretless bass","slap bass 1","slap bass 2","synth bass 1","synth bass 2","violin","viola","cello","contrabass","tremolo strings","pizzicato strings","orchestral harp","timpani","string ensemble 1","string ensemble 2","synthstrings 1","synthstrings 2","choir aahs","voice oohs","synth voice","orchestra hit","trumpet","trombone","tuba","muted trumpet","french horn","brass section","synthbrass 1","synthbrass 2","soprano sax","alto sax","tenor sax","baritone sax","oboe","english horn","bassoon","clarinet","piccolo","flute","recorder","pan flute","blown bottle","shakuhachi","whistle","ocarina","lead 1 (square)","lead 2 (sawtooth)","lead 3 (calliope)","lead 4 (chiff)","lead 5 (charang)","lead 6 (voice)","lead 7 (fifths)","lead 8 (bass + lead)","pad 1 (new age)","pad 2 (warm)","pad 3 (polysynth)","pad 4 (choir)","pad 5 (bowed)","pad 6 (metallic)","pad 7 (halo)","pad 8 (sweep)","fx 1 (rain)","fx 2 (soundtrack)","fx 3 (crystal)","fx 4 (atmosphere)","fx 5 (brightness)","fx 6 (goblins)","fx 7 (echoes)","fx 8 (sci-fi)","sitar","banjo","shamisen","koto","kalimba","bag pipe","fiddle","shanai","tinkle bell","agogo","steel drums","woodblock","taiko drum","melodic tom","synth drum","reverse cymbal","guitar fret noise","breath noise","seashore","bird tweet","telephone ring","helicopter","applause","gunshot"],t.InstrumentFamilyByID=["piano","chromatic percussion","organ","guitar","bass","strings","ensemble","brass","reed","pipe","synth lead","synth pad","synth effects","world","percussive","sound effects"],t.DrumKitByPatchID={0:"standard kit",8:"room kit",16:"power kit",24:"electronic kit",25:"tr-808 kit",32:"jazz kit",40:"brush kit",48:"orchestra kit",56:"sound fx kit"}},function(e,t,n){function r(e){return["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"][e%12]}Object.defineProperty(t,"__esModule",{value:!0});var i,o,a=(i=/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,o={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},function(e){var t=i.exec(e),n=t[1],r=t[2];return o[n.toLowerCase()]+12*(parseInt(r,10)+1)}),s=new WeakMap,u=function(){function e(e,t,n){s.set(this,n),this.midi=e.midi,this.velocity=e.velocity,this.noteOffVelocity=t.velocity,this.ticks=e.ticks,this.durationTicks=t.ticks-e.ticks}return Object.defineProperty(e.prototype,"name",{get:function(){return e=this.midi,t=Math.floor(e/12)-1,r(e)+t.toString();var e,t},set:function(e){this.midi=a(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"octave",{get:function(){return Math.floor(this.midi/12)-1},set:function(e){var t=e-this.octave;this.midi+=12*t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"pitch",{get:function(){return r(this.midi)},set:function(e){this.midi=12*(this.octave+1)+["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"].indexOf(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){var e=s.get(this);return e.ticksToSeconds(this.ticks+this.durationTicks)-e.ticksToSeconds(this.ticks)},set:function(e){var t=s.get(this).secondsToTicks(this.time+e);this.durationTicks=t-this.ticks},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"time",{get:function(){return s.get(this).ticksToSeconds(this.ticks)},set:function(e){var t=s.get(this);this.ticks=t.secondsToTicks(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bars",{get:function(){return s.get(this).ticksToMeasures(this.ticks)},enumerable:!0,configurable:!0}),e.prototype.toJSON=function(){return{duration:this.duration,durationTicks:this.durationTicks,midi:this.midi,name:this.name,ticks:this.ticks,time:this.time,velocity:this.velocity}},e}();t.Note=u}])})),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t():"function"==typeof define&&define.amd?define(t):t()}(0,(function(){function e(e){var t=!0,n=!1,r=null,i={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function o(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function a(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function s(e){t=!1}function u(){document.addEventListener("mousemove",c),document.addEventListener("mousedown",c),document.addEventListener("mouseup",c),document.addEventListener("pointermove",c),document.addEventListener("pointerdown",c),document.addEventListener("pointerup",c),document.addEventListener("touchmove",c),document.addEventListener("touchstart",c),document.addEventListener("touchend",c)}function c(e){e.target.nodeName&&"html"===e.target.nodeName.toLowerCase()||(t=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mousedown",c),document.removeEventListener("mouseup",c),document.removeEventListener("pointermove",c),document.removeEventListener("pointerdown",c),document.removeEventListener("pointerup",c),document.removeEventListener("touchmove",c),document.removeEventListener("touchstart",c),document.removeEventListener("touchend",c))}document.addEventListener("keydown",(function(n){n.metaKey||n.altKey||n.ctrlKey||(o(e.activeElement)&&a(e.activeElement),t=!0)}),!0),document.addEventListener("mousedown",s,!0),document.addEventListener("pointerdown",s,!0),document.addEventListener("touchstart",s,!0),document.addEventListener("visibilitychange",(function(e){"hidden"===document.visibilityState&&(n&&(t=!0),u())}),!0),u(),e.addEventListener("focus",(function(e){var n,r,s;o(e.target)&&(t||(r=(n=e.target).type,"INPUT"===(s=n.tagName)&&i[r]&&!n.readOnly||"TEXTAREA"===s&&!n.readOnly||n.isContentEditable))&&a(e.target)}),!0),e.addEventListener("blur",(function(e){var t;o(e.target)&&(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added"))&&(n=!0,window.clearTimeout(r),r=window.setTimeout((function(){n=!1}),100),(t=e.target).hasAttribute("data-focus-visible-added")&&(t.classList.remove("focus-visible"),t.removeAttribute("data-focus-visible-added")))}),!0),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host?e.host.setAttribute("data-js-focus-visible",""):e.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if("undefined"!=typeof window&&"undefined"!=typeof document){var t;window.applyFocusVisiblePolyfill=e;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(e){(t=document.createEvent("CustomEvent")).initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(t)}"undefined"!=typeof document&&e(document)})),function(e,t){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports,require("@magenta/music/esm/core.js")):"function"==typeof define&&define.amd?define(["exports","@magenta/music/esm/core.js"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).midiPlayer={},e.core)}(void 0,(function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,u,"next",e)}function u(e){n(a,i,o,s,u,"throw",e)}s(void 0)}))}}var i=document.createElement("template");i.innerHTML="\n<style>\n".concat(":host {\n  display: inline-block;\n  width: 300px;\n  margin: 3px;\n  vertical-align: bottom;\n  font-family: sans-serif;\n  font-size: 14px;\n}\n\n:focus:not(.focus-visible) {\n  outline: none;\n}\n\n.controls {\n  width: inherit;\n  height: inherit;\n  box-sizing: border-box;\n  display: flex;\n  flex-direction: row;\n  position: relative;\n  overflow: hidden;\n  align-items: center;\n  border-radius: 100px;\n  background: #f2f5f6;\n  padding: 0 0.25em;\n  user-select: none;\n}\n.controls > * {\n  margin: 0.8em 0.45em;\n}\n.controls input, .controls button {\n  cursor: pointer;\n}\n.controls input:disabled, .controls button:disabled {\n  cursor: inherit;\n}\n.controls button {\n  text-align: center;\n  background: rgba(204, 204, 204, 0);\n  border: none;\n  width: 32px;\n  height: 32px;\n  border-radius: 100%;\n  transition: background-color 0.25s ease 0s;\n  padding: 0;\n}\n.controls button:not(:disabled):hover {\n  background: rgba(204, 204, 204, 0.3);\n}\n.controls button:not(:disabled):active {\n  background: rgba(204, 204, 204, 0.6);\n}\n.controls button .icon {\n  display: none;\n}\n.controls button .icon, .controls button .icon svg {\n  vertical-align: middle;\n}\n.controls button .icon svg {\n  fill: currentColor;\n}\n.controls .seek-bar {\n  flex: 1;\n  min-width: 0;\n  margin-right: 1.1em;\n  background: transparent;\n}\n.controls .seek-bar::-moz-range-track {\n  background-color: #555;\n}\n.controls.stopped .play-icon, .controls.playing .stop-icon, .controls.error .error-icon {\n  display: inherit;\n}\n.controls.frozen > div, .controls > button:disabled .icon {\n  opacity: 0.5;\n}\n.controls .overlay {\n  z-index: 0;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  margin: 0;\n  box-sizing: border-box;\n  display: none;\n  opacity: 1;\n}\n.controls.loading .loading-overlay {\n  display: block;\n  background: linear-gradient(110deg, #92929200 5%, #92929288 25%, #92929200 45%);\n  background-size: 250% 100%;\n  background-repeat: repeat-y;\n  animation: shimmer 1.5s linear infinite;\n}\n\n@keyframes shimmer {\n  0% {\n    background-position: 125% 0;\n  }\n  100% {\n    background-position: -200% 0;\n  }\n}",'\n</style>\n<div class="controls stopped frozen" part="control-panel">\n  <button class="play" part="play-button" disabled>\n    <span class="icon play-icon">').concat('<svg width="24" height="24" version="1.1" viewBox="0 0 6.35 6.35" xmlns="http://www.w3.org/2000/svg">\n <path d="m4.4979 3.175-2.1167 1.5875v-3.175z" stroke-width=".70201"/>\n</svg>\n','</span>\n    <span class="icon stop-icon">').concat('<svg width="24" height="24" version="1.1" viewBox="0 0 6.35 6.35" xmlns="http://www.w3.org/2000/svg">\n <path d="m1.8521 1.5875v3.175h0.92604v-3.175zm1.7198 0v3.175h0.92604v-3.175z" stroke-width=".24153"/>\n</svg>\n','</span>\n    <span class="icon error-icon">').concat('<svg width="24" height="24" version="1.1" viewBox="0 0 6.35 6.35" xmlns="http://www.w3.org/2000/svg">\n <path transform="scale(.26458)" d="m12 3.5a8.4993 8.4993 0 0 0-8.5 8.5 8.4993 8.4993 0 0 0 8.5 8.5 8.4993 8.4993 0 0 0 8.5-8.5 8.4993 8.4993 0 0 0-8.5-8.5zm-1.4062 3.5h3v6h-3v-6zm0 8h3v2h-3v-2z"/>\n</svg>\n','</span>\n  </button>\n  <div part="time"><span class="current-time" part="current-time">0:00</span> / <span class="total-time" part="total-time">0:00</span></div>\n  <input type="range" min="0" max="0" value="0" step="any" class="seek-bar" part="seek-bar" disabled>\n  <div class="overlay loading-overlay" part="loading-overlay"></div>\n</div>\n');var o=document.createElement("template");function a(e){var t=e<0,n=(e=Math.floor(Math.abs(e||0)))%60,r=(e-n)/60,i=(e-n-60*r)/3600,o=n>9?"".concat(n):"0".concat(n),a=r>9||!i?"".concat(r,":"):"0".concat(r,":");return(t?"-":"")+(i?"".concat(i,":"):"")+a+o}o.innerHTML="\n<style>\n".concat(":host {\n  display: block;\n}\n\n::slotted(.piano-roll-visualizer) {\n  overflow-x: auto;\n}","\n</style>\n<slot>\n</slot>\n");var s=["piano-roll","waterfall","staff"],u=function(){function e(){var t;return _classCallCheck(this,e),(t=_callSuper(this,e,arguments)).domInitialized=!1,t.ns=null,t._config={},t}return _inherits(e,_wrapNativeSuper(HTMLElement)),_createClass(e,[{key:"connectedCallback",value:function(){this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(o.content.cloneNode(!0)),this.domInitialized||(this.domInitialized=!0,this.wrapper=document.createElement("div"),this.appendChild(this.wrapper),this.initVisualizerNow())}},{key:"attributeChangedCallback",value:function(e,t,n){"src"!==e&&"type"!==e||this.initVisualizer()}},{key:"initVisualizer",value:function(){var e=this;null==this.initTimeout&&(this.initTimeout=window.setTimeout((function(){return e.initVisualizerNow()})))}},{key:"initVisualizerNow",value:function(){var e=this;return r(_regeneratorRuntime().mark((function n(){var r,i;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.initTimeout=null,n.t0=e.domInitialized,!n.t0){n.next=11;break}if(n.t1=e.src,!n.t1){n.next=9;break}return e.ns=null,n.next=8,t.urlToNoteSequence(e.src);case 8:e.ns=n.sent;case 9:e.wrapper.innerHTML="",n.t0=e.ns;case 11:if(!n.t0){n.next=13;break}"piano-roll"===e.type?(e.wrapper.classList.add("piano-roll-visualizer"),r=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.wrapper.appendChild(r),e.visualizer=new t.PianoRollSVGVisualizer(e.ns,r,e._config)):"waterfall"===e.type?(e.wrapper.classList.add("waterfall-visualizer"),e.visualizer=new t.WaterfallSVGVisualizer(e.ns,e.wrapper,e._config)):"staff"===e.type&&(e.wrapper.classList.add("staff-visualizer"),i=document.createElement("div"),e.wrapper.appendChild(i),e.visualizer=new t.StaffSVGVisualizer(e.ns,i,e._config));case 13:case"end":return n.stop()}}),n)})))()}},{key:"reload",value:function(){this.initVisualizerNow()}},{key:"redraw",value:function(e){this.visualizer&&this.visualizer.redraw(e,null!=e)}},{key:"clearActiveNotes",value:function(){this.visualizer&&this.visualizer.clearActiveNotes()}},{key:"noteSequence",get:function(){return this.ns},set:function(e){this.ns!=e&&(this.ns=e,this.removeAttribute("src"),this.initVisualizer())}},{key:"src",get:function(){return this.getAttribute("src")},set:function(e){this.ns=null,this.setOrRemoveAttribute("src",e),this.initVisualizer()}},{key:"type",get:function(){var e=this.getAttribute("type");return s.indexOf(e)<0&&(e="piano-roll"),e},set:function(e){if(null!=e&&s.indexOf(e)<0)throw new Error("Unknown visualizer type ".concat(e,". Allowed values: ").concat(s.join(", ")));this.setOrRemoveAttribute("type",e)}},{key:"config",get:function(){return this._config},set:function(e){this._config=e,this.initVisualizer()}},{key:"setOrRemoveAttribute",value:function(e,t){null==t?this.removeAttribute(e):this.setAttribute(e,t)}}],[{key:"observedAttributes",get:function(){return["src","type"]}}])}(),c=["start","stop","note"],l=null,h=function(){function e(){var t;return _classCallCheck(this,e),(t=_callSuper(this,e)).domInitialized=!1,t.needInitNs=!1,t.visualizerListeners=new Map,t.ns=null,t._playing=!1,t.seeking=!1,t.attachShadow({mode:"open"}),t.shadowRoot.appendChild(i.content.cloneNode(!0)),t.controlPanel=t.shadowRoot.querySelector(".controls"),t.playButton=t.controlPanel.querySelector(".play"),t.currentTimeLabel=t.controlPanel.querySelector(".current-time"),t.totalTimeLabel=t.controlPanel.querySelector(".total-time"),t.seekBar=t.controlPanel.querySelector(".seek-bar"),t}return _inherits(e,_wrapNativeSuper(HTMLElement)),_createClass(e,[{key:"connectedCallback",value:function(){var e=this;if(!this.domInitialized){this.domInitialized=!0;var t=window.applyFocusVisiblePolyfill;null!=t&&t(this.shadowRoot),this.playButton.addEventListener("click",(function(){e.player.isPlaying()?e.stop():e.start()})),this.seekBar.addEventListener("input",(function(){e.seeking=!0,e.player&&"started"===e.player.getPlayState()&&e.player.pause()})),this.seekBar.addEventListener("change",(function(){var t=e.currentTime;e.currentTimeLabel.textContent=a(t),e.player&&e.player.isPlaying()&&(e.player.seekTo(t),"paused"===e.player.getPlayState()&&e.player.resume()),e.seeking=!1})),this.initPlayerNow()}}},{key:"attributeChangedCallback",value:function(e,t,n){var r=this;if(this.hasAttribute(e)||(n=null),"sound-font"===e||"src"===e)this.initPlayer();else if("visualizer"===e){var i=function(){r.setVisualizerSelector(n)};"loading"===document.readyState?window.addEventListener("DOMContentLoaded",i):i()}}},{key:"initPlayer",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.needInitNs=this.needInitNs||t,null==this.initTimeout&&(this.stop(),this.setLoading(),this.initTimeout=window.setTimeout((function(){return e.initPlayerNow(e.needInitNs)})))}},{key:"initPlayerNow",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=this;return r(_regeneratorRuntime().mark((function r(){var i,o,s;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.initTimeout=null,n.needInitNs=!1,!n.domInitialized){r.next=32;break}if(r.prev=1,r.t0=e,!r.t0){r.next=12;break}if(r.t1=n.src,!r.t1){r.next=10;break}return n.ns=null,r.next=9,t.urlToNoteSequence(n.src);case 9:n.ns=r.sent;case 10:n.currentTime=0,n.ns||n.setError("No content loaded");case 12:if(i=n.ns){r.next=14;break}return r.abrupt("return",(n.seekBar.max="0",void(n.totalTimeLabel.textContent=a(0))));case 14:if(n.seekBar.max=String(i.totalTime),n.totalTimeLabel.textContent=a(i.totalTime),o=n.soundFont,s={run:function(e){return n.ns===i&&n.noteCallback(e)},stop:function(){}},null!==o){r.next=20;break}n.player=new t.Player(!1,s),r.next=24;break;case 20:return""===o&&(o="https://storage.googleapis.com/magentadata/js/soundfonts/sgm_plus"),n.player=new t.SoundFontPlayer(o,void 0,void 0,void 0,s),r.next=24,n.player.loadSamples(i);case 24:if(n.ns===i){r.next=26;break}return r.abrupt("return");case 26:n.setLoaded(),n.dispatchEvent(new CustomEvent("load")),r.next=32;break;case 29:throw r.prev=29,r.t2=r.catch(1),n.setError(String(r.t2)),r.t2;case 32:case"end":return r.stop()}}),r,null,[[1,29]])})))()}},{key:"reload",value:function(){this.initPlayerNow()}},{key:"start",value:function(){this._start()}},{key:"_start",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;r(_regeneratorRuntime().mark((function n(){var r,i,o,a,s;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.player){n.next=21;break}if("stopped"!=t.player.getPlayState()){n.next=20;break}!l||!l.playing||l==t&&e||l.stop(),l=t,t._playing=!0,r=t.currentTime,0==t.ns.notes.filter((function(e){return e.startTime>r})).length&&(r=0),t.currentTime=r,t.controlPanel.classList.remove("stopped"),t.controlPanel.classList.add("playing"),n.prev=5,i=_createForOfIteratorHelper(t.visualizerListeners.keys());try{for(i.s();!(o=i.n()).done;)(a=o.value).noteSequence!=t.ns&&(a.noteSequence=t.ns,a.reload())}catch(e){i.e(e)}finally{i.f()}return s=t.player.start(t.ns,void 0,r),e?t.dispatchEvent(new CustomEvent("loop")):t.dispatchEvent(new CustomEvent("start")),n.next=12,s;case 12:t.handleStop(!0),n.next=18;break;case 15:throw n.prev=15,n.t0=n.catch(5),t.handleStop(),n.t0;case 18:n.next=21;break;case 20:"paused"==t.player.getPlayState()&&t.player.resume();case 21:case"end":return n.stop()}}),n,null,[[5,15]])})))()}},{key:"stop",value:function(){this.player&&this.player.isPlaying()&&this.player.stop(),this.handleStop(!1)}},{key:"addVisualizer",value:function(e){for(var t=this,n={start:function(){e.noteSequence=t.noteSequence},stop:function(){e.clearActiveNotes()},note:function(t){e.redraw(t.detail.note)}},r=0,i=c;r<i.length;r++){var o=i[r];this.addEventListener(o,n[o])}this.visualizerListeners.set(e,n)}},{key:"removeVisualizer",value:function(e){for(var t=this.visualizerListeners.get(e),n=0,r=c;n<r.length;n++){var i=r[n];this.removeEventListener(i,t[i])}this.visualizerListeners.delete(e)}},{key:"noteCallback",value:function(e){this.playing&&(this.dispatchEvent(new CustomEvent("note",{detail:{note:e}})),this.seeking||(this.seekBar.value=String(e.startTime),this.currentTimeLabel.textContent=a(e.startTime)))}},{key:"handleStop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e){if(this.loop)return this.currentTime=0,void this._start(!0);this.currentTime=this.duration}this.controlPanel.classList.remove("playing"),this.controlPanel.classList.add("stopped"),this._playing&&(this._playing=!1,this.dispatchEvent(new CustomEvent("stop",{detail:{finished:e}})))}},{key:"setVisualizerSelector",value:function(e){var t,n=_createForOfIteratorHelper(this.visualizerListeners.values());try{for(n.s();!(t=n.n()).done;)for(var r=t.value,i=0,o=c;i<o.length;i++){var a=o[i];this.removeEventListener(a,r[a])}}catch(e){n.e(e)}finally{n.f()}if(this.visualizerListeners.clear(),null!=e){var s,l=_createForOfIteratorHelper(document.querySelectorAll(e));try{for(l.s();!(s=l.n()).done;){var h=s.value;h instanceof u?this.addVisualizer(h):console.warn("Selector ".concat(e," matched non-visualizer element"),h)}}catch(e){l.e(e)}finally{l.f()}}}},{key:"setLoading",value:function(){this.playButton.disabled=!0,this.seekBar.disabled=!0,this.controlPanel.classList.remove("error"),this.controlPanel.classList.add("loading","frozen"),this.controlPanel.removeAttribute("title")}},{key:"setLoaded",value:function(){this.controlPanel.classList.remove("loading","frozen"),this.playButton.disabled=!1,this.seekBar.disabled=!1}},{key:"setError",value:function(e){this.playButton.disabled=!0,this.seekBar.disabled=!0,this.controlPanel.classList.remove("loading","stopped","playing"),this.controlPanel.classList.add("error","frozen"),this.controlPanel.title=e}},{key:"noteSequence",get:function(){return this.ns},set:function(e){this.ns!=e&&(this.ns=e,this.removeAttribute("src"),this.initPlayer())}},{key:"src",get:function(){return this.getAttribute("src")},set:function(e){this.ns=null,this.setOrRemoveAttribute("src",e),this.initPlayer()}},{key:"soundFont",get:function(){return this.getAttribute("sound-font")},set:function(e){this.setOrRemoveAttribute("sound-font",e)}},{key:"loop",get:function(){return null!=this.getAttribute("loop")},set:function(e){this.setOrRemoveAttribute("loop",e?"":null)}},{key:"currentTime",get:function(){return parseFloat(this.seekBar.value)},set:function(e){this.seekBar.value=String(e),this.currentTimeLabel.textContent=a(this.currentTime),this.player&&this.player.isPlaying()&&this.player.seekTo(e)}},{key:"duration",get:function(){return parseFloat(this.seekBar.max)}},{key:"playing",get:function(){return this._playing}},{key:"setOrRemoveAttribute",value:function(e,t){null==t?this.removeAttribute(e):this.setAttribute(e,t)}}],[{key:"observedAttributes",get:function(){return["sound-font","src","visualizer"]}}])}();window.customElements.define("midi-player",h),window.customElements.define("midi-visualizer",u),e.PlayerElement=h,e.VisualizerElement=u,Object.defineProperty(e,"__esModule",{value:!0})}));