"use strict";var domain="https://comments.saobby.com";function get_verification_code(){gebi("check-btn").disabled=!0,fetch_data(domain+"/api/get_aerfaying_verification_code","POST",headers,JSON.stringify({})).then((function(e){var t=JSON.parse(e.response_text);t.success?(gebi("comment-content").innerHTML=t.data.auth_key,gebi("timestamp").value=t.data.timestamp,gebi("signature").value=t.data.signature,gebi("check-btn").disabled=!1):gebi("comment-content").innerHTML="无法加载评论内容，因为:".concat(t.message,"，请刷新页面")}),(function(e){gebi("comment-content").innerHTML="无法加载评论内容，因为:".concat(e.message,"，请刷新页面")}))}function check_comment(){set_btn_html(gebi("check-btn"),"请完成人机验证"),saobbyCaptchaV2.open_window_and_return_promise().then((function(e){set_btn_html(gebi("check-btn"),"请稍候");var t={access_token:localStorage["access-token"],captcha_token:gebi("scpc-token").value,timestamp:gebi("timestamp").value,signature:gebi("signature").value,auth_key:gebi("comment-content").innerHTML};fetch_data(domain+"/api/set_aerfaying_uid","POST",headers,JSON.stringify(t)).then((function(e){var t=JSON.parse(e.response_text);t.success?gebi("result").innerHTML="绑定成功!有人回复你的评论时，你将会在阿尔法营收到提醒消息":gebi("result").innerHTML=t.message,set_btn_html(gebi("check-btn"))}),(function(e){gebi("result").innerHTML=e.message,set_btn_html(gebi("check-btn"))}))}),(function(e){gebi("result").innerHTML="请先完成人机验证:"+e.message,set_btn_html(gebi("check-btn"))}))}function unbind(){set_btn_html(gebi("unbind-btn"),"请稍候"),fetch_data(domain+"/api/unbind_aerfaying","POST",headers,JSON.stringify({access_token:localStorage["access-token"]})).then((function(e){var t=JSON.parse(e.response_text);t.success?gebi("result2").innerHTML="解绑成功!":gebi("result2").innerHTML=t.message,set_btn_html(gebi("unbind-btn"))}),(function(e){gebi("result2").innerHTML=e.message,set_btn_html(gebi("unbind-btn"))}))}get_verification_code(),null==localStorage.getItem("access-token")&&(localStorage.login_redirect=window.location.href,window.location="/login");