var domain="https://ooocommenthk.saobby.cf";function get_verification_code(){var e=new XMLHttpRequest;e.open("POST",domain+"/api/get_aerfaying_verification_code",!0),e.setRequestHeader("Content-Type","application/json"),e.send(JSON.stringify({})),e.onreadystatechange=function(){if(4==e.readyState){if(504==e.status)return void(document.getElementById("comment-content").innerHTML="请求超时!请刷新页面");var t=JSON.parse(e.responseText);document.getElementById("comment-content").innerHTML=t.data.auth_key,document.getElementById("timestamp").value=t.data.timestamp,document.getElementById("signature").value=t.data.signature}}}function check_comment(){get_captcha_img(),document.getElementById("captcha-window").hidden=!1}function complete_captcha(){document.getElementById("check-btn").disabled=!0,document.getElementById("check-btn").innerHTML="请稍候";var e=new XMLHttpRequest;e.open("POST",domain+"/api/set_aerfaying_uid",!0),e.setRequestHeader("Content-Type","application/json");var t={access_token:localStorage["access-token"],captcha_token:document.getElementById("captcha-token").value,timestamp:document.getElementById("timestamp").value,signature:document.getElementById("signature").value,auth_key:document.getElementById("comment-content").innerHTML};e.send(JSON.stringify(t)),e.onreadystatechange=function(){if(4==e.readyState){if(document.getElementById("check-btn").disabled=!1,document.getElementById("check-btn").innerHTML="我已评论",504==e.status)return void(document.getElementById("result").innerHTML="请求超时!请刷新页面");var t=JSON.parse(e.responseText);t.success?document.getElementById("result").innerHTML="绑定成功!有人回复你的评论时，你将会在阿尔法营收到提醒消息":document.getElementById("result").innerHTML=t.message}}}function unbind(){document.getElementById("unbind-btn").disabled=!0,document.getElementById("unbind-btn").innerHTML="请稍候";var e=new XMLHttpRequest;e.open("POST",domain+"/api/unbind_aerfaying",!0),e.setRequestHeader("Content-Type","application/json");var t={access_token:localStorage["access-token"]};e.send(JSON.stringify(t)),e.onreadystatechange=function(){if(4==e.readyState){if(document.getElementById("unbind-btn").disabled=!1,document.getElementById("unbind-btn").innerHTML="解除绑定",504==e.status)return void(document.getElementById("result2").innerHTML="请求超时!请刷新页面");var t=JSON.parse(e.responseText);t.success?document.getElementById("result2").innerHTML="解绑成功!":document.getElementById("result2").innerHTML=t.message}}}get_verification_code(),null==localStorage.getItem("access-token")&&(localStorage.login_redirect=window.location.href,window.location="/login");
